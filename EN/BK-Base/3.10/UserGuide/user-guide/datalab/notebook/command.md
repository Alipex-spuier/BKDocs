## Notebook command set

### Features

Notebook serves as the entrance to platform data operations, provides relevant instruction sets for result table operations, and supports update operations on result table data (insert data, delete data, modify data, etc.) and create and delete result table operations.



### Preliminary knowledge: Type of result table generated by Notebook

Notebook tasks, cleaning tasks, and data development tasks can all generate result tables. The result tables generated in Notebook include two types: temporary result tables and snapshot result tables.

#### Temporary result table

The temporary result table can be understood as a draft table created by the user, and the result table data can be updated freely in the Notebook where the result table is created.

The scope of the temporary result table is within the Notebook task that generated the result table (data modification of the result table is supported within the same Notebook, and data query of the result table is supported within the same project).

The default storage type associated with the temporary result table is HDFS, and specifying other storage types is not supported.

#### Snapshot result table

If the data in the temporary result table meets the user's requirements and you want to use this data in other places on the platform, you can complete the online operation of the temporary result table and become the official snapshot result table of the platform.

The snapshot result table is the official result table of the platform. The platform does not add time fields to the snapshot table. It supports associated HDFS storage and Ignite storage, and can be used as static associated data for data development tasks.



### Result table related instruction set

- #### Create a temporary result table based on DataFrame data

##### Instruction description

Create a temporary result table and import data from Pandas DataFrame into the temporary result table

##### Scope of application

The result table created based on this command is a temporary result table. If you need to convert it to the platform's official result table, please refer to the following document "Temporary result table goes online into the platform's official result table"

##### How to use

```python
ResultTable.create(dataframe, result_table_id)
"""
:param dataframe: pandas dataframe
:param result_table_id: created result table id

:return: execution result, success or failure
"""
```

##### Usage examples

```python
import pandas as pd
df = pd.read_csv('file path', encoding='utf-8-sig')
ResultTable.create(dataframe=df, result_table_id='591_test')
```



- #### Insert data

##### Instruction description

Insert data into the result table. Data insertion operations are only supported for HDFS storage types.

##### Scope of application

Currently, the data insertion operation can only operate on the temporary result table generated by this Notebook, and cannot operate on the temporary result table generated by other Notebooks. The insertion operation of the platform's official result table is not supported at the moment.

##### How to use

```python
ResultTable.insert(result_table_id, column_names, column_values)
"""
:param result_table_id: result table id
:param column_names: field names
:param column_values: field values

:return: execution result, success or failure
"""
```

##### Usage examples

```python
ResultTable.insert(
     result_table_id='591_test',
     column_names=['user', 'ip'],
     column_values=[['zhang', '10.0.0.1'], ['liu', '10.0.0.1']]
)
```

##### Equivalent to SQL

```sql
INSERT INTO 591_test (user, ip) VALUES ('zhang', '10.0.0.1'), ('liu', '10.0.0.1');
```



- #### delete data

##### Instruction description

Deleting data from the result table only supports data deletion operations on the HDFS storage type.

##### Scope of application

Currently, the data deletion operation can only be applied to the temporary result table generated by this Notebook, and cannot operate on the temporary result table generated by other Notebooks. The deletion operation of the platform's official result table is not supported for the time being.

##### How to use

```python
ResultTable.delete(result_table_id, conditions)
"""
:param result_table_id: result table id
:param conditions: delete conditions

:return: execution result, success or failure
"""
```

##### Usage examples

```python
ResultTable.delete(
     result_table_id='591_test',
     conditions=[
         {'column_name': 'thedate', 'operator': '<', 'right_value': 20210101, 'condition': 'and'},
         {'column_name': 'ip', 'operator': '=', 'right_value': '10.0.0.1'}
     ]
)
```

##### Equivalent to SQL

```sql
DELETE FROM 591_test WHERE thedate < 20210101 AND ip = '10.0.0.1';
```



- #### change the data

##### Instruction description

Modifying data in the result table only supports data modification operations on the HDFS storage type.

##### Scope of application

Currently, the data modification operation can only be applied to the temporary result table generated by this Notebook. Temporary result tables generated by other Notebooks cannot be operated. Modification operations of the platform's official result table are not supported for the time being.

##### How to use

```python
ResultTable.update(result_table_id, conditions, values)
"""
:param result_table_id: result table id
:param conditions: update conditions
:param values: update content

:return: execution result, success or failure
"""
```

##### Usage examples

```python
ResultTable.update(
     result_table_id='591_test',
     conditions=[
         {'column_name': 'thedate', 'operator': '<', 'right_value': 20210101, 'condition': 'and'},
         {'column_name': 'ip', 'operator': '=', 'right_value': '10.0.0.1'}
     ],
     values={'user': 'lili', 'ip': '10.0.0.1'}
)
```

##### Equivalent to SQL

```sql
UPDATE 591_test SET user = 'lili', ip = '10.0.0.1' WHERE thedate < 20210101 AND ip = '10.0.0.1';
```



- #### The temporary result table is online and becomes the official result table of the platform.


##### Instruction description

​ The temporary result table can be online in Notebook. After the online operation is completed, it can be used as the official snapshot result table of the platform (the time field will not be added).

##### Scope of application

The current online operation is applicable to online the temporary result table into the official result table of the platform. The storage type associated with the official result table currently only supports HDFS and Ignite. The online operation of the platform’s official results table is not supported.

##### How to use

```python
ResultTable.save(src_rt, dst_rt, storage, storage_config, cluster_name)
"""
:param src_rt: source table result table name
:param dst_rt: target table result table name

The following three items are optional. If not filled in, a result table associated with HDFS storage will be created by default.
:param storage: Storage type (optional, only HDFS and Ignite storage types are currently supported)
:param storage_config: storage configuration (optional)
:param cluster_name: cluster name (optional)

:return: execution result, success or failure
"""
```

##### Usage examples

```python
# Generate the result table 591_snapshot associated with HDFS storage
ResultTable.save(
     src_rt='591_queryset',
     dst_rt='591_snapshot'
)
```

```python
# Generate the result table 591_snapshot2 associated with Ignite storage, storage_keys represents "unique key formation", and indexed_fields represents "index fields"
storage_config = {
     'storage_keys': ['ip'],
   'indexed_fields': ['ip']
}
ResultTable.save(
     src_rt='591_queryset',
     dst_rt='591_snapshot2',
     storage='ignite',
     storage_config=storage_config
)
```

##### Tips: storage_keys and indexed_fields are equivalent to the following configuration of the data storage page

![](../../../assets/datalab/notebook/feature-guide/save_ignite.png)



- #### Delete result table

##### Instruction description

Delete the temporary results table generated in Notebook

##### Scope of application

Currently, the deletion of result table operation can only be applied to the temporary result table generated by this Notebook. Temporary result tables generated by other Notebooks cannot be operated. Deletion of the official result table of the platform is not supported for the time being.

##### How to use

```python
ResultTable.drop(result_table_id, storage)
"""
:param result_table_id: result table id
:param storage: storage type (required, temporarily fill in 'all', which means deleting the result table and all its associated storage)

:return: execution result, success or failure
"""
```

##### Usage examples

```python
ResultTable.drop(result_table_id='591_test', storage='all')
```

##### Equivalent to SQL

```sql
DROP TABLE 591_test;
```