# Host-OS metrics

The built-in host indicators are collected through basereport. Different monitoring systems may have differences in calculation methods. Understanding the calculation methods can better understand the collected data.

| Indicator | Type | Unit | Meaning | Collection method (Linux) | Collection method (Windows) |
|------| --- | ---- | -----| -------------- | ---------------- |
| 5-minute load average | CPU | % | Average number of processes that are ready at the same time over five minutes | awk ‘{print $2}’ /proc/loadavg | N/A |
| cpu total usage | CPU | % | Percentage of total CPU currently consumed | delta(busy) / delta(total) * 100 busy = user + sys + nice + iowait + irq + softirq + steal + guest + guestnice + stolen total = busy + idle | for /f “tokens=1,2,* delims==” %i in ('wmic path Win32_PerfFormattedData_Counters_ProcessorInformation where "Name='_Total'" get PercentIdleTime/value &#124; findstr PercentIdleTime') do ( set /a 100-%j) |
| cpu single core usage | CPU | % | current percentage of single CPU consumption | delta(busy) / delta(total) * 100 busy = user + sys + nice + iowait + irq + softirq + steal + guest + guestnice + stolen total = busy + idle | for /f “tokens=1,2,* delims==” %i in ('wmic path Win32_PerfFormattedData_Counters_ProcessorInformation where “not name like '%Total%'” get PercentIdleTime/value &#124; findstr PercentIdleTime ') do (set /a 100-%j) |
| Receive byte traffic | Network | KB/s | The number of bits received by the network card per second, that is, the upstream bandwidth of the network card | Read the 1st item of the /proc/net/dev file SpeedRecv = delta(new.BytesRecv, old.BytesRecv) /interval | wmic path Win32_PerfRawData_Tcpip_NetworkInterface get BytesReceivedPersec/value &#124; findstr BytesReceivedPersec |
| Send byte traffic | Network | KB/s | The number of bits sent by the network card per second, that is, the downstream bandwidth of the network card | Read the 9th item of the /proc/net/dev file SpeedSent = delta(new.BytesSent, old.BytesSent) /interval | wmic path Win32_PerfRawData_Tcpip_NetworkInterface get BytesSentPersec/value &#124; findstr BytesSentPersec |
| Sending packet rate | Network | Packets/s | Number of data packets received by the network card per second | Read /proc/net/dev file item 10 SpeedPacketsSent = (counterDiff(once.Stat[i].PacketsSent, val.PacketsSent, NetCoutnerMaxSize)) / interval | wmic path Win32_PerfRawData_Tcpip_NetworkInterface get PacketsSentPersec/value &#124; findstr PacketsSentPersec |
| Receive packet rate | Network | Packets/s | Number of data packets sent by the network card per second | Read /proc/net/dev file item 2 SpeedPacketsRecv = delta(new.PacketsRecv, old.PacketsRecv) / interval | wmic path Win32_PerfRawData_Tcpip_NetworkInterface get PacketsReceivedPersec/value &#124; findstr PacketsReceivedPersec |
| Number of established connections | Network | | Number of connections with TCP links in the ESTABLISHED state under the current server | System netlink implementation verification method netstat -pant&#124;grep ESTABLISHED | netstat -ano -p tcp &#124; more +4 &# 124; find " ESTABLISHED " |
| time_wait number of connections | network | | number of connections with TCP links in the TIME_WAIT state under the current server | system netlink implementation verification method netstat -pant&#124;grep TIME_WAIT | netstat -ano -p tcp &#124; more +4 &# 124; find " TIME_WAIT " |
| listen number of connections | network | | number of connections with TCP links in the LISTEN state under the current server | system netlink implementation verification method netstat -pant&#124;grep LISTEN | netstat -ano -p tcp &#124; more +4 &# 124; find " LISTENING " |
| last_ack number of connections | network | | number of connections with TCP links in the LAST_ACK state under the current server | system netlink implementation verification method netstat -pant&#124;grep LAST_ACK | netstat -ano -p tcp &#124; more +4 &# 124; find " LAST_ACK " |
| syn_recv Number of connections | Network | | Number of connections with TCP links in the SYN_RECV state under the current server | System netlink implementation verification method netstat -pant&#124;grep SYNC_RECV | netstat -ano -p tcp &#124; more +4 &# 124; find " SYN_RECV " |
| syn_sent number of connections | network | | number of connections with TCP links in the SYN_SENT state under the current server | system netlink implementation verification method netstat -pant&#124;grep SYNC_SENT | netstat -ano -p tcp &#124; more +4 &# 124; find " SYN_SENT " |
| fin_wait1 Number of connections | Network | | Number of connections with TCP links in the FIN_WAIT1 state under the current server | System netlink implementation verification method netstat -pant&#124;grep FIN_WAIT1 | netstat -ano -p tcp &#124; more +4 &# 124; find " FIN_WAIT_1 " |
| fin_wait2 Number of connections | Network | | Number of connections with TCP links in the FIN_WAIT2 state under the current server | System netlink implementation verification method netstat -pant&#124;grep FIN_WAIT2 | netstat -ano -p tcp &#124; more +4 &# 124; find " FIN_WAIT_2 " |
| number of closing connections | network | | number of connections with TCP links in the CLOSING state under the current server | system netlink implementation verification method netstat -pant&#124;grep CLOSING | netstat -ano -p tcp &#124; more +4 &# 124; find " CLOSING " |
| Number of closed status connections | Network | | Number of connections with TCP links in the CLOSED state under the current server | System netlink implementation verification method netstat -pant&#124;grep CLOSED | netstat -ano -p tcp &#124; more +4 & #124; find " CLOSE " |
| Number of UDP packets received | Network | | Number of UDP packets received | Read /proc/net/snmp file InDatagrams item cat /proc/net/snmp&#124;grep Udp:&#124;grep -v 'InDatagrams'& #124;awk '{print $2}' | wmic path Win32_PerfFormattedData_Tcpip_UDPv4 get DatagramsReceivedPersec/value |
| Number of UDP packets sent | Network | | Number of UDP packets sent | Read /proc/net/snmp file OutDatagrams item cat /proc/net/snmp&#124;grep Udp:&#124;grep -v 'InDatagrams'& #124;awk '{print $5}' | Read item 2 of /proc/net/dev file SpeedPacketsRecv = delta(new.PacketsRecv, old.PacketsRecv) / interval |
| Available physical memory | Memory | MB | Available memory capacity | Read /proc/meminfo file MemTotal field *1024     `cat /proc/meminfo |grep 'MemTotal'|awk -F ':' '{print $2}'|awk '{print $1}'|awk '{print $1 * 1024}'`       | `for /f “tokens=1,2,* delims==” %i in (‘wmic OS get FreePhysicalMemory/value| findstr FreePhysicalMemory’) do (set /a %j/1024)` |
| Swap partition usage | Memory | MB | Swap partition usage capacity | Read /proc/meminfo file golang system call syscall.Sysinfo sysinfo.Totalswap - sysinfo.Freeswap verification method free -m | wmic os get TotalSwapSpaceSize/value |
| Physical memory usage | Memory | % | Memory usage percentage | Read /proc/meminfo file [MemTotal-MemFree]/MemTotal*100.0 | wmic os get FreePhysicalMemory,TotalVisibleMemorySize/value |
| Physical memory usage | Memory | MB | Used memory capacity | Read /proc/meminfo file [MemTotal-MemFree]*1024 | wmic os get FreePhysicalMemory,TotalVisibleMemorySize/value &#124; findstr “FreePhysicalMemory TotalVisibleMemorySize” |
| Application memory usage | Memory | MB | The amount of memory used by the application process | Read the /proc/meminfo file. If there is a MemAvailable field (different system versions vary) (MemTotal-MemAvailable)/1024, if there is no such field, MemAvailable= MemFree+Buffers+Cached | N/A |
| Application memory usage | Memory | % | Application process memory as a percentage of total memory | Read /proc/meminfo file (MemTotal-MemAvailable)/(MemTotal*100.0), if there is no MemAvailable field, MemAvailable=MemFree+Buffers +Cached | N/A |
| Disk usage | Disk | % | Percentage of disk used space | golang system call syscall.Statfs is equivalent to df | for /f “tokens=1,2,* delims==” %i in ('wmic path Win32_PerfFormattedData_PerfDisk_LogicalDisk where “name like '%:%'" get PercentFreeSpace/value &#124; findstr PercentFreeSpace') do (set /a 100-%j) |
| Read rate | Disk | Times/s | Disk output times per second | Read the fourth item of each line of /proc/diskstats float64((new_stat.ReadCount - stat.ReadCount)) / 60 only report logical partitions | wmic path Win32_PerfFormattedData_PerfDisk_LogicalDisk get DiskReadsPersec/value |
| Write rate | Disk | Times/s | Disk writes per second | Read /proc/diskstats item 8 float64((new_stat.WriteCount - stat.WriteCount)) / 60 only report logical partitions | wmic path Win32_PerfFormattedData_PerfDisk_LogicalDisk get DiskWritesPersec /value |
| Disk IO Usage | Disk | % | Percentage of time disk was active | Read /proc/diskstats file Read /proc/diskstats Item 13 (new_stat.ITime - stat.ITime)/60.0 / 1000.0 | for /f "tokens=1,2,* delims==" %i in ('wmic path Win32_PerfFormattedData_PerfDisk_LogicalDisk where "Name='_Total'" get PercentIdleTime/value &#124; findstr PercentIdleTime') do (set /a 100-%j) |
| Number of system processes | Processes | | Number of system started processes | Capture the number of all subdirectories under the /proc directory | wmic path win32_process get ProcessId/value |