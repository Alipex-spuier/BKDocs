# Various process configuration methods

There are many ways to start a process and various usage scenarios. How to configure in CMDB to meet the needs of process monitoring under various process configurations.

The following introduces various process configuration cases, and gives the configuration methods and feasibility.

```
Note: Try to use the complete name obtained by readlink -f /proc/${pid}/exe for the process name, such as /usr/local/bin/pyton
```

### Situation 1: Start with the same machine, the same binary name (same path) and different parameters

Such as the startup method of Java and Python interpreter classes.

```bash
root 13670 0.9 17.8 48339468 17593272 ? Sl January 01 290:11 java -server -Xms24g -Xmx24g -XX:MaxDirectMemorySize=32g -XX:+ExitOnOutOfMemoryError -Duser.timezone=UTC -Dfile.encoding=UTF-8 -Djava.io .tmpdir=var/tmp -Djava.util.logging.manager=org.apache.logging.log4j.jul.LogManager -cp /data/mapleleaf/druid/conf/druid/cluster/query/broker:/data/mapleleaf/ druid/conf/druid/cluster/query/_common:/data/mapleleaf/druid/conf/druid/cluster/query/_common/hadoop-xml:/data/mapleleaf/druid/conf/druid/cluster/query/.. /_common:/data/mapleleaf/druid/conf/druid/cluster/query/../_common/hadoop-xml:/data/mapleleaf/druid/bin/../lib/* org.apache.druid.cli. Main server broker
root 27012 0.2 0.5 14885784 538188 ? Sl January 15 24:30 java -server -Xms512m -Xmx512m -XX:+ExitOnOutOfMemoryError -Duser.timezone=UTC -Dfile.encoding=UTF-8 -Djava.io.tmpdir=var/tmp -Djava.util.logging.manager=org.apache.logging.log4j.jul.LogManager -cp /data/mapleleaf/druid/conf/druid/cluster/data/middleManager:/data/mapleleaf/druid/conf/druid/ cluster/data/_common:/data/mapleleaf/druid/conf/druid/cluster/data/_common/hadoop-xml:/data/mapleleaf/druid/conf/druid/cluster/data/../_common:/data/ mapleleaf/druid/conf/druid/cluster/data/../_common/hadoop-xml:/data/mapleleaf/druid/bin/../lib/* org.apache.druid.cli.Main server middleManager
```

*Configuration method:
     * Process name: binary name without path, such as `java`
     * Process alias: Displayed and identifiable, such as `druid-broker`
     * Startup parameters: uniquely distinguishable parameter names, such as `/data/mapleleaf/druid/conf/druid/cluster/query/broker`

### Case 2: Same binary name, different paths, no parameters

This type either does not need to enable the port, or the configuration uses the same working directory as the binary, etc.

```bash
/opt/gosuv
/usr/local/gosuv
```

*Configuration method: Not supported at the moment, the function needs to be improved.

### Scenario 3: Same machine, same binary name, different paths, same parameters

Services such as Nginx, MySQL, Redis, etc. support relative path parameters.

```bash
/usr/local/bin/redis-server ./redis.conf
/usr/bin/redis-server ./redis.conf
```

*Configuration method: Not supported at the moment, the function needs to be improved.

### Scenario 4: Same machine, same binary name, different paths, same process display, same parameters

Services such as Nginx, MySQL, Redis, etc. support relative path parameters. Because you use cd to the destination directory and then start, this type of configuration is not recommended because it will complicate management.

```bash
./redis-server ./redis.conf
./redis-server ./redis.conf
```

*Configuration method: Not supported at the moment, the function needs to be improved.

### Scenario 5: The dimension identifier of the process cannot be defined and is dynamically generated by the program.

Everything else is the same, only the containers part is different:

```bash
     /bin/java -Xms30720m -Xmx30720m -XX:+UseConcMarkSweepGC -XX:CMSInitiatingOccupancyFraction=75 -XX:+UseCMSInitiatingOccupancyOnly -XX:+DisableExplicitGC -XX:+AlwaysPreTouch -server -Djava.awt.headless=true -Dfile.encoding=UTF -8 -Djna.nosys=true -Dio.netty.noUnsafe=true -Dio.netty.noKeySetOptimization=true -Dlog4j.shutdownHookEnabled=false -Dlog4j2.disable.jmx=true -Dlog4j.skipJansi=true -XX:+HeapDumpOnOutOfMemoryError - Des.path.home=/data1/containers/1495608881000003411/es -cp /data1/containers/1495608881000003411/es/lib/* org.elasticsearch.bootstrap.Elasticsearch -d
```

One of the dimension names that you want to finally report is `/containers/1495608881000003411`.

The process is dynamically forked from the main program, such as game room opening.

In this case, the process program that is dynamically generated by the program cannot be guaranteed by monitoring itself or manual detection. Performance data can only be provided by the main program.

*Configuration method: currently not supported and needs to be improved.

### Situation 6: Windows processes are case-sensitive

* Configuration method: Change all process names to lowercase, and the function needs to be improved.

### Scenario 7: Soft connection process

```bash
mysql 26921 0.0 0.1 116352 1876 ? Ss 00:41 0:00 /bin/sh /usr/bin/mysqld_safe --basedir=/usr
mysql 27120 0.0 8.0 1103564 82072 ? Sl 00:41 0:24 /usr/libexec/mysqld --basedir=/usr --datadir=/var/lib/mysql --plugin-dir=/usr/lib64/mysql/plugin --log-error=/var/log/mariadb/mariadb.log --pid-file=/var/run/mariadb/mariadb.pid --socket=/var/lib/mysql/mysql.sock
```

The mysqld_safe process is sh, which is actually a soft link, so currently only bash can be configured.


The function needs to be improved.

### Case 8: Only port but no process name

This situation does not belong to process monitoring, but to local port probing.

*Configuration method: Implemented by writing scripts through plug-ins.