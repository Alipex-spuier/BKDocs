
    <html lang="zh-cn">
    <head>
    <meta content="text/html; charset=utf-8" http-equiv="content-type" />
    <link href="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/default.css" rel="stylesheet">
    </head>
    <body>
    <h1 id="api">API 简介</h1>
<p>蓝鲸 API 文档已同步到社区版 6.0 版本。在 6.0 版本基础上，API 接口文档更加规范和全面。</p>
<p>蓝鲸系统允许你以编程方式获取和修改蓝鲸的配置，并提供对数据的访问。</p>
<p>主要用于：
 - SaaS 研发过程中，通过 API 来使用蓝鲸各产品的数据；
 - 将蓝鲸与第三方系统集成；
 - 自动化执行常规任务等。</p>
<p>API 主要包含以下几种方法：get, create/add, update, delete, find/search, send, import, export 等</p>
<p><strong>注意：</strong>
部分 API 预计于下一个版本下线（2020 年 6 月之后）<a href="../开发指南/即将下掉的API接口和变量/readme.md">下线 API 公示</a></p>
<h2 id="api_1">API 调用</h2>
<p>调用 API 主要有两种方式，一种是使用 SaaS 开发框架中提供的 SDK 包，一种是根据 API 地址直接访问。</p>
<h2 id="api_2">API 调用说明</h2>
<p>请求 API 时，需提供 APP 应用认证信息(bk_app_code、bk_app_secret)和用户认证信息(bk_token、bk_username)，用以对 APP 应用和当前用户进行认证。</p>
<h2 id="saas">SaaS 应用认证信息</h2>
<p>使用 API 前，需先根据已有应用或创建一个应用，获取应用 ID 和安全密钥，作为应用认证信息。</p>
<ul>
<li>
<p>应用 ID: 应用唯一标识，创建应用时由创建者指定，可在应用基本信息中通过 应用 ID 获取</p>
</li>
<li>
<p>安全密钥: 应用密钥，创建应用后由平台生成，可在应用基本信息中通过 安全密钥 获取</p>
</li>
</ul>
<h2 id="_1">用户认证信息</h2>
<p>用户认证，通过验证用户登录态实现。用户登录态 bk_token，在用户登录后，存储在浏览器的 Cookies 中。</p>
<p>调用 API 时，若无法提供用户登录态，可将应用 ID 添加到应用免登录态验证白名单中，则此应用请求 API 时，提供当前用户的 bk_username 即可。</p>
<ul>
<li>
<p>functioncontroller: 通用白名单管理，通过指定不同的功能 code，维护不同的白名单</p>
</li>
<li>
<p>user_auth::skip_user_auth: "应用免登录态验证白名单" 功能 code，添加此功能 code，然后将应用 ID 添加到"功能测试白名单"中
。</p>
</li>
</ul>
<h2 id="saas-sdk">使用 SaaS 开发框架中的 SDK 包</h2>
<p>使用 SDK 包访问 API 有两种方式 shortcuts 或 ComponentClient。使用示例如下：</p>
<ul>
<li>shortcuts -- get_client_by_request</li>
</ul>
<pre class="codehilite"><code class="language-python">    from blueking.component.shortcuts import get_client_by_request
    # 默认从django settings中获取APP认证信息：应用ID和安全密钥
    # 默认从django request中获取用户登录态bk_token
    client = get_client_by_request(request)
    # 参数
    kwargs = {'bk_biz_id': 1}
    result = client.cc.get_app_host_list(kwargs)</code></pre>


<ul>
<li>shortcuts -- get_client_by_user</li>
</ul>
<pre class="codehilite"><code class="language-python">    from blueking.component.shortcuts import get_client_by_user
    # 默认从django settings中获取APP认证信息：应用ID和安全密钥
    # 默认从user中获取username，user为User对象或直接为User中username数据
    user = 'username'
    client = get_client_by_user(user)
    # 参数
    kwargs = {'bk_biz_id': 1}
    result = client.cc.get_app_host_list(kwargs)</code></pre>


<ul>
<li>ComponentClient</li>
</ul>
<pre class="codehilite"><code class="language-python">     from blueking.component.client import ComponentClient
     # APP应用ID
     bk_app_code = 'xxx'
     # APP安全密钥
     bk_app_secret = 'xxx-xxx-xxx-xxx-xxx'
     # 用户登录态信息
     common_args = {'bk_token': 'xxx'}
     # APP应用ID和APP安全密钥如未提供，默认从django settings中获取
     client = ComponentClient(
         bk_app_code=bk_app_code,
         bk_app_secret=bk_app_secret,
         common_args=common_args
     )
     # 参数
     kwargs = {'bk_biz_id': 1}
     result = client.cc.get_app_host_list(kwargs)
 ```

### APP 开发框架中的 SDK 包

SDK 包默认包含系统提供的所有 API；

用户开发的组件及自助接入的 API，可以通过以下步骤添加到 SDK 包：

- 在 APP 开发框架 blueking/component/apis 目录下，创建系统包文件，如系统名称为 agent，可创建系统包文件 agent.py
- 系统包文件中添加 API 信息，如 agent.py 中添加 create_task 的访问入口

```python
# -*- coding: utf-8 -*-
from ..base import ComponentAPI

# 系统API集合类的名称，一般为 Collections + 系统名
class CollectionsAGENT(object):

    def __init__(self, client):
        self.client = client

        # create_task为API名，method为请求API使用的方法，path为API路径，API域名为系统默认域名
        self.create_task = ComponentAPI(
            client=self.client, method='POST', path='/api/c/compapi/agent/create_task/',
            description=u'',
        )</code></pre>


<ul>
<li>在 blueking/component/collections.py 中加入系统 API 文件信息（若已加入则忽略此步骤）</li>
</ul>
<pre class="codehilite"><code class="language-python"># 导入路径
from .apis.agent import CollectionsAGENT

AVAILABLE_COLLECTIONS = {
    'cc': CollectionsCC,
    'job': CollectionsJOB,
    'bk_login': CollectionsBkLogin,

    # 此处加入新包信息
    'agent': CollectionsAGENT,
}</code></pre>


<h2 id="api_3">根据 API 地址直接访问</h2>
<p>请求参数包括：应用信息(bk_app_code + bk_app_secret)，用户信息(bk_token 或 bk_username)，及请求参数</p>
<p>用 curl 直接访问示例如下：</p>
<pre class="codehilite"><code class="language-bash">    curl -d '{&quot;bk_app_code&quot;: &quot;xxx&quot;, &quot;bk_app_secret&quot;: &quot;xxx&quot;, &quot;bk_token&quot;: &quot;xxx&quot;, &quot;bk_biz_id&quot;: 1}' 'http://domain.com/path/'

    curl 'http://domain.com/path/?bk_app_code=xxx&amp;bk_app_secret=xxx&amp;bk_token=xxx&amp;bk_biz_id=1'   # 数据需urlencode编码</code></pre>


<h2 id="api_4">深入了解 API</h2>
<p>你现在知道怎么使用蓝鲸 API ，不要停下来。
去深入了解 <strong>蓝鲸</strong> 吧。
我们建议你查阅：
<a href="../开发指南/扩展开发/API网关/README.md">API 网关</a>、
<a href="../API文档/BK_LOGIN/README.md">蓝鲸统一登录 API 列表</a>、
<a href="../API文档/BK_PAAS/README.md">蓝鲸开发者中心 API 列表</a>、
<a href="../API文档/CMSI/README.md">消息管理 API 列表</a>、
<a href="../API文档/CC/README.md">配置平台 API 列表</a>、
<a href="../API文档/GSE/README.md">管控平台 API 列表</a>、
<a href="../API文档/JOB/README.md">作业平台 API 列表</a>、
<a href="../API文档/MONITOR_V3/README.md">监控平台 API 列表</a>、
<a href="../API文档/SOPS/README.md">标准运维 API 列表</a>。</p><h2 id="api">蓝鲸统一登录 API 简介</h2>
<p><strong>蓝鲸统一登录，管理用户登录验证，及用户信息。</strong></p>
<table>
<thead>
<tr>
<th>资源名称</th>
<th>资源描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="./get_user.md">get_user</a></td>
<td>获取用户信息</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/bk_login/get_user/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>获取用户信息</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h3 id="_6">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
}</code></pre>


<h3 id="_7">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;OK&quot;,
    &quot;data&quot;: {
        &quot;bk_username&quot;: &quot;admin&quot;,
        &quot;qq&quot;: &quot;12345&quot;,
        &quot;bk_role&quot;: 1,
        &quot;language&quot;: &quot;zh-cn&quot;,
        &quot;phone&quot;: &quot;12345678911&quot;,
        &quot;wx_userid&quot;: &quot;&quot;,
        &quot;email&quot;: &quot;11@qq.com&quot;,
        &quot;chname&quot;: &quot;admin&quot;,
        &quot;time_zone&quot;: &quot;Asia/Shanghai&quot;
    }
}</code></pre>


<h3 id="_8">返回结果参数说明</h3>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_username</td>
<td>string</td>
<td>用户名</td>
</tr>
<tr>
<td>qq</td>
<td>string</td>
<td>用户 QQ</td>
</tr>
<tr>
<td>language</td>
<td>string</td>
<td>语言</td>
</tr>
<tr>
<td>phone</td>
<td>string</td>
<td>手机号</td>
</tr>
<tr>
<td>wx_userid</td>
<td>string</td>
<td>企业号用户 USERID/公众号用户 OPENID</td>
</tr>
<tr>
<td>email</td>
<td>string</td>
<td>邮箱</td>
</tr>
<tr>
<td>chname</td>
<td>string</td>
<td>中文名</td>
</tr>
<tr>
<td>time_zone</td>
<td>string</td>
<td>时区</td>
</tr>
</tbody>
</table><h2 id="api">蓝鲸开发者中心 API 简介</h2>
<table>
<thead>
<tr>
<th>资源名称</th>
<th>资源描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="./get_app_info.md">get_app_info</a></td>
<td>获取应用信息</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/bk_paas/get_app_info/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>获取应用信息，支持批量获取</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>target_app_code</td>
<td>string</td>
<td>否</td>
<td>target_app_code 表示应用 ID，多个 ID 以英文分号分隔，target_app_code 为空则表示所有应用</td>
</tr>
<tr>
<td>fields</td>
<td>string</td>
<td>否</td>
<td>fields 需要返回的字段，多个字段以英文分号分割，如果不传或传入 &#34;&#34;，则返回应用的 bk_app_code、bk_app_name 字段。可选的字段有：bk_app_code（应用 ID），bk_app_name（应用名），introduction（应用简介），creator（创建者），developer（开发人员）</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;target_app_code&quot;: &quot;bk_test;esb_test&quot;,
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: [
        {
            &quot;bk_app_code&quot;: &quot;bk_test&quot;,
            &quot;bk_app_name&quot;: &quot;BKTest&quot;
        },
        {
            &quot;bk_app_code&quot;: &quot;esb_test&quot;,
            &quot;bk_app_name&quot;: &quot;ESBTest&quot;
        }
    ]
}</code></pre><h2 id="api">蓝鲸消息管理 API 简介</h2>
<p><strong>蓝鲸消息管理，用于支持向用户发送多种类型的消息，包括邮件、短信、语音通知等。</strong></p>
<table>
<thead>
<tr>
<th>资源名称</th>
<th>资源描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="./get_msg_type.md">get_msg_type</a></td>
<td>查询消息发送类型</td>
</tr>
<tr>
<td><a href="./send_mail.md">send_mail</a></td>
<td>发送邮件</td>
</tr>
<tr>
<td><a href="./send_msg.md">send_msg</a></td>
<td>通用消息发送</td>
</tr>
<tr>
<td><a href="./send_sms.md">send_sms</a></td>
<td>发送短信</td>
</tr>
<tr>
<td><a href="./send_voice_msg.md">send_voice_msg</a></td>
<td>公共语音通知</td>
</tr>
<tr>
<td><a href="./send_weixin.md">send_weixin</a></td>
<td>发送微信消息</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/cmsi/get_msg_type/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>查询 send_msg 组件支持发送消息的类型</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h3 id="_6">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;
}</code></pre>


<h3 id="_7">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;data&quot;: [
        {
            &quot;type&quot;: &quot;weixin&quot;,
            &quot;label&quot;: &quot;微信&quot;,
            &quot;is_active&quot;: true,
            &quot;icon&quot;: &quot;xxxxxxx&quot;
        },
        {
            &quot;type&quot;: &quot;mail&quot;,
            &quot;label&quot;: &quot;邮件&quot;,
            &quot;is_active&quot;: true,
            &quot;icon&quot;: &quot;xxxxxxx&quot;
        },
        {
            &quot;type&quot;: &quot;sms&quot;,
            &quot;label&quot;: &quot;短信&quot;,
            &quot;is_active&quot;: true,
            &quot;icon&quot;: &quot;xxxxxxx&quot;
        },
        {
            &quot;type&quot;: &quot;voice&quot;,
            &quot;label&quot;: &quot;语音&quot;,
            &quot;is_active&quot;: true,
            &quot;icon&quot;: &quot;xxxxxxx&quot;
        }
    ]
}</code></pre>


<h3 id="_8">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>true/false 操作是否成功</td>
</tr>
<tr>
<td>code</td>
<td>string</td>
<td>组件返回错误编码，0 表示 success，&gt;0 表示失败错误</td>
</tr>
<tr>
<td>data</td>
<td>list</td>
<td>result=true 时成功数据，详细信息请见下面说明</td>
</tr>
</tbody>
</table>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>type</td>
<td>string</td>
<td>消息类型</td>
</tr>
<tr>
<td>label</td>
<td>string</td>
<td>消息类型标签</td>
</tr>
<tr>
<td>is_active</td>
<td>bool</td>
<td>是否激活</td>
</tr>
<tr>
<td>icon</td>
<td>str</td>
<td>消息类型图标，经过 base64 编码的 ico 格式的文件</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/cmsi/send_mail/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>发送邮件</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>receiver</td>
<td>string</td>
<td>否</td>
<td>邮件接收者，包含邮件完整地址，多个以逗号分隔，若 receiver、receiver__username 同时存在，以 receiver 为准</td>
</tr>
<tr>
<td>receiver__username</td>
<td>string</td>
<td>否</td>
<td>邮件接收者，包含用户名，用户需在蓝鲸平台注册，多个以逗号分隔，若 receiver、receiver__username 同时存在，以 receiver 为准</td>
</tr>
<tr>
<td>sender</td>
<td>string</td>
<td>否</td>
<td>发件人</td>
</tr>
<tr>
<td>title</td>
<td>string</td>
<td>是</td>
<td>邮件主题</td>
</tr>
<tr>
<td>content</td>
<td>string</td>
<td>是</td>
<td>邮件内容</td>
</tr>
<tr>
<td>cc</td>
<td>string</td>
<td>否</td>
<td>抄送人，包含邮件完整地址，多个以逗号分隔</td>
</tr>
<tr>
<td>cc__username</td>
<td>string</td>
<td>否</td>
<td>抄送人，包含用户名，用户需在蓝鲸平台注册，多个以逗号分隔，若 cc、cc__username 同时存在，以 cc 为准</td>
</tr>
<tr>
<td>body_format</td>
<td>string</td>
<td>否</td>
<td>邮件格式，包含&#39;Html&#39;, &#39;Text&#39;，默认为&#39;Html&#39;</td>
</tr>
<tr>
<td>is_content_base64</td>
<td>bool</td>
<td>否</td>
<td>邮件内容是否 base64 编码，默认 False，不编码，请使用 base64.b64encode 方法编码</td>
</tr>
<tr>
<td>attachments</td>
<td>list</td>
<td>否</td>
<td>邮件附件</td>
</tr>
</tbody>
</table>
<h5 id="attachments">attachments</h5>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>filename</td>
<td>string</td>
<td>是</td>
<td>文件名</td>
</tr>
<tr>
<td>content</td>
<td>string</td>
<td>是</td>
<td>文件内容，文件内容为原文件内容的 base64 编码字符串</td>
</tr>
<tr>
<td>type</td>
<td>string</td>
<td>否</td>
<td>文件类型，默认为文件名后缀，如 a.png 文件类型为 &#39;png&#39;</td>
</tr>
<tr>
<td>disposition</td>
<td>string</td>
<td>否</td>
<td>文件 Content-Disposition，图片文件(type=image, jpg, png, jpeg)默认为 &#39;inline&#39;，其他文件默认为 &#39;attachment&#39;</td>
</tr>
<tr>
<td>content_id</td>
<td>string</td>
<td>否</td>
<td>文件 Content-ID，文件为图片文件时生效；默认为 &#39;&lt;文件名&gt;&#39;</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;receiver&quot;: &quot;admin@bking.com&quot;,
    &quot;sender&quot;: &quot;admin@bking.com&quot;,
    &quot;title&quot;: &quot;This is a Test&quot;,
    &quot;content&quot;: &quot;&lt;html&gt;Welcome to Blueking&lt;/html&gt;&quot;
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: &quot;00&quot;,
    &quot;message&quot;: &quot;OK&quot;,
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/cmsi/send_msg/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>通用消息发送接口</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>msg_type</td>
<td>string</td>
<td>是</td>
<td>发送信息的类型，可通过 get_msg_type 组件获取</td>
</tr>
<tr>
<td>receiver__username</td>
<td>string</td>
<td>是</td>
<td>接收者，包含用户名，用户需在蓝鲸平台注册，多个以逗号分隔</td>
</tr>
<tr>
<td>title</td>
<td>string</td>
<td>是</td>
<td>主题</td>
</tr>
<tr>
<td>content</td>
<td>string</td>
<td>是</td>
<td>内容</td>
</tr>
<tr>
<td>sender</td>
<td>string</td>
<td>否</td>
<td>发件人，msg_type 为 mail 时有效</td>
</tr>
<tr>
<td>cc__username</td>
<td>string</td>
<td>否</td>
<td>抄送人，包含用户名，用户需在蓝鲸平台注册，多个以逗号分隔，msg_type 为 mail 时有效</td>
</tr>
<tr>
<td>body_format</td>
<td>string</td>
<td>否</td>
<td>邮件格式，包含'Html', 'Text'，默认为'Html'， msg_type 为 mail 时有效</td>
</tr>
<tr>
<td>attachments</td>
<td>list</td>
<td>否</td>
<td>邮件附件， msg_type 为 mail 时有效</td>
</tr>
<tr>
<td>date</td>
<td>string</td>
<td>否</td>
<td>通知发送时间，默认为当前时间 "YYYY-mm-dd HH:MM"，msg_type 为 weixin 时有效</td>
</tr>
<tr>
<td>remark</td>
<td>string</td>
<td>否</td>
<td>通知尾部文字，msg_type 为 weixin 时有效</td>
</tr>
<tr>
<td>wx_qy_agentid</td>
<td>string</td>
<td>否</td>
<td>企业微信 AgentId，msg_type 为 weixin 时有效</td>
</tr>
<tr>
<td>wx_qy_corpsecret</td>
<td>string</td>
<td>否</td>
<td>企业微信 CorpSecret，msg_type 为 weixin 时有效</td>
</tr>
<tr>
<td>is_content_base64</td>
<td>bool</td>
<td>否</td>
<td>通知文字 content 是否 base64 编码，默认 False，不编码，若编码请使用 base64.b64encode 方法</td>
</tr>
</tbody>
</table>
<h5 id="attachments">attachments</h5>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>filename</td>
<td>string</td>
<td>是</td>
<td>文件名</td>
</tr>
<tr>
<td>content</td>
<td>string</td>
<td>是</td>
<td>文件内容，文件内容为原文件内容的 base64 编码字符串"</td>
</tr>
<tr>
<td>type</td>
<td>string</td>
<td>否</td>
<td>文件类型，默认为文件名后缀，如 a.png 文件类型为 'png'</td>
</tr>
<tr>
<td>disposition</td>
<td>string</td>
<td>否</td>
<td>文件 Content-Disposition，图片文件(type=image, jpg, png, jpeg)默认为 'inline'，其他文件默认为 'attachment'</td>
</tr>
<tr>
<td>content_id</td>
<td>string</td>
<td>否</td>
<td>文件 Content-ID，文件为图片文件时生效；默认为 '&lt;文件名&gt;'</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_app_code&quot;: &quot;esb-test&quot;,
    &quot;bk_app_secret&quot;: &quot;esb-test-secret&quot;,
    &quot;bk_username&quot;: &quot;admin&quot;,
    &quot;msg_type&quot;: &quot;mail&quot;,
    &quot;receiver__username&quot;: &quot;admin,yunchao&quot;,
    &quot;title&quot;: &quot;xxx&quot;,
    &quot;content&quot;: &quot;xxx&quot;
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;OK&quot;,
    &quot;data&quot;: [],
    &quot;request_id&quot;: &quot;sdfdfdfsdfasdasdasas&quot;
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/cmsi/send_sms/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>发送短信</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>receiver</td>
<td>string</td>
<td>否</td>
<td>短信接收者，包含接收者电话号码，多个以逗号分隔，若 receiver、receiver__username 同时存在，以 receiver 为准</td>
</tr>
<tr>
<td>receiver__username</td>
<td>string</td>
<td>否</td>
<td>短信接收者，包含用户名，用户需在蓝鲸平台注册，多个以逗号分隔，若 receiver、receiver__username 同时存在，以 receiver 为准</td>
</tr>
<tr>
<td>content</td>
<td>string</td>
<td>是</td>
<td>短信内容</td>
</tr>
<tr>
<td>is_content_base64</td>
<td>bool</td>
<td>否</td>
<td>消息内容是否 base64 编码，默认 False，不编码，请使用 base64.b64encode 方法编码</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;receiver&quot;: &quot;1234567890&quot;,
    &quot;receiver__username&quot;: &quot;admin&quot;,
    &quot;content&quot;: &quot;Welcome to Blueking&quot;,
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: &quot;00&quot;,
    &quot;message&quot;: &quot;OK&quot;,
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/cmsi/send_voice_msg/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>公共语音通知</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>auto_read_message</td>
<td>string</td>
<td>是</td>
<td>自动语音读字信息</td>
</tr>
<tr>
<td>user_list_information</td>
<td>array</td>
<td>否</td>
<td>待通知的用户列表，自动语音通知列表，若 user_list_information、receiver__username 同时存在，以 user_list_information 为准</td>
</tr>
<tr>
<td>receiver__username</td>
<td>string</td>
<td>否</td>
<td>待通知的用户列表，包含用户名，用户需在蓝鲸平台注册，多个以逗号分隔，若 user_list_information、receiver__username 同时存在，以 user_list_information 为准</td>
</tr>
</tbody>
</table>
<h4 id="user_list_information">user_list_information</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>username</td>
<td>string</td>
<td>是</td>
<td>被通知人</td>
</tr>
<tr>
<td>mobile_phone</td>
<td>string</td>
<td>否</td>
<td>被通知人手机号</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;auto_read_message&quot;: &quot;This is a test&quot;,
    &quot;user_list_information&quot;: [{
        &quot;username&quot;: &quot;admin&quot;,
        &quot;mobile_phone&quot;: &quot;1234567890&quot;,
    }]
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: &quot;00&quot;,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: {
        &quot;instance_id&quot;: &quot;2662152044&quot;
    }
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/cmsi/send_weixin/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>发送微信消息，支持微信公众号消息，及微信企业号消息</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>receiver</td>
<td>string</td>
<td>否</td>
<td>微信接收者，包含绑定在指定公众号上的微信用户的 openid 或 企业号上的微信用户的用户 ID，多个以逗号分隔</td>
</tr>
<tr>
<td>receiver__username</td>
<td>string</td>
<td>否</td>
<td>微信接收者，包含用户名，用户需在蓝鲸平台注册，多个以逗号分隔，若 receiver、receiver__username 同时存在，以 receiver 为准</td>
</tr>
<tr>
<td>data</td>
<td>dict</td>
<td>是</td>
<td>消息内容</td>
</tr>
<tr>
<td>wx_qy_agentid</td>
<td>string</td>
<td>否</td>
<td>agentid of WeChat app</td>
</tr>
<tr>
<td>wx_qy_corpsecret</td>
<td>string</td>
<td>否</td>
<td>secret of WeChat app</td>
</tr>
</tbody>
</table>
<h4 id="data">data 参数包含内容</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>heading</td>
<td>string</td>
<td>是</td>
<td>通知头部文字</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>是</td>
<td>通知文字</td>
</tr>
<tr>
<td>date</td>
<td>string</td>
<td>否</td>
<td>通知发送时间，默认为当前时间 &#34;YYYY-mm-dd HH:MM&#34;</td>
</tr>
<tr>
<td>remark</td>
<td>string</td>
<td>否</td>
<td>通知尾部文字</td>
</tr>
<tr>
<td>is_message_base64</td>
<td>bool</td>
<td>否</td>
<td>通知文字 message 是否 base64 编码，默认 False，不编码，若编码请使用 base64.b64encode 方法</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;receiver&quot;: &quot;xxx&quot;,
    &quot;data&quot;: {
        &quot;heading&quot;: &quot;blueking alarm&quot;,
        &quot;message&quot;: &quot;This is a test.&quot;,
        &quot;date&quot;: &quot;2017-02-22 15:36&quot;,
        &quot;remark&quot;: &quot;This is a test!&quot;
    }
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: &quot;00&quot;,
    &quot;message&quot;: &quot;OK&quot;,
}</code></pre><h2 id="api">蓝鲸用户管理 API 简介</h2>
<table>
<thead>
<tr>
<th>资源名称</th>
<th>资源描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="./department_ancestor.md">department_ancestor</a></td>
<td>查询部门全部祖先 (旧版接口，不推荐使用，后续会下架，请尽快迁移)</td>
</tr>
<tr>
<td><a href="./list_department_profiles.md">list_department_profiles</a></td>
<td>查询部门的用户信息 (v2)</td>
</tr>
<tr>
<td><a href="./list_departments.md">list_departments</a></td>
<td>查询部门 (v2)</td>
</tr>
<tr>
<td><a href="./list_profile_departments.md">list_profile_departments</a></td>
<td>查询用户的部门信息 (v2)</td>
</tr>
<tr>
<td><a href="./list_users.md">list_users</a></td>
<td>查询用户 (v2)</td>
</tr>
<tr>
<td><a href="./retrieve_department.md">retrieve_department</a></td>
<td>查询单个部门信息 (v2)</td>
</tr>
<tr>
<td><a href="./retrieve_user.md">retrieve_user</a></td>
<td>查询单个用户信息 (v2)</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/usermanage/department_ancestor/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>查询部门全部祖先，包括自己</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>整数</td>
<td>是</td>
<td>部门 ID</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;id&quot;: 296
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;message&quot;: &quot;Success&quot;,
    &quot;code&quot;: 0,
    &quot;data&quot;: [
        {
            &quot;id&quot;: 291,
            &quot;name&quot;: &quot;数字公司&quot;,
            &quot;has_children&quot;: true
        },
        {
            &quot;id&quot;: 296,
            &quot;name&quot;: &quot;开发组&quot;,
            &quot;has_children&quot;: false
        }
    ],
    &quot;result&quot;: true
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>返回结果，true 为成功，false 为失败</td>
</tr>
<tr>
<td>code</td>
<td>int</td>
<td>返回码，0 表示成功，其他值表示失败</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>错误信息</td>
</tr>
<tr>
<td>data</td>
<td>array</td>
<td>结果</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>部门名</td>
</tr>
<tr>
<td>has_children</td>
<td>bool</td>
<td>是否有子部门</td>
</tr>
<tr>
<td>id</td>
<td>int</td>
<td>部门 ID</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/usermanage/list_department_profiles/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>请求某部门的用户信息</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必须</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>lookup_field</td>
<td>字符串</td>
<td>否</td>
<td>查询字段, 默认为 'id'</td>
</tr>
<tr>
<td>recursive</td>
<td>布尔</td>
<td>否</td>
<td>是否级联查询部门用户,默认为否</td>
</tr>
<tr>
<td>no_page</td>
<td>布尔</td>
<td>否</td>
<td>是否不分页一次性返回所有结果，默认为否</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-json">{
  &quot;recursive&quot;: true
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;message&quot;: &quot;Success&quot;,
    &quot;code&quot;: 0,
    &quot;data&quot;: [
        {&quot;username&quot;:&quot;GW67279&quot;,&quot;id&quot;:90909},
        {&quot;username&quot;:&quot;GW67280&quot;,&quot;id&quot;:90910},
        {&quot;username&quot;:&quot;GW67281&quot;,&quot;id&quot;:90911}
    ],
    &quot;result&quot;: true
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>返回结果，true 为成功，false 为失败</td>
</tr>
<tr>
<td>code</td>
<td>int</td>
<td>返回码，0 表示成功，其他值表示失败</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>错误信息</td>
</tr>
<tr>
<td>data</td>
<td>array</td>
<td>结果</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/usermanage/list_departments/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>获取部门列表</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必须</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>lookup_field</td>
<td>字符串</td>
<td>否</td>
<td>查找字段, 默认值为 'id'</td>
</tr>
<tr>
<td>page</td>
<td>整数</td>
<td>否</td>
<td>页码</td>
</tr>
<tr>
<td>no_page</td>
<td>布尔</td>
<td>否</td>
<td>是否返回全部结果，默认为否</td>
</tr>
<tr>
<td>page_size</td>
<td>整数</td>
<td>否</td>
<td>每页结果数量</td>
</tr>
<tr>
<td>fields</td>
<td>字符串</td>
<td>否</td>
<td>返回值字段, 例如"username,id"</td>
</tr>
<tr>
<td>exact_lookups</td>
<td>字符串</td>
<td>否</td>
<td>精确查找内容列表, 例如"jack,pony"</td>
</tr>
<tr>
<td>fuzzy_lookups</td>
<td>字符串</td>
<td>否</td>
<td>模糊查找内容列表, 例如"jack,pony"</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-json">{
  &quot;fields&quot;: &quot;name,id&quot;,
  &quot;no_page&quot;: true
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;message&quot;: &quot;Success&quot;,
    &quot;code&quot;: 0,
    &quot;data&quot;: [{
        &quot;id&quot;: 4,
        &quot;name&quot;: &quot;PaaS&quot;,
    }],
    &quot;result&quot;: true
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>返回结果，true 为成功，false 为失败</td>
</tr>
<tr>
<td>code</td>
<td>int</td>
<td>返回码，0 表示成功，其他值表示失败</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>错误信息</td>
</tr>
<tr>
<td>data</td>
<td>array</td>
<td>结果</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/usermanage/list_profile_departments/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>请求某个用户的部门信息</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必须</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>lookup_field</td>
<td>字符串</td>
<td>否</td>
<td>查询字段, 默认为 'username'</td>
</tr>
<tr>
<td>with_family</td>
<td>布尔</td>
<td>否</td>
<td>结果是否返回部门树, 默认为否</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-json">{
  &quot;with_family&quot;: true
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;message&quot;: &quot;Success&quot;,
    &quot;code&quot;: 0,
    &quot;data&quot;: [{
        &quot;id&quot;: 4,
        &quot;name&quot;: &quot;PaaS&quot;,
        &quot;family&quot;: [
           {&quot;id&quot;: 5, &quot;name&quot;: &quot;BlueKing1&quot;},
           {&quot;id&quot;: 6, &quot;name&quot;: &quot;BlueKing2&quot;},
        ]
    }],
    &quot;result&quot;: true
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>返回结果，true 为成功，false 为失败</td>
</tr>
<tr>
<td>code</td>
<td>int</td>
<td>返回码，0 表示成功，其他值表示失败</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>错误信息</td>
</tr>
<tr>
<td>data</td>
<td>array</td>
<td>结果</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/usermanage/list_users/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>获取用户列表</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必须</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>lookup_field</td>
<td>字符串</td>
<td>否</td>
<td>查找字段, 默认值为 'username'</td>
</tr>
<tr>
<td>page</td>
<td>整数</td>
<td>否</td>
<td>页码</td>
</tr>
<tr>
<td>no_page</td>
<td>布尔</td>
<td>否</td>
<td>是否返回全部结果，默认为否</td>
</tr>
<tr>
<td>page_size</td>
<td>整数</td>
<td>否</td>
<td>每页结果数量</td>
</tr>
<tr>
<td>fields</td>
<td>字符串</td>
<td>否</td>
<td>返回值字段, 例如"username,id"</td>
</tr>
<tr>
<td>exact_lookups</td>
<td>字符串</td>
<td>否</td>
<td>精确查找内容列表, 例如"jack,pony"</td>
</tr>
<tr>
<td>fuzzy_lookups</td>
<td>字符串</td>
<td>否</td>
<td>模糊查找内容列表, 例如"jack,pony"</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-json">{
  &quot;fields&quot;: &quot;username,id&quot;,
  &quot;no_page&quot;: true
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;message&quot;: &quot;Success&quot;,
    &quot;code&quot;: 0,
    &quot;data&quot;: [{
        &quot;id&quot;: 4,
        &quot;username&quot;: &quot;jackma&quot;,
    }],
    &quot;result&quot;: true
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>返回结果，true 为成功，false 为失败</td>
</tr>
<tr>
<td>code</td>
<td>int</td>
<td>返回码，0 表示成功，其他值表示失败</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>错误信息</td>
</tr>
<tr>
<td>data</td>
<td>array</td>
<td>结果</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/usermanage/retrieve_department/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>查询部门具体信息</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必须</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>lookup_field</td>
<td>字符串</td>
<td>否</td>
<td>查询字段, 默认为 'username'</td>
</tr>
<tr>
<td>fields</td>
<td>字符串</td>
<td>否</td>
<td>返回字段, 例如 "username,id"</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-json">{
  &quot;fields&quot;: &quot;name,id&quot;
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;message&quot;: &quot;Success&quot;,
    &quot;code&quot;: 0,
    &quot;data&quot;: {
        &quot;id&quot;: 4,
        &quot;username&quot;: &quot;PaaS&quot;,
    },
    &quot;result&quot;: true
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>返回结果，true 为成功，false 为失败</td>
</tr>
<tr>
<td>code</td>
<td>int</td>
<td>返回码，0 表示成功，其他值表示失败</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>错误信息</td>
</tr>
<tr>
<td>data</td>
<td>array</td>
<td>结果</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/usermanage/retrieve_user/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>查询用户具体详情</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必须</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>lookup_field</td>
<td>字符串</td>
<td>否</td>
<td>查询字段, 默认为 'username'</td>
</tr>
<tr>
<td>fields</td>
<td>字符串</td>
<td>否</td>
<td>返回字段, 例如 "username,id"</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-json">{
  &quot;fields&quot;: &quot;username,id&quot;
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;message&quot;: &quot;Success&quot;,
    &quot;code&quot;: 0,
    &quot;data&quot;: {
        &quot;id&quot;: 4,
        &quot;username&quot;: &quot;jackma&quot;,
    },
    &quot;result&quot;: true
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>返回结果，true 为成功，false 为失败</td>
</tr>
<tr>
<td>code</td>
<td>int</td>
<td>返回码，0 表示成功，其他值表示失败</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>错误信息</td>
</tr>
<tr>
<td>data</td>
<td>array</td>
<td>结果</td>
</tr>
</tbody>
</table><h1 id="api-esb-api">后台 API 和 ESB API 说明</h1>
<h2 id="_1">背景</h2>
<p>由于高性能的 APIGateway2.0 尚未发布企业版, 所以为了性能考虑, 模型/策略/鉴权等接口目前没有接入 ESB, 直接后台 API 调用; 而 SaaS 上无权限申请/授权接口等, 接入了 ESB</p>
<p>目前权限中心提供的接口分为两类:
1. 后台 API, URL 前缀: <code>/api/v1/[model | policy | systems]</code>
    1.1 model <a href="../02-Model/00-API.md">模型注册及更新 API</a>
    1.2 policy <a href="../04-Auth/01-SDK.md">策略查询 API</a> / <a href="../04-Auth/02-DirectAPI.md">直接鉴权 API</a>
    1.3 systems 系统相关  <a href="../08-Query/01-PolicyGet.md">查询策略 API</a>
2. 组件 API, URL 前缀: <code>/api/c/compapi/v2/iam/[application | authorization]</code>
    1.1  application <a href="../05-Application/01-GenerateURL.md">5. 生成无权限申请 URL</a>
    1.2  authorization <a href="../07-ResourceCreatorAction/01-Attribute.md">新建关联属性授权接口</a>
    1.3 authorization <a href="../06-GrantRevoke/01-Topology.md">资源拓扑授权/回收</a></p>
<p>未来, APIGateway 2.0 企业版发布后, 会全部统一接入 APIGateway, 对于接入系统来说, 就是一套系统, 一种调用方式.</p>
<h2 id="api">后台 API</h2>
<p>直接调用 IAM 后台 API, 请仔细阅读 <a href="./02-APIBasicInfo.md">接口协议前置说明</a> 中对 request header/body 以及 response 的说明</p>
<p>调用地址:
- 如果是企业版 SaaS, 直接通过环境变量获取: <code>BK_IAM_V3_APP_CODE</code> (权限中心 SaaS 的 app_code, 用于跳转到权限中心的 URL 拼接) / <code>BK_IAM_V3_INNER_HOST</code>(权限中心后台的访问地址)
- 如果是非 SaaS 的其他平台, 需要部署时渲染 <code>__BKIAM_HOST__:__BKIAM_PORT__</code></p>
<p>相关链接:
- <a href="../../../HowTo/FAQ/ErrorCode.md">后台接口错误码说明</a></p>
<h2 id="esb-api">ESB API</h2>
<p>需要遵守企业版 ESB 的接口协议. eedev 联调环境, 可以通过 <code>https://{PAAS_DOMAIN}/esb/api_docs/system/IAM/</code> 查看权限中心接入 ESB 的具体文档</p>
<p>ESB 调用地址:
- 如果是企业版 SaaS, 使用 ESB SDK 调用,   API 调用说明 <code>https://{PAAS_DOMAIN}/esb/guide/page/use_component</code>
- 如果是企业版 SaaS, 直接通过 http 访问, 可以通过环境变量获取: <code>BK_PAAS_INNER_HOST</code>即 PaaS 的内网域名, 拼接<code>{BK_PAAS_INNER_HOST}/api/c/compapi/v2/iam/</code>
- 如果是非企业版 SaaS 的其他平台, 请使用 PaaS 内网地址或域名访问组件 <code>{PAAS_DOMAIN}/api/c/compapi/v2/iam/</code>. </p><h2 id="_1">接口协议前置说明</h2>
<p>Request Header:</p>
<ul>
<li><code>X-Bk-App-Code</code>   蓝鲸应用 app_code</li>
<li><code>X-Bk-App-Secret</code>  蓝鲸应用 app_secret</li>
<li><code>X-Bk-IAM-Version</code> IAM Policy 协议版本号, 不传默认为 1. (只有鉴权/策略相关的接口涉及, 暂时不需要关注)</li>
</ul>
<p>Response Header:
-  <code>X-Request-Id</code>  请求 request_id, 请记录, 用于错误排查</p>
<p>Response Body: 遵循蓝鲸官方 API 协议进行返回, <code>code != 0</code> 表示出错, <code>message</code>包含具体信息</p>
<pre class="codehilite"><code class="language-bash">{
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: {
    }
}</code></pre>


<p><strong>重要</strong>: 调用权限中心 API 都会返回一个<code>request_id</code>, 请在日志中记录, 以便后续联调及正式环境中进行问题排查; </p>
<hr />
<h2 id="resources">接口协议中<code>resources</code>字段说明</h2>
<p>Request 的 json body 中<code>resources</code></p>
<blockquote>
<p><code>resources</code>是一个列表
<code>resources</code>代表<code>一个资源</code></p>
</blockquote>
<p>如果是独立系统, 那么<code>resources</code>只有一个 item</p>
<pre class="codehilite"><code class="language-json">    &quot;resources&quot;: [
    {
        &quot;system&quot;: &quot;bk_paas&quot;,
        &quot;type&quot;: &quot;app&quot;,
        &quot;id&quot;: &quot;bk_framework&quot;
    }]</code></pre>


<p>如果是跨系统资源依赖, 那么<code>resources</code>有多个 item, 包含跨系统依赖资源, 例如 job 脚本是否有在 cmdb 某个主机上的执行权限</p>
<pre class="codehilite"><code class="language-json">    &quot;resources&quot;: [
    {
        &quot;system&quot;: &quot;bk_job&quot;,
        &quot;type&quot;: &quot;script&quot;,
        &quot;id&quot;: &quot;run&quot;
    },
    {
        &quot;system&quot;: &quot;bk_cmdb&quot;,
        &quot;type&quot;: &quot;host&quot;,
        &quot;id&quot;: &quot;192.168.1.1&quot;
    }]</code></pre>


<p>所以, 写批量接口批量确认一批资源权限
- <code>resources</code>表示一个资源, 类型是 <code>[resource,]</code>
- <code>resources_list</code>表示一批资源, 类型是 <code>[resources, resources]</code> 即, <code>[ [resource,],  [resource,], ]</code></p><h1 id="_1">系统间接口鉴权</h1>
<h2 id="-">接入系统 -&gt; 权限中心</h2>
<h3 id="1">1. 场景</h3>
<ol>
<li>模型注册 (<a href="../02-Model/00-API.md">模型注册接口协议</a>)</li>
<li>拉取策略/鉴权 (<a href="../04-Auth/01-SDK.md">SDK 鉴权接口协议</a>)</li>
</ol>
<h3 id="2">2. 鉴权逻辑</h3>
<p>使用蓝鲸 app_code/app_secret 进行鉴权 </p>
<p>Request Header:</p>
<pre class="codehilite"><code class="language-bash">X-Bk-App-Code 蓝鲸应用app_code
X-Bk-App-Secret 蓝鲸应用app_secret</code></pre>


<p>没有权限将返回:</p>
<pre class="codehilite"><code class="language-bash">status: 200
response_body:
# 没有提供app_code/app_secret
{
    &quot;code&quot;: 1901401,
    &quot;message&quot;: &quot;unauthorized: app code and app secret required&quot;,
    &quot;data&quot;: {}
}
# app_code或app_secret错误
{
    &quot;code&quot;: 1901401,
    &quot;message&quot;: &quot;unauthorized: app code or app secret wrong&quot;,
    &quot;data&quot;: {}
}</code></pre>


<hr />
<h2 id="-_1">权限中心 -&gt; 接入系统</h2>
<p>接入系统暴露的接口是可以查询资源实例/属性等信息的, 可能包含敏感信息, 所以需要对权限中心资源拉取接口做鉴权.</p>
<h3 id="1_1">1. 场景</h3>
<p>资源拉取 (<a href="../03-Callback/01-API.md">资源拉取接口协议</a>)</p>
<h3 id="2_1">2. 鉴权逻辑</h3>
<p><strong>注意</strong>: 目前只支持<code>none</code>或<code>basic</code>, 相对复杂的<code>digest</code>/<code>signature</code>规划中</p>
<ol>
<li>注册系统时(<a href="../02-Model/10-System.md">新增系统接口协议</a>), 需要确定鉴权方式: <code>none</code>/<code>basic</code>/<code>digest</code>/<code>signature</code> </li>
<li>系统注册成功, 会生成一个<code>token</code></li>
<li>当权限中心调用<code>接入系统</code>的时候, 会根据接入系统注册的鉴权方式和上一步生成的 token, 生成对应的请求, 然后调用<code>接入系统</code></li>
<li>接入系统需要根据注册系统选择的鉴权方式, 对权限中心发过来的请求进行鉴权.</li>
</ol>
<p><strong>鉴权方式:</strong>
- <code>none</code>: 不鉴权, 意味着所有资源拉取接口没有权限控制(<a href="../03-Callback/01-API.md">资源拉取接口协议</a>). <code>不推荐, 可以在测试联调时使用</code>
- <code>basic</code>: http basic auth, 权限中心调用接入系统, 生成 header<code>Authorization: Basic base64(username:password)</code> (其中<code>username=bk_iam, password={token}</code>), <code>接入系统</code>解析请求后, 要使用 token 进行鉴权.  <code>推荐, 同蓝鲸体系部署在同一个内网的服务</code> - 已支持
- <code>digest</code>: http digest auth, 权限中心调用接入系统, 使用摘要算法生成 header<code>Authorization: Digest xxxx</code>, <code>接入系统</code>解析请求后, 需要使用 token 进行鉴权. <code>同蓝鲸体系部署在同一个内网的服务, 对安全性进一步需求的服务(实现方和调用方的逻辑较为复杂, 出问题不好调试)</code> - 暂不支持
- <code>signature</code>: 使用签名算法, 生成 header<code>X-Bk-IAM-Signature: xxx</code> (尚未确认协议). <code>接入系统</code>解析请求后, 需要使用 token 进行鉴权. <code>外网服务或对安全性有很高要求的服务</code>- 暂不支持</p>
<p><code>接入系统</code>解析请求后, 需要使用 token 进行鉴权:</p>
<ul>
<li>使用<code>app_code/app_secret</code>到权限中心查询<code>token</code> (<a href="../02-Model/16-Token.md">查询 token 协议</a>) (建议, 查询回来后缓存起来)</li>
</ul><h1 id="api">模型注册 API</h1>
<ul>
<li><a href="./00-Concepts.md">名词及概念</a></li>
<li><a href="./10-System.md">系统 System</a></li>
<li><a href="./11-ResourceType.md">资源类型 ResourceType</a></li>
<li><a href="./12-InstanceSelection.md">实例视图 InstanceSelection</a></li>
<li><a href="./13-Action.md">操作 Action</a></li>
<li><a href="./14-ActionGroup.md">操作组 ActionGroup</a></li>
<li><a href="./15-CommonQuery.md">通用查询 Common Query</a></li>
<li><a href="./16-Token.md">系统 token 查询</a></li>
<li><a href="./17-CommonActions.md">常用操作配置 CommonActions</a></li>
<li><a href="./18-FeatureShieldRules.md">功能开关配置 FeatureShieldRules</a></li>
<li><a href="./19-ResourceCreatorAction.md">新建关联配置 ResourceCreatorAction</a></li>
</ul><h1 id="_1">名词及概念</h1>
<p>说明: 1. 概念 2.限制(例如正则校验/非空/全局唯一等等)</p>
<blockquote>
<p>所有更新(<code>PUT</code>)操作, 如果传了<code>key</code>并给了<code>空值</code>, 那么执行的是<code>置空操作</code>; 如果没有传<code>key</code>, 表示不更新该字段</p>
</blockquote>
<h2 id="1-system-saas">1. System: 接入权限中心的 SaaS 或平台或第三方系统</h2>
<ul>
<li>id: 系统的唯一标识，可直接使用 app_code 的值作为唯一标识，但 app_code 还用于接口的认证，值可以一样，但需支持 id 和 app_code 可单独配置不一样的，同时对于 cmdb 这种被依赖的系统，需要保证所有版本的系统 ID 都一样；只允许小写字母开头、包含小写字母、数字、下划线(_)和连接符(-)， 最长 32 个字符。</li>
<li>name: 系统名称，注册时权限中心不允许与已存在系统同名</li>
<li>name_en: 系统英文名，国际化时切换到英文版本显示</li>
<li>description:  系统描述</li>
<li>description_en: 系统描述描述英文, 国际化切换到英文版本展示</li>
<li>clients： 有权限调用权限中心获取或操作该系统权限相关数据的客户端列表，即 app_code list，多个使用英文逗号分隔， 比如 BCS 由一个客户端 bk_bcs 注册，但是需要多个客户端（bk_bcs,bk_bcs_app,bk_devops,bk_harbor）都可以调用鉴权接口进行该系统的鉴权 </li>
<li>provider_config.host：权限中心回调接入系统时需要的配置文件，权限中心需要调用接入系统拉取资源实例接口，所以需要接入系统 API 的 HOST, HOST 格式：scheme://netloc，与 resource_type.provider_config.path 配合使用. <code>例如system.provider_config.host=http://cmdb.consul, resource_type.provider_config.path=/api/v1/resources</code>, 那么将调用<code>http://cmdb.consul/api/v1/resources</code>去拉取该资源类型相关信息</li>
<li>provider_config.auth: 权限中心调用接入系统吸取资源信息需要用的的接口鉴权方法, 目前支持<code>none/basic</code>, (<code>digest/signature</code>规划中), 接入系统需要实现相应的鉴权逻辑, 确保是合法的 iam 请求. <a href="../01-Overview/03-APIAuth.md">系统间调用接口鉴权:权限中心-&gt;接入系统</a></li>
<li>provider_config.healthz: 权限中心调用接入系统的 healthz 检查系统是否健康; 与 provider_config.host 配合使用, <code>例如system.provider_config.host=http://cmdb.consul, provider_config.healthz=/healthz/</code>, 那么将调用<code>http://cmdb.consul/healthz/</code>检查系统是否健康. </li>
</ul>
<hr />
<h2 id="2-resourcetype">2. ResourceType: 操作对象的资源类别</h2>
<ul>
<li>id: 资源类型的唯一标识，接入系统下唯一，只允许小写字母开头、包含小写字母、数字、下划线(_)和连接符(-)，最长 32 个字符。</li>
<li>name: 资源类型名称，系统下唯一</li>
<li>name_en:  资源类型英文名，国际化时切换到英文版本显示</li>
<li>description: 资源类型描述</li>
<li>description_en: 资源类型描述英文, 国际化切换到英文版本展示</li>
<li>parents: 资源类型的直接上级，可多个直接上级，可以是自身系统的资源类型或其他系统的资源类型, 可为空列表，不允许重复，数据仅用于权限中心产品上显示  </li>
<li>provider_config: 权限中心调用查询资源实例接口需要的配置文件，包括权限中心调用查询资源实例接口的 URL 的 path，与 system.provider_config.host 配合使用. <code>例如system.provider_config.host=http://cmdb.consul, resource_type.provider_config.path=/api/v1/resources</code>, 那么将调用<code>http://cmdb.consul/api/v1/resources</code>去拉取该资源类型相关信息</li>
</ul>
<hr />
<h2 id="3-instanceselection">3. InstanceSelection: 实例视图</h2>
<ul>
<li>id: 实例视图的唯一标识，接入系统下唯一，只允许小写字母开头、包含小写字母、数字、下划线(_)和连接符(-)，最长 32 个字符。</li>
<li>name: 实例视图名称，系统下唯一</li>
<li>name_en:  实例视图英文名，国际化时切换到英文版本显示</li>
<li>resource_type_chain：实例视图包含的资源类型的层级链路</li>
<li>is_dynamic：是否是动态拓扑视图，<code>默认为false</code>，如果是动态拓扑视图, 需要在<code>list_instance</code>中实现<code>child_type</code>来拉取到下一级的资源类型, <a href="../03-Callback/12-list_instance.md">具体参考</a><ul>
<li>使用动态拓扑视图的所有下级资源类型的系统 id 必须与 root 节点的系统 id 相同, 不能出现系统 id 不同的情况, 会导致配置出错误的权限</li>
<li>使用动态拓扑视图时, 权限中心不会校验用户提交的数据是否与视图匹配, 并且在创建依赖操作时, 如果发现是动态拓扑视图, 不会产生依赖操作</li>
</ul>
</li>
</ul>
<hr />
<h2 id="4-action">4. Action: 权限操作，比如增删改查</h2>
<ul>
<li>id: 操作的唯一标识，接入系统下唯一，只允许小写字母开头、包含小写字母、数字、下划线(_)和连接符(-)，最长 32 个字符。</li>
<li>name: 操作名称，系统下唯一</li>
<li>name_en:  操作英文名，国际化时切换到英文版本显示</li>
<li>description: 操作描述</li>
<li>description_en: 描述英文, 国际化切换到英文版本展示</li>
<li>type: 操作的类型，枚举值包括<code>create\delete\view\edit\list\manage\execute</code> 比如创建类操作需要标识为"create"，无法分类可为空字符串，目前权限中心仅仅对创建类操作有相关处理</li>
<li>related_actions: related_actions: 操作的依赖操作，当用户申请的操作权限必须依赖其他操作权限（暂不支持跨系统操作关联）时，比如用户申请 作业编辑，必须依赖 作业查看 的操作权限，作业查看 就是 作业编辑 的依赖操作。在产品层表现就是：当用户勾选 作业编辑 时，系统在创建申请单时，会自动申请 作业查看 权限。 </li>
<li>related_resource_types： 操作的对象资源类型列表，列表顺序与产品展示、鉴权校验 顺序 必须保持一致 <a href="../../../../权限中心/产品白皮书/术语解释/Trem.md#依赖资源">产品说明: 依赖资源</a><ul>
<li>system_id： 资源类型的来源系统，可以是自身系统或其他系统</li>
<li>scope：限制该操作对该资源的选择范围，条件表达式协议: <a href="../..//Expression/01-Schema.md">协议详情</a> <a href="../../../../权限中心/产品白皮书/术语解释/Trem.md#资源范围">产品说明: 资源范围</a></li>
<li>selection_mode: 选择类型, 即资源在权限中心产品上配置权限时的作用范围<ul>
<li>等于<code>instance</code>, 仅可选择实例, <code>默认值</code></li>
<li>等于<code>attribute</code>, 仅可配置属性, 此时<code>instance_selections</code>配置不生效</li>
<li>等于<code>all</code>, 可以同时选择实例和配置属性</li>
</ul>
</li>
<li>related_instance_selections：关联的实例视图，可以关联本系统定义的实例视图, 也可以配置其他系统定义的(如果<code>selection_mode=attribute</code>不用配置该字段). 该字段的功能表现在权限中心产品上配置权限时的实例选择方式 <a href="../../../../权限中心/产品白皮书/术语解释/Trem.md#实例视图">产品说明: 实例选择视图</a><ul>
<li>system_id：实例视图的系统</li>
<li>id：实例视图的 ID</li>
<li>ignore_iam_path：是否忽略路径，<code>默认为false</code>，在 IAM 产品上选择实例视图配置权限的资源时，<strong>如果选到 Action 关联的资源类型实例，而不是上级或祖先（选择了中间节点，ignore_iam_path 是不起作用的）</strong>，那么对于<code>ignore_iam_path=true</code>时权限保存类似：<code>id=192.168.1.1</code>，若<code>ignore_iam_path=false</code>时则权限保存类似：<code>id=192.168.1.1 AND _bk_iam_path_= /biz,1/set,2/module,3/</code><ul>
<li>ignore_iam_path 由 false 变更为 true 时，已配置的权限（类似：<code>id=192.168.1.1 AND _bk_iam_path_= /biz,1/set,2/module,3/</code>）将无法通过 id 直接通过鉴权</li>
<li>ignore_iam_path 由 true 变更为 false 时，已配置的权限（类似：<code>id=192.168.1.1</code>）无论任何路径都可以通过鉴权</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<hr />
<h2 id="5-version">5.版本号 version</h2>
<ul>
<li>仅仅作为在权限中心产品上进行 New 的更新提醒。<a href="../../../../权限中心/产品白皮书/术语解释/Trem.md#版本">产品说明：版本号</a></li>
<li>对于 ResourceType，对比该系统的所有 ResourceType 的 Version，最大的 version 将在产品上显示 New 的提示</li>
<li>对于 Action，对比该系统的所有 Action 的 Version，最大的 version 将在产品上显示 New 的提示</li>
</ul><h1 id="system-api">系统 System API</h1>
<h3 id="_1">参数说明</h3>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">id</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">系统 id, 全局唯一, 只允许小写字母开头、包含小写字母、数字、下划线(_)和连接符(-), 最长 32 个字符.</td>
</tr>
<tr>
<td align="left">name</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">系统名称，全局唯一</td>
</tr>
<tr>
<td align="left">name_en</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">系统英文名，国际化时切换到英文版本显示</td>
</tr>
<tr>
<td align="left">description</td>
<td align="left">string</td>
<td align="left">否</td>
<td align="left">系统描述，全局唯一</td>
</tr>
<tr>
<td align="left">description_en</td>
<td align="left">string</td>
<td align="left">否</td>
<td align="left">系统描述英文，国际化时切换到英文版本显示</td>
</tr>
<tr>
<td align="left">clients</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">有权限调用的客户端，即有权限调用的 app_code 列表，多个使用英文逗号分隔，注册系统时会校验 Header 头里的 app_code 必须在列表里 <a href="./00-Concepts.md">更多概念说明</a></td>
</tr>
<tr>
<td align="left">provider_config</td>
<td align="left">Object</td>
<td align="left">是</td>
<td align="left">权限中心回调接入系统的配置文件 <a href="./00-Concepts.md">更多概念说明</a></td>
</tr>
</tbody>
</table>
<p>provider_config 内元素 参数：</p>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">host</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">权限中心调用查询资源实例接口的 HOST，格式：scheme://netloc，与 resource_type.provider_config.path 配合使用</td>
</tr>
<tr>
<td align="left">auth</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">权限中心调用查询资源实例接口的鉴权方式, 当前可选: <code>none</code>/<code>basic</code>, 详细说明文档 <a href="../01-Overview/03-APIAuth.md">系统间调用接口鉴权:权限中心-&gt;接入系统</a></td>
</tr>
<tr>
<td align="left">healthz</td>
<td align="left">string</td>
<td align="left">否</td>
<td align="left">权限中心调用接入系统的 healthz 检查系统是否健康; 与 provider_config.host 配合使用, <code>例如system.provider_config.host=http://cmdb.consul, provider_config.healthz=/healthz/</code>, 那么将调用<code>http://cmdb.consul/healthz/</code>检查系统是否健康.</td>
</tr>
</tbody>
</table>
<h3 id="1-system">1. 新增 system</h3>
<p>注意: </p>
<ul>
<li>一个 app_code 只能创建一个 system, 且 system_id 必须等于 app_code; 如果不符合要求, 接口返回 <code>1901400 bad request:system_id should be the app_code!</code></li>
<li>创建 system 时如果没有把自己加入 clients, 会自动将当前发起<code>新增system</code>的 app_code 加入<code>clients</code></li>
</ul>
<hr />
<h4 id="url">URL</h4>
<blockquote>
<p>POST /api/v1/model/systems</p>
</blockquote>
<h4 id="request">Request</h4>
<pre class="codehilite"><code class="language-json">{
    &quot;id&quot;: &quot;bk_cmdb&quot;,
    &quot;name&quot;: &quot;配置平台&quot;,
    &quot;name_en&quot;: &quot;CMDB&quot;,
    &quot;description&quot;: &quot;配置平台是一个...&quot;,
    &quot;description_en&quot;: &quot;CMDB is a...&quot;,
    &quot;clients&quot;: &quot;bk_cmdb,cmdb&quot;,
    &quot;provider_config&quot;: {
        &quot;host&quot;: &quot;http://cmdb.service.consul&quot;,
        &quot;auth&quot;: &quot;basic&quot;,
        &quot;healthz&quot;: &quot;/api/v1/healthz&quot;
    }
}</code></pre>


<h4 id="response">Response</h4>
<pre class="codehilite"><code class="language-json">{
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: {
        &quot;id&quot;: &quot;bk_cmdb&quot;
    }
}</code></pre>


<h3 id="2-system">2. 更新 system</h3>
<p><code>路径中system_id是唯一标识; body中只需要传入要更新的字段, 其中对于provider_config是全覆盖更新，不支持只更新provider_config中某个字段</code></p>
<p>注意: 
- 更新 system 时如果没有把自己加入 clients, 会自动将当前发起<code>更新system</code>的 app_code 加入<code>clients</code>(即, 更新发起者无法将自己移除<code>clients</code>)</p>
<h4 id="url_1">URL</h4>
<blockquote>
<p>PUT /api/v1/model/systems/{system_id}</p>
</blockquote>
<h4 id="parameters">Parameters</h4>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">位置</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">system_id</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">path</td>
<td align="left">系统 ID</td>
</tr>
</tbody>
</table>
<h4 id="request_1">Request</h4>
<p><code>json
{
    "name": "配置平台",
    "name_en": "CMDB",
    "clients": "bk_cmdb,cmdb",
    "provider_config": {
        "host": "http://cmdb_new.service.consul"
    }
}</code></p>
<h4 id="response_1">Response</h4>
<pre class="codehilite"><code class="language-json">{
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: {}
}</code></pre><h1 id="resourcetype-api">资源类型 ResourceType API</h1>
<h3 id="_1">参数说明</h3>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">id</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">资源类型 id, 系统下唯一, 只允许小写字母开头、包含小写字母、数字、下划线(_)和连接符(-),最长 32 个字符.</td>
</tr>
<tr>
<td align="left">name</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">资源类型名称，系统下唯一</td>
</tr>
<tr>
<td align="left">name_en</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">资源类型英文名，国际化时切换到英文版本显示</td>
</tr>
<tr>
<td align="left">description</td>
<td align="left">string</td>
<td align="left">否</td>
<td align="left">资源类型名称，系统下唯一</td>
</tr>
<tr>
<td align="left">description_en</td>
<td align="left">string</td>
<td align="left">否</td>
<td align="left">资源类型英文名，国际化时切换到英文版本显示</td>
</tr>
<tr>
<td align="left">parents</td>
<td align="left">Array[Object]</td>
<td align="left">否</td>
<td align="left">资源类型的直接上级，可多个直接上级，可以是自身系统的资源类型或其他系统的资源类型, 可为空列表，不允许重复，数据仅用于权限中心产品上显示</td>
</tr>
<tr>
<td align="left">provider_config</td>
<td align="left">Object</td>
<td align="left">是</td>
<td align="left">权限中心调用查询资源实例接口的配置文件，与 system.provider_config.host 配合使用 <a href="./00-Concepts.md">更多概念说明</a></td>
</tr>
<tr>
<td align="left">version</td>
<td align="left">int</td>
<td align="left">否</td>
<td align="left">版本号，允许为空，仅仅作为在权限中心上进行 New 的更新提醒  <a href="./00-Concepts.md">更多概念说明</a></td>
</tr>
</tbody>
</table>
<p>parents 元素参数说明</p>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">system_id</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">直接上级资源类型的来源系统 ID</td>
</tr>
<tr>
<td align="left">id</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">直接上级资源类型 ID</td>
</tr>
</tbody>
</table>
<p>provider_config 内元素 参数：</p>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">path</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">权限中心调用查询资源实例接口的 URL 的 PATH，与 system.provider_config.host 配合使用</td>
</tr>
</tbody>
</table>
<h3 id="1-resourcetype">1. 新增 resourceType</h3>
<p>限制:
- 一个系统只能创建最多 50 个 resourceType</p>
<h4 id="url">URL</h4>
<blockquote>
<p>POST /api/v1/model/systems/{system_id}/resource-types</p>
</blockquote>
<h4 id="parameters">Parameters</h4>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">位置</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">system_id</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">path</td>
<td align="left">系统 ID</td>
</tr>
</tbody>
</table>
<h4 id="request">Request</h4>
<pre class="codehilite"><code class="language-json">[
    {
        &quot;id&quot;: &quot;biz_set&quot;,
        &quot;name&quot;: &quot;业务集&quot;,
        &quot;name_en&quot;: &quot;biz_set&quot;,
        &quot;description&quot;: &quot;业务集是...&quot;,
        &quot;description_en&quot;: &quot;biz_set is a ...&quot;,
        &quot;parents&quot;: [],
        &quot;provider_config&quot;: {
            &quot;path&quot;: &quot;/api/v1/resources/biz_set/query&quot;
        },
        &quot;version&quot;: 1
    },
    {
        &quot;id&quot;: &quot;biz&quot;,
        &quot;name&quot;: &quot;业务&quot;,
        &quot;name_en&quot;: &quot;biz&quot;,
        &quot;description&quot;: &quot;业务是...&quot;,
        &quot;description_en&quot;: &quot;biz is a ...&quot;,
        &quot;parents&quot;: [
            {&quot;system_id&quot;: &quot;bk_cmdb&quot;, &quot;id&quot;: &quot;biz_set&quot;}            
        ],
        &quot;provider_config&quot;: {
            &quot;path&quot;: &quot;/api/v1/resources/biz/query&quot;
        },
        &quot;version&quot;: 1
    },
    {
        &quot;id&quot;: &quot;dir&quot;, 
        &quot;name&quot;: &quot;目录&quot;,
        &quot;name_en&quot;: &quot;dir&quot;, 
        &quot;description&quot;: &quot;目录是...&quot;,
        &quot;description_en&quot;: &quot;dir is a ...&quot;,
        &quot;parents&quot;: [
            {&quot;system_id&quot;: &quot;bk_cmdb&quot;, &quot;id&quot;: &quot;biz&quot;}
        ],
        &quot;provider_config&quot;: {
            &quot;path&quot;: &quot;/api/v1/resources/dir/query&quot;
        },
        &quot;version&quot;: 1
    },  
    {
        &quot;id&quot;: &quot;set&quot;, 
        &quot;name&quot;: &quot;集群&quot;,
        &quot;name_en&quot;: &quot;set&quot;, 
        &quot;description&quot;: &quot;集群是...&quot;,
        &quot;description_en&quot;: &quot;set is a ...&quot;,
        &quot;parents&quot;: [
            {&quot;system_id&quot;: &quot;bk_cmdb&quot;, &quot;id&quot;: &quot;biz&quot;},
            {&quot;system_id&quot;: &quot;bk_cmdb&quot;, &quot;id&quot;: &quot;dir&quot;}
        ],
        &quot;provider_config&quot;: {
            &quot;path&quot;: &quot;/api/v1/resources/set/query&quot;
        },
        &quot;version&quot;: 1
    },
    {
        &quot;id&quot;: &quot;module&quot;, 
        &quot;name&quot;: &quot;模块&quot;,
        &quot;name_en&quot;: &quot;module&quot;, 
        &quot;description&quot;: &quot;模块是...&quot;,
        &quot;description_en&quot;: &quot;module is a ...&quot;,
        &quot;parents&quot;: [
            {&quot;system_id&quot;: &quot;bk_cmdb&quot;, &quot;id&quot;: &quot;set&quot;}
        ],
        &quot;provider_config&quot;: {
            &quot;path&quot;: &quot;/api/v1/resources/module/query&quot;
        },
        &quot;version&quot;: 1
    },
    {
        &quot;id&quot;: &quot;host&quot;, 
        &quot;name&quot;: &quot;主机&quot;,
        &quot;name_en&quot;: &quot;host&quot;, 
        &quot;description&quot;: &quot;主机是...&quot;,
        &quot;description_en&quot;: &quot;host is a ...&quot;,
        &quot;parents&quot;: [
            {&quot;system_id&quot;: &quot;bk_cmdb&quot;, &quot;id&quot;: &quot;module&quot;}
        ],
        &quot;provider_config&quot;: {
            &quot;path&quot;: &quot;/api/v1/resources/host/query&quot;
        },
        &quot;version&quot;: 1
    }
]</code></pre>


<h4 id="response">Response</h4>
<pre class="codehilite"><code class="language-json">{
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: {}
}</code></pre>


<h3 id="2-resourcetype">2. 修改 resourceType</h3>
<h4 id="url_1">URL</h4>
<blockquote>
<p>PUT /api/v1/model/systems/{system_id}/resource-types/{resource_type_id}</p>
</blockquote>
<h4 id="parameters_1">Parameters</h4>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">位置</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">system_id</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">path</td>
<td align="left">系统 ID</td>
</tr>
<tr>
<td align="left">resource_type_id</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">path</td>
<td align="left">资源类型 ID</td>
</tr>
</tbody>
</table>
<h4 id="request_1">Request</h4>
<pre class="codehilite"><code class="language-json">{
    &quot;name&quot;: &quot;业务新&quot;,
    &quot;name_en&quot;: &quot;biz new&quot;,
    &quot;description&quot;: &quot;业务新...&quot;,
    &quot;description_en&quot;: &quot;biz new is ....&quot;,
    &quot;provider_config&quot;: {
        &quot;path&quot;: &quot;/api/v2/resources/biz/query&quot;
    },
    &quot;version&quot;: 2
}</code></pre>


<h4 id="response_1">Response</h4>
<pre class="codehilite"><code class="language-json">{
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: {}
}</code></pre>


<h3 id="3-resourcetype">3. 删除 resourceType</h3>
<p>必须同时满足以下两个条件才能成功删除资源类型
1. 该资源类型不作为其他的上级资源，具体遍历所有资源类型的 parents 是否存在该资源类型
2. 该资源类型不作为 Action 的操作对象资源类型，具体遍历所有 Action 的 related_resource_types 是否存在该资源类型</p>
<h4 id="url_2">URL</h4>
<p>批量删除 (需要 Request.Body)</p>
<blockquote>
<p>DELETE /api/v1/model/systems/{system_id}/resource-types</p>
</blockquote>
<p>单个删除 (不需要 Request.Body)</p>
<blockquote>
<p>DELETE /api/v1/model/systems/{system_id}/resource-types/{resource_type_id}</p>
</blockquote>
<h4 id="parameters_2">Parameters</h4>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">位置</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">system_id</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">path</td>
<td align="left">系统 ID</td>
</tr>
<tr>
<td align="left">resource_type_id</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">path</td>
<td align="left">资源类型 ID</td>
</tr>
<tr>
<td align="left">check_existence</td>
<td align="left">boolean</td>
<td align="left">否</td>
<td align="left">query</td>
<td align="left">默认会检查 id 存在, 不存在将导致删除失败,  设置 false 不检查 id 是否存在, 直接走删除(<code>delete from table where id in []</code>)</td>
</tr>
</tbody>
</table>
<h4 id="request_2">Request</h4>
<pre class="codehilite"><code class="language-json">[
    {
        &quot;id&quot;: &quot;biz&quot;
    },
    {
        &quot;id&quot;: &quot;set&quot;
    }
]</code></pre>


<h4 id="response_2">Response</h4>
<pre class="codehilite"><code class="language-json">{
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: {}
}</code></pre><h1 id="instanceselection-api">实例视图 InstanceSelection API</h1>
<h3 id="_1">参数说明</h3>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">id</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">实例视图 id, 系统下唯一, 只允许小写字母开头、包含小写字母、数字、下划线(_)和连接符(-),最长 32 个字符.</td>
</tr>
<tr>
<td align="left">name</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">实例视图名称，系统下唯一</td>
</tr>
<tr>
<td align="left">name_en</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">实例视图的英文名，国际化时切换到英文版本显示，系统下唯一</td>
</tr>
<tr>
<td align="left">is_dynamic</td>
<td align="left">bool</td>
<td align="left">否</td>
<td align="left">是否是动态拓扑视图，<code>默认为false</code>，<a href="./00-Concepts.md">更多概念说明</a></td>
</tr>
<tr>
<td align="left">resource_type_chain</td>
<td align="left">Array(Object)</td>
<td align="left">是</td>
<td align="left">资源类型的层级链路</td>
</tr>
</tbody>
</table>
<p>resource_type_chain 里的元素 </p>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">system_id</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">资源类型的来源系统 ID</td>
</tr>
<tr>
<td align="left">id</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">资源类型 ID</td>
</tr>
</tbody>
</table>
<h3 id="1-instanceselection">1. 新增 instanceSelection</h3>
<p>限制:
- 一个系统只能创建最多 50 个 instanceSelection</p>
<h4 id="url">URL</h4>
<blockquote>
<p>POST /api/v1/model/systems/{system_id}/instance-selections</p>
</blockquote>
<h4 id="parameters">Parameters</h4>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">位置</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">system_id</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">path</td>
<td align="left">系统 ID</td>
</tr>
</tbody>
</table>
<h4 id="request">Request</h4>
<pre class="codehilite"><code class="language-json">[
    {
        &quot;id&quot;: &quot;free_host&quot;,
        &quot;name&quot;: &quot;空闲主机&quot;,
        &quot;name_en&quot;: &quot;free host&quot;,
        &quot;resource_type_chain&quot;: [{
            &quot;system_id&quot;: &quot;bk_cmdb&quot;,
            &quot;id&quot;: &quot;host&quot;
        }]
    },
    {
        &quot;id&quot;: &quot;biz_topology&quot;,
        &quot;name&quot;: &quot;业务拓扑&quot;,
        &quot;name_en&quot;: &quot;biz topology&quot;,
        &quot;resource_type_chain&quot;: [{
                &quot;system_id&quot;: &quot;bk_cmdb&quot;,
                &quot;id&quot;: &quot;biz&quot;
            },
            {
                &quot;system_id&quot;: &quot;bk_cmdb&quot;,
                &quot;id&quot;: &quot;set&quot;
            },
            {
                &quot;system_id&quot;: &quot;bk_cmdb&quot;,
                &quot;id&quot;: &quot;module&quot;
            },
            {
                &quot;system_id&quot;: &quot;bk_cmdb&quot;,
                &quot;id&quot;: &quot;host&quot;
            }
        ]
    }
]</code></pre>


<h4 id="response">Response</h4>
<pre class="codehilite"><code class="language-json">{
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: {}
}</code></pre>


<h3 id="2-instanceselection">2. 修改 instanceSelection</h3>
<h4 id="url_1">URL</h4>
<blockquote>
<p>PUT /api/v1/model/systems/{system_id}/instance-selections/{instance_selection_id}</p>
</blockquote>
<h4 id="parameters_1">Parameters</h4>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">位置</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">system_id</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">path</td>
<td align="left">系统 ID</td>
</tr>
<tr>
<td align="left">instance_selection_id</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">path</td>
<td align="left">实例视图 ID</td>
</tr>
</tbody>
</table>
<h4 id="request_1">Request</h4>
<pre class="codehilite"><code class="language-json">{
    &quot;id&quot;: &quot;free_host1&quot;,
    &quot;name&quot;: &quot;空闲主机1&quot;,
    &quot;name_en&quot;: &quot;free host1&quot;,
    &quot;resource_type_chain&quot;: [{
        &quot;system_id&quot;: &quot;bk_cmdb&quot;,
        &quot;id&quot;: &quot;host&quot;
    }]
}</code></pre>


<h4 id="response_1">Response</h4>
<pre class="codehilite"><code class="language-json">{
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: {}
}</code></pre>


<h3 id="3-instanceselection">3. 删除 instanceSelection</h3>
<p>必须满足以下条件才能成功删除实例视图:
1. 该实例视图没有被本系统的 Action 关联资源操作引用，具体遍历所有 Action 的 related_resource_types 中的 related_instance_selections 是否存在该实例视图</p>
<h4 id="url_2">URL</h4>
<p>批量删除 (需要 Request.Body)</p>
<blockquote>
<p>DELETE  /api/v1/model/systems/{system_id}/instance-selections</p>
</blockquote>
<p>单个删除 (不需要 Request.Body)</p>
<blockquote>
<p>DELETE /api/v1/model/systems/{system_id}/instance-selections/{instance_selection_id}</p>
</blockquote>
<h4 id="parameters_2">Parameters</h4>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">位置</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">system_id</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">path</td>
<td align="left">系统 ID</td>
</tr>
<tr>
<td align="left">instance_selection_id</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">path</td>
<td align="left">实例视图 ID</td>
</tr>
<tr>
<td align="left">check_existence</td>
<td align="left">boolean</td>
<td align="left">否</td>
<td align="left">query</td>
<td align="left">默认会检查 id 存在, 不存在将导致删除失败, 设置 false 不检查 id 是否存在, 直接走删除( <code>delete from table where id in []</code> )</td>
</tr>
</tbody>
</table>
<h4 id="request_2">Request</h4>
<pre class="codehilite"><code class="language-json">[
    {
        &quot;id&quot;: &quot;free_host&quot;
    },
    {
        &quot;id&quot;: &quot;biz_topology&quot;
    }
]</code></pre>


<h4 id="response_2">Response</h4>
<pre class="codehilite"><code class="language-json">{
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: {}
}</code></pre><h1 id="action-api">操作 Action API</h1>
<h3 id="_1">参数说明</h3>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">id</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">操作 id, 系统下唯一, 只允许小写字母开头、包含小写字母、数字、下划线(_)和连接符(-). 最长 32 个字符.</td>
</tr>
<tr>
<td align="left">name</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">操作名称，系统下唯一，参考<a href="../../NamingRules.md">命名规范</a></td>
</tr>
<tr>
<td align="left">name_en</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">操作英文名，国际化时切换到英文版本显示，参考<a href="../../NamingRules.md">命名规范</a></td>
</tr>
<tr>
<td align="left">description</td>
<td align="left">string</td>
<td align="left">否</td>
<td align="left">操作描述</td>
</tr>
<tr>
<td align="left">description_en</td>
<td align="left">string</td>
<td align="left">否</td>
<td align="left">操作描述英文，国际化时切换到英文版本显示</td>
</tr>
<tr>
<td align="left">type</td>
<td align="left">string</td>
<td align="left">否</td>
<td align="left">操作的类型，枚举值包括<code>create\delete\view\edit\list\manage\execute\use</code> 比如创建类操作需要标识为"create"，无法分类可为空字符串</td>
</tr>
<tr>
<td align="left">related_resource_types</td>
<td align="left">Array(Object)</td>
<td align="left">否</td>
<td align="left">操作的对象，资源类型列表，列表顺序与<code>产品展示</code>、<code>鉴权校验</code> 顺序 必须保持一致。<code>如果操作无需关联资源实例，这里为空即可。</code>  <strong>注意这是一个有序的列表!</strong>:</td>
</tr>
<tr>
<td align="left">related_actions</td>
<td align="left">Array(string)</td>
<td align="left">否</td>
<td align="left">操作的依赖操作, 由操作 ID 组成的字符串列表, 用于在申请权限时同时创建依赖权限  <a href="./00-Concepts.md">更多概念说明</a></td>
</tr>
<tr>
<td align="left">version</td>
<td align="left">int</td>
<td align="left">否</td>
<td align="left">版本号，允许为空，仅仅作为在权限中心上进行 New 的更新提醒 <a href="./00-Concepts.md">更多概念说明</a></td>
</tr>
</tbody>
</table>
<p>related_resource_types 里的元素</p>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">system_id</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">资源类型的来源系统，可以是自身系统或其他系统</td>
</tr>
<tr>
<td align="left">id</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">资源类型 ID，操作关联多个资源类型时，<code>同一个related_resource_types里 id 不能重复</code></td>
</tr>
<tr>
<td align="left">name_alias</td>
<td align="left">string</td>
<td align="left">否</td>
<td align="left">资源类型名称的别名，同一个资源类型对于不同 Action 可以有各自的显示名称</td>
</tr>
<tr>
<td align="left">name_alias_en</td>
<td align="left">string</td>
<td align="left">否</td>
<td align="left">资源类型名称的别名英文名</td>
</tr>
<tr>
<td align="left">scope</td>
<td align="left">Object</td>
<td align="left">否</td>
<td align="left">选填，限制该操作对该资源的选择范围，<a href="../../Expression/01-Schema.md">条件表达式协议</a></td>
</tr>
<tr>
<td align="left">selection_mode</td>
<td align="left">string</td>
<td align="left">否</td>
<td align="left">选择类型, 即资源在权限中心产品上配置权限时的作用范围, 可选: <code>instance</code>/<code>attribute</code>/<code>all</code>, 如果不设置, 默认为<code>instance</code>, <a href="./00-Concepts.md">更多概念说明</a></td>
</tr>
<tr>
<td align="left">related_instance_selections</td>
<td align="left">Array(Object)</td>
<td align="left">否</td>
<td align="left">关联的实例视图，即资源在权限中心产品上配置权限时的选择方式; 可以配置本系统的实例视图, 也可以配置其他系统的实例视图(如果<code>selection_mode=attribute</code>则该字段不用配置; 如果没有设置<code>selection_mode</code>或<code>selection_mode=instance/all</code>, 此时这个字段不能为空)</td>
</tr>
</tbody>
</table>
<p>related_instance_selections 里的元素 </p>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">system_id</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">实例视图的来源系统 ID</td>
</tr>
<tr>
<td align="left">id</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">实例视图 ID</td>
</tr>
<tr>
<td align="left">ignore_iam_path</td>
<td align="left">bool</td>
<td align="left">否</td>
<td align="left">是否配置的权限忽略路径，<code>默认为false</code>，<a href="./00-Concepts.md">更多概念说明</a></td>
</tr>
</tbody>
</table>
<p>注册后，IAM 配置权限时拉取资源的逻辑，请查看<a href="../03-Callback/01-API.md">资源拉取接口协议</a></p>
<p><strong>重要说明：</strong> 
- Action 关联的资源类型必须在权限中心已经注册的，否则 Action 将注册失败
- 若关联的资源类型的自身系统的，则需要先注册该资源类型
- 若关联的资源类型是依赖其他系统的，则需要等依赖系统注册该资源类型后才可以进行该 Action 注册</p>
<h3 id="1-action">1. 添加 action</h3>
<p>限制:
- 一个系统只能创建最多 100 个 action, 所以如果操作会超过 100 个, 需要思考模型的正确性/合理性(例如把实例抽象到了 action 导致 action 随实例增多而增多)</p>
<h4 id="url">URL</h4>
<blockquote>
<p>POST  /api/v1/model/systems/{system_id}/actions</p>
</blockquote>
<h4 id="parameters">Parameters</h4>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">位置</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">system_id</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">path</td>
<td align="left">系统 ID</td>
</tr>
</tbody>
</table>
<h4 id="request">Request</h4>
<pre class="codehilite"><code class="language-json">[
    {
        &quot;id&quot;: &quot;biz_create&quot;,
        &quot;name&quot;: &quot;业务创建&quot;,
        &quot;name_en&quot;: &quot;biz_create&quot;,
        &quot;description&quot;: &quot;业务创建是...&quot;,
        &quot;description_en&quot;: &quot;biz_create is...&quot;,
        &quot;type&quot;: &quot;create&quot;,
        &quot;related_resource_types&quot;: [],
        &quot;version&quot;: 1
    },
    {
        &quot;id&quot;: &quot;host_edit&quot;,
        &quot;name&quot;: &quot;主机编辑&quot;,
        &quot;name_en&quot;: &quot;host_edit&quot;,
        &quot;type&quot;: &quot;&quot;,
        &quot;related_resource_types&quot;: [
            {
                &quot;system_id&quot;: &quot;bk_cmdb&quot;,
                &quot;id&quot;: &quot;host&quot;,
                &quot;name_alias&quot;:  &quot;&quot;,
                &quot;name_alias_en&quot;: &quot;&quot;,
                &quot;selection_mode&quot;: &quot;instance&quot;,
                &quot;related_instance_selections&quot;: [
                    {
                        &quot;system_id&quot;: &quot;bk_cmdb&quot;,
                        &quot;id&quot;: &quot;free_host&quot;,
                        &quot;ignore_iam_path&quot;: false,
                    }, 
                    {
                        &quot;system_id&quot;: &quot;bk_cmdb&quot;,
                        &quot;id&quot;: &quot;biz_topology&quot;,
                        &quot;ignore_iam_path&quot;: false,
                    }, 
                    {
                        &quot;system_id&quot;: &quot;bk_cmdb&quot;,
                        &quot;id&quot;: &quot;biz_set_topology&quot;,
                        &quot;ignore_iam_path&quot;: false,
                    }
                ]
            }
        ],
        &quot;related_actions&quot;: [&quot;view&quot;, &quot;delete&quot;],
        &quot;version&quot;: 1
    }
]</code></pre>


<h4 id="response">Response</h4>
<pre class="codehilite"><code class="language-json">{
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: {}
}</code></pre>


<h3 id="2-action">2. 修改 action</h3>
<p><strong>重点：</strong>
- 可更新 name\name_en\type\version\related_resource_types 这 5 个 key 的值， 如果传了对应<code>key</code>并给了<code>空值</code>, 那么执行的是<code>置空操作</code>; 如果没有传<code>key</code>, 表示不更新该字段；
- <code>特别：对于related_resource_types是一个完全覆盖操作，不能单独更新related_resource_types里的某个key的值</code></p>
<h4 id="url_1">URL</h4>
<blockquote>
<p>PUT /api/v1/model/systems/{system_id}/actions/{action_id}</p>
</blockquote>
<h4 id="parameters_1">Parameters</h4>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">位置</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">system_id</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">path</td>
<td align="left">系统 ID</td>
</tr>
<tr>
<td align="left">action_id</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">path</td>
<td align="left">操作 ID</td>
</tr>
</tbody>
</table>
<h4 id="request_1">Request</h4>
<pre class="codehilite"><code class="language-json">{
   &quot;name&quot;:&quot;主机编辑New&quot;,
   &quot;name_en&quot;:&quot;host_edit&quot;,
   &quot;description&quot;:&quot;主机编辑New是...&quot;,
   &quot;description_en&quot;:&quot;host_edit is...&quot;,
   &quot;related_resource_types&quot;:[
      {
         &quot;system_id&quot;:&quot;bk_cmdb&quot;,
         &quot;id&quot;:&quot;host&quot;,
         &quot;name_alias&quot;:&quot;&quot;,
         &quot;name_alias_en&quot;:&quot;&quot;,
         &quot;selection_mode&quot;: &quot;instance&quot;,
         &quot;related_instance_selections&quot;:[
                    {
                        &quot;system_id&quot;: &quot;bk_cmdb&quot;,
                        &quot;id&quot;: &quot;free_host&quot;,
                        &quot;ignore_iam_path&quot;: false,
                    }, 
                    {
                        &quot;system_id&quot;: &quot;bk_cmdb&quot;,
                        &quot;id&quot;: &quot;biz_topology&quot;,
                        &quot;ignore_iam_path&quot;: false,
                    }
         ]
      }
   ],
   &quot;related_actions&quot;: [&quot;view&quot;, &quot;delete&quot;],
   &quot;version&quot;:2
}</code></pre>


<h4 id="response_1">Response</h4>
<pre class="codehilite"><code class="language-json">{
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: {}
}</code></pre>


<h3 id="3-action">3. 删除 action</h3>
<p>说明：
- 删除 Action 成功后，将会删除该 Action 相关权限，该删除操作不可逆，请谨慎调用</p>
<h4 id="url_2">URL</h4>
<p>批量删除 (需要 Request.Body)</p>
<blockquote>
<p>DELETE  /api/v1/model/systems/{system_id}/actions</p>
</blockquote>
<p>单个删除 (不需要 Request.Body)</p>
<blockquote>
<p>DELETE /api/v1/model/systems/{system_id}/actions/{action_id}</p>
</blockquote>
<h4 id="parameters_2">Parameters</h4>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">位置</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">system_id</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">path</td>
<td align="left">系统 ID</td>
</tr>
<tr>
<td align="left">action_id</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">path</td>
<td align="left">操作 ID</td>
</tr>
<tr>
<td align="left">check_existence</td>
<td align="left">boolean</td>
<td align="left">否</td>
<td align="left">query</td>
<td align="left">默认会检查 id 存在, 不存在将导致删除失败, 设置 false 不检查 id 是否存在, 直接走删除( <code>delete from table where id in []</code> )</td>
</tr>
</tbody>
</table>
<h4 id="request_2">Request</h4>
<pre class="codehilite"><code class="language-json">[
    {
        &quot;id&quot;: &quot;host_edit&quot;
    }
]</code></pre>


<h4 id="response_2">Response</h4>
<pre class="codehilite"><code class="language-json">{
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: {}
}</code></pre><h1 id="actiongroup-api">操作组 ActionGroup API</h1>
<h3 id="_1">参数说明</h3>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">name</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">操作组名称</td>
</tr>
<tr>
<td align="left">name_en</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">操作组英文名，国际化时切换到英文版本显示</td>
</tr>
<tr>
<td align="left">actions</td>
<td align="left">Array(Object)</td>
<td align="left">否</td>
<td align="left">操作列表</td>
</tr>
<tr>
<td align="left">sub_groups</td>
<td align="left">Array(Object)</td>
<td align="left">否</td>
<td align="left">下一级操作组</td>
</tr>
</tbody>
</table>
<p>注意:</p>
<ol>
<li>最多<code>两级</code>操作组(即第一级<code>sub_gropus</code>下的操作组不能有下一级<code>sub_groups</code>), 如果嵌套超过两级, 会返回错误 <code>1901400(more than 2-levels action_group, current only support 2-levels)</code> </li>
<li>同一个操作组的<code>actions</code>和<code>sub_groups</code> 不能同时为空 <code>1901400(actions and sub_groups can't be empty at the same time)</code></li>
<li>action 可以挂在一级或二级的<code>操作组</code>上, 但是, 同一个 action 只能挂在一个<code>一级操作组</code>/<code>二级操作组</code>下; 即, action_id 全局 json 内唯一;   <code>1901400(one action can belong only one group)</code> </li>
<li>会校验每一个<code>action_id</code>; 必须是系统注册的合法<code>action_id</code>; 所以使用接口调用注册或者使用 migration 注册时, <code>action_id</code>对应的操作必须先注册, 再更新<code>action_groups</code></li>
</ol>
<h3 id="1">1. 注册或更新 操作组</h3>
<h4 id="url">URL</h4>
<p>注册</p>
<blockquote>
<p>POST /api/v1/model/systems/{system_id}/configs/action_groups</p>
</blockquote>
<p>更新 (整个列表完全覆盖更新)</p>
<blockquote>
<p>PUT /api/v1/model/systems/{system_id}/configs/action_groups</p>
</blockquote>
<h4 id="parameters">Parameters</h4>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">位置</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">system_id</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">path</td>
<td align="left">系统 ID</td>
</tr>
</tbody>
</table>
<h4 id="request">Request</h4>
<pre class="codehilite"><code class="language-json">[
    {
        &quot;name&quot;: &quot;管理权限&quot;,
        &quot;name_en&quot;: &quot;Admin Permissions&quot;,
        &quot;actions&quot;: [
            {
                &quot;id&quot;: &quot;create_biz&quot;
            },
            {
                &quot;id&quot;: &quot;delete_biz&quot;
            }
        ]
    },
    {
        &quot;name&quot;: &quot;运维&quot;,
        &quot;name_en&quot;: &quot;Devops Permissions&quot;,
        &quot;sub_groups&quot;: [
            {
                &quot;name&quot;: &quot;主机权限&quot;,
                &quot;name_en&quot;: &quot;Host Permissions&quot;,
                &quot;actions&quot;: [
                    {
                        &quot;id&quot;: &quot;view_host&quot;
                    },
                    {
                        &quot;id&quot;: &quot;create_host&quot;
                    }
                ]
            }
        ]
    }
]</code></pre>


<h4 id="response">Response</h4>
<pre class="codehilite"><code class="language-json">{
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: {}
}</code></pre><h1 id="common-query-api">通用查询 Common Query API</h1>
<h3 id="1">1. 查询系统注册的信息</h3>
<h4 id="url">URL</h4>
<blockquote>
<p>GET /api/v1/model/systems/{system_id}/query</p>
</blockquote>
<h4 id="parameters">Parameters</h4>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">位置</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">system_id</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">path</td>
<td align="left">系统 ID</td>
</tr>
<tr>
<td align="left">fields</td>
<td align="left">string</td>
<td align="left">否</td>
<td align="left">query</td>
<td align="left">需要查询的信息类型，枚举值：base_info(基础信息), resource_types(资源类型)，actions(操作)，action_groups (操作组), instance_selections(实例视图), resource_creator_actions(新建关联配置), common_actions(常用操作) 多个以英文逗号分隔，空值时查询所有注册的信息</td>
</tr>
</tbody>
</table>
<h4 id="request">Request</h4>
<pre class="codehilite"><code class="language-json">fields=base_info,resource_types,actions,action_groups,instance_selections,resource_creator_actions</code></pre>


<h4 id="response">Response</h4>
<p>说明：
- 返回的信息数据结构与注册时的数据结构一致</p>
<pre class="codehilite"><code class="language-json">{
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: {
        // 基础信息
        &quot;base_info&quot;: {
            &quot;id&quot;: &quot;bk_cmdb&quot;,
            &quot;name&quot;: &quot;配置平台&quot;,
            &quot;name_en&quot;: &quot;CMDB&quot;,
            &quot;description&quot;: &quot;配置平台是...&quot;,
            &quot;description_en&quot;: &quot;CMDB is...&quot;,
            &quot;clients&quot;: &quot;bk_cmdb,cmdb&quot;,
            &quot;provider_config&quot;: {
                &quot;host&quot;: &quot;http://cmdb.service.consul&quot;,
                &quot;auth&quot;: &quot;basic&quot;
            }
        },
        // 资源类型
        &quot;resource_types&quot;: [
            {
                &quot;id&quot;: &quot;host&quot;, 
                &quot;name&quot;: &quot;主机&quot;,
                &quot;name_en&quot;: &quot;host&quot;, 
                &quot;description&quot;: &quot;主机是...&quot;,
                &quot;description_en&quot;: &quot;host is...&quot;, 
                &quot;parents&quot;: [
                    {&quot;system_id&quot;: &quot;bk_cmdb&quot;, &quot;id&quot;: &quot;module&quot;}
                ],
                &quot;provider_config&quot;: {
                    &quot;path&quot;: &quot;/api/v1/resources/host/query&quot;
                }
                &quot;version&quot;: 1
           }, 
           {
                &quot;id&quot;: &quot;biz&quot;,
                &quot;name&quot;: &quot;业务&quot;,
                &quot;name_en&quot;: &quot;biz&quot;,
                &quot;description&quot;: &quot;业务是...&quot;,
                &quot;description_en&quot;: &quot;biz is...&quot;,
                &quot;parents&quot;: [
                    {&quot;system_id&quot;: &quot;bk_cmdb&quot;, &quot;id&quot;: &quot;biz_set&quot;}            
                ],
                &quot;provider_config&quot;: {
                    &quot;path&quot;: &quot;/api/v1/resources/biz_set/query&quot;
                }
                &quot;version&quot;: 1
            }
        ],
        // 操作
        &quot;actions&quot;: [
            {
                &quot;id&quot;: &quot;host_edit&quot;,
                &quot;name&quot;: &quot;主机编辑New&quot;,
                &quot;name_en&quot;: &quot;host_edit&quot;,
                &quot;description&quot;: &quot;主机编辑New是...&quot;,
                &quot;description_en&quot;: &quot;host_edit is...&quot;,
                &quot;type&quot;: &quot;&quot;,
                &quot;related_resource_types&quot;: [
                    {
                        &quot;system_id&quot;: &quot;bk_cmdb&quot;,
                        &quot;id&quot;: &quot;host&quot;,
                        &quot;name_alias&quot;:  &quot;服务器&quot;,
                        &quot;name_alias_en&quot;: &quot;server&quot;,
                        &quot;instance_selections&quot;: [
                            {
                                &quot;name&quot;: &quot;资源池主机&quot;,
                                &quot;name_en&quot;: &quot;free host&quot;,
                                &quot;resource_type_chain&quot;: [{&quot;system_id&quot;: &quot;bk_cmdb&quot;, &quot;id&quot;: &quot;host&quot;}]
                            }, 
                            {
                                &quot;name&quot;: &quot;业务拓扑&quot;,
                                &quot;name_en&quot;: &quot;biz topology&quot;,
                                &quot;resource_type_chain&quot;: [{&quot;system_id&quot;: &quot;bk_cmdb&quot;, &quot;id&quot;: &quot;biz&quot;}, {&quot;system_id&quot;: &quot;bk_cmdb&quot;, &quot;id&quot;: &quot;set&quot;}, {&quot;system_id&quot;: &quot;bk_cmdb&quot;, &quot;id&quot;: &quot;module&quot;}, {&quot;system_id&quot;: &quot;bk_cmdb&quot;, &quot;id&quot;: &quot;host&quot;}]
                            },
                            {
                                &quot;name&quot;: &quot;业务集拓扑&quot;,
                                &quot;name_en&quot;: &quot;biz set topology&quot;
                                &quot;resource_type_chain&quot;: [{&quot;system_id&quot;: &quot;bk_cmdb&quot;, &quot;id&quot;: &quot;biz_set&quot;}, {&quot;system_id&quot;: &quot;bk_cmdb&quot;, &quot;id&quot;: &quot;set&quot;}, {&quot;system_id&quot;: &quot;bk_cmdb&quot;, &quot;id&quot;: &quot;module&quot;}, {&quot;system_id&quot;: &quot;bk_cmdb&quot;, &quot;id&quot;: &quot;host&quot;}]
                            }
                        ]
                    }
                ],
                &quot;version&quot;: 1,
            }
        ],
        // 实例视图
        &quot;instance_selections&quot;: [
            {
                &quot;id&quot;: &quot;view1&quot;,
                &quot;name&quot;: &quot;实例选择11&quot;,
                &quot;name_en&quot;: &quot;view11&quot;,
                &quot;resource_type_chain&quot;: [
                    {
                        &quot;id&quot;: &quot;bbbdd&quot;,
                        &quot;system_id&quot;: &quot;aaacc&quot;
                    }
                ]
            }
        ],
        &quot;resource_creator_actions&quot;: {
            &quot;config&quot;:[
                {
                    &quot;id&quot;:&quot;biz&quot;,
                    &quot;actions&quot;:[
                        {
                            &quot;id&quot;:&quot;biz_edit&quot;,
                            &quot;required&quot;:false
                        },
                        {
                            &quot;id&quot;:&quot;biz_view&quot;,
                            &quot;required&quot;:true
                        },
                        {
                            &quot;id&quot;:&quot;set_create&quot;,
                            &quot;required&quot;:false
                        }
                    ],
                    &quot;sub_resource_types&quot;:[
                        {
                            &quot;id&quot;:&quot;set&quot;,
                            &quot;actions&quot;:[
                                {
                                    &quot;id&quot;:&quot;set_edit&quot;,
                                    &quot;required&quot;:false
                                },
                                {
                                    &quot;id&quot;:&quot;set_view&quot;,
                                    &quot;required&quot;:false
                                },
                                {
                                    &quot;id&quot;:&quot;module_create&quot;,
                                    &quot;required&quot;:false
                                }
                            ],
                            &quot;sub_resource_types&quot;:[
                                {
                                    &quot;id&quot;:&quot;module&quot;,
                                    &quot;actions&quot;:[
                                        {
                                            &quot;id&quot;:&quot;module_edit&quot;,
                                            &quot;required&quot;:false
                                        },
                                        {
                                            &quot;id&quot;:&quot;module_view&quot;,
                                            &quot;required&quot;:false
                                        },
                                        {
                                            &quot;id&quot;:&quot;host_create&quot;,
                                            &quot;required&quot;:false
                                        }
                                    ],
                                    &quot;sub_resource_types&quot;:[
                                        {
                                            &quot;id&quot;:&quot;host&quot;,
                                            &quot;actions&quot;:[
                                                {
                                                    &quot;id&quot;:&quot;host_edit&quot;,
                                                    &quot;required&quot;:false
                                                },
                                                {
                                                    &quot;id&quot;:&quot;host_view&quot;,
                                                    &quot;required&quot;:false
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    }
}</code></pre><h1 id="token-api">系统 token 查询 API</h1>
<h3 id="token">查询系统 token</h3>
<p>用于<code>权限中心</code> 调用 <code>接入系统</code> 拉取资源信息相关接口的鉴权</p>
<h4 id="url">URL</h4>
<blockquote>
<p>GET /api/v1/model/systems/{system_id}/token</p>
</blockquote>
<h4 id="parameters">Parameters</h4>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">位置</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">system_id</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">path</td>
<td align="left">系统 ID</td>
</tr>
</tbody>
</table>
<h4 id="response">Response</h4>
<pre class="codehilite"><code class="language-bash">{
    &quot;code&quot;: 0,
    &quot;data&quot;: {
        &quot;token&quot;: &quot;dk9httsqmq4bbdu7aqq6cqp1az6i8org&quot;
    },
    &quot;message&quot;: &quot;ok&quot;
}</code></pre><h1 id="commonactions-api">常用操作配置 CommonActions API</h1>
<h3 id="_1">参数说明</h3>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">name</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">常用操作名称</td>
</tr>
<tr>
<td align="left">name_en</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">常用操作英文名，国际化时切换到英文版本显示</td>
</tr>
<tr>
<td align="left">actions</td>
<td align="left">Array(Object)</td>
<td align="left">是</td>
<td align="left">操作列表</td>
</tr>
</tbody>
</table>
<h3 id="1">1. 注册或更新 常用操作</h3>
<h4 id="url">URL</h4>
<p>注册</p>
<blockquote>
<p>POST /api/v1/model/systems/{system_id}/configs/common_actions</p>
</blockquote>
<p>更新 (整个列表完全覆盖更新)</p>
<blockquote>
<p>PUT /api/v1/model/systems/{system_id}/configs/common_actions</p>
</blockquote>
<h4 id="parameters">Parameters</h4>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">位置</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">system_id</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">path</td>
<td align="left">系统 ID</td>
</tr>
</tbody>
</table>
<h4 id="request">Request</h4>
<pre class="codehilite"><code class="language-json">[
    {
        &quot;name&quot;: &quot;测试&quot;,
        &quot;name_en&quot;: &quot;test&quot;,
        &quot;actions&quot;: [
            {
                &quot;id&quot;: &quot;biz_delete&quot;
            }
        ]
    }
]</code></pre>


<h4 id="response">Response</h4>
<pre class="codehilite"><code class="language-json">{
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: {}
}</code></pre><h1 id="featureshieldrules-api">功能开关配置 FeatureShieldRules API</h1>
<h3 id="_1">参数说明</h3>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">effect</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">支持黑白名单，值为 deny 或 allow</td>
</tr>
<tr>
<td align="left">feature</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">开启或关闭的功能</td>
</tr>
<tr>
<td align="left">action</td>
<td align="left">Object</td>
<td align="left">是</td>
<td align="left">操作</td>
</tr>
</tbody>
</table>
<p>feature 字段枚举值说明：</p>
<p>| 枚举值 | 说明 |
|:---|:---|:---|
| application.custom_permission.grant | 申请自定义权限 |
| application.custom_permission.renew | 申请自定义权限续期 |
| user_permission.custom_permission.delete | 自定义权限删除 |</p>
<p>action 字段说明：</p>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">id</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">Action 的唯一标识，<code>特别说明:</code> 如果功能是针对整个接入系统，则 id 为 *</td>
</tr>
</tbody>
</table>
<p><code>特别说明</code>：
1. 多条 allow/deny 规则判断最终 effect 的逻辑（类似 Nginx 的 IP 白名单判断），即判断某个功能开启或关闭逻辑：</p>
<pre class="codehilite"><code class="language-bash">在某个功能下的该系统的某个Action的开启与否：allow *[开启] &gt; allow action_id[开启] &gt; deny *[关闭] &gt; deny action_id[关闭] &gt; 默认开启
（1）如果存在allow * 或 allow action_id 的规则匹配，则开启
（3）如果不存在allow * 和 allow action_id 规则，但有deny * 或者deny action_id 规则匹配，则关闭
（4）如果没有任何规则匹配，则默认开启

一般来说，只需要配置屏蔽的功能即可</code></pre>


<ol>
<li>对于依赖操作，如果被屏蔽了，则不会创建依赖操作，比如 edit 依赖 view，但是 view 被屏蔽了，则申请 edit 权限时，不会创建其依赖操作 view</li>
</ol>
<h3 id="1">1. 注册或更新 功能开关规则</h3>
<h4 id="url">URL</h4>
<p>注册</p>
<blockquote>
<p>POST /api/v1/model/systems/{system_id}/configs/feature_shield_rules</p>
</blockquote>
<p>更新 (整个列表完全覆盖更新)</p>
<blockquote>
<p>PUT /api/v1/model/systems/{system_id}/configs/feature_shield_rules</p>
</blockquote>
<h4 id="parameters">Parameters</h4>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">位置</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">system_id</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">path</td>
<td align="left">系统 ID</td>
</tr>
</tbody>
</table>
<h4 id="request">Request</h4>
<pre class="codehilite"><code class="language-json">[
    // 对于自定义申请，屏蔽整个该接入系统所有Action，即该接入系统不支持自定义申请
    {
        &quot;effect&quot;: &quot;deny&quot;,
        &quot;feature&quot;: &quot;application.custom_permission.grant&quot;,
        &quot;action&quot;: {
            &quot;id&quot;: &quot;*&quot;
        }
    },
    // 对于个人权限，接入系统某个Aciton的自定义权限不允许被删除
    {
        &quot;effect&quot;: &quot;deny&quot;,
        &quot;feature&quot;: &quot;user_permission.custom_permission.delete&quot;,
        &quot;action&quot;: {
            &quot;id&quot;: &quot;access_business&quot;
        }
    }
]</code></pre>


<h4 id="response">Response</h4>
<pre class="codehilite"><code class="language-json">{
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: {}
}</code></pre><h1 id="resourcecreatoraction-api">新建关联配置 ResourceCreatorAction API</h1>
<h3 id="_1">参数说明</h3>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">config</td>
<td align="left">array(object)</td>
<td align="left">是</td>
<td align="left">新建关联的配置文件，包含了每种资源类型对应的创建时可以对创建者进行授权的 Action</td>
</tr>
</tbody>
</table>
<p>config 里的每个元素的字段说明:</p>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">id</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">资源类型的唯一标识</td>
</tr>
<tr>
<td align="left">actions</td>
<td align="left">array(object)</td>
<td align="left">是</td>
<td align="left">对应资源被创建时可以对创建者进行授权的 Action 列表</td>
</tr>
<tr>
<td align="left">sub_resource_types</td>
<td align="left">array(object)</td>
<td align="left">否</td>
<td align="left">子资源类型相关可授权的 Action 相关配置信息，列表每个元素同 config 列表里的每个元素一样，这是个递归结构</td>
</tr>
</tbody>
</table>
<p>actions 里的每个元素的字段说明：</p>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">id</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">Action 的唯一标识</td>
</tr>
<tr>
<td align="left">required</td>
<td align="left">bool</td>
<td align="left">是</td>
<td align="left">该 Action 是否是必须的，即后续权限中心支持企业和用户修改创建者赋权时，该 Action 能否不被选择授予</td>
</tr>
</tbody>
</table>
<p><strong><code>required 字段特别说明</code></strong></p>
<blockquote>
<p>假设资源类型 host 产生时可以对 host_edit 、host_view、host_delete 这 3 个权限授权，且 host_delete 配置 required=true</p>
</blockquote>
<ul>
<li>
<p>后续权限中心将支持用户和企业自定义这个新建关联的配置时，host_delete 是必选的，无法去除</p>
</li>
<li>
<p>如果用户自定义新建管理的配置是 host 产生时对 host_view、host_delete 这 2 个权限授权（host_edit 和 host_view 由于 required=false，所以是可以配置为不授权的），那么该用户在接入系统新增 host 后，自动拥有 host_view 和 host_delete</p>
</li>
</ul>
<p><code>注意:</code>
1. 层级结构是依据资源的层级
2. 后续权限中心将会支持这份配置可由企业全局修改和每个用户自定义</p>
<h3 id="1">1. 注册或更新 新建关联配置</h3>
<h4 id="url">URL</h4>
<p>注册</p>
<blockquote>
<p>POST /api/v1/model/systems/{system_id}/configs/resource_creator_actions</p>
</blockquote>
<p>更新 (整个列表完全覆盖更新)</p>
<blockquote>
<p>PUT /api/v1/model/systems/{system_id}/configs/resource_creator_actions</p>
</blockquote>
<h4 id="parameters">Parameters</h4>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">位置</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">system_id</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">path</td>
<td align="left">系统 ID</td>
</tr>
</tbody>
</table>
<h4 id="request">Request</h4>
<ul>
<li>[样例] cmdb 可能的新建关联配置</li>
</ul>
<pre class="codehilite"><code class="language-json">{
    &quot;config&quot;:[
        {
            &quot;id&quot;:&quot;biz&quot;,
            &quot;actions&quot;:[
                {
                    &quot;id&quot;:&quot;biz_edit&quot;,
                    &quot;required&quot;:false
                },
                {
                    &quot;id&quot;:&quot;biz_view&quot;,
                    &quot;required&quot;:true
                },
                {
                    &quot;id&quot;:&quot;set_create&quot;,
                    &quot;required&quot;:false
                }
            ],
            &quot;sub_resource_types&quot;:[
                {
                    &quot;id&quot;:&quot;set&quot;,
                    &quot;actions&quot;:[
                        {
                            &quot;id&quot;:&quot;set_edit&quot;,
                            &quot;required&quot;:false
                        },
                        {
                            &quot;id&quot;:&quot;set_view&quot;,
                            &quot;required&quot;:false
                        },
                        {
                            &quot;id&quot;:&quot;module_create&quot;,
                            &quot;required&quot;:false
                        }
                    ],
                    &quot;sub_resource_types&quot;:[
                        {
                            &quot;id&quot;:&quot;module&quot;,
                            &quot;actions&quot;:[
                                {
                                    &quot;id&quot;:&quot;module_edit&quot;,
                                    &quot;required&quot;:false
                                },
                                {
                                    &quot;id&quot;:&quot;module_view&quot;,
                                    &quot;required&quot;:false
                                },
                                {
                                    &quot;id&quot;:&quot;host_create&quot;,
                                    &quot;required&quot;:false
                                }
                            ],
                            &quot;sub_resource_types&quot;:[
                                {
                                    &quot;id&quot;:&quot;host&quot;,
                                    &quot;actions&quot;:[
                                        {
                                            &quot;id&quot;:&quot;host_edit&quot;,
                                            &quot;required&quot;:false
                                        },
                                        {
                                            &quot;id&quot;:&quot;host_view&quot;,
                                            &quot;required&quot;:false
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    ]
}</code></pre>


<ul>
<li>[样例] 标准运维新建关联配置</li>
</ul>
<pre class="codehilite"><code class="language-json">{
    &quot;config&quot;:[
        {
            &quot;id&quot;:&quot;project&quot;,
            &quot;actions&quot;:[
                {
                    &quot;id&quot;:&quot;project_fast_create_task&quot;,
                    &quot;required&quot;:false
                },
                {
                    &quot;id&quot;:&quot;flow_create&quot;,
                    &quot;required&quot;:false
                },
                {
                    &quot;id&quot;:&quot;project_edit&quot;,
                    &quot;required&quot;:false
                },
                {
                    &quot;id&quot;:&quot;project_view&quot;,
                    &quot;required&quot;:false
                }
            ],
            &quot;sub_resource_types&quot;:[
                {
                    &quot;id&quot;:&quot;common_flow&quot;,
                    &quot;actions&quot;:[
                        {
                            &quot;id&quot;:&quot;common_flow_view&quot;,
                            &quot;required&quot;:false
                        },
                        {
                            &quot;id&quot;:&quot;common_flow_edit&quot;,
                            &quot;required&quot;:false
                        },
                        {
                            &quot;id&quot;:&quot;common_flow_delete&quot;,
                            &quot;required&quot;:false
                        }
                    ]
                },
                {
                    &quot;id&quot;:&quot;flow&quot;,
                    &quot;actions&quot;:[
                        {
                            &quot;id&quot;:&quot;flow_create_periodic_task&quot;,
                            &quot;required&quot;:false
                        },
                        {
                            &quot;id&quot;:&quot;flow_create_mini_app&quot;,
                            &quot;required&quot;:false
                        },
                        {
                            &quot;id&quot;:&quot;flow_create_task&quot;,
                            &quot;required&quot;:false
                        },
                        {
                            &quot;id&quot;:&quot;flow_delete&quot;,
                            &quot;required&quot;:false
                        },
                        {
                            &quot;id&quot;:&quot;flow_edit&quot;,
                            &quot;required&quot;:false
                        },
                        {
                            &quot;id&quot;:&quot;flow_view&quot;,
                            &quot;required&quot;:false
                        }
                    ]
                },
                {
                    &quot;id&quot;:&quot;mini_app&quot;,
                    &quot;actions&quot;:[
                        {
                            &quot;id&quot;:&quot;mini_app_create_task&quot;,
                            &quot;required&quot;:false
                        },
                        {
                            &quot;id&quot;:&quot;mini_app_delete&quot;,
                            &quot;required&quot;:false
                        },
                        {
                            &quot;id&quot;:&quot;mini_app_edit&quot;,
                            &quot;required&quot;:false
                        },
                        {
                            &quot;id&quot;:&quot;mini_app_view&quot;,
                            &quot;required&quot;:false
                        }
                    ]
                },
                {
                    &quot;id&quot;:&quot;periodic_task&quot;,
                    &quot;actions&quot;:[
                        {
                            &quot;id&quot;:&quot;periodic_task_view&quot;,
                            &quot;required&quot;:false
                        },
                        {
                            &quot;id&quot;:&quot;periodic_task_edit&quot;,
                            &quot;required&quot;:false
                        },
                        {
                            &quot;id&quot;:&quot;periodic_task_delete&quot;,
                            &quot;required&quot;:false
                        }
                    ]
                },
                {
                    &quot;id&quot;:&quot;task&quot;,
                    &quot;actions&quot;:[
                        {
                            &quot;id&quot;:&quot;task_view&quot;,
                            &quot;required&quot;:false
                        },
                        {
                            &quot;id&quot;:&quot;task_edit&quot;,
                            &quot;required&quot;:false
                        },
                        {
                            &quot;id&quot;:&quot;task_operate&quot;,
                            &quot;required&quot;:false
                        },
                        {
                            &quot;id&quot;:&quot;task_claim&quot;,
                            &quot;required&quot;:false
                        },
                        {
                            &quot;id&quot;:&quot;task_delete&quot;,
                            &quot;required&quot;:false
                        },
                        {
                            &quot;id&quot;:&quot;task_clone&quot;,
                            &quot;required&quot;:false
                        }
                    ]
                }
            ]
        }
    ]
}</code></pre>


<h4 id="response">Response</h4>
<pre class="codehilite"><code class="language-json">{
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: {}
}</code></pre><h1 id="_1">名词及概念说明</h1>
<h2 id="1-resource">1. 资源实例 Resource</h2>
<ul>
<li>id：资源实例唯一标识，<code>需要保证对于一个系统同一种资源类型下id唯一</code></li>
<li>type: 资源类型的 ID，比如主机、集群、业务即 host、set、biz</li>
<li>name: 资源实例名称，比如 192.168.1.1</li>
<li>display_name: 资源实例展示名称，比如 大区 1(qq 大区)</li>
</ul>
<h2 id="2">2. 可用于配置权限的<code>属性</code>和<code>属性值</code></h2>
<p>可以使用资源属性配置权限, 例如用户 1 可以操作所有<code>os=linux</code>的主机;</p>
<p>为了实现这个功能, 需要从接入系统拉取可以配置权限的属性及属性值列表;</p>
<p>比如：在配置平台中，<code>主机</code>有属性<code>地区</code>，属性值, 枚举: 中国、美国、新加坡、日本等，则：</p>
<pre class="codehilite"><code class="language-bash">属性 id = &quot;area&quot;
属性 display_name = &quot;地区&quot;
属性值 id = &quot;China&quot;
属性值  display_name = &quot;中国&quot;</code></pre>


<p>属性值 id 的类型支持 <code>string/int/bool</code>; 以配置平台主机属性为例：</p>
<pre class="codehilite"><code class="language-json">[string]
属性 id = &quot;os&quot;
属性 display_name = &quot;操作系统&quot;
属性值 id = &quot;linux&quot; 
属性值 display_name = &quot;Linux&quot; 

[int]
属性 id = &quot;isp&quot;
属性 display_name = &quot;运营商&quot;
属性值 id = 1 
属性值 display_name = &quot;中国电信&quot;

[bool]
属性 id = &quot;is_public&quot;
属性 display_name = &quot;是否公共&quot;
属性值 id = true
属性值 display_name = &quot;是&quot; </code></pre>


<h2 id="3-path">3. 特殊属性：路径(path)属性说明</h2>
<p><a href="../../ResourceTopology.md">资源拓扑 Path 说明</a></p><h1 id="api">资源拉取 API</h1>
<h2 id="api_1">API 地址</h2>
<p>接入系统注册模型到权限中心时
- 注册<code>system</code>有提供<code>system.provider_config.host</code>; 假设为<code>http://cmdb.consul</code>
- 注册<code>resource_type</code>有提供<code>system.provider_config.path</code>; 假设为<code>/api/v1/resources</code></p>
<p>那么权限中心将调用<code>http://cmdb.consul/api/v1/resources</code>去拉取该资源类型相关信息</p>
<p>即: 接入系统需要实现一个 API, 用于权限中心拉取不同资源类型的信息;</p>
<p>需要支持: (一个接口根据参数做分发)
1. list_attr 查询某个资源类型可用于配置权限的属性列表
2. list_attr_value 获取一个资源类型某个属性的值列表
3. list_instance 根据过滤条件查询实例
4. fetch_instance_info 批量获取资源实例详情
5. list_instance_by_policy 根据策略表达式查询资源实例
6. search_instance 搜索资源实例</p>
<hr />
<h2 id="_1">接口协议前置说明</h2>
<p>Request Header: 
- <a href="../01-Overview/03-APIAuth.md">系统间调用接口鉴权:权限中心-&gt;接入系统</a></p>
<ul>
<li><code>Blueking-Language</code>  国际化多语言，值为：zh-cn 或 en，当值为 en 时，则接口数据返回中包含的 display_name 字段的值为英文，否则默认返回中文；</li>
<li><code>X-Request-Id</code>  请求 request_id, 请记录, 用于错误排查</li>
</ul>
<p>Response Header:
-  <code>X-Request-Id</code>  将请求 Header 头里的 request_id 返回, 用于错误排查</p>
<p>Response Body: 遵循蓝鲸官方 API 协议进行返回, <code>code != 0</code> 表示出错, <code>message</code>包含具体信息</p>
<pre class="codehilite"><code class="language-bash">{
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: {
    }
}</code></pre>


<p><strong>重要</strong>: 接入系统 API 都需要返回一个<code>request_id</code>, 权限中心将会在日志中记录, 以便后续联调及正式环境中进行问题排查; </p>
<hr />
<h2 id="_2">协议</h2>
<ul>
<li>Method: POST</li>
<li>Path: <code>system.provider_config.host</code> + <code>system.provider_config.path</code></li>
<li>Request.Body:</li>
</ul>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">type</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">对应查询的资源类型</td>
</tr>
<tr>
<td align="left">method</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">需要查询资源信息的方式，不同方式对应查询资源的不同信息，目前值有：<a href="./10-list_attr.md">list_attr</a>、<a href="./11-list_attr_value.md">list_attr_value</a>、 <a href="./12-list_instance.md">list_instance</a>、<a href="./13-fetch_instance_info.md">fetch_instance_info</a>、<a href="./14-list_instance_by_policy.md">list_instance_by_policy</a>、<a href="./15-search_instance.md">search_instance</a>，具体每个值的协议请往下看</td>
</tr>
<tr>
<td align="left">filter</td>
<td align="left">object</td>
<td align="left">否</td>
<td align="left">根据不同查询方式(method)，传入不同的过滤参数</td>
</tr>
<tr>
<td align="left">page</td>
<td align="left">object</td>
<td align="left">否</td>
<td 0="0" 10_="10," _offset_:="&quot;offset&quot;:" align="left" limit:="limit:">当返回数据需要支持分页时，需要参数，具体包含 limit 和 offset 字段，其值类型为 int，比如 </td>
</tr>
</tbody>
</table>
<ul>
<li>Response.Body: </li>
</ul>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">code</td>
<td align="left">int</td>
<td align="left">是</td>
<td align="left">表示请求是否成功，0 表示成功，<code>code != 0</code> 表示出错</td>
</tr>
<tr>
<td align="left">message</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">code != 0 时，message 表示错误信息，code=0 时 可返回 ok 或空字符串</td>
</tr>
<tr>
<td align="left">data</td>
<td align="left">object/array</td>
<td align="left">是</td>
<td align="left">根据不同查询方式(method)，返回的内容也不一样，类型可为数组或者字典</td>
</tr>
</tbody>
</table>
<ul>
<li>code 字段特别说明：</li>
</ul>
<table>
<thead>
<tr>
<th align="left">值</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>code = 401</code></td>
<td align="left">代表接口认证失败</td>
</tr>
<tr>
<td align="left"><code>code = 404</code></td>
<td align="left">代表查询的 type(资源类型)或 method(查询资源信息的方式) 不存在，或其他不存在的返回，message 为具体错误信息</td>
</tr>
<tr>
<td align="left"><code>code = 500</code></td>
<td align="left">代表查询时出现系统错误或异常，message 为具体错误或异常信息</td>
</tr>
<tr>
<td align="left"><code>code = 422</code></td>
<td align="left">代表查询时，特别是有过滤搜索时，扫描的资源内容过多，拒绝返回数据</td>
</tr>
<tr>
<td align="left"><code>code = 406</code></td>
<td align="left">代表搜索时 keyword 不符合要求</td>
</tr>
<tr>
<td align="left"><code>code = 429</code></td>
<td align="left">代表接口请求超过接入系统的频率控制</td>
</tr>
</tbody>
</table>
<ul>
<li>说明<ul>
<li>接口只提供给 iam 使用, 需要单独 url/鉴权/逻辑等, 避免同现有业务使用 api 重复</li>
<li>上面的 URL 只是一个示例, 可自行定义, 注册到权限中心即可</li>
<li>需要支持版本, url 格式如<code>/api/v1/</code>, 确保后续可以进行 api 升级</li>
<li>性能要求: </li>
</ul>
</li>
</ul>
<pre class="codehilite"><code class="language-bash">[list_attr] 
&lt; 50ms

[list_attr_value]
无keyword搜索和id过滤条件 &lt; 50ms
keyword搜索 &lt; 100ms
批量 id 过滤（id数量小于10个）&lt; 100ms
批量 id 过滤（id数量大于10个）&lt; 200ms

[list_instance]
按照资源的上级过滤查询 &lt; 50ms

[fetch_instance_info] 性能敏感，由于用于鉴权，所以必须严格保证该接口性能
单个资源获取 &lt; 20ms
批量资源获取 &lt; 100ms

[list_instance_by_policy]
&lt; 500ms

[search_instance]
按照资源实例进行keyword搜索查询 &lt; 100ms</code></pre><h1 id="list_attr">list_attr</h1>
<h2 id="list_attr_1">list_attr 查询某个资源类型可用于配置权限的属性列表</h2>
<blockquote>
<p>在权限中心里用于（1）<code>产品</code>上按照属性配置权限（2）<code>产品</code>上回显权限</p>
</blockquote>
<p>比如: 在配置平台中，主机的可用于配置权限的属性列表：os(操作系统)/country(国家)/province(省份)/isp(运营商) 等</p>
<h3 id="requestbody">Request.Body</h3>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">type</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">对应查询的资源类型(ResourceType)</td>
</tr>
<tr>
<td align="left">method</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">值为：list_attr</td>
</tr>
</tbody>
</table>
<pre class="codehilite"><code class="language-json">{
    &quot;type&quot;: &quot;host&quot;,
    &quot;method&quot;: &quot;list_attr&quot;
}</code></pre>


<h3 id="responsebody">Response.Body</h3>
<p>data 字段，类型为 Array</p>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">id</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">资源属性的唯一标识</td>
</tr>
<tr>
<td align="left">display_name</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">资源属性的展示名称</td>
</tr>
</tbody>
</table>
<pre class="codehilite"><code class="language-json">{
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: [
        {&quot;id&quot;: &quot;os&quot;, &quot;display_name&quot;: &quot;操作系统&quot;},
        {&quot;id&quot;: &quot;country&quot;, &quot;display_name&quot;: &quot;国家&quot;},
        {&quot;id&quot;: &quot;province&quot;, &quot;display_name&quot;: &quot;省份&quot;},
        {&quot;id&quot;: &quot;isp&quot;, &quot;display_name&quot;: &quot;运营商&quot;}
    ]
}</code></pre><h1 id="list_attr_value">list_attr_value</h1>
<h2 id="list_attr_value_1">list_attr_value 获取一个资源类型某个属性的值列表</h2>
<blockquote>
<p>可用于配置权限的属性 的值列表</p>
<p>在权限中心产品里用于（1）<code>产品</code>上按照属性配置权限（2）<code>产品</code>上回显权限</p>
</blockquote>
<p>比如: 在配置平台中，主机(host)资源的操作系统属性(os)可用于配置权限，对应的操作系统属性的值列表：linux(Linux)、windows(Windows)、mac(Mac)</p>
<h3 id="_1">需支持的过滤查询</h3>
<ul>
<li>keyword 搜索<ul>
<li>接入系统获取到 keyword 后，可选择 id 或 display_name 进行模糊搜索过滤，模糊搜索规则可以是前缀匹配或包含子串等其他匹配规则</li>
</ul>
</li>
<li>批量 id 过滤</li>
</ul>
<p>简单例子：
【keyword 搜索】</p>
<pre class="codehilite"><code class="language-json">&quot;filter&quot;: {
    &quot;attr&quot;: &quot;os&quot;,
    &quot;keyword&quot;: &quot;Li&quot; 
}</code></pre>


<p>【批量 id 过滤】</p>
<pre class="codehilite"><code class="language-json">&quot;filter&quot;: {
    &quot;attr&quot;: &quot;os&quot;,
    &quot;ids&quot;: [&quot;linux&quot;, &quot;windows&quot;]
}</code></pre>


<h3 id="requestbody">Request.Body</h3>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">type</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">对应查询的资源类型</td>
</tr>
<tr>
<td align="left">method</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">值为：list_attr_value</td>
</tr>
<tr>
<td align="left">filter</td>
<td align="left">object</td>
<td align="left">是</td>
<td align="left">根据 2.1 里需支持的过滤查询，传入不同的参数</td>
</tr>
<tr>
<td align="left">page</td>
<td align="left">object</td>
<td align="left">是</td>
<td align="left">返回数据需要支持分页，该参数必填，具体说明请查看 <a href="./01-API.md">需实现接口的基础协议里的 Request.Body.page 字段</a>, <code>limit 最大为1000</code></td>
</tr>
</tbody>
</table>
<p>filter 字段</p>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">attr</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">需要查询的资源属性 id</td>
</tr>
<tr>
<td align="left">keyword</td>
<td align="left">string</td>
<td align="left">否</td>
<td align="left">资源属性值的搜索关键字</td>
</tr>
<tr>
<td align="left">ids</td>
<td align="left">Array(string/int/bool)</td>
<td align="left">否</td>
<td align="left">资源属性值 ID 列表, <a href="./00-Concepts.md">值的数据类型详细说明</a></td>
</tr>
</tbody>
</table>
<ul>
<li>无过滤条件</li>
</ul>
<pre class="codehilite"><code class="language-json">{
    &quot;type&quot;: &quot;host&quot;,
    &quot;method&quot;: &quot;list_attr_value&quot;,
    &quot;filter&quot;: {
        &quot;attr&quot;: &quot;os&quot;
    },
    &quot;page&quot;: {
        &quot;offset&quot;: 0,
        &quot;limit&quot;: 20
    }
}</code></pre>


<ul>
<li>有过滤条件</li>
</ul>
<pre class="codehilite"><code class="language-json">{
    &quot;type&quot;: &quot;host&quot;,
    &quot;method&quot;: &quot;list_attr_value&quot;,
    &quot;filter&quot;: {
        &quot;attr&quot;: &quot;os&quot;,
        &quot;keyword&quot;: &quot;Li&quot;
    },
    &quot;page&quot;: {
        &quot;offset&quot;: 0,
        &quot;limit&quot;: 20
    }
}</code></pre>


<h3 id="responsebody">Response.Body</h3>
<p>data 字段，类型为 Dict</p>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">count</td>
<td align="left">int</td>
<td align="left">是</td>
<td align="left">查询到的总数量</td>
</tr>
<tr>
<td align="left">results</td>
<td align="left">array(object)</td>
<td align="left">是</td>
<td align="left">对应的属性值列表</td>
</tr>
</tbody>
</table>
<p>results 字段，类型 Array</p>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">id</td>
<td align="left">string/int/bool</td>
<td align="left">是</td>
<td align="left">资源属性值的唯一标识, <a href="./00-Concepts.md">值的数据类型详细说明</a></td>
</tr>
<tr>
<td align="left">display_name</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">资源属性值的展示名称</td>
</tr>
</tbody>
</table>
<pre class="codehilite"><code class="language-json">{
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: {
        &quot;count&quot;: 100,
        &quot;results&quot;: [
            {&quot;id&quot;: &quot;linux&quot;, &quot;display_name&quot;: &quot;Linux&quot;},
            {&quot;id&quot;: &quot;windows&quot;, &quot;display_name&quot;: &quot;Windows&quot;},
            {&quot;id&quot;: &quot;mac&quot;, &quot;display_name&quot;: &quot;Mac&quot;}
        ]
    }
}</code></pre><h1 id="list_instance">list_instance</h1>
<h2 id="list_instance_1">list_instance 根据过滤条件查询实例</h2>
<blockquote>
<p>在权限中心里用于（1）<code>产品</code>上按照资源拓扑树选择资源实例</p>
</blockquote>
<h3 id="_1">需支持的过滤查询</h3>
<ul>
<li>按照资源的上级过滤查询</li>
</ul>
<p>简单例子：</p>
<p>【按照资源的上级过滤查询】</p>
<pre class="codehilite"><code class="language-json">&quot;filter&quot;: {
    &quot;parent&quot;: {
        &quot;type&quot;: &quot;module&quot;,
        &quot;id&quot;: &quot;m1&quot;
    }
}</code></pre>


<h3 id="requestbody">Request.Body</h3>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">type</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">对应查询的资源类型</td>
</tr>
<tr>
<td align="left">method</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">值为：list_instance</td>
</tr>
<tr>
<td align="left">filter</td>
<td align="left">object</td>
<td align="left">否</td>
<td align="left">根据 3.1 里需支持的过滤查询，传入不同的参数</td>
</tr>
<tr>
<td align="left">page</td>
<td align="left">object</td>
<td align="left">是</td>
<td align="left">返回数据需要支持分页，该参数必填，具体说明请查看 <a href="./01-API.md">需实现接口的基础协议里的 Request.Body.page 字段</a>, <code>limit 最大为1000</code></td>
</tr>
</tbody>
</table>
<p>filter 字段</p>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">parent</td>
<td align="left">object</td>
<td align="left">否</td>
<td align="left">资源的直接上级，具体包含 type 和 id，type 为直接上级资源的类型，id 为直接上级资源实例 ID</td>
</tr>
</tbody>
</table>
<ul>
<li>无条件查询</li>
</ul>
<pre class="codehilite"><code class="language-json">{
    &quot;type&quot;: &quot;host&quot;,
    &quot;method&quot;: &quot;list_instance&quot;,
    &quot;page&quot;: {
        &quot;offset&quot;: 0,
        &quot;limit&quot;: 20
    }
}</code></pre>


<ul>
<li>上级过滤查询</li>
</ul>
<pre class="codehilite"><code class="language-json">{
    &quot;type&quot;: &quot;host&quot;,
    &quot;method&quot;: &quot;list_instance&quot;,
    &quot;filter&quot;: {
        &quot;parent&quot;: {
            &quot;type&quot;: &quot;module&quot;,
            &quot;id&quot;: &quot;m1&quot;
        }
    },
    &quot;page&quot;: {
        &quot;offset&quot;: 0,
        &quot;limit&quot;: 20
    }
}</code></pre>


<h3 id="responsebody">Response.Body</h3>
<p>data 字段，类型为 Dict</p>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">count</td>
<td align="left">int</td>
<td align="left">是</td>
<td align="left">查询到的资源实例的总数量</td>
</tr>
<tr>
<td align="left">results</td>
<td align="left">array(object)</td>
<td align="left">是</td>
<td align="left">对应的资源实例列表</td>
</tr>
</tbody>
</table>
<p>results 字段 ，类型 Array</p>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">id</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">资源实例的唯一标识</td>
</tr>
<tr>
<td align="left">display_name</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">资源实例的展示名称</td>
</tr>
<tr>
<td align="left">child_type</td>
<td align="left">string</td>
<td align="left">否</td>
<td align="left">非必填，仅仅"用户管理"系统定制的字段，其他系统不需要返回，表示该资源实例的下一层资源类型，仅仅用于动态资源层级，且其下一层与本层类型一致的情况，空值表示已经无下一层级，该数据将用于在权限中心产品拉取同一资源动态层级拓扑</td>
</tr>
</tbody>
</table>
<pre class="codehilite"><code class="language-json">{
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: {
        &quot;count&quot;: 100,
        &quot;results&quot;: [
            {&quot;id&quot;: &quot;h1&quot;, &quot;display_name&quot;: &quot;192.168.1.1&quot;},
            {&quot;id&quot;: &quot;h2&quot;, &quot;display_name&quot;: &quot;192.168.1.2&quot;},
            {&quot;id&quot;: &quot;h3&quot;, &quot;display_name&quot;: &quot;192.168.1.3&quot;}
        ]
    }
}</code></pre><h1 id="fetch_instance_info">fetch_instance_info</h1>
<h2 id="fetch_instance_info_1">fetch_instance_info 批量获取资源实例详情</h2>
<blockquote>
<p>在权限中心里用于（1）<code>产品</code>上回显权限（2）<code>鉴权</code>上依赖资源的查询</p>
</blockquote>
<h3 id="_1">需支持的查询</h3>
<ul>
<li>批量属性 attr 列表</li>
</ul>
<p>简单例子：</p>
<p>【批量属性 attr 列表】</p>
<p>比如查询主机 h1 和主机 h2 的 路径(path)、名称(name)、操作系统(os)和所属国家(country)</p>
<pre class="codehilite"><code class="language-json">&quot;filter&quot;: {
    &quot;ids&quot;: [&quot;h1&quot;, &quot;h2&quot;],  // 资源实例ID
    &quot;attrs&quot;: [&quot;_bk_iam_path_&quot;, &quot;display_name&quot;, &quot;os&quot;, &quot;country&quot;] // 属性列表
}</code></pre>


<h3 id="requestbody">Request.Body</h3>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">type</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">对应查询的资源类型</td>
</tr>
<tr>
<td align="left">method</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">值为：fetch_instance_info</td>
</tr>
<tr>
<td align="left">filter</td>
<td align="left">object</td>
<td align="left">是</td>
<td align="left">根据需支持的查询，传入不同的参数</td>
</tr>
</tbody>
</table>
<p>filter 字段:</p>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">ids</td>
<td align="left">array(string)</td>
<td align="left">是</td>
<td align="left">需要查询的资源实例的唯一标识列表, <code>最多1000个</code></td>
</tr>
<tr>
<td align="left">attrs</td>
<td align="left">array(string)</td>
<td align="left">否</td>
<td align="left">需要查询的资源属性列表，比如["<em>bk_iam_path</em>", "os"]，空列表或无该参数则表示查询所有属性</td>
</tr>
</tbody>
</table>
<ul>
<li>无查询条件，表示查询资源的所有属性</li>
</ul>
<pre class="codehilite"><code class="language-json">{
    &quot;type&quot;: &quot;host&quot;,
    &quot;method&quot;: &quot;fetch_instance_info&quot;,
    &quot;filter&quot;: {
        &quot;ids&quot;: [&quot;h1&quot;, &quot;h2&quot;]
    }
}</code></pre>


<ul>
<li>有过滤条件</li>
</ul>
<pre class="codehilite"><code class="language-json">{
    &quot;type&quot;: &quot;host&quot;,
    &quot;method&quot;: &quot;fetch_instance_info&quot;,
    &quot;filter&quot;: {
        &quot;ids&quot;: [&quot;h1&quot;, &quot;h2&quot;],
        &quot;attrs&quot;: [&quot;_bk_iam_path_&quot;, &quot;os&quot;, &quot;country&quot;]
    }
}</code></pre>


<h3 id="responsebody">Response.Body</h3>
<p>data 字段，类型为 Array</p>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">id</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">资源实例的唯一标识</td>
</tr>
<tr>
<td align="left"><code>&lt;attr&gt;</code></td>
<td align="left">string/int/bool 或 array(string/int/bool)</td>
<td align="left">是</td>
<td align="left">根据查询条件中的 attrs 返回，无 attrs 参数则返回所有属性</td>
</tr>
</tbody>
</table>
<p><code>特殊属性</code>:  <a href="../../ResourceTopology.md">path 属性说明</a></p>
<pre class="codehilite"><code class="language-json">{
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;ok&quot;,
    &quot;data&quot;: [
        {
            &quot;id&quot;: &quot;h1&quot;,
            &quot;os&quot;: &quot;Linux&quot;,
            &quot;country&quot;: &quot;China&quot;,
            &quot;isp&quot;: 1,
            &quot;is_public&quot;: true,
            &quot;_bk_iam_path_&quot;: [
                &quot;/biz,1/set,1/module,1/&quot;,
                &quot;/biz,1/set,1/module,2/&quot;
            ]
        },
        {
            &quot;id&quot;: &quot;h2&quot;,
            &quot;os&quot;: &quot;Windows&quot;,
            &quot;country&quot;: &quot;China&quot;,
            &quot;isp&quot;: 3,
            &quot;is_public&quot;: false,
            &quot;_bk_iam_path_&quot;: [
                &quot;/biz,1/set,1/module,1/&quot;,
                &quot;/biz_set,1/set,2/module,2/&quot;
            ]
        }
    ]
}</code></pre><h1 id="list_instance_by_policy">list_instance_by_policy</h1>
<h2 id="list_instance_by_policy_1">list_instance_by_policy 根据策略表达式查询资源实例</h2>
<blockquote>
<p>在权限中心里用于（1）<code>产品</code>上动态查询资源实例进行预览</p>
</blockquote>
<h3 id="requestbody">Request.Body</h3>
<p>| 字段 |  类型 |是否必须  | 描述  |
|:---|:---|:---|:---||
| type | string | 是 | 对应查询的资源类型 |
| method |string | 是 | 值为：list_instance_by_policy |
| filter | object | 是 | 查询条件 |
| page | object | 是 | 返回数据需要支持分页，该参数必填，具体说明请查看 <a href="./01-API.md">需实现接口的基础协议里的 Request.Body.page 字段</a>|</p>
<p>filter 字段</p>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">expression</td>
<td align="left">object</td>
<td align="left">是</td>
<td align="left">资源的表达式，<a href="../../Expression/01-Schema.md">协议请查看</a></td>
</tr>
</tbody>
</table>
<pre class="codehilite"><code class="language-json">{
    &quot;type&quot;: &quot;host&quot;,
    &quot;method&quot;: &quot;list_instance_by_policy&quot;,
    &quot;filter&quot;: {
        &quot;expression&quot;: {
            &quot;op&quot;: &quot;OR&quot;,
            &quot;content&quot;: [
            {
                &quot;op&quot;: &quot;in&quot;,
                &quot;field&quot;: &quot;host.id&quot;,
                &quot;value&quot;: [1, 2, 3]
            },
            {
                &quot;op&quot;: &quot;eq&quot;,
                &quot;field&quot;: &quot;host.os&quot;,
                &quot;value&quot;: &quot;linux&quot;
            },
            {
                &quot;op&quot;: &quot;eq&quot;,
                &quot;field&quot;: &quot;host.owner&quot;,
                &quot;value&quot;: &quot;admin&quot;
            },
            {
                &quot;op&quot;: &quot;OR&quot;,
                &quot;content&quot;: [
                {
                    &quot;op&quot;: &quot;starts_with&quot;,
                    &quot;field&quot;: &quot;host._bk_iam_path_&quot;,
                    &quot;value&quot;: &quot;/biz,1/&quot;
                },
                {
                    &quot;op&quot;: &quot;starts_with&quot;,
                    &quot;field&quot;: &quot;host._bk_iam_path_&quot;,
                    &quot;value&quot;: &quot;/biz,2/&quot;
                }]
            },
            {
                &quot;op&quot;: &quot;AND&quot;,
                &quot;content&quot;: [
                {
                    &quot;op&quot;: &quot;eq&quot;,
                    &quot;field&quot;: &quot;host.biz&quot;,
                    &quot;value&quot;: &quot;bk&quot;
                },
                {
                    &quot;op&quot;: &quot;eq&quot;,
                    &quot;field&quot;: &quot;host.status&quot;,
                    &quot;value&quot;: &quot;online&quot;
                }]
            }]
        }
    },
    &quot;page&quot;: {
        &quot;offset&quot;: 0,
        &quot;limit&quot;: 20
    }    
}</code></pre>


<h3 id="responsebody">Response.Body</h3>
<p>data 字段，类型为 Dict</p>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">count</td>
<td align="left">int</td>
<td align="left">是</td>
<td align="left">查询到的资源实例的总数量</td>
</tr>
<tr>
<td align="left">results</td>
<td align="left">array(object)</td>
<td align="left">是</td>
<td align="left">对应到的资源实例列表</td>
</tr>
</tbody>
</table>
<p>results 字段 ，类型 Array</p>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">id</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">资源实例的唯一标识</td>
</tr>
<tr>
<td align="left">display_name</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">资源实例的展示名称</td>
</tr>
</tbody>
</table>
<pre class="codehilite"><code class="language-json">{
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: {
        &quot;count&quot;: 100,
        &quot;results&quot;: [
            {&quot;id&quot;: &quot;h1&quot;, &quot;display_name&quot;: &quot;192.168.1.1&quot;},
            {&quot;id&quot;: &quot;h2&quot;, &quot;display_name&quot;: &quot;192.168.1.2&quot;},
            {&quot;id&quot;: &quot;h3&quot;, &quot;display_name&quot;: &quot;192.168.1.3&quot;}
        ]
    }
}</code></pre><h1 id="search_instance">search_instance</h1>
<h2 id="search_instance_1">search_instance 根据过滤条件和搜索关键字查询实例</h2>
<blockquote>
<p>在权限中心里用于（1）<code>产品</code>上搜索资源实例（1）<code>产品</code>上支持拓扑树的资源搜索</p>
</blockquote>
<h3 id="_1">需支持的过滤查询</h3>
<ul>
<li>按照资源实例进行 Keyword 搜索查询<ul>
<li>接入系统获取到 keyword 后，可支持对应资源实例的唯一标识 id、名称 name、展示名称 display_name 等字段进行模糊搜索过滤，<code>默认必须支持display_name搜索</code>，搜索结果为<code>包含关键词</code>。</li>
</ul>
</li>
<li>按照资源的上级 + 资源实例 Keyword 搜索 查询</li>
</ul>
<p><strong>重要</strong>：
<code>搜索不要区分大小写！！！</code>
<code>搜索不要区分大小写！！！</code>
<code>搜索不要区分大小写！！！</code></p>
<p>简单例子：</p>
<p>【按照资源实例进行 Keyword 搜索查询】</p>
<pre class="codehilite"><code class="language-json">&quot;filter&quot;: {
    &quot;keyword&quot;: &quot;192.168.&quot;
}</code></pre>


<p>【按照资源的上级 + 资源实例 Keyword 搜索 查询】</p>
<pre class="codehilite"><code class="language-json">&quot;filter&quot;: {
    &quot;parent&quot;: {
        &quot;type&quot;: &quot;module&quot;,
        &quot;id&quot;: &quot;m1&quot;
    },
    &quot;keyword&quot;: &quot;192.168.&quot;
}</code></pre>


<p><strong><code>特别注意</code></strong>
由于 keyword 搜索可能性能很低，接入系统需要做<code>频率控制</code>和实现适当的<code>缓存机制</code>，否则可能会引发接入系统负载过高而导致正常业务服务的故障</p>
<h3 id="requestbody">Request.Body</h3>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">type</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">对应查询的资源类型</td>
</tr>
<tr>
<td align="left">method</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">值为：search_instance</td>
</tr>
<tr>
<td align="left">filter</td>
<td align="left">object</td>
<td align="left">否</td>
<td align="left">根据 6.1 里需支持的过滤查询，传入不同的参数</td>
</tr>
<tr>
<td align="left">page</td>
<td align="left">object</td>
<td align="left">是</td>
<td align="left">返回数据需要支持分页，该参数必填，具体说明请查看 <a href="./01-API.md">需实现接口的基础协议里的 Request.Body.page 字段</a>, <code>limit 最大为1000</code></td>
</tr>
</tbody>
</table>
<p>filter 字段</p>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">keyword</td>
<td align="left">object</td>
<td align="left">是</td>
<td align="left">资源实例的搜索关键字</td>
</tr>
<tr>
<td align="left">parent</td>
<td align="left">object</td>
<td align="left">否</td>
<td align="left">资源的直接上级，具体包含 type 和 id，type 为直接上级资源的类型，id 为直接上级资源实例 ID  <code>两种情况下可为空，(1) 本身资源类型无上级 (2) 权限中心产品上只需要根据Keyword全局搜索该资源类型，可能场景如某种资源类型的下拉框过滤选择</code></td>
</tr>
</tbody>
</table>
<ul>
<li>Keyword 搜索查询</li>
</ul>
<pre class="codehilite"><code class="language-json">{
    &quot;type&quot;: &quot;host&quot;,
    &quot;method&quot;: &quot;search_instance&quot;,
    &quot;filter&quot;: {
        &quot;keyword&quot;: &quot;192.168.&quot;
    },
    &quot;page&quot;: {
        &quot;offset&quot;: 0,
        &quot;limit&quot;: 20
    }
}</code></pre>


<ul>
<li>上级+Keyword 搜索查询</li>
</ul>
<pre class="codehilite"><code class="language-bash">{
    &quot;type&quot;: &quot;host&quot;,
    &quot;method&quot;: &quot;search_instance&quot;,
    &quot;filter&quot;: {
       &quot;parent&quot;: {
            &quot;type&quot;: &quot;module&quot;,
            &quot;id&quot;: &quot;m1&quot;
        }
        &quot;keyword&quot;: &quot;192.168.&quot;
    },
    &quot;page&quot;: {
        &quot;offset&quot;: 0,
        &quot;limit&quot;: 20
    }
}</code></pre>


<h3 id="responsebody">Response.Body</h3>
<p>code 字段说明
- <code>code = 422</code> 代表 Keyword 搜索时，扫描的资源内容过多，无法支持，拒绝返回数据，对于 IAM 产品上将提示用户完善搜索条件再搜索
- <code>code = 429</code> 代表接口超过接入系统的频率控制 </p>
<p>data 字段，类型为 Dict</p>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">count</td>
<td align="left">int</td>
<td align="left">是</td>
<td align="left">查询到的资源实例的总数量</td>
</tr>
<tr>
<td align="left">results</td>
<td align="left">array(object)</td>
<td align="left">是</td>
<td align="left">对应的资源实例列表</td>
</tr>
</tbody>
</table>
<p>results 字段 ，类型 Array</p>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">id</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">资源实例的唯一标识</td>
</tr>
<tr>
<td align="left">display_name</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">资源实例的展示名称</td>
</tr>
<tr>
<td align="left">child_type</td>
<td align="left">string</td>
<td align="left">否</td>
<td align="left">非必填，仅仅"用户管理"系统定制的字段，其他系统不需要返回，表示该资源实例的下一层资源类型，仅仅用于动态资源层级，且其下一层与本层类型一致的情况，空值表示已经无下一层级，该数据将用于在权限中心产品拉取同一资源动态层级拓扑</td>
</tr>
</tbody>
</table>
<ul>
<li>正常查询返回</li>
</ul>
<pre class="codehilite"><code class="language-json">{
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: {
        &quot;count&quot;: 100,
        &quot;results&quot;: [
            {&quot;id&quot;: &quot;h1&quot;, &quot;display_name&quot;: &quot;192.168.1.1&quot;},
            {&quot;id&quot;: &quot;h2&quot;, &quot;display_name&quot;: &quot;192.168.1.2&quot;},
            {&quot;id&quot;: &quot;h3&quot;, &quot;display_name&quot;: &quot;192.168.1.3&quot;}
        ]
    }
}</code></pre>


<ul>
<li>搜到的 Keyword 不满足要求，即 keyword 的参数校验规则，比如，可能对于某些资源类型，keyword 至少 2 个字符才进行搜索<ul>
<li><code>对于message字段，必须清楚提示keyword的校验规则</code></li>
</ul>
</li>
</ul>
<pre class="codehilite"><code class="language-json">{
    &quot;code&quot;: 406,
    &quot;message&quot;: &quot;the length of keyword should be greater than or equals to 2&quot;,
    &quot;data&quot;: {}
}</code></pre>


<ul>
<li>搜索结果分页返回，如果个别资源类型因为搜索结果过多而导致性能问题，无法返回时，</li>
<li><code>对于这种情况，权限中心产品上将会提示用户完善Keyword，尽量精确</code></li>
</ul>
<pre class="codehilite"><code class="language-json">{
    &quot;code&quot;: 422,
    &quot;message&quot;: &quot;not support, too much data found&quot;,
    &quot;data&quot;: {}
}</code></pre>


<ul>
<li>接口超过调用频率控制</li>
</ul>
<pre class="codehilite"><code class="language-json">{
    &quot;code&quot;: 429,
    &quot;message&quot;: &quot;exceed api rate limiting&quot;,
    &quot;data&quot;: {}
}</code></pre><h1 id="sdk-api">SDK 鉴权 API</h1>
<h2 id="_1">说明</h2>
<p>重要:</p>
<ol>
<li>不存在跨系统资源依赖
        - 那么请求中可以不带 resources，此时会返回 用户 在 这个系统 的这个操作 的所有策略，然后在本地进行计算;<ul>
<li>所以不存在跨系统资源依赖，可以做批量接口，一次策略查询，然后遍历本地的多个资源，逐一计算结果 (此时少了 N-1 次 IO 查询)</li>
</ul>
</li>
<li>如果存在跨系统资源依赖<ul>
<li>请求策略查询，一定要带上跨系统依赖资源，上面的示例，一定要带上 bk_cmdb; 因为权限中心需要到被依赖系统拉取相关的内容进行计算</li>
<li>所以存在跨系统资源依赖，不能做批量接口; 除非本地的多个资源依赖的是同一个其他系统资源，例如 10 个 job 作业依赖的同一个 cmdb 主机，要鉴权</li>
</ul>
</li>
<li>如果传了 resources<ul>
<li>会走两阶段计算</li>
<li>权限中心会拿 requests 中传递的资源，先行进行计算，得到中间结果(也是策略)，返回给接入系统，接入系统继续计算</li>
</ul>
</li>
</ol>
<h2 id="1-policy-query">1. policy query 拉取权限策略</h2>
<p>sdk 接入, 需要实现</p>
<ol>
<li>鉴权: 拉取权限策略</li>
<li>获取有权限的资源列表</li>
</ol>
<p>两个将使用同一个接口, 从服务端拉取策略列表</p>
<p>返回结果中包含条件表达式. 具体见<a href="../../../Reference/Expression/01-Schema.md">条件表达式协议</a></p>
<h3 id="11-url">1.1 URL</h3>
<blockquote>
<p>POST /api/v1/policy/query</p>
</blockquote>
<h3 id="12-request">1.2 Request</h3>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">system</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">系统唯一标识</td>
</tr>
<tr>
<td align="left">subject</td>
<td align="left">subject</td>
<td align="left">是</td>
<td align="left">鉴权实体</td>
</tr>
<tr>
<td align="left">action</td>
<td align="left">action</td>
<td align="left">是</td>
<td align="left">操作</td>
</tr>
<tr>
<td align="left">resources</td>
<td align="left">Array(resource_node)</td>
<td align="left">是</td>
<td align="left">资源实例, 资源类型的顺序必须操作注册时的顺序一致;可以为空列表</td>
</tr>
</tbody>
</table>
<p>action</p>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">id</td>
<td align="left">字符串</td>
<td align="left">是</td>
<td align="left">操作 ID</td>
</tr>
</tbody>
</table>
<p>subject</p>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">type</td>
<td align="left">字符串</td>
<td align="left">是</td>
<td align="left">授权对象类型, 当前只支持 user</td>
</tr>
<tr>
<td align="left">id</td>
<td align="left">字符串</td>
<td align="left">是</td>
<td align="left">授权对象 ID</td>
</tr>
</tbody>
</table>
<p>resource_node</p>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">system</td>
<td align="left">字符串</td>
<td align="left">是</td>
<td align="left">资源系统 ID</td>
</tr>
<tr>
<td align="left">type</td>
<td align="left">字符串</td>
<td align="left">是</td>
<td align="left">资源类型 ID</td>
</tr>
<tr>
<td align="left">id</td>
<td align="left">字符串</td>
<td align="left">是</td>
<td align="left">资源实例 ID</td>
</tr>
<tr>
<td align="left">attribute</td>
<td align="left">对象</td>
<td align="left">是</td>
<td align="left">资源属性</td>
</tr>
</tbody>
</table>
<h4 id="cmdb">无 cmdb 依赖</h4>
<pre class="codehilite"><code class="language-json"># 1. 
{
    &quot;system&quot;: &quot;bk_job&quot;,
    &quot;subject&quot;:
    {
        &quot;type&quot;: &quot;user&quot;,
        &quot;id&quot;: &quot;admin&quot;
    },
    &quot;action&quot;: {
        &quot;id&quot;: &quot;edit&quot;
    },
    &quot;resources&quot;: []
}</code></pre>


<h4 id="cmdb_1">有 cmdb 依赖</h4>
<pre class="codehilite"><code class="language-json">{
    &quot;system&quot;: &quot;bk_job&quot;,
    &quot;subject&quot;:
    {
        &quot;type&quot;: &quot;user&quot;,
        &quot;id&quot;: &quot;admin&quot;
    },
    &quot;action&quot;: {
        &quot;id&quot;: &quot;execute&quot;
    },
    &quot;resources&quot;: [
    {
        &quot;system&quot;: &quot;bk_cmdb&quot;,
        &quot;type&quot;: &quot;host&quot;,
        &quot;id&quot;: &quot;192.168.1.1&quot;
    }]
}</code></pre>


<h3 id="13-response">1.3 Response</h3>
<blockquote>
<p>Status: 200 OK</p>
</blockquote>
<pre class="codehilite"><code class="language-json">{
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;ok&quot;,
    &quot;data&quot;: {  // 条件表达式
        &quot;field&quot;: &quot;host.id&quot;,
        &quot;op&quot;: &quot;any&quot;,
        &quot;value&quot;: []
    }
}</code></pre>


<h2 id="2-policy-query-by-actions">2. policy query by actions 批量拉取一批操作的权限策略</h2>
<p>场景: 接入系统需要对同一资源类型的一批资源实例的多个操作鉴权, 比如资源实例列表页显示多个操作是否有权限</p>
<p>约束:</p>
<ol>
<li>一批资源的资源类型必须是一样的</li>
<li>action 如果对 cmdb 资源有依赖, 依赖的 cmdb 资源实例必须是同一个</li>
</ol>
<p>SDK 实现:</p>
<ol>
<li>批量拉取一批操作的权限策略</li>
<li>本地遍历计算资源实例是否有权限</li>
</ol>
<h3 id="21-url">2.1 URL</h3>
<blockquote>
<p>POST /api/v1/policy/query_by_actions</p>
</blockquote>
<h3 id="22-request">2.2 Request</h3>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">system</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">系统唯一标识</td>
</tr>
<tr>
<td align="left">subject</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">subject</td>
</tr>
<tr>
<td align="left">actions</td>
<td align="left">Array(action)</td>
<td align="left">是</td>
<td align="left">操作列表</td>
</tr>
<tr>
<td align="left">resources</td>
<td align="left">Array(resource_node)</td>
<td align="left">是</td>
<td align="left">资源实例, 资源类型的顺序必须操作注册时的顺序一致</td>
</tr>
</tbody>
</table>
<p>action</p>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">id</td>
<td align="left">字符串</td>
<td align="left">是</td>
<td align="left">操作 ID</td>
</tr>
</tbody>
</table>
<p>subject</p>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">type</td>
<td align="left">字符串</td>
<td align="left">是</td>
<td align="left">授权对象类型, 当前只支持 user</td>
</tr>
<tr>
<td align="left">id</td>
<td align="left">字符串</td>
<td align="left">是</td>
<td align="left">授权对象 ID</td>
</tr>
</tbody>
</table>
<p>resource_node</p>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">system</td>
<td align="left">字符串</td>
<td align="left">是</td>
<td align="left">资源系统 ID</td>
</tr>
<tr>
<td align="left">type</td>
<td align="left">字符串</td>
<td align="left">是</td>
<td align="left">资源类型 ID</td>
</tr>
<tr>
<td align="left">id</td>
<td align="left">字符串</td>
<td align="left">是</td>
<td align="left">资源实例 ID</td>
</tr>
<tr>
<td align="left">attribute</td>
<td align="left">对象</td>
<td align="left">是</td>
<td align="left">资源属性</td>
</tr>
</tbody>
</table>
<h4 id="cmdb_2">无 cmdb 依赖</h4>
<pre class="codehilite"><code class="language-json">{
    &quot;system&quot;: &quot;bk_job&quot;,
    &quot;subject&quot;:
    {
        &quot;type&quot;: &quot;user&quot;,
        &quot;id&quot;: &quot;admin&quot;
    },
    &quot;actions&quot;: [
        {
            &quot;id&quot;: &quot;edit&quot;
        },
        {
            &quot;id&quot;: &quot;view&quot;
        }
    ],
    &quot;resources&quot;: []
}</code></pre>


<h4 id="cmdb_3">有 cmdb 依赖</h4>
<pre class="codehilite"><code class="language-json">{
    &quot;system&quot;: &quot;bk_job&quot;,
    &quot;subject&quot;:
    {
        &quot;type&quot;: &quot;user&quot;,
        &quot;id&quot;: &quot;admin&quot;
    },
    &quot;actions&quot;: [
        {
            &quot;id&quot;: &quot;execute&quot;
        },
        {
            &quot;id&quot;: &quot;quick_execute&quot;
        }
    ],
    &quot;resources&quot;: [
    {
        &quot;system&quot;: &quot;bk_cmdb&quot;,
        &quot;type&quot;: &quot;host&quot;,
        &quot;id&quot;: &quot;192.168.1.1&quot;
    }]
}</code></pre>


<h3 id="23-response">2.3 Response</h3>
<blockquote>
<p>Status: 200 OK</p>
</blockquote>
<pre class="codehilite"><code class="language-json">{
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;ok&quot;,
    &quot;data&quot;: [ // action的顺序与请求中的acitons顺序一致
        {
            &quot;action&quot;:{
                &quot;id&quot;:&quot;edit&quot;
            },
            &quot;condition&quot;: {  // 条件表达式
                &quot;field&quot;: &quot;host.id&quot;,
                &quot;op&quot;: &quot;any&quot;,
                &quot;value&quot;: []
            }
        },
        {
            &quot;action&quot;:{
                &quot;id&quot;:&quot;view&quot;
            },
            &quot;condition&quot;: {  // 条件表达式
                &quot;field&quot;: &quot;host.id&quot;,
                &quot;op&quot;: &quot;any&quot;,
                &quot;value&quot;: []
            }
        }
    ]
}</code></pre>


<h2 id="3-query_by_ext_resources">3. query_by_ext_resources 批量第三方依赖鉴权策略查询</h2>
<h3 id="31">3.1 背景</h3>
<p>本系统的操作依赖外部系统资源类型, 需要大批量使用外部资源实例鉴权</p>
<p>例如: 用户在作业平台需要触发上千台主机上批量执行某个作业, 比如 需要在 host1, host2 上执行 job1</p>
<p>这个接口, 支持拉取策略的同时, 帮助接入系统到<code>依赖系统</code>拉取策略计算需要的资源信息; </p>
<p>接入系统同时拿到<code>策略</code>和<code>资源信息</code>, 就可以完成计算, 确认是否有权限;</p>
<p>注: 由于大批量遍历计算 expression 属于 cpu 密集计算, 如果计算放在 IAM, 在并发批量计算时, 会导致 IAM 服务 CPU 资源不足, 进而服务不可用, 所以需要把计算分散到接入系统分布计算, 减轻 IAM 服务的压力</p>
<h4 id="1-1000">场景 1: 外部依赖资源实例的数量<strong>不</strong>超过 1000 个</h4>
<p>使用建议:</p>
<p>直接使用<code>query_by_ext_resources</code>接口查询策略表达式与资源实例相关信息到本地后遍历计算是否有权限</p>
<h4 id="2-1000">场景 2: 外部依赖资源实例的数量<strong>超过</strong>了 1000 个</h4>
<hr />
<p>使用建议:</p>
<ol>
<li>使用<code>policy/query</code>接口查询策略表达式</li>
<li>本地计算表达式中是否有<code>any</code>, 是否有实例<code>id in ["id1", "id2"]</code>初步计算部分外部依赖资源实例是否权限</li>
<li>对于在第二步中计算无权限的资源实例, 再分批次(每次不超过 1000 个)调用<code>query_by_ext_resources</code>接口查询策略表达式与资源实例相关信息到本地后遍历计算是否有权限</li>
</ol>
<h3 id="32">3.2 使用方式</h3>
<ol>
<li>在 request body 中 resources 传 job1 相关的资源信息, 在 ext_resources 中传第三方依赖的 host1, host2</li>
<li>返回的结果中 expression 是过滤了 request 中 resource 相关条件后的条件表达式, 结果的 ext_resources 返回填充属性的资源信息</li>
<li><strong>鉴权计算</strong>: 接入系统拿到 ext_resource 后遍历每个 host 实例带入 expression 中计算得到鉴权结果</li>
</ol>
<p>注意:</p>
<ul>
<li>request 中 resources 与 ext_resources 的关系, 当前 ext_resources 只能有一种第三方依赖类型的实例, resource 必须为 action 依赖的其它资源类型的实例</li>
<li>ext_resources 一次查询不能超过 1000 个, 如果超过建议分批次查询</li>
</ul>
<hr />
<h3 id="33">3.3 协议</h3>
<h4 id="331-url">3.3.1 URL</h4>
<blockquote>
<p>POST /api/v1/policy/query_by_ext_resources</p>
</blockquote>
<h4 id="332-request">3.3.2 Request</h4>
<pre class="codehilite"><code class="language-json">{
  &quot;system&quot;: &quot;bk_job&quot;,
  &quot;subject&quot;: {
    &quot;type&quot;: &quot;user&quot;,
    &quot;id&quot;: &quot;admin&quot;
  },
  &quot;action&quot;: {
    &quot;id&quot;: &quot;execute&quot;
  },
  &quot;resources&quot;: [  # 参与过滤策略的资源实例, 每种资源类型只能传1个, 可以不传, 不传时返回的表达式包含操作关联所有的资源类型的条件
    {
      &quot;system&quot;: &quot;bk_job&quot;,
      &quot;type&quot;: &quot;job&quot;,
      &quot;id&quot;: &quot;job1&quot;,
      &quot;attribute&quot;: {}
    }
  ],
  &quot;ext_resources&quot;: [  # 不参与计算的资源类型, 可以批量传入, IAM会向第三方系统查询资源的属性信息, 一次最多1000个
    {
      &quot;system&quot;: &quot;bk_cmdb&quot;,
      &quot;type&quot;: &quot;host&quot;,
      &quot;ids&quot;: [
        &quot;host1&quot;,
        &quot;host2&quot;
      ]
    }
  ]
}</code></pre>


<h4 id="333-response">3.3.3 Response</h4>
<blockquote>
<p>Status: 200 OK</p>
</blockquote>
<pre class="codehilite"><code class="language-json">{
  &quot;code&quot;: 0,
  &quot;message&quot;: &quot;ok&quot;,
  &quot;data&quot;: {
    &quot;expression&quot;: {  # 已经代入request中resources计算过后的表达式
      &quot;op&quot;: &quot;AND&quot;,
      &quot;content&quot;: [
        {
          &quot;op&quot;: &quot;in&quot;,
          &quot;field&quot;: &quot;host.id&quot;,
          &quot;value&quot;: [
            &quot;host1&quot;,
            &quot;host2&quot;
          ]
        },
        {
          &quot;op&quot;: &quot;starts_with&quot;,
          &quot;field&quot;: &quot;host._bk_iam_path_&quot;,
          &quot;value&quot;: [
            &quot;/biz,5/&quot;
          ]
        }
      ]
    },
    &quot;ext_resources&quot;: [  # 查询得到的第三方资源实例, 填充了与表达式相关的属性
      {
        &quot;system&quot;: &quot;bk_cmdb&quot;,
        &quot;type&quot;: &quot;host&quot;,
        &quot;instances&quot;: [
          {
            &quot;id&quot;: &quot;host1&quot;,
            &quot;attribute&quot;: {
              &quot;_bk_iam_path_&quot;: [
                &quot;/biz,5/&quot;
              ]
            }
          },
          {
            &quot;id&quot;: &quot;host2&quot;,
            &quot;attribute&quot;: {
              &quot;_bk_iam_path_&quot;: [
                &quot;/biz,5/&quot;
              ]
            }
          }
        ]
      }
    ]
  }
}</code></pre><h1 id="api">直接鉴权 API</h1>
<blockquote>
<p>中大型系统/平台类系统不要使用这个接口</p>
</blockquote>
<p>注意:</p>
<ul>
<li>这个 API 是给非 SDK 接入/无跨系统资源依赖的小型系统/脚本/后台任务使用的.</li>
<li>如果是普通接入系统(非脚本/定时任务等)，建议使用多语言 SDK 进行处理</li>
<li>使用直接鉴权 API，需要提供完整的信息，所有计算会在服务端完成，此时会同其他所有系统共用计算资源，性能可能不及本地 sdk 计算(本地 sdk 还可以做缓存等行为提升性能)</li>
<li>获取某个用户有某个权限的资源列表无法通过此 API 实现; 需要通过策略查询接口查询得到策略，解析表达式后，转换成自身存储的查询条件</li>
<li>该接口耗费服务端资源较大，后续会进行流控/熔断/服务降级</li>
</ul>
<h2 id="1-policy-auth">1. policy auth</h2>
<h3 id="11-url">1.1 URL</h3>
<blockquote>
<p>POST /api/v1/policy/auth</p>
</blockquote>
<h3 id="12-request">1.2 Request</h3>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">system</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">系统唯一标识</td>
</tr>
<tr>
<td align="left">subject</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">subject</td>
</tr>
<tr>
<td align="left">action</td>
<td align="left">object</td>
<td align="left">是</td>
<td align="left">操作</td>
</tr>
<tr>
<td align="left">resources</td>
<td align="left">Array(resource_node)</td>
<td align="left">是</td>
<td align="left">资源实例, 资源类型的顺序必须操作注册时的顺序一致</td>
</tr>
</tbody>
</table>
<p>action</p>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">id</td>
<td align="left">字符串</td>
<td align="left">是</td>
<td align="left">操作 ID</td>
</tr>
</tbody>
</table>
<p>subject</p>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">type</td>
<td align="left">字符串</td>
<td align="left">是</td>
<td align="left">授权对象类型, 当前只支持 user</td>
</tr>
<tr>
<td align="left">id</td>
<td align="left">字符串</td>
<td align="left">是</td>
<td align="left">授权对象 ID</td>
</tr>
</tbody>
</table>
<p>resource_node</p>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">system</td>
<td align="left">字符串</td>
<td align="left">是</td>
<td align="left">资源系统 ID</td>
</tr>
<tr>
<td align="left">type</td>
<td align="left">字符串</td>
<td align="left">是</td>
<td align="left">资源类型 ID</td>
</tr>
<tr>
<td align="left">id</td>
<td align="left">字符串</td>
<td align="left">是</td>
<td align="left">资源实例 ID</td>
</tr>
<tr>
<td align="left">attribute</td>
<td align="left">对象</td>
<td align="left">是</td>
<td align="left">资源属性</td>
</tr>
</tbody>
</table>
<pre class="codehilite"><code class="language-json">{
    &quot;system&quot;: &quot;bk_job&quot;,
    &quot;subject&quot;: {
        &quot;type&quot;: &quot;user&quot;,
        &quot;id&quot;: &quot;admin&quot;
    },
    &quot;action&quot;: {
        &quot;id&quot;: &quot;execute&quot;
    },
    &quot;resources&quot;: [{   // 资源类型的顺序必须操作注册时的顺序一致, 否则会导致鉴权失败!
        &quot;system&quot;: &quot;bk_job&quot;,
        &quot;type&quot;: &quot;job&quot;,
        &quot;id&quot;: &quot;ping&quot;,
        &quot;attribute&quot;: {  // 资源的属性值可能有多个, 目前支持string/int/boolean, 以及路径stringList
            &quot;os&quot;: &quot;linux&quot;,
            &quot;_bk_iam_path_&quot;: [&quot;/biz,1/set,2/&quot;],
            &quot;is_ready&quot;: true,
            &quot;area_id&quot;: 200
        }
    }, {
        &quot;system&quot;: &quot;bk_cmdb&quot;,
        &quot;type&quot;: &quot;host&quot;,
        &quot;id&quot;: &quot;192.168.1.1&quot;,
        &quot;attribute&quot;: {} // 外部资源的属性由iam负责查询属性, 接入方不需要传入
    }]
}</code></pre>


<h3 id="13-response">1.3 Response</h3>
<p>Response 字段说明, 表格</p>
<blockquote>
<p>Status: 200 OK</p>
</blockquote>
<pre class="codehilite"><code class="language-json">{
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;ok&quot;,
    &quot;data&quot;: {
        &quot;allowed&quot;: true
    }
}</code></pre>


<h2 id="2-policy-auth-by-resources">2. policy auth by resources</h2>
<p>鉴权场景: 查看一个 <code>用户</code> 有没有 100 台 <code>资源A</code> 的 <code>编辑</code>  权限
限制: resources_list 最大能传 100 个资源</p>
<h3 id="21-url">2.1 URL</h3>
<blockquote>
<p>POST /api/v1/policy/auth_by_resources</p>
</blockquote>
<h3 id="22-request">2.2 Request</h3>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">system</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">系统唯一标识</td>
</tr>
<tr>
<td align="left">subject</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">subject</td>
</tr>
<tr>
<td align="left">action</td>
<td align="left">object</td>
<td align="left">是</td>
<td align="left">操作</td>
</tr>
<tr>
<td align="left">resources_list</td>
<td align="left">Array(resources)</td>
<td align="left">是</td>
<td align="left">资源实例列表, 资源类型的顺序必须操作注册时的顺序一致</td>
</tr>
</tbody>
</table>
<p>action</p>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">id</td>
<td align="left">字符串</td>
<td align="left">是</td>
<td align="left">操作 ID</td>
</tr>
</tbody>
</table>
<p>subject</p>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">type</td>
<td align="left">字符串</td>
<td align="left">是</td>
<td align="left">授权对象类型, 当前只支持 user</td>
</tr>
<tr>
<td align="left">id</td>
<td align="left">字符串</td>
<td align="left">是</td>
<td align="left">授权对象 ID</td>
</tr>
</tbody>
</table>
<p>resources</p>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">resources</td>
<td align="left">Array(resource_node)</td>
<td align="left">是</td>
<td align="left">一个资源</td>
</tr>
</tbody>
</table>
<p>resource_node</p>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">system</td>
<td align="left">字符串</td>
<td align="left">是</td>
<td align="left">资源系统 ID</td>
</tr>
<tr>
<td align="left">type</td>
<td align="left">字符串</td>
<td align="left">是</td>
<td align="left">资源类型 ID</td>
</tr>
<tr>
<td align="left">id</td>
<td align="left">字符串</td>
<td align="left">是</td>
<td align="left">资源实例 ID</td>
</tr>
<tr>
<td align="left">attribute</td>
<td align="left">对象</td>
<td align="left">是</td>
<td align="left">资源属性</td>
</tr>
</tbody>
</table>
<pre class="codehilite"><code class="language-json">{
    &quot;system&quot;: &quot;bk_job&quot;,
    &quot;subject&quot;: {
        &quot;type&quot;: &quot;user&quot;,
        &quot;id&quot;: &quot;admin&quot;
    },
    &quot;action&quot;: {
        &quot;id&quot;: &quot;execute&quot;
    },
    &quot;resources_list&quot;: [
        [{   // 第一个资源
            &quot;system&quot;: &quot;bk_job&quot;,
            &quot;type&quot;: &quot;job&quot;,
            &quot;id&quot;: &quot;ping&quot;,
            &quot;attribute&quot;: {
                &quot;os&quot;: &quot;linux&quot;,
                &quot;_bk_iam_path_&quot;: [&quot;/biz,1/set,2/&quot;],
                &quot;is_ready&quot;: true,
                &quot;area_id&quot;: 200
            }
        }, {
            &quot;system&quot;: &quot;bk_cmdb&quot;,
            &quot;type&quot;: &quot;host&quot;,
            &quot;id&quot;: &quot;192.168.1.1&quot;,
            &quot;attribute&quot;: {}
        }],
        [{    // 第二个资源
            &quot;system&quot;: &quot;bk_job&quot;,
            &quot;type&quot;: &quot;job&quot;,
            &quot;id&quot;: &quot;ping2&quot;,
            &quot;attribute&quot;: {
                &quot;os&quot;: &quot;linux&quot;,
                &quot;_bk_iam_path_&quot;: [&quot;/biz,1/set,2/&quot;],
                &quot;is_ready&quot;: true,
                &quot;area_id&quot;: 200
            }
        }, {
            &quot;system&quot;: &quot;bk_cmdb&quot;,
            &quot;type&quot;: &quot;host2&quot;,
            &quot;id&quot;: &quot;192.168.2.2&quot;,
            &quot;attribute&quot;: {}
        }]
    ]
}</code></pre>


<h3 id="23-response">2.3 Response</h3>
<p>Response 字段说明, 表格</p>
<blockquote>
<p>Status: 200 OK</p>
</blockquote>
<pre class="codehilite"><code class="language-json">{
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;ok&quot;,
    &quot;data&quot;: {
        &quot;bk_job,job,ping/bk_cmdb,host,192.168.1.1&quot;: false,
        &quot;bk_job,job,ping2/bk_cmdb,host2,192.168.2.2&quot;: false
    }
}</code></pre>


<h2 id="3-policy-auth-by-actions">3. policy auth by actions</h2>
<p>鉴权场景: 查看一个<code>用户</code>有没有<code>资源A</code>的<code>查看</code>/<code>编辑</code>/<code>删除</code>权限
限制: actions 最大能传 10 个操作</p>
<h3 id="31-url">3.1 URL</h3>
<blockquote>
<p>POST /api/v1/policy/auth_by_actions</p>
</blockquote>
<h3 id="32-request">3.2 Request</h3>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">system</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">系统唯一标识</td>
</tr>
<tr>
<td align="left">subject</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">subject</td>
</tr>
<tr>
<td align="left">actions</td>
<td align="left">Array(action)</td>
<td align="left">是</td>
<td align="left">操作</td>
</tr>
<tr>
<td align="left">resources</td>
<td align="left">Array(resource_node)</td>
<td align="left">是</td>
<td align="left">资源实例, 资源类型的顺序必须操作注册时的顺序一致</td>
</tr>
</tbody>
</table>
<p>action</p>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">id</td>
<td align="left">字符串</td>
<td align="left">是</td>
<td align="left">操作 ID</td>
</tr>
</tbody>
</table>
<p>subject</p>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">type</td>
<td align="left">字符串</td>
<td align="left">是</td>
<td align="left">授权对象类型, 当前只支持 user</td>
</tr>
<tr>
<td align="left">id</td>
<td align="left">字符串</td>
<td align="left">是</td>
<td align="left">授权对象 ID</td>
</tr>
</tbody>
</table>
<p>resource_node</p>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">system</td>
<td align="left">字符串</td>
<td align="left">是</td>
<td align="left">资源系统 ID</td>
</tr>
<tr>
<td align="left">type</td>
<td align="left">字符串</td>
<td align="left">是</td>
<td align="left">资源类型 ID</td>
</tr>
<tr>
<td align="left">id</td>
<td align="left">字符串</td>
<td align="left">是</td>
<td align="left">资源实例 ID</td>
</tr>
<tr>
<td align="left">attribute</td>
<td align="left">对象</td>
<td align="left">是</td>
<td align="left">资源属性</td>
</tr>
</tbody>
</table>
<pre class="codehilite"><code class="language-json">{
    &quot;system&quot;: &quot;bk_job&quot;,
    &quot;subject&quot;: {
        &quot;type&quot;: &quot;user&quot;,
        &quot;id&quot;: &quot;admin&quot;
    },
    &quot;actions&quot;: [{
        &quot;id&quot;: &quot;execute&quot;
    }, {
        &quot;id&quot;: &quot;view&quot;
    }],
    &quot;resources&quot;: [{   // 资源类型的顺序必须操作注册时的顺序一致, 否则会导致鉴权失败!
        &quot;system&quot;: &quot;bk_job&quot;,
        &quot;type&quot;: &quot;job&quot;,
        &quot;id&quot;: &quot;ping&quot;,
        &quot;attribute&quot;: {  // 资源的属性值可能有多个, 目前支持string/int/boolean, 以及路径stringList
            &quot;os&quot;: &quot;linux&quot;,
            &quot;_bk_iam_path_&quot;: [&quot;/biz,1/set,2/&quot;],
            &quot;is_ready&quot;: true,
            &quot;area_id&quot;: 200
        }
    }, {
        &quot;system&quot;: &quot;bk_cmdb&quot;,
        &quot;type&quot;: &quot;host&quot;,
        &quot;id&quot;: &quot;192.168.1.1&quot;,
        &quot;attribute&quot;: {}  // 外部资源的属性由iam负责查询属性, 接入方不需要传入
    }]
}</code></pre>


<h3 id="33-response">3.3 Response</h3>
<blockquote>
<p>Status: 200 OK</p>
</blockquote>
<pre class="codehilite"><code class="language-json">{
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;ok&quot;,
    &quot;data&quot;: {
        &quot;execute&quot;: true,
        &quot;view&quot;: false
    }
}</code></pre><h1 id="url">生成无权限申请 URL</h1>
<blockquote>
<p>此文档向接入系统说明接入系统在用户无权限需要提醒用户申请时使用的 api</p>
</blockquote>
<h3 id="_1">接入系统权限申请</h3>
<p>用户在接入系统进行操作时, 如果没有某些权限, 此时需要跳转到权限中心申请对应权限.
权限中心申请页面, 需要自动填充相关的申请信息.
所以, 需要接入系统, 将相关信息预先提交到权限中心, 权限中心返回<code>权限申请URL</code></p>
<p>流程:
1. 组装权限申请信息
2. 请求 API, 获取权限申请 url
3. url 渲染到前端表单, 用户点击后, 跳转到权限中心的权限申请页面</p>
<p>具体无权限交互可以查看 <a href="../../../HowTo/NoPermissionApply.md">文档</a></p>
<h4 id="url_1">URL</h4>
<blockquote>
<p>POST /api/c/compapi/v2/iam/application/
<code>特别说明:该 API 为ESB API</code> <a href="../01-Overview/01-BackendAPIvsESBAPI.md">ESB API 说明</a></p>
</blockquote>
<h4 id="_2">通用参数</h4>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">bk_app_code</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">应用 ID</td>
</tr>
<tr>
<td align="left">bk_app_secret</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td align="left">bk_token</td>
<td align="left">string</td>
<td align="left">否</td>
<td align="left">当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td align="left">bk_username</td>
<td align="left">string</td>
<td align="left">否</td>
<td align="left">当前用户用户名，仅仅在 ESB 里配置免登录态验证白名单中的应用，才可以用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="request">Request</h4>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">system</td>
<td align="left">字符串</td>
<td align="left">是</td>
<td align="left">系统 id</td>
</tr>
<tr>
<td align="left">actions</td>
<td align="left">数组</td>
<td align="left">是</td>
<td align="left">申请权限的操作</td>
</tr>
</tbody>
</table>
<p>actions</p>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">id</td>
<td align="left">字符串</td>
<td align="left">是</td>
<td align="left">操作 id</td>
</tr>
<tr>
<td align="left">related_resource_types</td>
<td align="left">数组</td>
<td align="left">是</td>
<td align="left">操作关联的资源类型, <code>资源类型的顺序必须操作注册时的顺序一致</code> (<a href="../../../Reference/API/02-Model/13-Action.md">操作注册 API</a>)</td>
</tr>
</tbody>
</table>
<p>related_resource_types</p>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">system</td>
<td align="left">字符串</td>
<td align="left">是</td>
<td align="left">资源类型的系统 id</td>
</tr>
<tr>
<td align="left">type</td>
<td align="left">字符串</td>
<td align="left">是</td>
<td align="left">资源类型</td>
</tr>
<tr>
<td align="left">instances</td>
<td align="left">数组[数组]</td>
<td align="left">否</td>
<td align="left">资源实例,可选</td>
</tr>
<tr>
<td align="left">attributes</td>
<td align="left">数组</td>
<td align="left">否</td>
<td align="left">实例属性,可选</td>
</tr>
</tbody>
</table>
<p>related_resource_types.instances</p>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">type</td>
<td align="left">字符串</td>
<td align="left">是</td>
<td align="left">资源类型</td>
</tr>
<tr>
<td align="left">id</td>
<td align="left">字符串</td>
<td align="left">是</td>
<td align="left">资源实例 id</td>
</tr>
</tbody>
</table>
<p>related_resource_types.attributes</p>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">id</td>
<td align="left">字符串</td>
<td align="left">是</td>
<td align="left">属性 key</td>
</tr>
<tr>
<td align="left">name</td>
<td align="left">字符串</td>
<td align="left">是</td>
<td align="left">属性 key 名称</td>
</tr>
<tr>
<td align="left">values</td>
<td align="left">数组</td>
<td align="left">是</td>
<td align="left">属性的可选值</td>
</tr>
</tbody>
</table>
<p>related_resource_types.attributes.values</p>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">id</td>
<td align="left">字符串</td>
<td align="left">是</td>
<td align="left">属性 value</td>
</tr>
<tr>
<td align="left">name</td>
<td align="left">字符串</td>
<td align="left">是</td>
<td align="left">属性 value 名称</td>
</tr>
</tbody>
</table>
<pre class="codehilite"><code class="language-json">{
  &quot;system&quot;: &quot;bk_job&quot;,  # 权限的系统
  &quot;actions&quot;: [
    {
      &quot;id&quot;: &quot;execute_job&quot;,  # 操作id
      &quot;related_resource_types&quot;: [  # 关联的资源类型, 无关联资源类型的操作, 必须为空, 资源类型的顺序必须操作注册时的顺序一致
        {
          &quot;system&quot;: &quot;bk_job&quot;,  # 资源类型所属的系统id
          &quot;type&quot;: &quot;job&quot;,  # 资源类型
          &quot;instances&quot;: [  # 申请权限的资源实例
            [  # 带层级的实例表示
              {
                &quot;type&quot;: &quot;job&quot;,  # 层级节点的资源类型
                &quot;id&quot;: &quot;job1&quot;,  # 层级节点的资源实例id
              }
            ]
          ]
        },
        {
          &quot;system&quot;: &quot;bk_cmdb&quot;,  # 资源类型所属的系统id
          &quot;type&quot;: &quot;host&quot;,  # 操作依赖的另外一个资源类型
          &quot;instances&quot;: [
            [
              {
                &quot;type&quot;: &quot;biz&quot;,
                &quot;id&quot;: &quot;biz1&quot;,
              }, {
                &quot;type&quot;: &quot;set&quot;,
                &quot;id&quot;: &quot;set1&quot;,
              }, {
                &quot;type&quot;: &quot;module&quot;,
                &quot;id&quot;: &quot;module1&quot;,
              }, {
                &quot;type&quot;: &quot;host&quot;,
                &quot;id&quot;: &quot;host1&quot;,
              }
            ]
          ],
          &quot;attributes&quot;: [  # 支持配置实例的属性值
            {
              &quot;id&quot;: &quot;os&quot;,  # 属性的key
              &quot;name&quot;: &quot;操作系统&quot;,
              &quot;values&quot;: [
                {
                  &quot;id&quot;: &quot;linux&quot;,  # 属性的value, 可以有多个
                  &quot;name&quot;: &quot;linux&quot;
                }
              ]
            }
          ]
        }
      ]
    }
  ]
}</code></pre>


<h4 id="response">Response</h4>
<pre class="codehilite"><code class="language-json">{
  &quot;data&quot;: {
    &quot;url&quot;: &quot;https://{PAAS_DOMAIN}/o/bk_iam_app/perm-apply?system_id=bk_job&amp;amp;tid=09d432dccac74ec4aa17629f5f83715f&quot;  # 链接有效期10分钟
  },
  &quot;result&quot;: true,
  &quot;code&quot;: 0,
  &quot;message&quot;: &quot;OK&quot;
}</code></pre>


<p>data</p>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">url</td>
<td align="left">字符串</td>
<td align="left">权限申请重定向 URL</td>
</tr>
</tbody>
</table>
<h3 id="_3">返回结果错误说明</h3>
<p>由于跳转申请后，产品上需要显示的时资源实例名称，而不是 ID，所以权限中心会回调查询接入系统
1. 如果未提供查询相关接口,则错误码 code=1902204
2. 如果查询不到资源实例的名称或接入系统不存在对应的资源实例，则错误码 code=1902416
3. 会校验 <code>related_resource_types</code>操作关联的资源类型, <code>资源类型的顺序必须操作注册时的顺序一致</code> (<a href="../../../Reference/API/02-Model/13-Action.md">操作注册 API</a>), 如果不一致, 错误码 <code>1902417</code>, 具体见文档 <a href="../../../HowTo/FAQ/ErrorCode.md">错误码</a></p><h2 id="_1">第三方鉴权失败返回权限申请数据协议</h2>
<h4 id="_2">背景</h4>
<p>标准运维调用作业平台执行作业, 如果是因为鉴权失败导致执行失败, 作业平台需要返回以下错误信息到标准运维, 标准运维使用以下数据展示需要申请的权限信息, 然后再调用以上 API 到权限中心申请权限</p>
<h4 id="http">建议：接口 HTTP 状态码</h4>
<p>http status_code = <code>200</code></p>
<h3 id="response-body">返回接口 response body 协议</h3>
<blockquote>
<p><code>字段code = 9900403 , 且需要有 permission字段返回需要对应申请的权限数据</code></p>
</blockquote>
<pre class="codehilite"><code class="language-json">{
  &quot;code&quot;: 9900403,
  &quot;message&quot;: &quot;&quot;,
  &quot;data&quot;: null,
  &quot;permission&quot;: {
    &quot;system_id&quot;: &quot;bk_job&quot;,
    &quot;system_name&quot;: &quot;作业平台&quot;,
    &quot;actions&quot;: [
      {
        &quot;id&quot;: &quot;execute_job&quot;,
        &quot;name&quot;: &quot;执行作业&quot;,
        &quot;related_resource_types&quot;: [
          {
            &quot;system_id&quot;: &quot;bk_job&quot;,
            &quot;system_name&quot;: &quot;作业平台&quot;,
            &quot;type&quot;: &quot;job&quot;,
            &quot;type_name&quot;: &quot;作业&quot;,
            &quot;instances&quot;: [
              [
                {
                  &quot;type&quot;: &quot;job&quot;,
                  &quot;type_name&quot;: &quot;作业&quot;,
                  &quot;id&quot;: &quot;job1&quot;,
                  &quot;name&quot;: &quot;作业1&quot;
                }
              ]
            ]
          },
          {
            &quot;system_id&quot;: &quot;bk_cmdb&quot;,
            &quot;system_name&quot;: &quot;配置平台&quot;,
            &quot;type&quot;: &quot;host&quot;,
            &quot;type_name&quot;: &quot;主机&quot;,
            &quot;instances&quot;: [
              [
                {
                  &quot;type&quot;: &quot;biz&quot;,
                  &quot;type_name&quot;: &quot;业务&quot;,
                  &quot;id&quot;: &quot;biz1&quot;,
                  &quot;name&quot;: &quot;业务1&quot;
                },
                {
                  &quot;type&quot;: &quot;set&quot;,
                  &quot;type_name&quot;: &quot;集群&quot;,
                  &quot;id&quot;: &quot;set1&quot;,
                  &quot;name&quot;: &quot;集群1&quot;
                },
                {
                  &quot;type&quot;: &quot;module&quot;,
                  &quot;type_name&quot;: &quot;模块&quot;,
                  &quot;id&quot;: &quot;module1&quot;,
                  &quot;name&quot;: &quot;模块1&quot;
                },
                {
                  &quot;type&quot;: &quot;host&quot;,
                  &quot;type_name&quot;: &quot;主机&quot;,
                  &quot;id&quot;: &quot;host1&quot;,
                  &quot;name&quot;: &quot;主机1&quot;
                }
              ]
            ]
          }
        ]
      }
    ]
  }
}</code></pre><h1 id="_1">资源拓扑授权/回收</h1>
<h3 id="_2">参数说明</h3>
<p><code>resources.path</code>的说明</p>
<p>示例 1: 拓扑层级授权到资源实例, <em>业务 1-集群 2-主机 1</em></p>
<pre class="codehilite"><code class="language-json">{
  &quot;system&quot;: &quot;bk_cmdb&quot;,
  &quot;type&quot;: &quot;host&quot;,
  &quot;path&quot;: [
    {
      &quot;type&quot;: &quot;biz&quot;,
      &quot;id&quot;: &quot;1&quot;,
      &quot;name&quot;: &quot;biz1&quot;
    },
    {
      &quot;type&quot;: &quot;set&quot;,
      &quot;id&quot;: &quot;2&quot;,
      &quot;name&quot;: &quot;set2&quot;
    },
    {
      &quot;type&quot;: &quot;host&quot;,
      &quot;id&quot;: &quot;1&quot;,
      &quot;name&quot;: &quot;host1&quot;
    }
  ]
}</code></pre>


<p>示例 2: 拓扑层级前缀, <em>业务 1-任意集群</em>, 此时只有业务 1 的集群下的主机会有权限</p>
<p><code>注意</code>: </p>
<ul>
<li>业务 1 下的主机与业务 1 下任意集群的主机的定义是不一样的</li>
<li><code>业务1下的主机</code>包含业务 1 下可能的<code>所有拓扑</code>下的所有主机</li>
<li><code>业务1下集群的所有主机</code>, 只包含特定拓扑 <code>业务-集群</code> 下的所有主机</li>
<li>为避免权限放大, 在拓扑层级授权时需要把选择到的拓扑节点的下一级的任意带上, 比如选择的是 <code>业务1</code>, 授权时传 <code>业务1-任意集群</code></li>
</ul>
<pre class="codehilite"><code class="language-json">{
  &quot;system&quot;: &quot;bk_cmdb&quot;,
  &quot;type&quot;: &quot;host&quot;,
  &quot;path&quot;: [
    {
      &quot;type&quot;: &quot;biz&quot;,
      &quot;id&quot;: &quot;1&quot;,
      &quot;name&quot;: &quot;biz1&quot;
    },
    {
      &quot;type&quot;: &quot;set&quot;,
      &quot;id&quot;: &quot;*&quot;,
      &quot;name&quot;: &quot;&quot;
    }
  ]
}</code></pre>


<h3 id="_3">资源拓扑授权/回收</h3>
<p>对单个资源拓扑, 单个操作的授权与回收接口</p>
<p><code>注意</code>: </p>
<ul>
<li><code>resources.type</code>的是操作关联的资源类型, <code>resources.path</code>是资源类型能选择的拓扑层级</li>
<li><code>resources.path</code>的路径必须与接入系统注册的资源实例选择视图的拓扑层级一致, 否则授权的拓扑层级在权限中心会出现在视图中选择不中(打不上勾)的情况</li>
</ul>
<hr />
<h4 id="url">URL</h4>
<blockquote>
<p>POST /api/c/compapi/v2/iam/authorization/path/
<code>特别说明:该 API 为ESB API</code> <a href="../01-Overview/01-BackendAPIvsESBAPI.md">ESB API 说明</a></p>
</blockquote>
<h4 id="_4">通用参数</h4>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">bk_app_code</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">应用 ID</td>
</tr>
<tr>
<td align="left">bk_app_secret</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td align="left">bk_token</td>
<td align="left">string</td>
<td align="left">否</td>
<td align="left">当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td align="left">bk_username</td>
<td align="left">string</td>
<td align="left">否</td>
<td align="left">当前用户用户名，仅仅在 ESB 里配置免登录态验证白名单中的应用，才可以用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="request">Request</h4>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">asynchronous</td>
<td align="left">布尔</td>
<td align="left">是</td>
<td align="left">是否异步调用, 默认 否, 当前只支持同步</td>
</tr>
<tr>
<td align="left">operate</td>
<td align="left">字符串</td>
<td align="left">是</td>
<td align="left">grant 或 revoke</td>
</tr>
<tr>
<td align="left">system</td>
<td align="left">字符串</td>
<td align="left">是</td>
<td align="left">系统 id</td>
</tr>
<tr>
<td align="left">action</td>
<td align="left">字符串</td>
<td align="left">是</td>
<td align="left">操作</td>
</tr>
<tr>
<td align="left">subject</td>
<td align="left">字符串</td>
<td align="left">是</td>
<td align="left">授权对象</td>
</tr>
<tr>
<td align="left">resources</td>
<td align="left">数组[对象]</td>
<td align="left">是</td>
<td align="left">资源拓扑, 资源类型的顺序必须操作注册时的顺序一致</td>
</tr>
</tbody>
</table>
<p>action</p>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">id</td>
<td align="left">字符串</td>
<td align="left">是</td>
<td align="left">操作 ID</td>
</tr>
</tbody>
</table>
<p>subject</p>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">type</td>
<td align="left">字符串</td>
<td align="left">是</td>
<td align="left">授权对象类型, 当前只支持 user</td>
</tr>
<tr>
<td align="left">id</td>
<td align="left">字符串</td>
<td align="left">是</td>
<td align="left">授权对象 ID</td>
</tr>
</tbody>
</table>
<p>resources</p>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">system</td>
<td align="left">字符串</td>
<td align="left">是</td>
<td align="left">资源系统 ID</td>
</tr>
<tr>
<td align="left">type</td>
<td align="left">字符串</td>
<td align="left">是</td>
<td align="left">资源类型 ID</td>
</tr>
<tr>
<td align="left">path</td>
<td align="left">数组[对象]</td>
<td align="left">是</td>
<td align="left">资源的拓扑</td>
</tr>
</tbody>
</table>
<p>resources.path</p>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">type</td>
<td align="left">字符串</td>
<td align="left">是</td>
<td align="left">拓扑节点类型 ID</td>
</tr>
<tr>
<td align="left">id</td>
<td align="left">字符串</td>
<td align="left">是</td>
<td align="left">拓扑节点实例 ID</td>
</tr>
<tr>
<td align="left">name</td>
<td align="left">字符串</td>
<td align="left">是</td>
<td align="left">拓扑节点实例名称</td>
</tr>
</tbody>
</table>
<pre class="codehilite"><code class="language-json">{
  &quot;asynchronous&quot;: false,  # 默认false, 当前只支持同步
  &quot;operate&quot;: &quot;grant&quot;,   # grant 授权 revoke 回收
  &quot;system&quot;: &quot;bk_cmdb&quot;,
  &quot;action&quot;: {
    &quot;id&quot;: &quot;edit_host&quot;
  },
  &quot;subject&quot;: {  # 当前只能对user授权
    &quot;type&quot;: &quot;user&quot;,
    &quot;id&quot;: &quot;admin&quot;
  },
  &quot;resources&quot;: [  # 操作依赖多个资源类型的情况下, 表示一个组合资源, 资源类型的顺序必须操作注册时的顺序一致
    {
      &quot;system&quot;: &quot;bk_cmdb&quot;,
      &quot;type&quot;: &quot;host&quot;,
      &quot;path&quot;: [
        {
          &quot;type&quot;: &quot;biz&quot;,
          &quot;id&quot;: &quot;1&quot;,
          &quot;name&quot;: &quot;biz1&quot;
        },{
          &quot;type&quot;: &quot;set&quot;,
          &quot;id&quot;: &quot;*&quot;,
          &quot;name&quot;: &quot;&quot;
        }
      ]
    }
  ]
}</code></pre>


<h4 id="response">Response</h4>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">policy_id</td>
<td align="left">数值</td>
<td align="left">权限策略 id</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">expression</td>
<td align="left">对象</td>
<td align="left">权限表达式</td>
<td align="left"></td>
</tr>
</tbody>
</table>
<blockquote>
<p>Status: 200 OK</p>
</blockquote>
<pre class="codehilite"><code class="language-json">{
  &quot;code&quot;: 0,
  &quot;message&quot;: &quot;ok&quot;,
  &quot;data&quot;: {
    &quot;policy_id&quot;: 1,
    &quot;expression&quot;: {  # 表达式是整个action的所有条件的组合, 包括用户已有的权限与新增的path授权的条件
      &quot;op&quot;: &quot;OR&quot;,
      &quot;content&quot;: [
        {  # 表达式中新增的路径授权
          &quot;field&quot;: &quot;host._bk_iam_path_&quot;,
          &quot;op&quot;: &quot;starts_with&quot;,
          &quot;value&quot;: [
            &quot;/biz,1/set,*/&quot;
          ]
        },
        {
          &quot;field&quot;: &quot;host.id&quot;,
          &quot;op&quot;: &quot;in&quot;,
          &quot;value&quot;: [
            &quot;host1&quot;,
            &quot;host2&quot;
          ]
        }
      ]
    }
  }
}</code></pre>


<h4 id="response-when-async">Response when async (未实现)</h4>
<pre class="codehilite"><code class="language-json">{
  &quot;code&quot;: 0,
  &quot;message&quot;: &quot;ok&quot;,
  &quot;data&quot;: {
    &quot;task_id&quot;: 1  // 任务id
  }
}</code></pre><h1 id="_1">批量资源拓扑授权/回收</h1>
<p>对多个资源拓扑, 多个操作的授权与回收接口</p>
<p><code>resources.paths</code>是批量的资源实例拓扑, 具体说明可以参考<a href="../06-GrantRevoke/01-Topology.md">资源拓扑授权/回收</a></p>
<hr />
<h4 id="url">URL</h4>
<blockquote>
<p>POST /api/c/compapi/v2/iam/authorization/batch_path/
<code>特别说明:该 API 为ESB API</code> <a href="../01-Overview/01-BackendAPIvsESBAPI.md">ESB API 说明</a></p>
</blockquote>
<h4 id="_2">通用参数</h4>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">bk_app_code</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">应用 ID</td>
</tr>
<tr>
<td align="left">bk_app_secret</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td align="left">bk_token</td>
<td align="left">string</td>
<td align="left">否</td>
<td align="left">当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td align="left">bk_username</td>
<td align="left">string</td>
<td align="left">否</td>
<td align="left">当前用户用户名，仅仅在 ESB 里配置免登录态验证白名单中的应用，才可以用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="request">Request</h4>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">asynchronous</td>
<td align="left">布尔</td>
<td align="left">是</td>
<td align="left">是否异步调用, 默认 否, 当前只支持同步</td>
</tr>
<tr>
<td align="left">operate</td>
<td align="left">字符串</td>
<td align="left">是</td>
<td align="left">grant 或 revoke</td>
</tr>
<tr>
<td align="left">system</td>
<td align="left">字符串</td>
<td align="left">是</td>
<td align="left">系统 id</td>
</tr>
<tr>
<td align="left">actions</td>
<td align="left">数组[对象]</td>
<td align="left">是</td>
<td align="left">操作</td>
</tr>
<tr>
<td align="left">subject</td>
<td align="left">字符串</td>
<td align="left">是</td>
<td align="left">授权对象</td>
</tr>
<tr>
<td align="left">resources</td>
<td align="left">数组[对象]</td>
<td align="left">是</td>
<td align="left">资源拓扑, 资源类型的顺序必须操作注册时的顺序一致</td>
</tr>
</tbody>
</table>
<p>actions</p>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">id</td>
<td align="left">字符串</td>
<td align="left">是</td>
<td align="left">操作 ID</td>
</tr>
</tbody>
</table>
<p>subject</p>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">type</td>
<td align="left">字符串</td>
<td align="left">是</td>
<td align="left">授权对象类型, 当前只支持 user</td>
</tr>
<tr>
<td align="left">id</td>
<td align="left">字符串</td>
<td align="left">是</td>
<td align="left">授权对象 ID</td>
</tr>
</tbody>
</table>
<p>resources</p>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">system</td>
<td align="left">字符串</td>
<td align="left">是</td>
<td align="left">资源系统 ID</td>
</tr>
<tr>
<td align="left">type</td>
<td align="left">字符串</td>
<td align="left">是</td>
<td align="left">资源类型 ID</td>
</tr>
<tr>
<td align="left">paths</td>
<td align="left">数组[[对象]]</td>
<td align="left">是</td>
<td align="left">批量资源拓扑，<code>最多1000个</code></td>
</tr>
</tbody>
</table>
<p>resources.paths</p>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">type</td>
<td align="left">字符串</td>
<td align="left">是</td>
<td align="left">拓扑节点类型 ID</td>
</tr>
<tr>
<td align="left">id</td>
<td align="left">字符串</td>
<td align="left">是</td>
<td align="left">拓扑节点实例 ID</td>
</tr>
<tr>
<td align="left">name</td>
<td align="left">字符串</td>
<td align="left">是</td>
<td align="left">拓扑节点实例名称</td>
</tr>
</tbody>
</table>
<pre class="codehilite"><code class="language-json">{
  &quot;asynchronous&quot;: false,
  &quot;operate&quot;: &quot;grant&quot;,
  &quot;system&quot;: &quot;bk_cmdb&quot;,
  &quot;actions&quot;: [  # 批量的操作
    {
      &quot;id&quot;: &quot;edit_host&quot;
    }
  ],
  &quot;subject&quot;: {
    &quot;type&quot;: &quot;user&quot;,
    &quot;id&quot;: &quot;admin&quot;
  },
  &quot;resources&quot;: [
    {  # 操作关联的资源类型, 必须与所有的actions都匹配, 资源类型的顺序必须操作注册时的顺序一致
      &quot;system&quot;: &quot;bk_cmdb&quot;,
      &quot;type&quot;: &quot;host&quot;,
      &quot;paths&quot;: [  # 批量资源拓扑
        [
          {
            &quot;type&quot;: &quot;biz&quot;,
            &quot;id&quot;: &quot;1&quot;,
            &quot;name&quot;: &quot;biz1&quot;
          },
          {
            &quot;type&quot;: &quot;set&quot;,
            &quot;id&quot;: &quot;*&quot;,
            &quot;name&quot;: &quot;&quot;
          }
        ]
      ]
    }
  ]
}</code></pre>


<h4 id="response">Response</h4>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">policy_id</td>
<td align="left">数值</td>
<td align="left">权限策略 id</td>
</tr>
<tr>
<td align="left">action</td>
<td align="left">对象</td>
<td align="left">操作</td>
</tr>
</tbody>
</table>
<blockquote>
<p>Status: 200 OK</p>
</blockquote>
<pre class="codehilite"><code class="language-json">{
  &quot;code&quot;: 0,
  &quot;message&quot;: &quot;ok&quot;,
  &quot;data&quot;: [
    {
      &quot;action&quot;: {
        &quot;id&quot;: &quot;edit_host&quot;
      },
      &quot;policy_id&quot;: 1
    }
  ]
}</code></pre>


<h4 id="response-when-async">Response when async (未实现)</h4>
<pre class="codehilite"><code class="language-json">{
  &quot;code&quot;: 0,
  &quot;message&quot;: &quot;ok&quot;,
  &quot;data&quot;: {
    &quot;task_id&quot;: 1  // 任务id
  }
}</code></pre><h1 id="_1">新建关联属性授权接口</h1>
<h3 id="_2">接口基本说明</h3>
<ul>
<li>
<p>背景：</p>
<ul>
<li>接入系统上批量资源实例被创建时，对应的创建者应该需要赋予依赖这批实例的某个属性的相关权限<ul>
<li>比如批量作业创建时，创建者需要有属性为 creator=xxx 的作业的编辑、删除和查看权限</li>
</ul>
</li>
</ul>
</li>
<li>
<p>流程:</p>
<ul>
<li>
<ol>
<li><strong>用户</strong>在<strong>接入系统</strong>上产生资源实例</li>
</ol>
</li>
<li>
<ol>
<li><strong>接入系统</strong>请求 API,  <strong>权限中心</strong>根据 <a href="../02-Model/19-ResourceCreatorAction.md">新建关联</a> 配置对应创建者进行授权</li>
</ol>
</li>
</ul>
</li>
<li>
<p>接口描述： </p>
<ul>
<li>接入系统根据资源实例创建，对创建者进行相关属性授权</li>
</ul>
</li>
<li>
<p><code>接口特别说明</code></p>
<ul>
<li>新建关联的 Actions 对应的依赖资源类型必须 selection_mode 为 all 或 attribute（Action 无关联实例除外）且只能有一种依赖资源，否则新建关联授权时会被<code>自动忽略</code></li>
</ul>
</li>
</ul>
<hr />
<h4 id="url">URL</h4>
<blockquote>
<p>POST /api/c/compapi/v2/iam/authorization/resource_creator_action_attribute/
<code>特别说明:该 API 为ESB API</code> <a href="../01-Overview/01-BackendAPIvsESBAPI.md">ESB API 说明</a></p>
</blockquote>
<h4 id="parameters">Parameters</h4>
<ul>
<li>通用参数</li>
</ul>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">bk_app_code</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">应用 ID</td>
</tr>
<tr>
<td align="left">bk_app_secret</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td align="left">bk_token</td>
<td align="left">string</td>
<td align="left">否</td>
<td align="left">当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td align="left">bk_username</td>
<td align="left">string</td>
<td align="left">否</td>
<td align="left">当前用户用户名，仅仅在 ESB 里配置免登录态验证白名单中的应用，才可以用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<ul>
<li>接口参数</li>
</ul>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">system</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">系统唯一标识</td>
</tr>
<tr>
<td align="left">type</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">资源类型的唯一标识</td>
</tr>
<tr>
<td align="left">creator</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">资源实例的创建者</td>
</tr>
<tr>
<td align="left">attributes</td>
<td align="left">array(object)</td>
<td align="left">是</td>
<td align="left">资源属性列表，<code>多个属性之间的权限逻辑是AND</code></td>
</tr>
</tbody>
</table>
<p>attributes 列表的元素说明</p>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">id</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">资源属性的唯一标识</td>
</tr>
<tr>
<td align="left">name</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">资源属性的名称</td>
</tr>
<tr>
<td align="left">values</td>
<td align="left">array(object)</td>
<td align="left">是</td>
<td align="left">资源属性的值，支持多个值，<code>多个值之间的权限逻辑是OR</code></td>
</tr>
</tbody>
</table>
<p>values 列表的元素说明</p>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">id</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">资源属性值的唯一标识</td>
</tr>
<tr>
<td align="left">name</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">资源属性值的名称</td>
</tr>
</tbody>
</table>
<h4 id="request">Request</h4>
<pre class="codehilite"><code class="language-json">{
    &quot;system&quot;: &quot;bk_sops&quot;,
    &quot;type&quot;:&quot;task&quot;,
    &quot;creator&quot;:&quot;admin&quot;,
    &quot;attributes&quot;: [
        {
            &quot;id&quot;:&quot;owner&quot;,
            &quot;name&quot;:&quot;任务所属者&quot;,
            &quot;values&quot;: [
                {
                    &quot;id&quot;: &quot;admin&quot;,
                    &quot;name&quot;: &quot;admin(管理员)&quot;
                }
            ]
        }
    ]
}</code></pre>


<h4 id="response">Response</h4>
<p>data 数组元素</p>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">action</td>
<td align="left">object</td>
<td align="left">creator 被授权对应的 Action</td>
</tr>
<tr>
<td align="left">policy_id</td>
<td align="left">int</td>
<td align="left">creator 被授权对应的策略 ID</td>
</tr>
</tbody>
</table>
<p>action</p>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">id</td>
<td align="left">string</td>
<td align="left">操作 ID</td>
</tr>
</tbody>
</table>
<blockquote>
<p>Status: 200 OK</p>
</blockquote>
<pre class="codehilite"><code class="language-json">{
  &quot;data&quot;: [  // 表示creator被授权对应的Action和策略ID列表
    {
        &quot;action&quot;: {
            &quot;id&quot;: &quot;edit&quot;
        },
        &quot;policy_id&quot;: 1
    },
    {
        &quot;action&quot;: {
            &quot;id&quot;: &quot;list&quot;
        },
        &quot;policy_id&quot;: 2
    },
    {
        &quot;action&quot;: {
            &quot;id&quot;: &quot;delete&quot;
        },
        &quot;policy_id&quot;: 3
    },
    {
        &quot;action&quot;: {
            &quot;id&quot;: &quot;view&quot;
        },
        &quot;policy_id&quot;: 4
    }
  ],
  &quot;result&quot;: true,
  &quot;code&quot;: 0,
  &quot;message&quot;: &quot;OK&quot;
}</code></pre><h1 id="api">查询类 API</h1>
<h2 id="_1">背景</h2>
<p>接入系统通过 LBAC 方案接入, 可以自由控制资源权限的授权和回收;</p>
<p>此时能感知到对应策略的<code>PolicyID</code>;</p>
<p>权限中心后台提供了以下查询接口, 用于接入系统查询<code>自己系统</code>的<code>权限信息</code></p>
<p>可以配合策略变更的<code>发布-订阅</code>机制, 做定时全量的策略拉取, 用于数据校准;</p>
<p>(类似于 k8s 的 list-watch 机制, list 调用全量查询接口, watch 使用发布订阅机制感知到增量变化)</p>
<h2 id="_2">接口前置说明</h2>
<p>请阅读 <a href="../01-Overview/02-APIBasicInfo.md">接口协议前置说明</a></p><h1 id="policy-get">policy get 获取某条策略详情</h1>
<p>根据策略 ID, 获取策略详情</p>
<p>注意:
- 如果<code>policy_id</code>对应记录不存在(错误的 ID 或者已经被删除), 将会返回<code>code=1901404(NotFoundError)</code> 
- 只能查询自己系统的策略详情, 如果是其他系统的 policy ID, 将会返回<code>code=1901403(ForbiddenError)</code> 
- 返回结果中<code>expired_at</code>为过期时间, 需二次判定是否过期(查回来一刻可能还没过期, 但是传递使用时可能已过期)</p>
<h4 id="url">URL</h4>
<blockquote>
<p>GET /api/v1/systems/{system_id}/policies/{policy_id}</p>
</blockquote>
<h4 id="parameters">Parameters</h4>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">位置</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">system_id</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">path</td>
<td align="left">系统 ID</td>
</tr>
<tr>
<td align="left">policy_id</td>
<td align="left">integer</td>
<td align="left">是</td>
<td align="left">path</td>
<td align="left">策略 ID</td>
</tr>
</tbody>
</table>
<h4 id="response">Response</h4>
<pre class="codehilite"><code class="language-json">{
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;ok&quot;,
    &quot;data&quot;: {
        &quot;version&quot;: &quot;1&quot;,
        &quot;id&quot;: 2,
        &quot;system&quot;: &quot;bk_cmdb&quot;,
        &quot;subject&quot;: {
            &quot;type&quot;: &quot;user&quot;,
            &quot;id&quot;: &quot;admin&quot;,
            &quot;name&quot;: &quot;管理员&quot;
        },
        &quot;action&quot;: {
            &quot;id&quot;: &quot;view_host&quot;
        },
        &quot;expression&quot;: {
            &quot;content&quot;: [
                {
                    &quot;field&quot;: &quot;host.id&quot;,
                    &quot;op&quot;: &quot;any&quot;,
                    &quot;value&quot;: []
                }
            ],
            &quot;op&quot;: &quot;OR&quot;
        },
        &quot;expired_at&quot;: 4102444800
    }
}</code></pre><h1 id="policy-list">policy list 拉取系统下某个操作的策略列表</h1>
<p>用于接入系统批量拉取某个 action 的所有策略; 全量带翻页; 
接入系统可以利用这个接口, 定期拉取策略进行全量校验及<code>补偿</code></p>
<p>关于 timestamp 的说明:
- 由于策略是带过期时间的, 翻页查询的过程是一个时间跨度比较长的操作, 如果每一页实时查询<code>当前未过期</code>的策略列表, 那么整体结果集及固定页码里面的策略内容将会动态变化; 接入系统无法真正拉取某个操作<code>全量</code>策略
- 这个接口拉取第一页, 默认设置<code>timestamp</code>为当天<code>00:00:00</code>的时间戳, 例如<code>1593273600</code>
- 当翻第二页到最后一页的过程中, 接入系统建议将<code>timestamp</code>作为参数传入; 以定位一个<code>锚点</code>; 防止翻页过程中跨天导致的策略列表动态变化; (如果不担心这个, 可以一直不传)
- <code>timestamp</code> 最小为<code>当前时间-24小时</code></p>
<p>注意:
- 查询回去的每条策略中<code>expired_at</code>为过期时间, 接入系统在使用前需要再次判定是否过期
- 只能查询自己系统的<code>action_id</code>, 如果是在本系统找不到这个<code>action_id</code>不存在, 将会返回<code>code=1901404(NotFoundError)</code> </p>
<hr />
<h4 id="url">URL</h4>
<blockquote>
<p>GET  /api/v1/systems/{system_id}/policies</p>
</blockquote>
<h4 id="parameters">Parameters</h4>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">位置</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">system_id</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">path</td>
<td align="left">系统 ID</td>
</tr>
<tr>
<td align="left">action_id</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">query</td>
<td align="left">操作 ID(action id), 必须是这个系统注册到权限中心的合法 Action</td>
</tr>
<tr>
<td align="left">page</td>
<td align="left">integer</td>
<td align="left">否</td>
<td align="left">query</td>
<td align="left">页码, 不传默认为<code>1</code></td>
</tr>
<tr>
<td align="left">page_size</td>
<td align="left">integer</td>
<td align="left">否</td>
<td align="left">query</td>
<td align="left">单页大小,不传默认<code>100</code>, 限制单页最大<code>500</code></td>
</tr>
<tr>
<td align="left">timestamp</td>
<td align="left">integer</td>
<td align="left">否</td>
<td align="left">query</td>
<td align="left">查询时间戳, 锚点</td>
</tr>
</tbody>
</table>
<p>示例: <code>action_id=edit_host&amp;page=1&amp;page_size=100&amp;timestamp=1592899208</code></p>
<h4 id="response">Response</h4>
<pre class="codehilite"><code class="language-json">{
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;ok&quot;,
    &quot;data&quot;: {
        &quot;metadata&quot;: {
            &quot;system&quot;: &quot;bk_cmdb&quot;,
            &quot;action&quot;: {
                &quot;id&quot;: &quot;edit_host&quot;
            },
            &quot;timestamp&quot;: 1593273600
        },
        &quot;count&quot;: 3,
        &quot;results&quot;: [
            {
                &quot;version&quot;: &quot;1&quot;,
                &quot;id&quot;: 3,
                &quot;subject&quot;: {
                    &quot;type&quot;: &quot;user&quot;,
                    &quot;id&quot;: &quot;test2&quot;,
                    &quot;name&quot;: &quot;test2&quot;
                },
                &quot;expression&quot;: {
                    &quot;content&quot;: [
                        {
                            &quot;field&quot;: &quot;host.id&quot;,
                            &quot;op&quot;: &quot;eq&quot;,
                            &quot;value&quot;: &quot;192.168.1.1&quot;
                        }
                    ],
                    &quot;op&quot;: &quot;OR&quot;
                },
                &quot;expired_at&quot;: 4102444800
            },
            {
                &quot;version&quot;: &quot;1&quot;,
                &quot;id&quot;: 4,
                &quot;subject&quot;: {
                    &quot;type&quot;: &quot;user&quot;,
                    &quot;id&quot;: &quot;test1&quot;,
                    &quot;name&quot;: &quot;test1&quot;
                },
                &quot;expression&quot;: {
                    &quot;content&quot;: [
                        {
                            &quot;field&quot;: &quot;host.system&quot;,
                            &quot;op&quot;: &quot;eq&quot;,
                            &quot;value&quot;: &quot;linux&quot;
                        }
                    ],
                    &quot;op&quot;: &quot;OR&quot;
                },
                &quot;expired_at&quot;: 4102444800
            },
            {
                &quot;version&quot;: &quot;1&quot;,
                &quot;id&quot;: 7,
                &quot;subject&quot;: {
                    &quot;type&quot;: &quot;user&quot;,
                    &quot;id&quot;: &quot;admin&quot;,
                    &quot;name&quot;: &quot;管理员&quot;
                },
                &quot;expression&quot;: {
                    &quot;content&quot;: [
                        {
                            &quot;field&quot;: &quot;host.id&quot;,
                            &quot;op&quot;: &quot;any&quot;,
                            &quot;value&quot;: []
                        }
                    ],
                    &quot;op&quot;: &quot;OR&quot;
                },
                &quot;expired_at&quot;: 4102444800
            }
        ]
    }
}</code></pre><h1 id="policy-subjects-id">policy subjects 根据策略 ID 拉群策略对应的用户信息</h1>
<p>基于 LBAC 方案, 最终每个资源会打上一批 label, 这批 label 对应一批 Policy IDs
查询这个资源的有某个权限的用户列表时, 可以将这批 Policy IDs 作为这个接口参数, 查询<code>用户列表</code></p>
<p>注意: 
- 只能查询自己系统的策略列表对应的<code>用户列表</code>
- 如果 policyID 是其他系统的, 将会被<code>过滤掉</code>, 接口正常, 但对应的 policyId 不会出现在结果列表中</p>
<h4 id="url">URL</h4>
<blockquote>
<p>GET /api/v1/systems/{system_id}/policies/-/subjects</p>
</blockquote>
<h4 id="parameters">Parameters</h4>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">是否必须</th>
<th align="left">位置</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">system_id</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">path</td>
<td align="left">系统 ID</td>
</tr>
<tr>
<td align="left">ids</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">query</td>
<td align="left">策略 id, 多个以英文逗号分隔</td>
</tr>
</tbody>
</table>
<p>示例: <code>ids=2,3,4,7,9</code></p>
<h4 id="response">Response</h4>
<pre class="codehilite"><code class="language-json">{
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;ok&quot;,
    &quot;data&quot;: [
        {
            &quot;id&quot;: 2,
            &quot;subject&quot;: {
                &quot;type&quot;: &quot;user&quot;,
                &quot;id&quot;: &quot;admin&quot;,
                &quot;name&quot;: &quot;管理员&quot;
            }
        },
        {
            &quot;id&quot;: 3,
            &quot;subject&quot;: {
                &quot;type&quot;: &quot;user&quot;,
                &quot;id&quot;: &quot;test2&quot;,
                &quot;name&quot;: &quot;test2&quot;
            }
        },
        {
            &quot;id&quot;: 4,
            &quot;subject&quot;: {
                &quot;type&quot;: &quot;user&quot;,
                &quot;id&quot;: &quot;test1&quot;,
                &quot;name&quot;: &quot;test1&quot;
            }
        },
        {
            &quot;id&quot;: 7,
            &quot;subject&quot;: {
                &quot;type&quot;: &quot;user&quot;,
                &quot;id&quot;: &quot;admin&quot;,
                &quot;name&quot;: &quot;管理员&quot;
            }
        }
    ]
}</code></pre><h2 id="api">配置平台 API 简介</h2>
<p><strong>蓝鲸配置平台是一款面向应用的 CMDB，在 ITIL 体系里，CMDB 是构建其它流程的基石，而在蓝鲸智云体系里，配置平台就扮演着基石的角色，为应用提供了各种运维场景的配置数据服务。</strong></p>
<table>
<thead>
<tr>
<th>资源名称</th>
<th>资源描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="./add_host_lock.md">add_host_lock</a></td>
<td>新加主机锁</td>
</tr>
<tr>
<td><a href="./add_host_to_resource.md">add_host_to_resource</a></td>
<td>新增主机到资源池</td>
</tr>
<tr>
<td><a href="./add_instance_association.md">add_instance_association</a></td>
<td>新建模型实例之间的关联关系</td>
</tr>
<tr>
<td><a href="./add_label_for_service_instance.md">add_label_for_service_instance</a></td>
<td>为服务实例添加标签</td>
</tr>
<tr>
<td><a href="./batch_create_proc_template.md">batch_create_proc_template</a></td>
<td>批量创建进程模板</td>
</tr>
<tr>
<td><a href="./batch_delete_inst.md">batch_delete_inst</a></td>
<td>批量删除实例</td>
</tr>
<tr>
<td><a href="./batch_delete_set.md">batch_delete_set</a></td>
<td>批量删除集群</td>
</tr>
<tr>
<td><a href="./batch_update_host.md">batch_update_host</a></td>
<td>批量更新主机属性</td>
</tr>
<tr>
<td><a href="./batch_update_inst.md">batch_update_inst</a></td>
<td>批量更新对象实例</td>
</tr>
<tr>
<td><a href="./bind_role_privilege.md">bind_role_privilege</a></td>
<td>绑定角色权限</td>
</tr>
<tr>
<td><a href="./clone_host_property.md">clone_host_property</a></td>
<td>克隆主机属性</td>
</tr>
<tr>
<td><a href="./create_biz_custom_field.md">create_biz_custom_field</a></td>
<td>创建业务自定义模型属性</td>
</tr>
<tr>
<td><a href="./create_business.md">create_business</a></td>
<td>新建业务</td>
</tr>
<tr>
<td><a href="./create_classification.md">create_classification</a></td>
<td>添加模型分类</td>
</tr>
<tr>
<td><a href="./create_cloud_area.md">create_cloud_area</a></td>
<td>创建云区域</td>
</tr>
<tr>
<td><a href="./create_custom_query.md">create_custom_query</a></td>
<td>添加自定义查询</td>
</tr>
<tr>
<td><a href="./create_dynamic_group.md">create_dynamic_group</a></td>
<td>创建动态分组</td>
</tr>
<tr>
<td><a href="./create_inst.md">create_inst</a></td>
<td>创建实例</td>
</tr>
<tr>
<td><a href="./create_module.md">create_module</a></td>
<td>创建模块</td>
</tr>
<tr>
<td><a href="./create_object.md">create_object</a></td>
<td>创建模型</td>
</tr>
<tr>
<td><a href="./create_object_attribute.md">create_object_attribute</a></td>
<td>创建模型属性</td>
</tr>
<tr>
<td><a href="./create_process_instance.md">create_process_instance</a></td>
<td>创建进程实例</td>
</tr>
<tr>
<td><a href="./create_service_category.md">create_service_category</a></td>
<td>新建服务分类</td>
</tr>
<tr>
<td><a href="./create_service_instance.md">create_service_instance</a></td>
<td>创建服务实例</td>
</tr>
<tr>
<td><a href="./create_service_template.md">create_service_template</a></td>
<td>新建服务模板</td>
</tr>
<tr>
<td><a href="./create_set.md">create_set</a></td>
<td>创建集群</td>
</tr>
<tr>
<td><a href="./create_set_template.md">create_set_template</a></td>
<td>新建集群模板</td>
</tr>
<tr>
<td><a href="./delete_business.md">delete_business</a></td>
<td>删除业务</td>
</tr>
<tr>
<td><a href="./delete_classification.md">delete_classification</a></td>
<td>删除模型分类</td>
</tr>
<tr>
<td><a href="./delete_cloud_area.md">delete_cloud_area</a></td>
<td>删除云区域</td>
</tr>
<tr>
<td><a href="./delete_custom_query.md">delete_custom_query</a></td>
<td>删除自定义查询</td>
</tr>
<tr>
<td><a href="./delete_dynamic_group.md">delete_dynamic_group</a></td>
<td>删除动态分组</td>
</tr>
<tr>
<td><a href="./delete_host.md">delete_host</a></td>
<td>删除主机</td>
</tr>
<tr>
<td><a href="./delete_host_lock.md">delete_host_lock</a></td>
<td>删除主机锁</td>
</tr>
<tr>
<td><a href="./delete_inst.md">delete_inst</a></td>
<td>删除实例</td>
</tr>
<tr>
<td><a href="./delete_instance_association.md">delete_instance_association</a></td>
<td>删除模型实例之间的关联关系</td>
</tr>
<tr>
<td><a href="./delete_module.md">delete_module</a></td>
<td>删除模块</td>
</tr>
<tr>
<td><a href="./delete_object.md">delete_object</a></td>
<td>删除模型</td>
</tr>
<tr>
<td><a href="./delete_object_attribute.md">delete_object_attribute</a></td>
<td>删除对象模型属性</td>
</tr>
<tr>
<td><a href="./delete_process_instance.md">delete_process_instance</a></td>
<td>删除进程实例</td>
</tr>
<tr>
<td><a href="./delete_proc_template.md">delete_proc_template</a></td>
<td>删除进程模板</td>
</tr>
<tr>
<td><a href="./delete_related_inst_asso.md">delete_related_inst_asso</a></td>
<td>删除某实例所有的关联关系（包含其作为关联关系原模型和关联关系目标模型的情况）</td>
</tr>
<tr>
<td><a href="./delete_service_category.md">delete_service_category</a></td>
<td>删除服务分类</td>
</tr>
<tr>
<td><a href="./delete_service_instance.md">delete_service_instance</a></td>
<td>删除服务实例</td>
</tr>
<tr>
<td><a href="./delete_service_template.md">delete_service_template</a></td>
<td>删除服务模板</td>
</tr>
<tr>
<td><a href="./delete_set.md">delete_set</a></td>
<td>删除集群</td>
</tr>
<tr>
<td><a href="./delete_set_template.md">delete_set_template</a></td>
<td>删除集群模板</td>
</tr>
<tr>
<td><a href="./execute_dynamic_group.md">execute_dynamic_group</a></td>
<td>执行动态分组</td>
</tr>
<tr>
<td><a href="./find_host_biz_relations.md">find_host_biz_relations</a></td>
<td>查询主机业务关系信息</td>
</tr>
<tr>
<td><a href="./find_host_by_service_template.md">find_host_by_service_template</a></td>
<td>查询服务模板下的主机</td>
</tr>
<tr>
<td><a href="./find_host_by_set_template.md">find_host_by_set_template</a></td>
<td>查询集群模板下的主机</td>
</tr>
<tr>
<td><a href="./find_host_by_topo.md">find_host_by_topo</a></td>
<td>查询拓扑节点下的主机</td>
</tr>
<tr>
<td><a href="./find_host_snapshot_batch.md">find_host_snapshot_batch</a></td>
<td>批量查询主机快照</td>
</tr>
<tr>
<td><a href="./find_host_topo_relation.md">find_host_topo_relation</a></td>
<td>获取主机与拓扑的关系</td>
</tr>
<tr>
<td><a href="./find_instance_association.md">find_instance_association</a></td>
<td>查询模型实例之间的关联关系</td>
</tr>
<tr>
<td><a href="./find_module_batch.md">find_module_batch</a></td>
<td>批量查询某业务的模块详情</td>
</tr>
<tr>
<td><a href="./find_module_host_relation.md">find_module_host_relation</a></td>
<td>根据模块 ID 查询主机和模块的关系</td>
</tr>
<tr>
<td><a href="./find_module_with_relation.md">find_module_with_relation</a></td>
<td>根据条件查询业务下的模块</td>
</tr>
<tr>
<td><a href="./find_object_association.md">find_object_association</a></td>
<td>查询模型之间的关联关系</td>
</tr>
<tr>
<td><a href="./find_set_batch.md">find_set_batch</a></td>
<td>批量查询某业务的集群详情</td>
</tr>
<tr>
<td><a href="./find_topo_node_paths.md">find_topo_node_paths</a></td>
<td>查询业务拓扑节点的拓扑路径</td>
</tr>
<tr>
<td><a href="./get_biz_internal_module.md">get_biz_internal_module</a></td>
<td>查询业务的空闲机/故障机/待回收模块</td>
</tr>
<tr>
<td><a href="./get_custom_query_data.md">get_custom_query_data</a></td>
<td>根据自定义查询获取数据</td>
</tr>
<tr>
<td><a href="./get_custom_query_detail.md">get_custom_query_detail</a></td>
<td>获取自定义查询详情</td>
</tr>
<tr>
<td><a href="./get_dynamic_group.md">get_dynamic_group</a></td>
<td>查询指定动态分组</td>
</tr>
<tr>
<td><a href="./get_host_base_info.md">get_host_base_info</a></td>
<td>获取主机详情</td>
</tr>
<tr>
<td><a href="./get_mainline_object_topo.md">get_mainline_object_topo</a></td>
<td>查询主线模型的业务拓扑</td>
</tr>
<tr>
<td><a href="./get_operation_log.md">get_operation_log</a></td>
<td>获取操作日志</td>
</tr>
<tr>
<td><a href="./get_proc_template.md">get_proc_template</a></td>
<td>获取进程模板</td>
</tr>
<tr>
<td><a href="./get_service_template.md">get_service_template</a></td>
<td>获取服务模板</td>
</tr>
<tr>
<td><a href="./list_biz_hosts.md">list_biz_hosts</a></td>
<td>查询业务下的主机</td>
</tr>
<tr>
<td><a href="./list_biz_hosts_topo.md">list_biz_hosts_topo</a></td>
<td>查询业务下的主机和拓扑信息</td>
</tr>
<tr>
<td><a href="./list_hosts_without_biz.md">list_hosts_without_biz</a></td>
<td>没有业务 ID 的主机查询</td>
</tr>
<tr>
<td><a href="./list_process_detail_by_ids.md">list_process_detail_by_ids</a></td>
<td>查询某业务下进程 ID 对应的进程详情</td>
</tr>
<tr>
<td><a href="./list_process_instance.md">list_process_instance</a></td>
<td>查询进程实例列表</td>
</tr>
<tr>
<td><a href="./list_proc_template.md">list_proc_template</a></td>
<td>查询进程模板列表</td>
</tr>
<tr>
<td><a href="./list_resource_pool_hosts.md">list_resource_pool_hosts</a></td>
<td>查询资源池中的主机</td>
</tr>
<tr>
<td><a href="./list_service_category.md">list_service_category</a></td>
<td>查询服务分类列表</td>
</tr>
<tr>
<td><a href="./list_service_instance.md">list_service_instance</a></td>
<td>查询服务实例列表</td>
</tr>
<tr>
<td><a href="./list_service_instance_by_host.md">list_service_instance_by_host</a></td>
<td>通过主机查询关联的服务实例列表</td>
</tr>
<tr>
<td><a href="./list_service_instance_detail.md">list_service_instance_detail</a></td>
<td>获取服务实例详细信息</td>
</tr>
<tr>
<td><a href="./list_service_instance_by_set_template.md">list_service_instance_by_set_template</a></td>
<td>通过集群模版查询关联的服务实例列表</td>
</tr>
<tr>
<td><a href="./list_service_template.md">list_service_template</a></td>
<td>服务模板列表查询</td>
</tr>
<tr>
<td><a href="./list_set_template.md">list_set_template</a></td>
<td>查询集群模板</td>
</tr>
<tr>
<td><a href="./list_set_template_related_service_template.md">list_set_template_related_service_template</a></td>
<td>获取某集群模版下的服务模版列表</td>
</tr>
<tr>
<td><a href="./remove_label_from_service_instance.md">remove_label_from_service_instance</a></td>
<td>从服务实例移除标签</td>
</tr>
<tr>
<td><a href="./resource_watch.md">resource_watch</a></td>
<td>监听资源变化事件</td>
</tr>
<tr>
<td><a href="./search_biz_inst_topo.md">search_biz_inst_topo</a></td>
<td>查询业务实例拓扑</td>
</tr>
<tr>
<td><a href="./search_business.md">search_business</a></td>
<td>查询业务</td>
</tr>
<tr>
<td><a href="./search_classifications.md">search_classifications</a></td>
<td>查询模型分类</td>
</tr>
<tr>
<td><a href="./search_cloud_area.md">search_cloud_area</a></td>
<td>查询云区域</td>
</tr>
<tr>
<td><a href="./search_custom_query.md">search_custom_query</a></td>
<td>查询自定义查询</td>
</tr>
<tr>
<td><a href="./search_dynamic_group.md">search_dynamic_group</a></td>
<td>搜索动态分组</td>
</tr>
<tr>
<td><a href="./search_host_lock.md">search_host_lock</a></td>
<td>查询主机锁</td>
</tr>
<tr>
<td><a href="./search_hostidentifier.md">search_hostidentifier</a></td>
<td>根据条件查询主机身份</td>
</tr>
<tr>
<td><a href="./search_inst.md">search_inst</a></td>
<td>查询实例</td>
</tr>
<tr>
<td><a href="./search_inst_association_topo.md">search_inst_association_topo</a></td>
<td>根据关联关系实例查询模型实例</td>
</tr>
<tr>
<td><a href="./search_inst_asst_object_inst_base_info.md">search_inst_asst_object_inst_base_info</a></td>
<td>查询实例关联模型实例基本信息</td>
</tr>
<tr>
<td><a href="./search_inst_by_object.md">search_inst_by_object</a></td>
<td>查询实例详情</td>
</tr>
<tr>
<td><a href="./search_module.md">search_module</a></td>
<td>查询模块</td>
</tr>
<tr>
<td><a href="./search_objects.md">search_objects</a></td>
<td>查询模型</td>
</tr>
<tr>
<td><a href="./search_object_attribute.md">search_object_attribute</a></td>
<td>查询对象模型属性</td>
</tr>
<tr>
<td><a href="./search_object_topo.md">search_object_topo</a></td>
<td>查询普通模型拓扑</td>
</tr>
<tr>
<td><a href="./search_related_inst_asso.md">search_related_inst_asso</a></td>
<td>查询某实例所有的关联关系（包含其作为关联关系原模型和关联关系目标模型的情况）</td>
</tr>
<tr>
<td><a href="./search_set.md">search_set</a></td>
<td>查询集群</td>
</tr>
<tr>
<td><a href="./search_subscription.md">search_subscription</a></td>
<td>查询订阅</td>
</tr>
<tr>
<td><a href="./search_topo_tree.md">search_topo_tree</a></td>
<td>搜索业务拓扑树</td>
</tr>
<tr>
<td><a href="./subscribe_event.md">subscribe_event</a></td>
<td>订阅事件</td>
</tr>
<tr>
<td><a href="./sync_set_template_to_set.md">sync_set_template_to_set</a></td>
<td>集群模板同步</td>
</tr>
<tr>
<td><a href="./transfer_host_module.md">transfer_host_module</a></td>
<td>业务内主机转移模块</td>
</tr>
<tr>
<td><a href="./transfer_host_to_faultmodule.md">transfer_host_to_faultmodule</a></td>
<td>上交主机到业务的故障机模块</td>
</tr>
<tr>
<td><a href="./transfer_host_to_idlemodule.md">transfer_host_to_idlemodule</a></td>
<td>上交主机到业务的空闲机模块</td>
</tr>
<tr>
<td><a href="./transfer_host_to_resourcemodule.md">transfer_host_to_resourcemodule</a></td>
<td>上交主机至资源池</td>
</tr>
<tr>
<td><a href="./transfer_resourcehost_to_idlemodule.md">transfer_resourcehost_to_idlemodule</a></td>
<td>资源池主机分配至业务的空闲机模块</td>
</tr>
<tr>
<td><a href="./transfer_sethost_to_idle_module.md">transfer_sethost_to_idle_module</a></td>
<td>清空业务下集群/模块中主机</td>
</tr>
<tr>
<td><a href="./unsubcribe_event.md">unsubcribe_event</a></td>
<td>退订事件</td>
</tr>
<tr>
<td><a href="./update_biz_custom_field.md">update_biz_custom_field</a></td>
<td>更新业务自定义模型属性</td>
</tr>
<tr>
<td><a href="./update_business.md">update_business</a></td>
<td>修改业务</td>
</tr>
<tr>
<td><a href="./update_business_enable_status.md">update_business_enable_status</a></td>
<td>修改业务启用状态</td>
</tr>
<tr>
<td><a href="./update_classification.md">update_classification</a></td>
<td>更新模型分类</td>
</tr>
<tr>
<td><a href="./update_cloud_area.md">update_cloud_area</a></td>
<td>更新云区域</td>
</tr>
<tr>
<td><a href="./update_custom_query.md">update_custom_query</a></td>
<td>更新自定义查询</td>
</tr>
<tr>
<td><a href="./update_dynamic_group.md">update_dynamic_group</a></td>
<td>更新动态分组</td>
</tr>
<tr>
<td><a href="./update_event_subscribe.md">update_event_subscribe</a></td>
<td>修改订阅</td>
</tr>
<tr>
<td><a href="./update_host.md">update_host</a></td>
<td>更新主机属性</td>
</tr>
<tr>
<td><a href="./update_host_cloud_area_field.md">update_host_cloud_area_field</a></td>
<td>更新主机的云区域字段</td>
</tr>
<tr>
<td><a href="./update_inst.md">update_inst</a></td>
<td>更新对象实例</td>
</tr>
<tr>
<td><a href="./update_module.md">update_module</a></td>
<td>更新模块</td>
</tr>
<tr>
<td><a href="./update_object.md">update_object</a></td>
<td>更新定义</td>
</tr>
<tr>
<td><a href="./update_object_attribute.md">update_object_attribute</a></td>
<td>更新对象模型属性</td>
</tr>
<tr>
<td><a href="./update_object_topo_graphics.md">update_object_topo_graphics</a></td>
<td>更新拓扑图</td>
</tr>
<tr>
<td><a href="./update_process_instance.md">update_process_instance</a></td>
<td>更新进程实例</td>
</tr>
<tr>
<td><a href="./update_proc_template.md">update_proc_template</a></td>
<td>更新进程模板</td>
</tr>
<tr>
<td><a href="./update_service_category.md">update_service_category</a></td>
<td>更新服务分类</td>
</tr>
<tr>
<td><a href="./update_service_template.md">update_service_template</a></td>
<td>更新服务模板</td>
</tr>
<tr>
<td><a href="./update_set.md">update_set</a></td>
<td>更新集群</td>
</tr>
<tr>
<td><a href="./update_set_template.md">update_set_template</a></td>
<td>编辑集群模板</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/add_host_lock/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>根据主机的 id 列表对主机加锁，新加主机锁，如果主机已经加过锁，同样提示加锁成功(v3.8.6)</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id_list</td>
<td>int array</td>
<td>是</td>
<td>主机 ID 列表</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
   &quot;id_list&quot;:[1, 2, 3]
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;success&quot;,
    &quot;data&quot;: null
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/add_host_to_resource/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>新增主机到资源池</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_supplier_account</td>
<td>string</td>
<td>否</td>
<td>开发商账号</td>
</tr>
<tr>
<td>host_info</td>
<td>dict</td>
<td>是</td>
<td>主机信息</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>否</td>
<td>业务 ID</td>
</tr>
</tbody>
</table>
<h4 id="host_info">host_info</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_host_innerip</td>
<td>string</td>
<td>是</td>
<td>主机内网 ip</td>
</tr>
<tr>
<td>import_from</td>
<td>string</td>
<td>是</td>
<td>主机导入来源,以 api 方式导入为 3</td>
</tr>
<tr>
<td>bk_cloud_id</td>
<td>int</td>
<td>是</td>
<td>云区域 ID</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_supplier_account&quot;: &quot;123456789&quot;,
    &quot;host_info&quot;: {
        &quot;0&quot;: {
            &quot;bk_host_innerip&quot;: &quot;10.0.0.1&quot;,
            &quot;bk_cloud_id&quot;: 0,
            &quot;import_from&quot;: &quot;3&quot;
        }
    }
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: {}
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/add_instance_association/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>新增模型实例之间的关联关系.</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>是否必填</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>metadata</td>
<td>object</td>
<td>Yes</td>
<td>meta data</td>
</tr>
<tr>
<td>condition</td>
<td>string map</td>
<td>Yes</td>
<td>查询条件</td>
</tr>
</tbody>
</table>
<p>metadata params</p>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>是否必填</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>label</td>
<td>string map</td>
<td>Yes</td>
<td>标签信息</td>
</tr>
</tbody>
</table>
<p>label params</p>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>是否必填</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>string</td>
<td>Yes</td>
<td>业务 id</td>
</tr>
</tbody>
</table>
<p>condition params</p>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>是否必填</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_obj_asst_id</td>
<td>string</td>
<td>Yes</td>
<td>模型之间关系关系的唯一 id</td>
</tr>
<tr>
<td>bk_inst_id</td>
<td>int64</td>
<td>Yes</td>
<td>源模型实例 id</td>
</tr>
<tr>
<td>bk_asst_inst_id</td>
<td>int64</td>
<td>Yes</td>
<td>目标模型实例 id</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;bk_obj_asst_id&quot;: &quot;bk_switch_belong_bk_host&quot;,
    &quot;bk_inst_id&quot;: 11,
    &quot;bk_asst_inst_id&quot;: 21,
    &quot;metadata&quot;:{
        &quot;label&quot;:{
            &quot;bk_biz_id&quot;:&quot;1&quot;
        }
    }
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: {
        &quot;id&quot;: 1038
    }
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>int64</td>
<td>新增的实例关联关系身份 id</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/add_label_for_service_instance/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>根据服务实例 id 和设置的标签为服务实例添加标签</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>instance_ids</td>
<td>array</td>
<td>是</td>
<td>无</td>
</tr>
<tr>
<td>labels</td>
<td>object</td>
<td>是</td>
<td>无</td>
</tr>
</tbody>
</table>
<h4 id="labels">labels 字段说明</h4>
<ul>
<li>key 校验规则: <code>^[a-zA-Z]([a-z0-9A-Z\-_.]*[a-z0-9A-Z])?$</code></li>
<li>value 校验规则: <code>^[a-z0-9A-Z]([a-z0-9A-Z\-_.]*[a-z0-9A-Z])?$</code></li>
</ul>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
  &quot;bk_biz_id&quot;: 1,
  &quot;instance_ids&quot;: [59, 62],
  &quot;labels&quot;: {
    &quot;key1&quot;: &quot;value1&quot;,
    &quot;key2&quot;: &quot;value2&quot;
  }
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
  &quot;result&quot;: true,
  &quot;code&quot;: 0,
  &quot;message&quot;: &quot;success&quot;,
  &quot;permission&quot;: null,
  &quot;data&quot;: null
}</code></pre>


<h3 id="_9">返回结果说明</h3>
<h4 id="response">response</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>请求成功与否。true:请求成功；false 请求失败</td>
</tr>
<tr>
<td>code</td>
<td>int</td>
<td>错误编码。 0 表示 success，&gt;0 表示失败错误</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>请求失败返回的错误信息</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/batch_create_proc_template/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>批量创建进程模板</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 ID</td>
</tr>
<tr>
<td>service_template_id</td>
<td>int</td>
<td>否</td>
<td>服务模板 ID</td>
</tr>
<tr>
<td>processes</td>
<td>array</td>
<td>是</td>
<td>进程模板信息</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
  &quot;bk_biz_id&quot;: 1,
  &quot;service_template_id&quot;: 1,
  &quot;processes&quot;: [
    {
      &quot;spec&quot;: {
          &quot;auto_start&quot;: {
            &quot;as_default_value&quot;: true,
            &quot;value&quot;: false
          },
          &quot;auto_time_gap&quot;: {
            &quot;as_default_value&quot;: false
          },
          &quot;bind_ip&quot;: {
            &quot;as_default_value&quot;: true,
            &quot;value&quot;: &quot;1&quot;
          },
          &quot;bk_biz_id&quot;: {
            &quot;as_default_value&quot;: true,
            &quot;value&quot;: 2
          },
          &quot;bk_func_id&quot;: {
            &quot;as_default_value&quot;: true,
            &quot;value&quot;: &quot;1&quot;
          },
          &quot;bk_func_name&quot;: {
            &quot;as_default_value&quot;: true,
            &quot;value&quot;: &quot;nginx&quot;
          },
          &quot;bk_process_id&quot;: {
            &quot;as_default_value&quot;: true,
            &quot;value&quot;: 3
          },
          &quot;bk_process_name&quot;: {
            &quot;as_default_value&quot;: true,
            &quot;value&quot;: &quot;&quot;
          },
          &quot;bk_supplier_account&quot;: {
            &quot;as_default_value&quot;: true,
            &quot;value&quot;: &quot;&quot;
          },
          &quot;create_time&quot;: {
            &quot;as_default_value&quot;: true,
            &quot;value&quot;: &quot;2019-05-06T07:12:35.082Z&quot;
          },
          &quot;description&quot;: {
            &quot;as_default_value&quot;: true,
            &quot;value&quot;: &quot;a simple description&quot;
          },
          &quot;face_stop_cmd&quot;: {
            &quot;as_default_value&quot;: true,
            &quot;value&quot;: &quot;./stop.sh&quot;
          },
          &quot;last_time&quot;: {
            &quot;as_default_value&quot;: true,
            &quot;value&quot;: &quot;2019-05-06T07:12:35.082Z&quot;
          },
          &quot;pid_file&quot;: {
            &quot;as_default_value&quot;: true,
            &quot;value&quot;: &quot;&quot;
          },
          &quot;port&quot;: {
            &quot;as_default_value&quot;: true,
            &quot;value&quot;: &quot;8000,8001,8003,8004&quot;
          },
          &quot;priority&quot;: {
            &quot;as_default_value&quot;: true,
            &quot;value&quot;: 1
          },
          &quot;proc_num&quot;: {
            &quot;as_default_value&quot;: true,
            &quot;value&quot;: 1
          },
          &quot;protocol&quot;: {
            &quot;as_default_value&quot;: true,
            &quot;value&quot;: &quot;1&quot;
          },
          &quot;reload_cmd&quot;: {
            &quot;as_default_value&quot;: true,
            &quot;value&quot;: &quot;&quot;
          },
          &quot;restart_cmd&quot;: {
            &quot;as_default_value&quot;: true,
            &quot;value&quot;: &quot;./restart.sh&quot;
          },
          &quot;start_cmd&quot;: {
            &quot;as_default_value&quot;: true,
            &quot;value&quot;: &quot;./start.sh&quot;
          },
          &quot;stop_cmd&quot;: {
            &quot;as_default_value&quot;: true,
            &quot;value&quot;: &quot;./stop.sh&quot;
          },
          &quot;timeout&quot;: {
            &quot;as_default_value&quot;: true,
            &quot;value&quot;: 60
          },
          &quot;user&quot;: {
            &quot;as_default_value&quot;: true,
            &quot;value&quot;: &quot;&quot;
          },
          &quot;work_path&quot;: {
            &quot;as_default_value&quot;: true,
            &quot;value&quot;: &quot;/data/bkce&quot;
          },
          &quot;bk_start_param_regex&quot;: {
            &quot;as_default_value&quot;: true,
            &quot;value&quot;: &quot;&quot;
          }
        }
      }
  ]
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
  &quot;result&quot;: true,
  &quot;code&quot;: 0,
  &quot;message&quot;: &quot;success&quot;,
  &quot;permission&quot;: null,
  &quot;data&quot;: [[52]]
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="response">response</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>请求成功与否。true:请求成功；false 请求失败</td>
</tr>
<tr>
<td>code</td>
<td>int</td>
<td>错误编码。 0 表示 success，&gt;0 表示失败错误</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>请求失败返回的错误信息</td>
</tr>
<tr>
<td>data</td>
<td>array</td>
<td>成功创建的进程模板 ID</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/batch_delete_inst/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>批量删除对象实例</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_obj_id</td>
<td>string</td>
<td>是</td>
<td>模型 ID</td>
</tr>
<tr>
<td>inst_ids</td>
<td>int array</td>
<td>是</td>
<td>实例 ID 集合</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_supplier_account&quot;: &quot;0&quot;,
    &quot;bk_obj_id&quot;: &quot;test&quot;,
    &quot;delete&quot;:{
    &quot;inst_ids&quot;:[123]
    }
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: &quot;success&quot;
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/batch_delete_set/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>对指定业务 id 下通过集群 id 批量删除集群</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 ID</td>
</tr>
<tr>
<td>inst_ids</td>
<td>int array</td>
<td>是</td>
<td>集群 ID 集合</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_biz_id&quot;:0,
    &quot;delete&quot;: {
    &quot;inst_ids&quot;: [123]
    }
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: &quot;success&quot;
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/batch_update_host/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>根据主机 id 和属性批量更新主机属性（不能用于更新主机属性中的云区域字段）</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>update</td>
<td>object array</td>
<td>是</td>
<td>主机被更新的属性和值，最多 500 条</td>
</tr>
</tbody>
</table>
<h4 id="update">update</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>properties</td>
<td>object</td>
<td>是</td>
<td>主机被更新的属性和值，不能用于更新主机属性中的云区域字段</td>
</tr>
<tr>
<td>bk_host_id</td>
<td>int</td>
<td>是</td>
<td>用于更新的主机 ID</td>
</tr>
</tbody>
</table>
<h4 id="properties">properties</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_host_name</td>
<td>string</td>
<td>否</td>
<td>主机名，也可以为其它属性，不能用于更新主机属性中的云区域字段</td>
</tr>
<tr>
<td>operator</td>
<td>string</td>
<td>否</td>
<td>主要维护人，也可以为其它属性，不能用于更新主机属性中的云区域字段</td>
</tr>
<tr>
<td>bk_comment</td>
<td>string</td>
<td>否</td>
<td>备注，也可以为其它属性，不能用于更新主机属性中的云区域字段</td>
</tr>
<tr>
<td>bk_isp_name</td>
<td>string</td>
<td>否</td>
<td>所属运营商，也可以为其它属性，不能用于更新主机属性中的云区域字段</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;bk_supplier_account&quot;:&quot;0&quot;,
    &quot;update&quot;:[
      {
        &quot;properties&quot;:{
          &quot;bk_host_name&quot;:&quot;batch_update&quot;,
          &quot;operator&quot;: &quot;admin&quot;,
          &quot;bk_comment&quot;: &quot;test&quot;,
          &quot;bk_isp_name&quot;: &quot;1&quot;
        },
        &quot;bk_host_id&quot;:46
      }
    ]
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;success&quot;,
    &quot;data&quot;: null
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/batch_update_inst/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>批量更新对象实例</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_obj_id</td>
<td>string</td>
<td>是</td>
<td>模型 ID</td>
</tr>
<tr>
<td>update</td>
<td>object array</td>
<td>是</td>
<td>实例被更新的字段及值</td>
</tr>
</tbody>
</table>
<h4 id="update">update</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_inst_name</td>
<td>string</td>
<td>否</td>
<td>实例名，也可以为其它自定义字段</td>
</tr>
<tr>
<td>datas</td>
<td>object</td>
<td>是</td>
<td>实例被更新的字段取值</td>
</tr>
<tr>
<td>inst_id</td>
<td>int</td>
<td>是</td>
<td>指明 datas 用于更新的具体实例</td>
</tr>
</tbody>
</table>
<h4 id="datas">datas</h4>
<p><strong>datas 是 map 类型的对象，key 是实例对应的模型定义的字段，value 是字段的取值</strong></p>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_supplier_account&quot;:&quot;0&quot;,
    &quot;bk_obj_id&quot;:&quot;test&quot;,
    &quot;update&quot;:[
        {
          &quot;datas&quot;:{
            &quot;bk_inst_name&quot;:&quot;batch_update&quot;
          },
          &quot;inst_id&quot;:46
         }
        ]
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: &quot;success&quot;
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/bind_role_privilege/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/clone_host_property/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>克隆主机属性</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_org_ip</td>
<td>string</td>
<td>是</td>
<td>源主机 ip, 只支持传入单 ip</td>
</tr>
<tr>
<td>bk_dst_ip</td>
<td>string</td>
<td>是</td>
<td>目标主机 ip, 多个 ip 用","分割</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 ID</td>
</tr>
<tr>
<td>bk_cloud_id</td>
<td>int</td>
<td>否</td>
<td>云区域 ID</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_biz_id&quot;:2,
    &quot;bk_org_ip&quot;:&quot;127.0.0.1&quot;,
    &quot;bk_dst_ip&quot;:&quot;127.0.0.2&quot;,
    &quot;bk_cloud_id&quot;:0
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: null
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/create_biz_custom_field/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>创建业务自定义模型属性</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 id</td>
</tr>
<tr>
<td>creator</td>
<td>string</td>
<td>否</td>
<td>数据的创建者</td>
</tr>
<tr>
<td>description</td>
<td>string</td>
<td>否</td>
<td>数据的描述信息</td>
</tr>
<tr>
<td>editable</td>
<td>bool</td>
<td>否</td>
<td>表明数据是否可编辑</td>
</tr>
<tr>
<td>isonly</td>
<td>bool</td>
<td>否</td>
<td>表明唯一性</td>
</tr>
<tr>
<td>ispre</td>
<td>bool</td>
<td>否</td>
<td>true:预置字段,false:非内置字段</td>
</tr>
<tr>
<td>isreadonly</td>
<td>bool</td>
<td>否</td>
<td>true:只读，false:非只读</td>
</tr>
<tr>
<td>isrequired</td>
<td>bool</td>
<td>否</td>
<td>true:必填，false:可选</td>
</tr>
<tr>
<td>option</td>
<td>string</td>
<td>否</td>
<td _min_:_1_max_:_2_="&quot;min&quot;:&quot;1&quot;,&quot;max&quot;:&quot;2&quot;">用户自定义内容，存储的内容及格式由调用方决定，以数字类型为例（</td>
</tr>
<tr>
<td>unit</td>
<td>string</td>
<td>否</td>
<td>单位</td>
</tr>
<tr>
<td>placeholder</td>
<td>string</td>
<td>否</td>
<td>占位符</td>
</tr>
<tr>
<td>bk_property_group</td>
<td>string</td>
<td>否</td>
<td>字段分栏的名字</td>
</tr>
<tr>
<td>bk_obj_id</td>
<td>string</td>
<td>是</td>
<td>模型 ID</td>
</tr>
<tr>
<td>bk_property_id</td>
<td>string</td>
<td>是</td>
<td>模型的属性 ID</td>
</tr>
<tr>
<td>bk_property_name</td>
<td>string</td>
<td>是</td>
<td>模型属性名，用于展示</td>
</tr>
<tr>
<td>bk_property_type</td>
<td>string</td>
<td>是</td>
<td>定义的属性字段用于存储数据的数据类型,可取值范围（singlechar,longchar,int,enum,date,time,objuser,singleasst,multiasst,timezone,bool）</td>
</tr>
<tr>
<td>bk_asst_obj_id</td>
<td>string</td>
<td>否</td>
<td>如果有关联其它的模型，那么就必需设置此字段，否则就不需要设置</td>
</tr>
</tbody>
</table>
<h4 id="bk_property_type">bk_property_type</h4>
<table>
<thead>
<tr>
<th>标识</th>
<th>名字</th>
</tr>
</thead>
<tbody>
<tr>
<td>singlechar</td>
<td>短字符</td>
</tr>
<tr>
<td>longchar</td>
<td>长字符</td>
</tr>
<tr>
<td>int</td>
<td>整形</td>
</tr>
<tr>
<td>enum</td>
<td>枚举类型</td>
</tr>
<tr>
<td>date</td>
<td>日期</td>
</tr>
<tr>
<td>time</td>
<td>时间</td>
</tr>
<tr>
<td>objuser</td>
<td>用户</td>
</tr>
<tr>
<td>singleasst</td>
<td>单关联</td>
</tr>
<tr>
<td>multiasst</td>
<td>多关联</td>
</tr>
<tr>
<td>timezone</td>
<td>时区</td>
</tr>
<tr>
<td>bool</td>
<td>布尔</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;bk_biz_id&quot;: 2,
    &quot;creator&quot;: &quot;user&quot;,
    &quot;description&quot;: &quot;test&quot;,
    &quot;editable&quot;: true,
    &quot;isonly&quot;: false,
    &quot;ispre&quot;: false,
    &quot;isreadonly&quot;: false,
    &quot;isrequired&quot;: false,
    &quot;option&quot;: {&quot;min&quot;:1,&quot;max&quot;:2},
    &quot;unit&quot;: &quot;1&quot;,
    &quot;placeholder&quot;: &quot;test&quot;,
    &quot;bk_property_group&quot;: &quot;default&quot;,
    &quot;bk_obj_id&quot;: &quot;cc_test_inst&quot;,
    &quot;bk_supplier_account&quot;: &quot;0&quot;,
    &quot;bk_property_id&quot;: &quot;cc_test&quot;,
    &quot;bk_property_name&quot;: &quot;cc_test&quot;,
    &quot;bk_property_type&quot;: &quot;singlechar&quot;,
    &quot;bk_asst_obj_id&quot;: &quot;test&quot;
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: {
        &quot;bk_biz_id&quot;: 2,
        &quot;id&quot;: 7,
        &quot;bk_supplier_account&quot;: &quot;0&quot;,
        &quot;bk_obj_id&quot;: &quot;cc_test_inst&quot;,
        &quot;bk_property_id&quot;: &quot;cc_test&quot;,
        &quot;bk_property_name&quot;: &quot;cc_test&quot;,
        &quot;bk_property_group&quot;: &quot;default&quot;,
        &quot;bk_property_index&quot;: 4,
        &quot;unit&quot;: &quot;1&quot;,
        &quot;placeholder&quot;: &quot;test&quot;,
        &quot;editable&quot;: true,
        &quot;ispre&quot;: false,
        &quot;isrequired&quot;: false,
        &quot;isreadonly&quot;: false,
        &quot;isonly&quot;: false,
        &quot;bk_issystem&quot;: false,
        &quot;bk_isapi&quot;: false,
        &quot;bk_property_type&quot;: &quot;singlechar&quot;,
        &quot;option&quot;: {&quot;min&quot;:1,&quot;max&quot;:2},
        &quot;description&quot;: &quot;test&quot;,
        &quot;creator&quot;: &quot;user&quot;,
        &quot;create_time&quot;: &quot;2020-03-25 17:12:08&quot;,
        &quot;last_time&quot;: &quot;2020-03-25 17:12:08&quot;,
        &quot;bk_property_group_name&quot;: &quot;default&quot;
    }
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>业务自定义字段的业务 id</td>
</tr>
<tr>
<td>creator</td>
<td>string</td>
<td>数据的创建者</td>
</tr>
<tr>
<td>description</td>
<td>string</td>
<td>数据的描述信息</td>
</tr>
<tr>
<td>editable</td>
<td>bool</td>
<td>表明数据是否可编辑</td>
</tr>
<tr>
<td>isonly</td>
<td>bool</td>
<td>表明唯一性</td>
</tr>
<tr>
<td>ispre</td>
<td>bool</td>
<td>true:预置字段,false:非内置字段</td>
</tr>
<tr>
<td>isreadonly</td>
<td>bool</td>
<td>true:只读，false:非只读</td>
</tr>
<tr>
<td>isrequired</td>
<td>bool</td>
<td>true:必填，false:可选</td>
</tr>
<tr>
<td>option</td>
<td>string</td>
<td>用户自定义内容，存储的内容及格式由调用方决定</td>
</tr>
<tr>
<td>unit</td>
<td>string</td>
<td>单位</td>
</tr>
<tr>
<td>placeholder</td>
<td>string</td>
<td>占位符</td>
</tr>
<tr>
<td>bk_property_group</td>
<td>string</td>
<td>字段分栏的名字</td>
</tr>
<tr>
<td>bk_obj_id</td>
<td>string</td>
<td>模型 ID</td>
</tr>
<tr>
<td>bk_supplier_account</td>
<td>string</td>
<td>开发商账号</td>
</tr>
<tr>
<td>bk_property_id</td>
<td>string</td>
<td>模型的属性 ID</td>
</tr>
<tr>
<td>bk_property_name</td>
<td>string</td>
<td>模型属性名，用于展示</td>
</tr>
<tr>
<td>bk_property_type</td>
<td>string</td>
<td>定义的属性字段用于存储数据的数据类型 （singlechar,longchar,int,enum,date,time,objuser,singleasst,multiasst,timezone,bool)</td>
</tr>
<tr>
<td>bk_asst_obj_id</td>
<td>string</td>
<td>如果有关联其它的模型，那么就必需设置此字段，否则就不需要设置</td>
</tr>
</tbody>
</table>
<h4 id="bk_property_type_1">bk_property_type</h4>
<table>
<thead>
<tr>
<th>标识</th>
<th>名字</th>
</tr>
</thead>
<tbody>
<tr>
<td>singlechar</td>
<td>短字符</td>
</tr>
<tr>
<td>longchar</td>
<td>长字符</td>
</tr>
<tr>
<td>int</td>
<td>整形</td>
</tr>
<tr>
<td>enum</td>
<td>枚举类型</td>
</tr>
<tr>
<td>date</td>
<td>日期</td>
</tr>
<tr>
<td>time</td>
<td>时间</td>
</tr>
<tr>
<td>objuser</td>
<td>用户</td>
</tr>
<tr>
<td>singleasst</td>
<td>单关联</td>
</tr>
<tr>
<td>multiasst</td>
<td>多关联</td>
</tr>
<tr>
<td>timezone</td>
<td>时区</td>
</tr>
<tr>
<td>bool</td>
<td>布尔</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/create_business/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>新建业务</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_supplier_account</td>
<td>string</td>
<td>否</td>
<td>开发商账号</td>
</tr>
<tr>
<td>data</td>
<td>dict</td>
<td>是</td>
<td>业务数据</td>
</tr>
</tbody>
</table>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_name</td>
<td>string</td>
<td>是</td>
<td>业务名</td>
</tr>
<tr>
<td>bk_biz_maintainer</td>
<td>string</td>
<td>是</td>
<td>运维人员</td>
</tr>
<tr>
<td>bk_biz_productor</td>
<td>string</td>
<td>是</td>
<td>产品人员</td>
</tr>
<tr>
<td>bk_biz_developer</td>
<td>string</td>
<td>是</td>
<td>开发人员</td>
</tr>
<tr>
<td>bk_biz_tester</td>
<td>string</td>
<td>是</td>
<td>测试人员</td>
</tr>
<tr>
<td>time_zone</td>
<td>string</td>
<td>是</td>
<td>时区</td>
</tr>
<tr>
<td>language</td>
<td>string</td>
<td>是</td>
<td>语言, "1"代表中文, "2"代表英文</td>
</tr>
<tr>
<td><strong>注意：此处的输入参数仅对必填以及系统内置的参数做了说明，其余需要填写的参数取决于用户自己定义的属性字段</strong></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_supplier_account&quot;: &quot;123456789&quot;,
    &quot;data&quot;: {
        &quot;bk_biz_name&quot;: &quot;cc_app_test&quot;,
        &quot;bk_biz_maintainer&quot;: &quot;admin&quot;,
        &quot;bk_biz_productor&quot;: &quot;admin&quot;,
        &quot;bk_biz_developer&quot;: &quot;admin&quot;,
        &quot;bk_biz_tester&quot;: &quot;admin&quot;,
        &quot;time_zone&quot;: &quot;Asia/Shanghai&quot;,
        &quot;language&quot;: &quot;1&quot;
    }
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: {
        &quot;bk_biz_id&quot;: 2
    }
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/create_classification/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>添加模型分类</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_classification_id</td>
<td>string</td>
<td>是</td>
<td>分类 ID，英文描述用于系统内部使用</td>
</tr>
<tr>
<td>bk_classification_name</td>
<td>string</td>
<td>是</td>
<td>分类名</td>
</tr>
<tr>
<td>bk_classification_icon</td>
<td>string</td>
<td>否</td>
<td>模型分类的图标,取值可参考，取值可参考<a href="resource_define/classIcon.json">(classIcon.json)</a></td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_classification_id&quot;: &quot;cs_test&quot;,
    &quot;bk_classification_name&quot;: &quot;test_name&quot;,
    &quot;bk_classification_icon&quot;: &quot;icon-cc-business&quot;
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: {
        &quot;id&quot;: 18
    }
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>int</td>
<td>新增数据记录的 ID</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/create_cloud_area/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>根据云区域名字创建云区域</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_cloud_name</td>
<td>string</td>
<td>是</td>
<td>云区域名字</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_cloud_name&quot;: &quot;test1&quot;
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;success&quot;,
    &quot;permission&quot;: null,
    &quot;data&quot;: {
        &quot;created&quot;: {
            &quot;id&quot;: 2
        }
    }
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>created</td>
<td>object</td>
<td>创建成功，返回信息</td>
</tr>
</tbody>
</table>
<h4 id="datacreated">data.created</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>int</td>
<td>云区域 id, bk_cloud_id</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/create_custom_query/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>添加自定义查询</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_supplier_account</td>
<td>string</td>
<td>否</td>
<td>开发商账号</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 ID</td>
</tr>
<tr>
<td>info</td>
<td>string</td>
<td>是</td>
<td>通用查询条件</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>是</td>
<td>收藏的名称</td>
</tr>
</tbody>
</table>
<h4 id="info">info</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_obj_id</td>
<td>string</td>
<td>否</td>
<td>对象名,可以为 biz,set,module,host,object</td>
</tr>
<tr>
<td>fields</td>
<td>array</td>
<td>否</td>
<td>查询输出字段</td>
</tr>
<tr>
<td>condition</td>
<td>array</td>
<td>否</td>
<td>查询条件</td>
</tr>
</tbody>
</table>
<h4 id="infoconditioncondition">info.condition.condition</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>field</td>
<td>string</td>
<td>否</td>
<td>对象的字段</td>
</tr>
<tr>
<td>operator</td>
<td>string</td>
<td>否</td>
<td>操作符, $eq 为相等，$ne 为不等，$in 为属于，$nin 为不属于</td>
</tr>
<tr>
<td>value</td>
<td>string</td>
<td>否</td>
<td>字段对应的值</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_supplier_account&quot;: &quot;123456789&quot;,
    &quot;bk_biz_id&quot;: 1,
    &quot;info&quot;: &quot;{\&quot;condition\&quot;:[{\&quot;bk_obj_id\&quot;:\&quot;biz\&quot;,\&quot;condition\&quot;:[{\&quot;field\&quot;:\&quot;default\&quot;,\&quot;operator\&quot;:\&quot;$ne\&quot;,\&quot;value\&quot;:1}],\&quot;fields\&quot;:[]},{\&quot;bk_obj_id\&quot;:\&quot;set\&quot;,\&quot;condition\&quot;:[],\&quot;fields\&quot;:[]},{\&quot;bk_obj_id\&quot;:\&quot;module\&quot;,\&quot;condition\&quot;:[],\&quot;fields\&quot;:[]},{\&quot;bk_obj_id\&quot;:\&quot;host\&quot;,\&quot;condition\&quot;:[{\&quot;field\&quot;:\&quot;bk_host_innerip\&quot;,\&quot;operator\&quot;:\&quot;$eq\&quot;,\&quot;value\&quot;:\&quot;127.0.0.1\&quot;}],\&quot;fields\&quot;:[\&quot;bk_host_innerip\&quot;,\&quot;bk_host_outerip\&quot;,\&quot;bk_agent_status\&quot;]}]}&quot;,
    &quot;name&quot;: &quot;api1&quot;
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: {
        &quot;id&quot;: &quot;b80nu3dmjrccd9i5r1eg&quot;
    }
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>string</td>
<td>自定义查询主键 ID</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/create_dynamic_group/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>创建动态分组 (V3.9.6)</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 ID</td>
</tr>
<tr>
<td>bk_obj_id</td>
<td>string</td>
<td>是</td>
<td>动态分组的目标资源对象类型,目前可以为 host,set</td>
</tr>
<tr>
<td>info</td>
<td>object</td>
<td>是</td>
<td>通用查询条件</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>是</td>
<td>动态分组名称</td>
</tr>
</tbody>
</table>
<h4 id="infocondition">info.condition</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_obj_id</td>
<td>string</td>
<td>是</td>
<td>条件对象资源类型, host 类型的动态分组支持的 info.conditon:set,module,host；set 类型的动态分组支持的 info.condition:set</td>
</tr>
<tr>
<td>condition</td>
<td>array</td>
<td>是</td>
<td>查询条件</td>
</tr>
</tbody>
</table>
<h4 id="infoconditioncondition">info.condition.condition</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>field</td>
<td>string</td>
<td>是</td>
<td>对象的字段</td>
</tr>
<tr>
<td>operator</td>
<td>string</td>
<td>是</td>
<td>操作符, op 值为 eq(相等)/ne(不等)/in(属于)/nin(不属于)</td>
</tr>
<tr>
<td>value</td>
<td>object</td>
<td>是</td>
<td>字段对应的值</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_biz_id&quot;: 1,
    &quot;bk_obj_id&quot;: &quot;host&quot;,
    &quot;name&quot;: &quot;my-dynamic-group&quot;,
    &quot;info&quot;: {
        &quot;condition&quot;:[
            {
                &quot;bk_obj_id&quot;:&quot;set&quot;,
                &quot;condition&quot;:[
                    {
                        &quot;field&quot;:&quot;default&quot;,
                        &quot;operator&quot;:&quot;$ne&quot;,
                        &quot;value&quot;:1
                    }
                ]
            },
            {
                &quot;bk_obj_id&quot;:&quot;module&quot;,
                &quot;condition&quot;:[
                    {
                        &quot;field&quot;:&quot;default&quot;,
                        &quot;operator&quot;:&quot;$ne&quot;,
                        &quot;value&quot;:1
                    }
                ]
            },
            {
                &quot;bk_obj_id&quot;:&quot;host&quot;,
                &quot;condition&quot;:[
                    {
                        &quot;field&quot;:&quot;bk_host_innerip&quot;,
                        &quot;operator&quot;:&quot;$eq&quot;,
                        &quot;value&quot;:&quot;127.0.0.1&quot;
                    }
                ]
            }
        ]
    }
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: {
        &quot;id&quot;: &quot;XXXXXXXX&quot;
    }
}</code></pre>


<h3 id="_9">返回结果参数</h3>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>string</td>
<td>创建成功后返回新的动态分组主键 ID</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/create_inst/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>创建实例</p>
<ul>
<li>该接口只适用于自定义层级模型和通用模型实例上，不适用于业务、集群、模块、主机等模型实例</li>
</ul>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_obj_id</td>
<td>string</td>
<td>是</td>
<td>模型 ID</td>
</tr>
<tr>
<td>bk_inst_name</td>
<td>string</td>
<td>是</td>
<td>实例名</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>否</td>
<td>业务 ID， 当创建的是自定义主线层级模型实例时则必传</td>
</tr>
<tr>
<td>bk_parent_id</td>
<td>int</td>
<td>否</td>
<td>当创建的是自定义主线层级模型实例时则必传，代表父层级实例 ID</td>
</tr>
</tbody>
</table>
<p>注意：当操作的是自定义主线层级模型实例时，而又有使用权限中心的，对于 cmdb 小于 3.9 的版本，还需要传包含实例所在业务 id 的 metadata 参数，否则会导致权限中心鉴权失败，格式为
"metadata": {
    "label": {
        "bk_biz_id": "64"
    }
}</p>
<p>其它属于实例属性的字段均也可为入参。</p>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;bk_obj_id: &quot;switch&quot;,
    &quot;bk_inst_name&quot;: &quot;example18&quot;,
    &quot;bk_supplier_account&quot;: &quot;0&quot;,
    &quot;bk_biz_id&quot;: 0
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: {
        &quot;bk_inst_id&quot;: 67
    }
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_inst_id</td>
<td>int</td>
<td>实例 id</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/create_module/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>创建模块</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_supplier_account</td>
<td>string</td>
<td>否</td>
<td>开发商账号</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 ID</td>
</tr>
<tr>
<td>bk_set_id</td>
<td>int</td>
<td>是</td>
<td>集群 id</td>
</tr>
<tr>
<td>data</td>
<td>dict</td>
<td>是</td>
<td>业务数据</td>
</tr>
</tbody>
</table>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_parent_id</td>
<td>int</td>
<td>是</td>
<td>父实例节点的 ID，当前实例节点的上一级实例节点，在拓扑结构中对于 module 一般指的是 set 的 bk_set_id</td>
</tr>
<tr>
<td>bk_module_name</td>
<td>string</td>
<td>是</td>
<td>模块名</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_supplier_account&quot;: &quot;123456789&quot;,
    &quot;bk_biz_id&quot;: 1,
    &quot;bk_set_id&quot;: 10,
    &quot;data&quot;: {
        &quot;bk_parent_id&quot;: 10,
        &quot;bk_module_name&quot;: &quot;test&quot;
    }
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: {
        &quot;bk_module_id&quot;: 10
    }
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/create_object/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>创建模型</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>creator</td>
<td>string</td>
<td>否</td>
<td>本条数据创建者</td>
</tr>
<tr>
<td>bk_classification_id</td>
<td>string</td>
<td>是</td>
<td>对象模型的分类 ID，只能用英文字母序列命名</td>
</tr>
<tr>
<td>bk_obj_id</td>
<td>string</td>
<td>是</td>
<td>对象模型的 ID，只能用英文字母序列命名</td>
</tr>
<tr>
<td>bk_obj_name</td>
<td>string</td>
<td>是</td>
<td>对象模型的名字，用于展示，可以使用人类可以阅读的任何语言</td>
</tr>
<tr>
<td>bk_obj_icon</td>
<td>string</td>
<td>否</td>
<td>对象模型的 ICON 信息，用于前端显示，取值可参考<a href="/static/esb/api_docs/res/cc/modleIcon.json">(modleIcon.json)</a></td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;creator&quot;: &quot;admin&quot;,
    &quot;bk_classification_id&quot;: &quot;test&quot;,
    &quot;bk_obj_name&quot;: &quot;test&quot;,
    &quot;bk_supplier_account&quot;: &quot;0&quot;,
    &quot;bk_obj_icon&quot;: &quot;icon-cc-business&quot;,
    &quot;bk_obj_id&quot;: &quot;test&quot;
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: {
        &quot;id&quot;: 1038
    }
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>int</td>
<td>新增的数据记录的 ID</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/create_object_attribute/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>创建模型属性</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>creator</td>
<td>string</td>
<td>否</td>
<td>数据的创建者</td>
</tr>
<tr>
<td>description</td>
<td>string</td>
<td>否</td>
<td>数据的描述信息</td>
</tr>
<tr>
<td>editable</td>
<td>bool</td>
<td>否</td>
<td>表明数据是否可编辑</td>
</tr>
<tr>
<td>isonly</td>
<td>bool</td>
<td>否</td>
<td>表明唯一性</td>
</tr>
<tr>
<td>ispre</td>
<td>bool</td>
<td>否</td>
<td>true:预置字段,false:非内置字段</td>
</tr>
<tr>
<td>isreadonly</td>
<td>bool</td>
<td>否</td>
<td>true:只读，false:非只读</td>
</tr>
<tr>
<td>isrequired</td>
<td>bool</td>
<td>否</td>
<td>true:必填，false:可选</td>
</tr>
<tr>
<td>option</td>
<td>string</td>
<td>否</td>
<td _min_:_1_max_:_2_="&quot;min&quot;:&quot;1&quot;,&quot;max&quot;:&quot;2&quot;">用户自定义内容，存储的内容及格式由调用方决定，以数字类型为例（</td>
</tr>
<tr>
<td>unit</td>
<td>string</td>
<td>否</td>
<td>单位</td>
</tr>
<tr>
<td>placeholder</td>
<td>string</td>
<td>否</td>
<td>占位符</td>
</tr>
<tr>
<td>bk_property_group</td>
<td>string</td>
<td>否</td>
<td>字段分栏的名字</td>
</tr>
<tr>
<td>bk_obj_id</td>
<td>string</td>
<td>是</td>
<td>模型 ID</td>
</tr>
<tr>
<td>bk_property_id</td>
<td>string</td>
<td>是</td>
<td>模型的属性 ID</td>
</tr>
<tr>
<td>bk_property_name</td>
<td>string</td>
<td>是</td>
<td>模型属性名，用于展示</td>
</tr>
<tr>
<td>bk_property_type</td>
<td>string</td>
<td>是</td>
<td>定义的属性字段用于存储数据的数据类型,可取值范围（singlechar,longchar,int,enum,date,time,objuser,singleasst,multiasst,timezone,bool）</td>
</tr>
<tr>
<td>bk_asst_obj_id</td>
<td>string</td>
<td>否</td>
<td>如果有关联其它的模型，那么就必需设置此字段，否则就不需要设置</td>
</tr>
</tbody>
</table>
<h4 id="bk_property_type">bk_property_type</h4>
<table>
<thead>
<tr>
<th>标识</th>
<th>名字</th>
</tr>
</thead>
<tbody>
<tr>
<td>singlechar</td>
<td>短字符</td>
</tr>
<tr>
<td>longchar</td>
<td>长字符</td>
</tr>
<tr>
<td>int</td>
<td>整形</td>
</tr>
<tr>
<td>enum</td>
<td>枚举类型</td>
</tr>
<tr>
<td>date</td>
<td>日期</td>
</tr>
<tr>
<td>time</td>
<td>时间</td>
</tr>
<tr>
<td>objuser</td>
<td>用户</td>
</tr>
<tr>
<td>singleasst</td>
<td>单关联</td>
</tr>
<tr>
<td>multiasst</td>
<td>多关联</td>
</tr>
<tr>
<td>timezone</td>
<td>时区</td>
</tr>
<tr>
<td>bool</td>
<td>布尔</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;creator&quot;: &quot;user&quot;,
    &quot;description&quot;: &quot;test&quot;,
    &quot;editable&quot;: true,
    &quot;isonly&quot;: false,
    &quot;ispre&quot;: false,
    &quot;isreadonly&quot;: false,
    &quot;isrequired&quot;: false,
    &quot;option&quot;: {&quot;min&quot;:&quot;1&quot;,&quot;max&quot;:&quot;2&quot;},
    &quot;unit&quot;: &quot;1&quot;,
    &quot;placeholder&quot;: &quot;test&quot;,
    &quot;bk_property_group&quot;: &quot;default&quot;,
    &quot;bk_obj_id&quot;: &quot;cc_test_inst&quot;,
    &quot;bk_supplier_account&quot;: &quot;0&quot;,
    &quot;bk_property_id&quot;: &quot;cc_test&quot;,
    &quot;bk_property_name&quot;: &quot;cc_test&quot;,
    &quot;bk_property_type&quot;: &quot;singlechar&quot;,
    &quot;bk_asst_obj_id&quot;: &quot;test&quot;
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: {
        &quot;id&quot;: 7,
        &quot;bk_supplier_account&quot;: &quot;0&quot;,
        &quot;bk_obj_id&quot;: &quot;cc_test_inst&quot;,
        &quot;bk_property_id&quot;: &quot;cc_test&quot;,
        &quot;bk_property_name&quot;: &quot;cc_test&quot;,
        &quot;bk_property_group&quot;: &quot;default&quot;,
        &quot;bk_property_index&quot;: 4,
        &quot;unit&quot;: &quot;1&quot;,
        &quot;placeholder&quot;: &quot;test&quot;,
        &quot;editable&quot;: true,
        &quot;ispre&quot;: false,
        &quot;isrequired&quot;: false,
        &quot;isreadonly&quot;: false,
        &quot;isonly&quot;: false,
        &quot;bk_issystem&quot;: false,
        &quot;bk_isapi&quot;: false,
        &quot;bk_property_type&quot;: &quot;singlechar&quot;,
        &quot;option&quot;: {&quot;min&quot;:&quot;1&quot;,&quot;max&quot;:&quot;2&quot;},
        &quot;description&quot;: &quot;test&quot;,
        &quot;creator&quot;: &quot;user&quot;,
        &quot;create_time&quot;: &quot;2020-03-25 17:12:08&quot;,
        &quot;last_time&quot;: &quot;2020-03-25 17:12:08&quot;,
        &quot;bk_property_group_name&quot;: &quot;default&quot;
    }
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>creator</td>
<td>string</td>
<td>数据的创建者</td>
</tr>
<tr>
<td>description</td>
<td>string</td>
<td>数据的描述信息</td>
</tr>
<tr>
<td>editable</td>
<td>bool</td>
<td>表明数据是否可编辑</td>
</tr>
<tr>
<td>isonly</td>
<td>bool</td>
<td>表明唯一性</td>
</tr>
<tr>
<td>ispre</td>
<td>bool</td>
<td>true:预置字段,false:非内置字段</td>
</tr>
<tr>
<td>isreadonly</td>
<td>bool</td>
<td>true:只读，false:非只读</td>
</tr>
<tr>
<td>isrequired</td>
<td>bool</td>
<td>true:必填，false:可选</td>
</tr>
<tr>
<td>option</td>
<td>string</td>
<td>用户自定义内容，存储的内容及格式由调用方决定</td>
</tr>
<tr>
<td>unit</td>
<td>string</td>
<td>单位</td>
</tr>
<tr>
<td>placeholder</td>
<td>string</td>
<td>占位符</td>
</tr>
<tr>
<td>bk_property_group</td>
<td>string</td>
<td>字段分栏的名字</td>
</tr>
<tr>
<td>bk_obj_id</td>
<td>string</td>
<td>模型 ID</td>
</tr>
<tr>
<td>bk_supplier_account</td>
<td>string</td>
<td>开发商账号</td>
</tr>
<tr>
<td>bk_property_id</td>
<td>string</td>
<td>模型的属性 ID</td>
</tr>
<tr>
<td>bk_property_name</td>
<td>string</td>
<td>模型属性名，用于展示</td>
</tr>
<tr>
<td>bk_property_type</td>
<td>string</td>
<td>定义的属性字段用于存储数据的数据类型 （singlechar,longchar,int,enum,date,time,objuser,singleasst,multiasst,timezone,bool)</td>
</tr>
<tr>
<td>bk_asst_obj_id</td>
<td>string</td>
<td>如果有关联其它的模型，那么就必需设置此字段，否则就不需要设置</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>业务自定义字段的业务 id</td>
</tr>
</tbody>
</table>
<h4 id="bk_property_type_1">bk_property_type</h4>
<table>
<thead>
<tr>
<th>标识</th>
<th>名字</th>
</tr>
</thead>
<tbody>
<tr>
<td>singlechar</td>
<td>短字符</td>
</tr>
<tr>
<td>longchar</td>
<td>长字符</td>
</tr>
<tr>
<td>int</td>
<td>整形</td>
</tr>
<tr>
<td>enum</td>
<td>枚举类型</td>
</tr>
<tr>
<td>date</td>
<td>日期</td>
</tr>
<tr>
<td>time</td>
<td>时间</td>
</tr>
<tr>
<td>objuser</td>
<td>用户</td>
</tr>
<tr>
<td>singleasst</td>
<td>单关联</td>
</tr>
<tr>
<td>multiasst</td>
<td>多关联</td>
</tr>
<tr>
<td>timezone</td>
<td>时区</td>
</tr>
<tr>
<td>bool</td>
<td>布尔</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/create_process_instance/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>根据服务实例 ID 和进程实例属性值创建进程实例</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>service_instance_id</td>
<td>int</td>
<td>是</td>
<td>服务实例 ID</td>
</tr>
<tr>
<td>processes</td>
<td>array</td>
<td>是</td>
<td>进程实例中不同于模板的属性值</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
  &quot;bk_biz_id&quot;: 1,
  &quot;service_instance_id&quot;: 48,
  &quot;processes&quot;: [
    {
      &quot;process_info&quot;: {
        &quot;bk_supplier_account&quot;: &quot;0&quot;,
        &quot;bind_ip&quot;: &quot;1&quot;,
        &quot;description&quot;: &quot;&quot;,
        &quot;start_cmd&quot;: &quot;&quot;,
        &quot;restart_cmd&quot;: &quot;&quot;,
        &quot;pid_file&quot;: &quot;&quot;,
        &quot;auto_start&quot;: false,
        &quot;timeout&quot;: 30,
        &quot;protocol&quot;: &quot;1&quot;,
        &quot;auto_time_gap&quot;: 60,
        &quot;reload_cmd&quot;: &quot;&quot;,
        &quot;bk_func_name&quot;: &quot;java&quot;,
        &quot;work_path&quot;: &quot;/data/bkce&quot;,
        &quot;stop_cmd&quot;: &quot;&quot;,
        &quot;face_stop_cmd&quot;: &quot;&quot;,
        &quot;port&quot;: &quot;8008,8443&quot;,
        &quot;bk_process_name&quot;: &quot;job_java&quot;,
        &quot;user&quot;: &quot;&quot;,
        &quot;proc_num&quot;: 1,
        &quot;priority&quot;: 1,
        &quot;bk_biz_id&quot;: 2,
        &quot;bk_func_id&quot;: &quot;&quot;,
        &quot;bk_process_id&quot;: 1
      }
    }
  ]
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
  &quot;result&quot;: true,
  &quot;code&quot;: 0,
  &quot;message&quot;: &quot;success&quot;,
  &quot;data&quot;: [64]
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="response">response</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>请求成功与否。true:请求成功；false 请求失败</td>
</tr>
<tr>
<td>code</td>
<td>int</td>
<td>错误编码。 0 表示 success，&gt;0 表示失败错误</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>请求失败返回的错误信息</td>
</tr>
<tr>
<td>data</td>
<td>object</td>
<td>新建的进程实例 ID 列表</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/create_service_category/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>创建服务分类</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>string</td>
<td>是</td>
<td>服务分类名称</td>
</tr>
<tr>
<td>parent_id</td>
<td>int</td>
<td>否</td>
<td>父节点 ID</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
  &quot;bk_biz_id&quot;: 1,
  &quot;name&quot;: &quot;test101&quot;
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
  &quot;result&quot;: true,
  &quot;code&quot;: 0,
  &quot;message&quot;: &quot;success&quot;,
  &quot;data&quot;: {
    &quot;bk_biz_id&quot;: 1,
    &quot;id&quot;: 6,
    &quot;name&quot;: &quot;test5&quot;,
    &quot;root_id&quot;: 5,
    &quot;parent_id&quot;: 5,
    &quot;bk_supplier_account&quot;: &quot;0&quot;,
    &quot;is_built_in&quot;: false
  }
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="response">response</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>请求成功与否。true:请求成功；false 请求失败</td>
</tr>
<tr>
<td>code</td>
<td>int</td>
<td>错误编码。 0 表示 success，&gt;0 表示失败错误</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>请求失败返回的错误信息</td>
</tr>
<tr>
<td>data</td>
<td>object</td>
<td>新建的服务分类信息</td>
</tr>
</tbody>
</table>
<h4 id="data">data 字段说明</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>说明</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>integer</td>
<td>服务分类 ID</td>
<td></td>
</tr>
<tr>
<td>root_id</td>
<td>integer</td>
<td>服务分类根节点 ID</td>
<td></td>
</tr>
<tr>
<td>parent_id</td>
<td>integer</td>
<td>服务分类父节点 ID</td>
<td></td>
</tr>
<tr>
<td>is_built_in</td>
<td>bool</td>
<td>是否是内置节点</td>
<td>内置节点不允许编辑</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/create_service_instance/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>批量创建服务实例，如果模块绑定了服务模板，则服务实例也会根据模板创建，创建服务实例的进程参数内也必须提供每个进程对应的进程模板 ID</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_module_id</td>
<td>int</td>
<td>否</td>
<td>模块 ID</td>
</tr>
<tr>
<td>instances</td>
<td>array</td>
<td>是</td>
<td>需要创建的服务实例信息</td>
</tr>
</tbody>
</table>
<h4 id="instances">instances 字段说明</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>说明</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>instances.bk_host_id</td>
<td>int</td>
<td>主机 ID</td>
<td>服务实例绑定的主机 ID</td>
</tr>
<tr>
<td>instances.processes</td>
<td>array</td>
<td>进程信息</td>
<td>服务实例下新建的进程信息</td>
</tr>
<tr>
<td>instances.processes.process_template_id</td>
<td>int</td>
<td>进程模板 ID</td>
<td>如果模块没有绑定服务模板则填 0</td>
</tr>
<tr>
<td>instances.processes.process_info</td>
<td>object</td>
<td>进程实例信息</td>
<td>如果进程绑定有模板，则仅模板中没有锁定的字段有效</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
  &quot;bk_biz_id&quot;: 1,
  &quot;name&quot;: &quot;test1&quot;,
  &quot;bk_module_id&quot;: 60,
  &quot;instances&quot;: [
    {
      &quot;bk_host_id&quot;: 2,
      &quot;processes&quot;: [
        {
          &quot;process_template_id&quot;: 1,
          &quot;process_info&quot;: {
            &quot;bk_supplier_account&quot;: &quot;0&quot;,
            &quot;bind_ip&quot;: &quot;1&quot;,
            &quot;description&quot;: &quot;&quot;,
            &quot;start_cmd&quot;: &quot;&quot;,
            &quot;restart_cmd&quot;: &quot;&quot;,
            &quot;pid_file&quot;: &quot;&quot;,
            &quot;auto_start&quot;: false,
            &quot;timeout&quot;: 30,
            &quot;protocol&quot;: &quot;1&quot;,
            &quot;auto_time_gap&quot;: 60,
            &quot;reload_cmd&quot;: &quot;&quot;,
            &quot;bk_func_name&quot;: &quot;java&quot;,
            &quot;work_path&quot;: &quot;/data/bkce&quot;,
            &quot;stop_cmd&quot;: &quot;&quot;,
            &quot;face_stop_cmd&quot;: &quot;&quot;,
            &quot;port&quot;: &quot;8008,8443&quot;,
            &quot;bk_process_name&quot;: &quot;job_java&quot;,
            &quot;user&quot;: &quot;&quot;,
            &quot;proc_num&quot;: 1,
            &quot;priority&quot;: 1,
            &quot;bk_biz_id&quot;: 2,
            &quot;bk_func_id&quot;: &quot;&quot;,
            &quot;bk_process_id&quot;: 1
          }
        }
      ]
    }
  ]
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
  &quot;result&quot;: true,
  &quot;code&quot;: 0,
  &quot;message&quot;: &quot;success&quot;,
  &quot;data&quot;: [53]
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="response">response</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>请求成功与否。true:请求成功；false 请求失败</td>
</tr>
<tr>
<td>code</td>
<td>int</td>
<td>错误编码。 0 表示 success，&gt;0 表示失败错误</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>请求失败返回的错误信息</td>
</tr>
<tr>
<td>data</td>
<td>object</td>
<td>新建的服务实例 ID 列表</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/create_service_template/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>根据传入的服务模板名称的服务分类 ID 创建指定名称和服务分类的服务模板</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>string</td>
<td>是</td>
<td>服务模板名称</td>
</tr>
<tr>
<td>service_category_id</td>
<td>int</td>
<td>是</td>
<td>服务分类 ID</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
  &quot;bk_biz_id&quot;: 1,
  &quot;name&quot;: &quot;test4&quot;,
  &quot;service_category_id&quot;: 1
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
  &quot;result&quot;: true,
  &quot;code&quot;: 0,
  &quot;message&quot;: &quot;success&quot;,
  &quot;permission&quot;: null,
  &quot;data&quot;: {
    &quot;bk_biz_id&quot;: 1,
    &quot;id&quot;: 52,
    &quot;name&quot;: &quot;test4&quot;,
    &quot;service_category_id&quot;: 1,
    &quot;creator&quot;: &quot;admin&quot;,
    &quot;modifier&quot;: &quot;admin&quot;,
    &quot;create_time&quot;: &quot;2019-09-18T23:09:44.251970453+08:00&quot;,
    &quot;last_time&quot;: &quot;2019-09-18T23:09:44.251970568+08:00&quot;,
    &quot;bk_supplier_account&quot;: &quot;0&quot;
  }
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="response">response</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>请求成功与否。true:请求成功；false 请求失败</td>
</tr>
<tr>
<td>code</td>
<td>int</td>
<td>错误编码。 0 表示 success，&gt;0 表示失败错误</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>请求失败返回的错误信息</td>
</tr>
<tr>
<td>data</td>
<td>object</td>
<td>请求返回的数据</td>
</tr>
</tbody>
</table>
<h4 id="data">data 字段说明</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>说明</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>count</td>
<td>integer</td>
<td>总数</td>
<td></td>
</tr>
<tr>
<td>info</td>
<td>array</td>
<td>返回结果</td>
<td></td>
</tr>
</tbody>
</table>
<h4 id="info">info 字段说明</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>说明</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>integer</td>
<td>服务模板 ID</td>
<td></td>
</tr>
<tr>
<td>name</td>
<td>array</td>
<td>服务模板名称</td>
<td></td>
</tr>
<tr>
<td>service_category_id</td>
<td>integer</td>
<td>服务模板 ID</td>
<td></td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/create_set/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>创建集群</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_supplier_account</td>
<td>string</td>
<td>否</td>
<td>开发商账号</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 ID</td>
</tr>
<tr>
<td>data</td>
<td>dict</td>
<td>是</td>
<td>集群数据</td>
</tr>
</tbody>
</table>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_parent_id</td>
<td>int</td>
<td>是</td>
<td>父节点的 ID</td>
</tr>
<tr>
<td>bk_set_name</td>
<td>string</td>
<td>是</td>
<td>集群名字</td>
</tr>
<tr>
<td>default</td>
<td>int</td>
<td>否</td>
<td>0-普通集群，1-内置模块集合，默认为 0</td>
</tr>
<tr>
<td>set_template_id</td>
<td>int</td>
<td>否</td>
<td>集群模板 ID，需要通过集群模板创建集群时必填</td>
</tr>
</tbody>
</table>
<p><strong>注意：其它需要的字段由模型定义</strong></p>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_supplier_account&quot;: &quot;123456789&quot;,
    &quot;bk_biz_id&quot;: 1,
    &quot;data&quot;: {
        &quot;bk_parent_id&quot;: 1,
        &quot;bk_set_name&quot;: &quot;test-set&quot;,
        &quot;bk_set_desc&quot;: &quot;test-set&quot;,
        &quot;bk_capacity&quot;: 1000,
        &quot;description&quot;: &quot;description&quot;,
        &quot;set_template_id&quot;: 1
    }
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: {
        &quot;bk_set_id&quot;: 1
    }
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/create_set_template/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>在指定业务 id 下创建指定名称的集群模板，创建的集群模板通过指定的服务模板 id 去包含服务模板</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 ID</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>是</td>
<td>集群模板名称</td>
</tr>
<tr>
<td>service_template_ids</td>
<td>array</td>
<td>是</td>
<td>服务模板 ID 列表</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;bk_supplier_account&quot;: &quot;0&quot;,
    &quot;name&quot;: &quot;test&quot;,
    &quot;bk_biz_id&quot;: 20,
    &quot;service_template_ids&quot;: [59]
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;success&quot;,
    &quot;permission&quot;: null,
    &quot;data&quot;: {
        &quot;id&quot;: 6,
        &quot;name&quot;: &quot;test&quot;,
        &quot;bk_biz_id&quot;: 20,
        &quot;version&quot;: 0,
        &quot;creator&quot;: &quot;admin&quot;,
        &quot;modifier&quot;: &quot;admin&quot;,
        &quot;create_time&quot;: &quot;2019-11-27T17:24:10.671658+08:00&quot;,
        &quot;last_time&quot;: &quot;2019-11-27T17:24:10.671658+08:00&quot;,
        &quot;bk_supplier_account&quot;: &quot;0&quot;
    }
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="response">response</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>请求成功与否。true:请求成功；false 请求失败</td>
</tr>
<tr>
<td>code</td>
<td>int</td>
<td>错误编码。 0 表示 success，&gt;0 表示失败错误</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>请求失败返回的错误信息</td>
</tr>
<tr>
<td>data</td>
<td>object</td>
<td>请求返回的数据</td>
</tr>
</tbody>
</table>
<h4 id="data">data 字段说明</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>int</td>
<td>集群模板 ID</td>
</tr>
<tr>
<td>name</td>
<td>array</td>
<td>集群模板名称</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>业务 ID</td>
</tr>
<tr>
<td>version</td>
<td>int</td>
<td>集群模板版本</td>
</tr>
<tr>
<td>creator</td>
<td>string</td>
<td>创建者</td>
</tr>
<tr>
<td>modifier</td>
<td>string</td>
<td>最后修改人员</td>
</tr>
<tr>
<td>create_time</td>
<td>string</td>
<td>创建时间</td>
</tr>
<tr>
<td>last_time</td>
<td>string</td>
<td>更新时间</td>
</tr>
<tr>
<td>bk_supplier_account</td>
<td>string</td>
<td>开发商账号</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/delete_business/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>删除业务</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_supplier_account</td>
<td>string</td>
<td>否</td>
<td>开发商账号</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 id</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_supplier_account&quot;: &quot;123456789&quot;,
    &quot;bk_biz_id&quot;: 1
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: {}
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/delete_classification/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>通过模型分类 ID 删除模型分类</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>int</td>
<td>是</td>
<td>分类数据记录 ID</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;delete&quot;:{
    &quot;id&quot; : 0
    }
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: &quot;success&quot;
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/delete_cloud_area/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>根据云区域 ID 删除云区域</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_cloud_id</td>
<td>int</td>
<td>是</td>
<td>云区域 ID</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: &quot;success&quot;
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/delete_custom_query/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>删除自定义查询</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_supplier_account</td>
<td>string</td>
<td>否</td>
<td>开发商账号</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 ID</td>
</tr>
<tr>
<td>id</td>
<td>string</td>
<td>是</td>
<td>主键 ID</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_supplier_account&quot;: &quot;123456789&quot;,
    &quot;bk_biz_id&quot;: 1,
    &quot;id&quot;: &quot;xxx&quot;
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: {}
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/delete_dynamic_group/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>删除动态分组 (V3.9.6)</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 ID</td>
</tr>
<tr>
<td>id</td>
<td>string</td>
<td>是</td>
<td>动态分组主键 ID</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_biz_id&quot;: 1,
    &quot;id&quot;: &quot;XXXXXXXX&quot;
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: {}
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/delete_host/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>删除主机</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_supplier_account</td>
<td>string</td>
<td>否</td>
<td>开发商账号</td>
</tr>
<tr>
<td>bk_host_id</td>
<td>string</td>
<td>是</td>
<td>主机 id，多个以逗号分隔</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_supplier_account&quot;: &quot;123456789&quot;,
    &quot;bk_host_id&quot;: &quot;1,2,3&quot;,
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: {}
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/delete_host_lock/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>根据主机 ID 列表删除主机锁(v3.8.6)</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id_list</td>
<td>int array</td>
<td>是</td>
<td>主机 ID 列表</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
   &quot;id_list&quot;: [1, 2, 3]
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;success&quot;,
    &quot;data&quot;: null
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/delete_inst/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>指定模型 ID 和实例 ID 删除指定模型下的对象实例</p>
<ul>
<li>该接口只适用于自定义层级模型和通用模型实例上，不适用于业务、集群、模块、主机等模型实例</li>
</ul>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_obj_id</td>
<td>string</td>
<td>是</td>
<td>模型 ID</td>
</tr>
<tr>
<td>bk_inst_id</td>
<td>int</td>
<td>是</td>
<td>实例 ID</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>否</td>
<td>业务 ID， 当删除的是自定义主线层级模型实例时则必传</td>
</tr>
</tbody>
</table>
<p>注意：当操作的是自定义主线层级模型实例时，而又有使用权限中心的，对于 cmdb 小于 3.9 的版本，还需要传包含实例所在业务 id 的 metadata 参数，否则会导致权限中心鉴权失败，格式为
"metadata": {
    "label": {
        "bk_biz_id": "64"
    }
}</p>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;bk_supplier_account&quot;: &quot;0&quot;,
    &quot;bk_obj_id&quot;: &quot;test&quot;,
    &quot;bk_inst_id&quot;: 0
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: &quot;success&quot;
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/delete_instance_association/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>根据模型实例关联关系的唯一身份 id,删除模型实例之间的关联关系。</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必填</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>int64</td>
<td>Yes</td>
<td>模型实例关联关系的唯一身份 id</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;id&quot;: 1
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: &quot;success&quot;
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>请求成功与否。true:请求成功；false 请求失败</td>
</tr>
<tr>
<td>code</td>
<td>int</td>
<td>错误编码。 0 表示 success，&gt;0 表示失败错误</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>请求失败返回的错误信息</td>
</tr>
<tr>
<td>data</td>
<td>object</td>
<td>请求返回的数据</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/delete_module/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>删除模块</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_supplier_account</td>
<td>string</td>
<td>否</td>
<td>开发商账号</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 id</td>
</tr>
<tr>
<td>bk_set_id</td>
<td>int</td>
<td>是</td>
<td>集群 id</td>
</tr>
<tr>
<td>bk_module_id</td>
<td>int</td>
<td>是</td>
<td>模块 id</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_supplier_account&quot;: &quot;123456789&quot;,
    &quot;bk_biz_id&quot;: 1,
    &quot;bk_set_id&quot;: 1,
    &quot;bk_module_id&quot;: 1
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: {}
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/delete_object/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>根据模型 id 删除模型</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>int</td>
<td>否</td>
<td>被删除的数据记录的 ID</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;id&quot; : 0
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: &quot;success&quot;
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/delete_object_attribute/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>删除对象模型属性，可以删除业务自定义字段</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>int</td>
<td>否</td>
<td>被删除的数据记录的唯一标识 ID</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;id&quot; : 0
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: &quot;success&quot;
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/delete_process_instance/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>根据进程实例 ID 列表删除进程实例</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>process_instance_ids</td>
<td>int</td>
<td>是</td>
<td>进程实例 ID 列表</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
  &quot;bk_biz_id&quot;: 1,
  &quot;process_instance_ids&quot;: [54]
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
  &quot;result&quot;: true,
  &quot;code&quot;: 0,
  &quot;message&quot;: &quot;success&quot;,
  &quot;data&quot;: null
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="response">response</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>请求成功与否。true:请求成功；false 请求失败</td>
</tr>
<tr>
<td>code</td>
<td>int</td>
<td>错误编码。 0 表示 success，&gt;0 表示失败错误</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>请求失败返回的错误信息</td>
</tr>
<tr>
<td>data</td>
<td>object</td>
<td>请求返回的数据</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/delete_proc_template/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>根据进程模板 ID 列表删除进程模板</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>process_templates</td>
<td>array</td>
<td>是</td>
<td>进程模板 ID 列表</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
  &quot;bk_biz_id&quot;: 1,
  &quot;process_templates&quot;: [50]
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
  &quot;result&quot;: false,
  &quot;code&quot;: 1199056,
  &quot;message&quot;: &quot;禁止删除被引用记录&quot;,
  &quot;data&quot;: &quot;&quot;
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="response">response</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>请求成功与否。true:请求成功；false 请求失败</td>
</tr>
<tr>
<td>code</td>
<td>int</td>
<td>错误编码。 0 表示 success，&gt;0 表示失败错误</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>请求失败返回的错误信息</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/delete_related_inst_asso/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>根据实例关联关系的 ID 删除实例之间的关联。(生效版本：3.5.40)</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">必选</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">id</td>
<td align="left">int</td>
<td align="left">是</td>
<td align="left">实例关联关系的 ID， 最多 500 个</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;id&quot;:[1,2]
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;success&quot;,
    &quot;permission&quot;: null,
    &quot;data&quot;: null
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>请求成功与否。true:请求成功；false 请求失败</td>
</tr>
<tr>
<td>code</td>
<td>int</td>
<td>错误编码。 0 表示 success，&gt;0 表示失败错误</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>请求失败返回的错误信息</td>
</tr>
<tr>
<td>data</td>
<td>object</td>
<td>请求返回的数据</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/delete_service_category/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>根据服务分类 ID 删除服务分类</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>int</td>
<td>是</td>
<td>服务分类 ID</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
  &quot;bk_biz_id&quot;: 1,
  &quot;id&quot;: 6
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
  &quot;result&quot;: false,
  &quot;code&quot;: 1199054,
  &quot;message&quot;: &quot;内置结点，禁止删除&quot;,
  &quot;data&quot;: &quot;&quot;
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="response">response</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>请求成功与否。true:请求成功；false 请求失败</td>
</tr>
<tr>
<td>code</td>
<td>int</td>
<td>错误编码。 0 表示 success，&gt;0 表示失败错误</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>请求失败返回的错误信息</td>
</tr>
<tr>
<td>data</td>
<td>object</td>
<td>请求返回的数据</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/delete_service_instance/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>根据服务实例 ID 列表批量删除服务实例</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>service_instance_ids</td>
<td>array</td>
<td>是</td>
<td>服务实例 ID 列表</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
  &quot;bk_biz_id&quot;: 1,
  &quot;service_instance_ids&quot;: [48]
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
  &quot;result&quot;: true,
  &quot;code&quot;: 0,
  &quot;message&quot;: &quot;success&quot;,
  &quot;data&quot;: null
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="response">response</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>请求成功与否。true:请求成功；false 请求失败</td>
</tr>
<tr>
<td>code</td>
<td>int</td>
<td>错误编码。 0 表示 success，&gt;0 表示失败错误</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>请求失败返回的错误信息</td>
</tr>
<tr>
<td>data</td>
<td>object</td>
<td>请求返回的数据</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/delete_service_template/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>根据服务模板 ID 删除服务模板</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>service_template_id</td>
<td>int</td>
<td>是</td>
<td>服务模板 ID</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
  &quot;bk_biz_id&quot;: 1,
  &quot;service_template_id&quot;: 1
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
  &quot;result&quot;: false,
  &quot;code&quot;: 1199056,
  &quot;message&quot;: &quot;禁止删除被引用记录&quot;,
  &quot;data&quot;: &quot;&quot;
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="response">response</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>请求成功与否。true:请求成功；false 请求失败</td>
</tr>
<tr>
<td>code</td>
<td>int</td>
<td>错误编码。 0 表示 success，&gt;0 表示失败错误</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>请求失败返回的错误信息</td>
</tr>
<tr>
<td>data</td>
<td>object</td>
<td>请求返回的数据</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/delete_set/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>删除集群</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_supplier_account</td>
<td>string</td>
<td>否</td>
<td>开发商账号</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 id</td>
</tr>
<tr>
<td>bk_set_id</td>
<td>int</td>
<td>是</td>
<td>集群 id</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_supplier_account&quot;: &quot;123456789&quot;,
    &quot;bk_biz_id&quot;: 1,
    &quot;bk_set_id&quot;: 10
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: {}
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/delete_set_template/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>根据业务 ID 和集群模板 ID 列表删除指定业务下的集群模板</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 ID</td>
</tr>
<tr>
<td>set_template_ids</td>
<td>array</td>
<td>是</td>
<td>集群模板 ID 列表</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;bk_supplier_account&quot;: &quot;0&quot;,
    &quot;bk_biz_id&quot;: 20,
    &quot;set_template_ids&quot;: [59]
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;success&quot;,
    &quot;permission&quot;: null,
    &quot;data&quot;: null
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="response">response</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>请求成功与否。true:请求成功；false 请求失败</td>
</tr>
<tr>
<td>code</td>
<td>int</td>
<td>错误编码。 0 表示 success，&gt;0 表示失败错误</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>请求失败返回的错误信息</td>
</tr>
<tr>
<td>data</td>
<td>object</td>
<td>请求返回的数据</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/execute_dynamic_group/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>根据指定动态分组规则查询获取数据 (V3.9.6)</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 ID</td>
</tr>
<tr>
<td>id</td>
<td>string</td>
<td>是</td>
<td>动态分组主键 ID</td>
</tr>
<tr>
<td>fields</td>
<td>array</td>
<td>是</td>
<td>主机属性列表，控制返回结果的主机里有哪些字段，能够加速接口请求和减少网络流量传输,目标资源不具备指定的字段时该字段将被忽略</td>
</tr>
<tr>
<td>disable_counter</td>
<td>bool</td>
<td>否</td>
<td>是否返回总记录条数，默认返回</td>
</tr>
<tr>
<td>page</td>
<td>object</td>
<td>是</td>
<td>分页设置</td>
</tr>
</tbody>
</table>
<h4 id="page">page</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>start</td>
<td>int</td>
<td>是</td>
<td>记录开始位置</td>
</tr>
<tr>
<td>limit</td>
<td>int</td>
<td>是</td>
<td>每页限制条数,最大 200</td>
</tr>
<tr>
<td>sort</td>
<td>string</td>
<td>否</td>
<td>检索排序， 默认按照创建时间排序</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_biz_id&quot;: 1,
    &quot;disable_counter&quot;: true,
    &quot;id&quot;: &quot;XXXXXXXX&quot;,
    &quot;fields&quot;: [
        &quot;bk_host_id&quot;,
        &quot;bk_cloud_id&quot;,
        &quot;bk_host_innerip&quot;,
        &quot;bk_host_name&quot;
    ],
    &quot;page&quot;:{
        &quot;start&quot;: 0,
        &quot;limit&quot;: 10
    }
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: {
        &quot;count&quot;: 1,
        &quot;info&quot;: [
            {
                &quot;bk_obj_id&quot;: &quot;host&quot;,
                &quot;bk_host_id&quot;: 1,
                &quot;bk_host_name&quot;: &quot;nginx-1&quot;,
                &quot;bk_host_innerip&quot;: &quot;10.0.0.1&quot;,
                &quot;bk_cloud_id&quot;: 0
            }
        ]
    }
}</code></pre>


<h3 id="_9">返回结果参数</h3>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>count</td>
<td>int</td>
<td>当前规则能匹配到的总记录条数（用于调用者进行预分页，实际单次请求返回数量以及数据是否全部拉取完毕以 JSON Array 解析数量为准）</td>
</tr>
<tr>
<td>info</td>
<td>array</td>
<td>dict 数组，主机实际数据, 当动态分组为 host 查询时返回 host 自身属性信息,当动态分组为 set 查询时返回 set 信息</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/find_host_biz_relations/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>根据主机 ID 查询业务相关信息</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_host_id</td>
<td>int array</td>
<td>是</td>
<td>主机 ID 数组，ID 个数不能超过 500</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>否</td>
<td>业务 ID</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;bk_host_id&quot;: [
        3,
        4
    ]
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-json">{
  &quot;result&quot;:true,
  &quot;code&quot;:0,
  &quot;message&quot;:&quot;success&quot;,
  &quot;data&quot;: [
    {
      &quot;bk_biz_id&quot;: 3,
      &quot;bk_host_id&quot;: 3,
      &quot;bk_module_id&quot;: 59,
      &quot;bk_set_id&quot;: 11,
      &quot;bk_supplier_account&quot;: &quot;0&quot;
    },
    {
      &quot;bk_biz_id&quot;: 3,
      &quot;bk_host_id&quot;: 3,
      &quot;bk_module_id&quot;: 60,
      &quot;bk_set_id&quot;: 11,
      &quot;bk_supplier_account&quot;: &quot;0&quot;
    },
    {
      &quot;bk_biz_id&quot;: 3,
      &quot;bk_host_id&quot;: 3,
      &quot;bk_module_id&quot;: 61,
      &quot;bk_set_id&quot;: 12,
      &quot;bk_supplier_account&quot;: &quot;0&quot;
    },
    {
      &quot;bk_biz_id&quot;: 3,
      &quot;bk_host_id&quot;: 4,
      &quot;bk_module_id&quot;: 60,
      &quot;bk_set_id&quot;: 11,
      &quot;bk_supplier_account&quot;: &quot;0&quot;
    }
  ]
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<p>data 字段说明：</p>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>业务 ID</td>
</tr>
<tr>
<td>bk_host_id</td>
<td>int</td>
<td>主机 ID</td>
</tr>
<tr>
<td>bk_module_id</td>
<td>int</td>
<td>模块 ID</td>
</tr>
<tr>
<td>bk_set_id</td>
<td>int</td>
<td>集群 ID</td>
</tr>
<tr>
<td>bk_supplier_account</td>
<td>string</td>
<td>开发商账户</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/find_host_by_service_template/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>获取服务模板下的主机 (v3.8.6)</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 ID</td>
</tr>
<tr>
<td>bk_service_template_ids</td>
<td>int array</td>
<td>是</td>
<td>服务模板 ID 列表，最多可填 500 个</td>
</tr>
<tr>
<td>bk_module_ids</td>
<td>int array</td>
<td>否</td>
<td>模块 ID 列表, 最多可填 500 个</td>
</tr>
<tr>
<td>fields</td>
<td>string array</td>
<td>是</td>
<td>主机属性列表，控制返回结果的模块信息里有哪些字段</td>
</tr>
<tr>
<td>page</td>
<td>object</td>
<td>是</td>
<td>分页信息</td>
</tr>
</tbody>
</table>
<h4 id="page">page 字段说明</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>start</td>
<td>int</td>
<td>是</td>
<td>记录开始位置</td>
</tr>
<tr>
<td>limit</td>
<td>int</td>
<td>是</td>
<td>每页限制条数,最大 500</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;bk_biz_id&quot;: 5,
    &quot;bk_service_template_ids&quot;: [
        48,
        49
    ],
    &quot;bk_module_ids&quot;: [
        65,
        68
    ],
    &quot;fields&quot;: [
        &quot;bk_host_id&quot;,
        &quot;bk_cloud_id&quot;
    ],
    &quot;page&quot;: {
        &quot;start&quot;: 0,
        &quot;limit&quot;: 10
    }
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;success&quot;,
    &quot;data&quot;: {
        &quot;count&quot;: 6,
        &quot;info&quot;: [
            {
                &quot;bk_cloud_id&quot;: 0,
                &quot;bk_host_id&quot;: 1
            },
            {
                &quot;bk_cloud_id&quot;: 0,
                &quot;bk_host_id&quot;: 2
            },
            {
                &quot;bk_cloud_id&quot;: 0,
                &quot;bk_host_id&quot;: 3
            },
            {
                &quot;bk_cloud_id&quot;: 0,
                &quot;bk_host_id&quot;: 4
            },
            {
                &quot;bk_cloud_id&quot;: 0,
                &quot;bk_host_id&quot;: 7
            },
            {
                &quot;bk_cloud_id&quot;: 0,
                &quot;bk_host_id&quot;: 8
            }
        ]
    }
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/find_host_by_set_template/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>获取集群模板下的主机 (v3.8.6)</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 ID</td>
</tr>
<tr>
<td>bk_service_template_ids</td>
<td>int array</td>
<td>是</td>
<td>集群模板 ID 列表，最多可填 500 个</td>
</tr>
<tr>
<td>bk_set_ids</td>
<td>int array</td>
<td>否</td>
<td>集群 ID 列表, 最多可填 500 个</td>
</tr>
<tr>
<td>fields</td>
<td>string array</td>
<td>是</td>
<td>主机属性列表，控制返回结果的模块信息里有哪些字段</td>
</tr>
<tr>
<td>page</td>
<td>object</td>
<td>是</td>
<td>分页信息</td>
</tr>
</tbody>
</table>
<h4 id="page">page 字段说明</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>start</td>
<td>int</td>
<td>是</td>
<td>记录开始位置</td>
</tr>
<tr>
<td>limit</td>
<td>int</td>
<td>是</td>
<td>每页限制条数,最大 500</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;bk_biz_id&quot;: 5,
    &quot;bk_set_template_ids&quot;: [
        1,
        3
    ],
    &quot;bk_set_ids&quot;: [
        13,
        14
    ],
    &quot;fields&quot;: [
        &quot;bk_host_id&quot;,
        &quot;bk_cloud_id&quot;
    ],
    &quot;page&quot;: {
        &quot;start&quot;: 0,
        &quot;limit&quot;: 10
    }
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;success&quot;,
    &quot;data&quot;: {
        &quot;count&quot;: 7,
        &quot;info&quot;: [
            {
                &quot;bk_cloud_id&quot;: 0,
                &quot;bk_host_id&quot;: 1
            },
            {
                &quot;bk_cloud_id&quot;: 0,
                &quot;bk_host_id&quot;: 3
            },
            {
                &quot;bk_cloud_id&quot;: 0,
                &quot;bk_host_id&quot;: 4
            },
            {
                &quot;bk_cloud_id&quot;: 0,
                &quot;bk_host_id&quot;: 5
            },
            {
                &quot;bk_cloud_id&quot;: 0,
                &quot;bk_host_id&quot;: 6
            },
            {
                &quot;bk_cloud_id&quot;: 0,
                &quot;bk_host_id&quot;: 7
            },
            {
                &quot;bk_cloud_id&quot;: 0,
                &quot;bk_host_id&quot;: 8
            }
        ]
    }
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/find_host_by_topo/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>查询拓扑节点下的主机 (v3.8.13)</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 ID</td>
</tr>
<tr>
<td>bk_obj_id</td>
<td>string</td>
<td>是</td>
<td>拓扑节点模型 ID，不可为 biz</td>
</tr>
<tr>
<td>bk_inst_id</td>
<td>int</td>
<td>是</td>
<td>拓扑节点实例 ID</td>
</tr>
<tr>
<td>fields</td>
<td>array</td>
<td>是</td>
<td>主机属性列表，控制返回结果的主机里有哪些字段，能够加速接口请求和减少网络流量传输</td>
</tr>
<tr>
<td>page</td>
<td>object</td>
<td>是</td>
<td>分页信息</td>
</tr>
</tbody>
</table>
<h4 id="page">page 字段说明</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>start</td>
<td>int</td>
<td>是</td>
<td>记录开始位置</td>
</tr>
<tr>
<td>limit</td>
<td>int</td>
<td>是</td>
<td>每页限制条数,最大 500</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;bk_biz_id&quot;: 5,
    &quot;bk_obj_id&quot;: &quot;xxx&quot;,
    &quot;bk_inst_id&quot;: 10,
    &quot;fields&quot;: [
        &quot;bk_host_id&quot;,
        &quot;bk_cloud_id&quot;
    ],
    &quot;page&quot;: {
        &quot;start&quot;: 0,
        &quot;limit&quot;: 10
    }
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;success&quot;,
    &quot;data&quot;: {
        &quot;count&quot;: 2,
        &quot;info&quot;: [
            {
                &quot;bk_cloud_id&quot;: 0,
                &quot;bk_host_id&quot;: 1
            },
            {
                &quot;bk_cloud_id&quot;: 0,
                &quot;bk_host_id&quot;: 2
            }
        ]
    }
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>count</td>
<td>int</td>
<td>记录条数</td>
</tr>
<tr>
<td>info</td>
<td>array</td>
<td>主机实际数据</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/find_host_snapshot_batch/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>根据主机实例 ID 列表和想要获取的主机快照属性列表批量获取主机快照 (v3.8.6)</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_ids</td>
<td>int array</td>
<td>是</td>
<td>主机实例 ID 列表, 即 bk_host_id 列表，最多可填 200 个</td>
</tr>
<tr>
<td>fields</td>
<td>string array</td>
<td>是</td>
<td>主机快照属性列表，控制返回结果的主机快照信息里有哪些字段<br>目前支持字段有：bk_host_id,bk_all_ips</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;bk_ids&quot;: [
        1,
        2
    ],
    &quot;fields&quot;: [
        &quot;bk_host_id&quot;,
        &quot;bk_all_ips&quot;
    ]
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;success&quot;,
    &quot;data&quot;: [
        {
            &quot;bk_all_ips&quot;: {
                &quot;interface&quot;: [
                    {
                        &quot;addrs&quot;: [
                            {
                                &quot;ip&quot;: &quot;192.xx.xx.xx&quot;
                            },
                            {
                                &quot;ip&quot;: &quot;fe80::xx:xx:xx:xx&quot;
                            }
                        ],
                        &quot;mac&quot;: &quot;52:xx:xx:xx:xx:xx&quot;
                    },
                    {
                        &quot;addrs&quot;: [
                            {
                                &quot;ip&quot;: &quot;192.xx.xx.xx&quot;
                            }
                        ],
                        &quot;mac&quot;: &quot;02:xx:xx:xx:xx:xx&quot;
                    }
                ]
            },
            &quot;bk_host_id&quot;: 1
        },
        {
            &quot;bk_all_ips&quot;: {
                &quot;interface&quot;: [
                    {
                        &quot;addrs&quot;: [
                            {
                                &quot;ip&quot;: &quot;172.xx.xx.xx&quot;
                            },
                            {
                                &quot;ip&quot;: &quot;fe80::xx:xx:xx:xx&quot;
                            }
                        ],
                        &quot;mac&quot;: &quot;52:xx:xx:xx:xx:xx&quot;
                    },
                    {
                        &quot;addrs&quot;: [
                            {
                                &quot;ip&quot;: &quot;192.xx.xx.xx&quot;
                            }
                        ],
                        &quot;mac&quot;: &quot;02:xx:xx:xx:xx:xx&quot;
                    }
                ]
            },
            &quot;bk_host_id&quot;: 2
        }
    ]
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/find_host_topo_relation/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>获取主机与拓扑的关系</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 ID</td>
</tr>
<tr>
<td>bk_set_ids</td>
<td>array</td>
<td>否</td>
<td>集群 ID 列表，最多 200 条</td>
</tr>
<tr>
<td>bk_module_ids</td>
<td>array</td>
<td>否</td>
<td>模块 ID 列表，最多 500 条</td>
</tr>
<tr>
<td>bk_host_ids</td>
<td>array</td>
<td>否</td>
<td>主机 ID 列表，最多 500 条</td>
</tr>
<tr>
<td>page</td>
<td>object</td>
<td>是</td>
<td>分页信息</td>
</tr>
</tbody>
</table>
<h4 id="page">page 字段说明</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>start</td>
<td>int</td>
<td>否</td>
<td>获取数据偏移位置</td>
</tr>
<tr>
<td>limit</td>
<td>int</td>
<td>是</td>
<td>过去数据条数限制，建议 为 200</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_supplier_account&quot;: &quot;123456789&quot;,
    &quot;page&quot;:{
        &quot;start&quot;:0,
        &quot;limit&quot;:10
    },
    &quot;bk_biz_id&quot;:2,
    &quot;bk_set_ids&quot;: [1, 2],
    &quot;bk_module_ids&quot;: [23, 24],
    &quot;bk_host_ids&quot;: [25, 26]
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
  &quot;result&quot;: true,
  &quot;code&quot;: 0,
  &quot;message&quot;: &quot;success&quot;,
  &quot;permission&quot;: null,
  &quot;data&quot;: {
    &quot;count&quot;: 10,
    &quot;info&quot;: [
        {
        &quot;bk_biz_id&quot;: 3,
        &quot;bk_host_id&quot;: 5,
        &quot;bk_module_id&quot;: 54,
        &quot;bk_set_id&quot;: 10,
        &quot;bk_supplier_account&quot;: &quot;0&quot;
        },
        .....
    ]
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="data">data 字段说明</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>count</td>
<td>int</td>
<td>记录条数</td>
</tr>
<tr>
<td>info</td>
<td>object array</td>
<td>业务下主机与集群，模块，集群的数据详情列表</td>
</tr>
</tbody>
</table>
<h4 id="datainfo">data.info 字段说明</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>业务 ID</td>
</tr>
<tr>
<td>bk_set_id</td>
<td>int</td>
<td>集群 ID</td>
</tr>
<tr>
<td>bk_module_id</td>
<td>int</td>
<td>模块 ID</td>
</tr>
<tr>
<td>bk_host_id</td>
<td>int</td>
<td>主机 ID</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/find_instance_association/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>查询模型的实例关联关系。</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>是否必填</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>metadata</td>
<td>object</td>
<td>Yes</td>
<td>meta data</td>
</tr>
<tr>
<td>condition</td>
<td>string map</td>
<td>Yes</td>
<td>查询条件</td>
</tr>
</tbody>
</table>
<p>metadata params</p>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>是否必填</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>label</td>
<td>string map</td>
<td>Yes</td>
<td>标签信息</td>
</tr>
</tbody>
</table>
<p>label params</p>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>是否必填</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>string</td>
<td>Yes</td>
<td>业务 ID</td>
</tr>
</tbody>
</table>
<p>condition params</p>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>是否必填</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_obj_asst_id</td>
<td>string</td>
<td>Yes</td>
<td>模型关联关系的唯一 id</td>
</tr>
<tr>
<td>bk_asst_id</td>
<td>string</td>
<td>NO</td>
<td>关联类型的唯一 id</td>
</tr>
<tr>
<td>bk_obj_id</td>
<td>string</td>
<td>NO</td>
<td>源模型 id</td>
</tr>
<tr>
<td>bk_asst_id</td>
<td>string</td>
<td>NO</td>
<td>目标模型 id</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;condition&quot;: {
        &quot;bk_obj_asst_id&quot;: &quot;bk_switch_belong_bk_host&quot;,
        &quot;bk_asst_id&quot;: &quot;&quot;,
        &quot;bk_object_id&quot;: &quot;&quot;,
        &quot;bk_asst_obj_id&quot;: &quot;&quot;
    },
    &quot;metadata&quot;:{
        &quot;label&quot;:{
            &quot;bk_biz_id&quot;:&quot;3&quot;
        }
    }
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: [{
        &quot;bk_obj_asst_id&quot;: &quot;bk_switch_belong_bk_host&quot;,
        &quot;bk_obj_id&quot;:&quot;switch&quot;,
        &quot;bk_asst_obj_id&quot;:&quot;host&quot;,
        &quot;bk_inst_id&quot;:12,
        &quot;bk_asst_inst_id&quot;:13
    }]
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>int64</td>
<td>the association's unique id</td>
</tr>
<tr>
<td>bk_obj_asst_id</td>
<td>string</td>
<td>自动生成的模型关联关系 id.</td>
</tr>
<tr>
<td>bk_obj_id</td>
<td>string</td>
<td>关联关系源模型 id</td>
</tr>
<tr>
<td>bk_asst_obj_id</td>
<td>string</td>
<td>关联关系目标模型 id</td>
</tr>
<tr>
<td>bk_inst_id</td>
<td>int64</td>
<td>源模型实例 id</td>
</tr>
<tr>
<td>bk_asst_inst_id</td>
<td>int64</td>
<td>目标模型实例 id</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/find_module_batch/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>根据业务 ID 和模块实例 ID 列表，加上想要返回的模块属性列表，批量获取指定业务下模块实例的属性信息 (v3.8.6)</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 ID</td>
</tr>
<tr>
<td>bk_ids</td>
<td>int array</td>
<td>是</td>
<td>模块实例 ID 列表, 即 bk_module_id 列表，最多可填 500 个</td>
</tr>
<tr>
<td>fields</td>
<td>string array</td>
<td>是</td>
<td>模块属性列表，控制返回结果的模块信息里有哪些字段</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;bk_biz_id&quot;: 3,
    &quot;bk_ids&quot;: [
        56,
        57,
        58,
        59,
        60
    ],
    &quot;fields&quot;: [
        &quot;bk_module_id&quot;,
        &quot;bk_module_name&quot;,
        &quot;create_time&quot;
    ]
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;success&quot;,
    &quot;data&quot;: [
        {
            &quot;bk_module_id&quot;: 60,
            &quot;bk_module_name&quot;: &quot;sm1&quot;,
            &quot;create_time&quot;: &quot;2020-05-15T22:15:51.725+08:00&quot;,
            &quot;default&quot;: 0
        },
        {
            &quot;bk_module_id&quot;: 59,
            &quot;bk_module_name&quot;: &quot;m1&quot;,
            &quot;create_time&quot;: &quot;2020-05-12T21:04:47.286+08:00&quot;,
            &quot;default&quot;: 0
        },
        {
            &quot;bk_module_id&quot;: 58,
            &quot;bk_module_name&quot;: &quot;待回收&quot;,
            &quot;create_time&quot;: &quot;2020-05-12T21:03:37.238+08:00&quot;,
            &quot;default&quot;: 3
        },
        {
            &quot;bk_module_id&quot;: 57,
            &quot;bk_module_name&quot;: &quot;故障机&quot;,
            &quot;create_time&quot;: &quot;2020-05-12T21:03:37.183+08:00&quot;,
            &quot;default&quot;: 2
        },
        {
            &quot;bk_module_id&quot;: 56,
            &quot;bk_module_name&quot;: &quot;空闲机&quot;,
            &quot;create_time&quot;: &quot;2020-05-12T21:03:37.122+08:00&quot;,
            &quot;default&quot;: 1
        }
    ]
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/find_module_host_relation/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>根据模块 ID 查询主机和模块的关系(v3.8.7)</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 ID</td>
</tr>
<tr>
<td>bk_module_ids</td>
<td>int array</td>
<td>是</td>
<td>模块 ID 数组，最多 200 条</td>
</tr>
<tr>
<td>module_fields</td>
<td>string array</td>
<td>是</td>
<td>模块属性列表，控制返回结果的模块里有哪些字段</td>
</tr>
<tr>
<td>host_fields</td>
<td>string array</td>
<td>是</td>
<td>主机属性列表，控制返回结果的主机里有哪些字段</td>
</tr>
<tr>
<td>page</td>
<td>object</td>
<td>是</td>
<td>分页参数</td>
</tr>
</tbody>
</table>
<h4 id="page">page</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>start</td>
<td>int</td>
<td>否</td>
<td>记录开始位置,默认值 0</td>
</tr>
<tr>
<td>limit</td>
<td>int</td>
<td>是</td>
<td>每页限制条数,最大 1000</td>
</tr>
</tbody>
</table>
<p><strong>注: 一个模块下的主机关系可能会拆分多次返回，分页方式是按主机 ID 排序进行分页。</strong></p>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;bk_module_ids&quot;: [
        1,
        2,
        3
    ],
    &quot;module_fields&quot;: [
        &quot;bk_module_id&quot;,
        &quot;bk_module_name&quot;
    ],
    &quot;host_fields&quot;: [
        &quot;bk_host_innerip&quot;,
        &quot;bk_host_id&quot;
    ],
    &quot;page&quot;: {
        &quot;start&quot;: 0,
        &quot;limit&quot;: 500
    }
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-json">{
  &quot;result&quot;: true,
  &quot;code&quot;: 0,
  &quot;message&quot;: &quot;success&quot;,
  &quot;data&quot;: {
    &quot;count&quot;: 2,
    &quot;relation&quot;: [
      {
        &quot;host&quot;: {
          &quot;bk_host_id&quot;: 1,
          &quot;bk_host_innerip&quot;: &quot;127.0.0.1&quot;,
        },
        &quot;modules&quot;: [
          {
            &quot;bk_module_id&quot;: 1,
            &quot;bk_module_name&quot;: &quot;m1&quot;,
          },
          {
            &quot;bk_module_id&quot;: 2,
            &quot;bk_module_name&quot;: &quot;m2&quot;,
          }
        ]
      },
      {
        &quot;host&quot;: {
          &quot;bk_host_id&quot;: 2,
          &quot;bk_host_innerip&quot;: &quot;127.0.0.2&quot;,
        },
        &quot;modules&quot;: [
          {
            &quot;bk_module_id&quot;: 3,
            &quot;bk_module_name&quot;: &quot;m3&quot;,
          }
        ]
      }
    ]
  }
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>请求成功与否。true:请求成功；false 请求失败</td>
</tr>
<tr>
<td>code</td>
<td>int</td>
<td>错误编码。 0 表示 success，&gt;0 表示失败错误</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>请求失败返回的错误信息</td>
</tr>
<tr>
<td>data</td>
<td>object</td>
<td>请求返回的数据</td>
</tr>
</tbody>
</table>
<p>data 字段说明：</p>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>count</td>
<td>int</td>
<td>记录条数</td>
</tr>
<tr>
<td>relation</td>
<td>object array</td>
<td>主机和模块实际数据</td>
</tr>
</tbody>
</table>
<p>info 字段说明:</p>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>host</td>
<td>object</td>
<td>主机数据</td>
</tr>
<tr>
<td>modules</td>
<td>object array</td>
<td>主机所属的模块信息</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/find_module_with_relation/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>根据条件查询业务下的模块 (v3.9.7)</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 ID</td>
</tr>
<tr>
<td>bk_set_ids</td>
<td>int array</td>
<td>否</td>
<td>集群 ID 列表, 最多可填 200 个</td>
</tr>
<tr>
<td>bk_service_template_ids</td>
<td>int array</td>
<td>否</td>
<td>服务模板 ID 列表</td>
</tr>
<tr>
<td>fields</td>
<td>string array</td>
<td>是</td>
<td>模块属性列表，控制返回结果的模块信息里有哪些字段</td>
</tr>
<tr>
<td>page</td>
<td>object</td>
<td>是</td>
<td>分页信息</td>
</tr>
</tbody>
</table>
<h4 id="page">page 字段说明</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>start</td>
<td>int</td>
<td>是</td>
<td>记录开始位置</td>
</tr>
<tr>
<td>limit</td>
<td>int</td>
<td>是</td>
<td>每页限制条数,最大 500</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;bk_biz_id&quot;: 2,
    &quot;bk_set_ids&quot;:[1,2],
    &quot;bk_service_template_ids&quot;: [3,4],
    &quot;fields&quot;:[&quot;bk_module_id&quot;, &quot;bk_module_name&quot;],
    &quot;page&quot;: {
        &quot;start&quot;: 0,
        &quot;limit&quot;: 10
    }
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;result&quot;: true,
    &quot;bk_error_code&quot;: 0,
    &quot;bk_error_msg&quot;: &quot;success&quot;,
    &quot;permission&quot;: null,
    &quot;data&quot;: {
        &quot;count&quot;: 2,
        &quot;info&quot;: [
            {
                &quot;bk_module_id&quot;: 8,
                &quot;bk_module_name&quot;: &quot;license&quot;
            },
            {
                &quot;bk_module_id&quot;: 12,
                &quot;bk_module_name&quot;: &quot;gse_proc&quot;
            }
        ]
    }
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/find_object_association/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>查询模型的实例之间的关联关系。</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>是否必填</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>condition</td>
<td>string map</td>
<td>Yes</td>
<td>查询条件</td>
</tr>
</tbody>
</table>
<p>condition params</p>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>是否必填</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_asst_id</td>
<td>string</td>
<td>Yes</td>
<td>模型的关联类型唯一 id</td>
</tr>
<tr>
<td>bk_obj_id</td>
<td>string</td>
<td>Yes</td>
<td>源模型 id</td>
</tr>
<tr>
<td>bk_asst_id</td>
<td>string</td>
<td>Yes</td>
<td>目标模型 id</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;condition&quot;: {
        &quot;bk_asst_id&quot;: &quot;belong&quot;,
        &quot;bk_obj_id&quot;: &quot;bk_switch&quot;,
        &quot;bk_asst_obj_id&quot;: &quot;bk_host&quot;
    }
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: [
        {
            &quot;id&quot;: 1,
            &quot;bk_obj_asst_id&quot;: &quot;bk_switch_belong_bk_host&quot;,
            &quot;bk_obj_asst_name&quot;: &quot;&quot;,
            &quot;bk_asst_id&quot;: &quot;belong&quot;,
            &quot;bk_asst_name&quot;: &quot;belong&quot;,
            &quot;bk_obj_id&quot;: &quot;bk_switch&quot;,
            &quot;bk_obj_name&quot;: &quot;switch&quot;,
            &quot;bk_asst_obj_id&quot;: &quot;bk_host&quot;,
            &quot;bk_asst_obj_name&quot;: &quot;host&quot;,
            &quot;mapping&quot;: &quot;1:n&quot;,
            &quot;on_delete&quot;: &quot;none&quot;
        }
    ]
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>int64</td>
<td>模型关联关系的身份 id</td>
</tr>
<tr>
<td>bk_obj_asst_id</td>
<td>string</td>
<td>模型关联关系的唯一 id.</td>
</tr>
<tr>
<td>bk_obj_asst_name</td>
<td>string</td>
<td>关联关系的别名.</td>
</tr>
<tr>
<td>bk_asst_id</td>
<td>string</td>
<td>关联类型 id</td>
</tr>
<tr>
<td>bk_asst_name</td>
<td>string</td>
<td>关联类型名称</td>
</tr>
<tr>
<td>bk_obj_id</td>
<td>string</td>
<td>源模型 id</td>
</tr>
<tr>
<td>bk_obj_name</td>
<td>string</td>
<td>源模型名称</td>
</tr>
<tr>
<td>bk_asst_obj_id</td>
<td>string</td>
<td>目标模型 id</td>
</tr>
<tr>
<td>bk_asst_obj_name</td>
<td>string</td>
<td>目标模型名称</td>
</tr>
<tr>
<td>mapping</td>
<td>string</td>
<td>源模型与目标模型关联关系实例的映身关系，可以是以下中的一种[1:1, 1:n, n:n]</td>
</tr>
<tr>
<td>on_delete</td>
<td>string</td>
<td>删除关联关系时的动作, 取值为以下其中的一种 [none, delete_src, delete_dest], "none" 什么也不做, "delete_src" 删除源模型的实例, "delete_dest" 删除目标模型的实例.</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/find_set_batch/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>根据业务 id 和集群实例 id 列表，以及想要获取的属性列表，批量获取指定业务下集群的属性详情 (v3.8.6)</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 ID</td>
</tr>
<tr>
<td>bk_ids</td>
<td>int array</td>
<td>是</td>
<td>集群实例 ID 列表, 即 bk_set_id 列表，最多可填 500 个</td>
</tr>
<tr>
<td>fields</td>
<td>string array</td>
<td>是</td>
<td>集群属性列表，控制返回结果的集群信息里有哪些字段</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;bk_biz_id&quot;: 3,
    &quot;bk_ids&quot;: [
        11,
        12
    ],
    &quot;fields&quot;: [
        &quot;bk_set_id&quot;,
        &quot;bk_set_name&quot;,
        &quot;create_time&quot;
    ]
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;success&quot;,
    &quot;data&quot;: [
        {
            &quot;bk_set_id&quot;: 12,
            &quot;bk_set_name&quot;: &quot;ss1&quot;,
            &quot;create_time&quot;: &quot;2020-05-15T22:15:51.67+08:00&quot;,
            &quot;default&quot;: 0
        },
        {
            &quot;bk_set_id&quot;: 11,
            &quot;bk_set_name&quot;: &quot;set1&quot;,
            &quot;create_time&quot;: &quot;2020-05-12T21:04:36.644+08:00&quot;,
            &quot;default&quot;: 0
        }
    ]
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/find_topo_node_paths/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>该接口用于根据业务拓扑层级中的某个节点实例(包括自定义节层级实例)，查询该节点的父层级一直到业务顶点的路径信息。(v3.9.1)</p>
<p><strong>注意</strong>
该接口有缓存，缓存更新的最长时间为 5 分钟。</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 ID</td>
</tr>
<tr>
<td>bk_nodes</td>
<td>object array</td>
<td>是</td>
<td>要查询的业务拓扑实例节点信息列表, 最大查询数量为 1000</td>
</tr>
</tbody>
</table>
<h4 id="bk_nodes">bk_nodes 字段说明</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_obj_id</td>
<td>string</td>
<td>是</td>
<td>业务拓扑节点模型名称，如 biz,set,module 及自定义层级模型名</td>
</tr>
<tr>
<td>bk_inst_id</td>
<td>int64</td>
<td>是</td>
<td>该业务拓扑节点的实例 ID</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;bk_nodes&quot;: [
        {
            &quot;bk_obj_id&quot;: &quot;set&quot;,
            &quot;bk_inst_id&quot;: 11
        },
        {
            &quot;bk_obj_id&quot;: &quot;module&quot;,
            &quot;bk_inst_id&quot;: 60
        },
        {
            &quot;bk_obj_id&quot;: &quot;province&quot;,
            &quot;bk_inst_id&quot;: 3
        }
    ]
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;success&quot;,
    &quot;permission&quot;: null,
    &quot;data&quot;: [
        {
            &quot;bk_obj_id&quot;: &quot;set&quot;,
            &quot;bk_inst_id&quot;: 11,
            &quot;bk_inst_name&quot;: &quot;gz&quot;,
            &quot;bk_paths&quot;: [
                [
                    {
                        &quot;bk_obj_id&quot;: &quot;biz&quot;,
                        &quot;bk_inst_id&quot;: 3,
                        &quot;bk_inst_name&quot;: &quot;demo&quot;
                    },
                    {
                        &quot;bk_obj_id&quot;: &quot;province&quot;,
                        &quot;bk_inst_id&quot;: 3,
                        &quot;bk_inst_name&quot;: &quot;sz&quot;
                    }
                ]
            ]
        },
        {
            &quot;bk_obj_id&quot;: &quot;module&quot;,
            &quot;bk_inst_id&quot;: 60,
            &quot;bk_inst_name&quot;: &quot;m2&quot;,
            &quot;bk_paths&quot;: [
                [
                    {
                        &quot;bk_obj_id&quot;: &quot;biz&quot;,
                        &quot;bk_inst_id&quot;: 3,
                        &quot;bk_inst_name&quot;: &quot;demo&quot;
                    },
                    {
                        &quot;bk_obj_id&quot;: &quot;province&quot;,
                        &quot;bk_inst_id&quot;: 3,
                        &quot;bk_inst_name&quot;: &quot;sz&quot;
                    },
                    {
                        &quot;bk_obj_id&quot;: &quot;set&quot;,
                        &quot;bk_inst_id&quot;: 12,
                        &quot;bk_inst_name&quot;: &quot;set1&quot;
                    }
                ]
            ]
        },
        {
            &quot;bk_obj_id&quot;: &quot;province&quot;,
            &quot;bk_inst_id&quot;: 3,
            &quot;bk_inst_name&quot;: &quot;sz&quot;,
            &quot;bk_paths&quot;: [
                [
                    {
                        &quot;bk_obj_id&quot;: &quot;biz&quot;,
                        &quot;bk_inst_id&quot;: 3,
                        &quot;bk_inst_name&quot;: &quot;demo&quot;
                    }
                ]
            ]
        }
    ]
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="data">data 说明</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_obj_id</td>
<td>string</td>
<td>业务拓扑节点模型名称，如 biz,set,module 及自定义层级模型名</td>
</tr>
<tr>
<td>bk_inst_id</td>
<td>int64</td>
<td>该业务拓扑节点的实例 ID</td>
</tr>
<tr>
<td>bk_paths</td>
<td>object array</td>
<td>该节点的层级信息，即从业务到该节点的父节点的层级信息</td>
</tr>
</tbody>
</table>
<h4 id="bk_paths">bk_paths 说明</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_obj_id</td>
<td>string</td>
<td>节点类型</td>
</tr>
<tr>
<td>bk_inst_id</td>
<td>int64</td>
<td>节点实例 ID</td>
</tr>
<tr>
<td>bk_inst_name</td>
<td>string</td>
<td>节点实例名称</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/get_biz_internal_module/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>根据业务 ID 获取业务空闲机, 故障机和待回收模块</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 ID</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_biz_id&quot;:0,
    &quot;bk_supplier_account&quot;:&quot;0&quot;
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
  &quot;result&quot;: true,
  &quot;code&quot;: 0,
  &quot;message&quot;: &quot;success&quot;,
  &quot;data&quot;: {
    &quot;bk_set_id&quot;: 2,
    &quot;bk_set_name&quot;: &quot;空闲机池&quot;,
    &quot;module&quot;: [
      {
        &quot;bk_module_id&quot;: 3,
        &quot;bk_module_name&quot;: &quot;空闲机&quot;
      },
      {
        &quot;bk_module_id&quot;: 4,
        &quot;bk_module_name&quot;: &quot;故障机&quot;
      },
      {
        &quot;bk_module_id&quot;: 5,
        &quot;bk_module_name&quot;: &quot;待回收&quot;
      }
    ]
  }
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="data">data 说明</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_set_id</td>
<td>int64</td>
<td>空闲机, 故障机和待回收模块所属的 set 的实例 ID</td>
</tr>
<tr>
<td>bk_set_name</td>
<td>string</td>
<td>空闲机, 故障机和待回收模块所属的 set 的实例名称</td>
</tr>
</tbody>
</table>
<h4 id="module">module 说明</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_module_id</td>
<td>int64</td>
<td>空闲机, 故障机或待回收模块的实例 ID</td>
</tr>
<tr>
<td>bk_module_name</td>
<td>string</td>
<td>空闲机, 故障机或待回收模块的实例名称</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/get_custom_query_data/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>根据自定义查询获取数据</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_supplier_account</td>
<td>string</td>
<td>否</td>
<td>开发商账号</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 ID</td>
</tr>
<tr>
<td>id</td>
<td>string</td>
<td>是</td>
<td>主键 ID</td>
</tr>
<tr>
<td>start</td>
<td>int</td>
<td>是</td>
<td>记录开始位置</td>
</tr>
<tr>
<td>limit</td>
<td>int</td>
<td>是</td>
<td>每页限制条数,最大 200</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_supplier_account&quot;: &quot;123456789&quot;,
    &quot;bk_biz_id&quot;: 1,
    &quot;id&quot;: &quot;xxx&quot;,
    &quot;start&quot;: 0,
    &quot;limit&quot;: 10
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: {
        &quot;count&quot;: 1,
        &quot;info&quot;: [
            {
                &quot;biz&quot;: {
                    &quot;bk_biz_id&quot;: 1,
                    &quot;bk_biz_name&quot;: &quot;test&quot;,
                    &quot;bk_biz_maintainer&quot;: &quot;admin&quot;,
                    &quot;bk_biz_productor&quot;: &quot;admin&quot;
                },
                &quot;host&quot;: {
                    &quot;bk_host_id&quot;: 1,
                    &quot;bk_host_name&quot;: &quot;nginx-1&quot;,
                    &quot;bk_host_innerip&quot;: &quot;10.0.0.1&quot;,
                    &quot;bk_cloud_id&quot;: 0
                },
                &quot;module&quot;: {
                    &quot;bk_module_name&quot;: &quot;module-test&quot;
                },
                &quot;set&quot;: {
                    &quot;bk_set_name&quot;: &quot;set-test&quot;
                }
            }
        ]
    }
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>count</td>
<td>int</td>
<td>记录条数</td>
</tr>
<tr>
<td>info</td>
<td>array</td>
<td>主机实际数据</td>
</tr>
</tbody>
</table>
<h4 id="datainfo">data.info</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>biz</td>
<td>dict</td>
<td>主机所属的业务信息</td>
</tr>
<tr>
<td>set</td>
<td>dict</td>
<td>主机所属的集群信息</td>
</tr>
<tr>
<td>module</td>
<td>dict</td>
<td>主机所属的模块信息</td>
</tr>
<tr>
<td>host</td>
<td>dict</td>
<td>主机自身属性</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/get_custom_query_detail/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>获取自定义查询详情</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_supplier_account</td>
<td>string</td>
<td>否</td>
<td>开发商账号</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 ID</td>
</tr>
<tr>
<td>id</td>
<td>string</td>
<td>是</td>
<td>主键 ID</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_supplier_account&quot;: &quot;123456789&quot;,
    &quot;bk_biz_id&quot;: 1,
    &quot;id&quot;: &quot;xxx&quot;
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: {
        &quot;bk_biz_id&quot;: 1,
        &quot;name&quot;: &quot;api1&quot;,
        &quot;id&quot;: &quot;bacfet4kd42325venmcg&quot;,
        &quot;info&quot;: &quot;{\&quot;condition\&quot;:[{\&quot;bk_obj_id\&quot;:\&quot;biz\&quot;,\&quot;condition\&quot;:[{\&quot;field\&quot;:\&quot;default\&quot;,\&quot;operator\&quot;:\&quot;$ne\&quot;,\&quot;value\&quot;:1}],\&quot;fields\&quot;:[]},{\&quot;bk_obj_id\&quot;:\&quot;set\&quot;,\&quot;condition\&quot;:[],\&quot;fields\&quot;:[]},{\&quot;bk_obj_id\&quot;:\&quot;module\&quot;,\&quot;condition\&quot;:[],\&quot;fields\&quot;:[]},{\&quot;bk_obj_id\&quot;:\&quot;host\&quot;,\&quot;condition\&quot;:[{\&quot;field\&quot;:\&quot;bk_host_innerip\&quot;,\&quot;operator\&quot;:\&quot;$eq\&quot;,\&quot;value\&quot;:\&quot;127.0.0.1\&quot;}],\&quot;fields\&quot;:[\&quot;bk_host_innerip\&quot;,\&quot;bk_host_outerip\&quot;,\&quot;bk_agent_status\&quot;]}]}&quot;,
        &quot;create_user&quot;: &quot;admin&quot;,
        &quot;create_time&quot;: &quot;2018-03-27T16:22:43.271+08:00&quot;,
        &quot;modify_user&quot;: &quot;admin&quot;,
        &quot;last_time&quot;: &quot;2018-03-27T16:29:26.428+08:00&quot;
    }
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>业务 ID</td>
</tr>
<tr>
<td>create_time</td>
<td>string</td>
<td>创建时间</td>
</tr>
<tr>
<td>create_user</td>
<td>string</td>
<td>创建者</td>
</tr>
<tr>
<td>id</td>
<td>string</td>
<td>自定义查询主键 ID</td>
</tr>
<tr>
<td>info</td>
<td>string</td>
<td>自定义查询信息</td>
</tr>
<tr>
<td>last_time</td>
<td>string</td>
<td>更新时间</td>
</tr>
<tr>
<td>modify_user</td>
<td>string</td>
<td>修改者</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>自定义查询命名</td>
</tr>
</tbody>
</table>
<h4 id="datainfo">data.info</h4>
<p>| 字段      |  类型     |  描述      |
|-----------|------------|--------|------------|
| bk_obj_id |  string   | 对象名,可以为 biz,set,module,host,object |
| fields    |  array    | 查询输出字段 |
| condition |  array    | 查询条件 |</p>
<h4 id="datainfocondition">data.info.condition</h4>
<p>| 字段      |  类型     |  描述      |
|-----------|------------|--------|------------|
| field     |  string    | 对象的字段 |
| operator  |  string    | 操作符, $eq 为相等，$ne 为不等，$in 为属于，$nin 为不属于 |
| value     |  string    | 字段对应的值 |</p><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/get_dynamic_group/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>获取动态分组详情 (V3.9.6)</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 ID</td>
</tr>
<tr>
<td>id</td>
<td>string</td>
<td>是</td>
<td>目标动态分组主键 ID</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_biz_id&quot;: 1,
    &quot;id&quot;: &quot;XXXXXXXX&quot;
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: {
        &quot;bk_biz_id&quot;: 1,
        &quot;name&quot;: &quot;my-dynamic-group&quot;,
        &quot;id&quot;: &quot;XXXXXXXX&quot;,
        &quot;bk_obj_id&quot;: &quot;host&quot;,
        &quot;info&quot;: {
            &quot;condition&quot;:[
                {
                    &quot;bk_obj_id&quot;:&quot;set&quot;,
                    &quot;condition&quot;:[
                        {
                            &quot;field&quot;:&quot;default&quot;,
                            &quot;operator&quot;:&quot;$ne&quot;,
                            &quot;value&quot;:1
                        }
                    ]
                },
                {
                    &quot;bk_obj_id&quot;:&quot;module&quot;,
                    &quot;condition&quot;:[
                        {
                            &quot;field&quot;:&quot;default&quot;,
                            &quot;operator&quot;:&quot;$ne&quot;,
                            &quot;value&quot;:1
                        }
                    ]
                },
                {
                    &quot;bk_obj_id&quot;:&quot;host&quot;,
                    &quot;condition&quot;:[
                        {
                            &quot;field&quot;:&quot;bk_host_innerip&quot;,
                            &quot;operator&quot;:&quot;$eq&quot;,
                            &quot;value&quot;:&quot;127.0.0.1&quot;
                        }
                    ]
                }
            ]
        },
       &quot;create_user&quot;: &quot;admin&quot;,
       &quot;create_time&quot;: &quot;2018-03-27T16:22:43.271+08:00&quot;,
       &quot;modify_user&quot;: &quot;admin&quot;,
       &quot;last_time&quot;: &quot;2018-03-27T16:29:26.428+08:00&quot;
    }
}</code></pre>


<h3 id="_9">返回结果参数</h3>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>业务 ID</td>
</tr>
<tr>
<td>id</td>
<td>string</td>
<td>动态分组主键 ID</td>
</tr>
<tr>
<td>bk_obj_id</td>
<td>string</td>
<td>动态分组的目标资源对象类型,目前可以为 host,set</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>动态分组命名</td>
</tr>
<tr>
<td>info</td>
<td>object</td>
<td>动态分组规则信息</td>
</tr>
<tr>
<td>last_time</td>
<td>string</td>
<td>更新时间</td>
</tr>
<tr>
<td>modify_user</td>
<td>string</td>
<td>修改者</td>
</tr>
<tr>
<td>create_time</td>
<td>string</td>
<td>创建时间</td>
</tr>
<tr>
<td>create_user</td>
<td>string</td>
<td>创建者</td>
</tr>
</tbody>
</table>
<h4 id="datainfocondition">data.info.condition</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_obj_id</td>
<td>string</td>
<td>条件对象资源类型, host 类型的动态分组支持的 info.conditon:set,module,host；set 类型的动态分组支持的 info.condition:set</td>
</tr>
<tr>
<td>condition</td>
<td>array</td>
<td>查询条件</td>
</tr>
</tbody>
</table>
<h4 id="datainfoconditioncondition">data.info.condition.condition</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>field</td>
<td>string</td>
<td>对象的字段</td>
</tr>
<tr>
<td>operator</td>
<td>string</td>
<td>操作符, op 值为 eq(相等)/ne(不等)/in(属于)/nin(不属于)</td>
</tr>
<tr>
<td>value</td>
<td>object</td>
<td>字段对应的值</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/get_host_base_info/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>获取主机基础信息详情</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_supplier_account</td>
<td>string</td>
<td>否</td>
<td>开发商账号</td>
</tr>
<tr>
<td>bk_host_id</td>
<td>int</td>
<td>是</td>
<td>主机 ID</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_supplier_account&quot;: &quot;123456789&quot;,
    &quot;bk_host_id&quot;: 10000
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: [
        {
            &quot;bk_property_id&quot;: &quot;bk_host_name&quot;,
            &quot;bk_property_name&quot;: &quot;host name&quot;,
            &quot;bk_property_value&quot;: &quot;centos7&quot;
        },
        {
            &quot;bk_property_id&quot;: &quot;bk_host_id&quot;,
            &quot;bk_property_name&quot;: &quot;host ID&quot;,
            &quot;bk_property_value&quot;: &quot;10000&quot;
        }
    ]
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_property_id</td>
<td>string</td>
<td>属性 id</td>
</tr>
<tr>
<td>bk_property_name</td>
<td>string</td>
<td>属性名称</td>
</tr>
<tr>
<td>bk_property_value</td>
<td>string</td>
<td>属性值</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/get_mainline_object_topo/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>获取主线模型的业务拓扑</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_supplier_account&quot;:&quot;0&quot;
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
  &quot;result&quot;: true,
  &quot;code&quot;: 0,
  &quot;message&quot;: &quot;success&quot;,
  &quot;data&quot;: [
    {
      &quot;bk_obj_id&quot;: &quot;biz&quot;,
      &quot;bk_obj_name&quot;: &quot;业务&quot;,
      &quot;bk_supplier_account&quot;: &quot;0&quot;,
      &quot;bk_next_obj&quot;: &quot;set&quot;,
      &quot;bk_next_name&quot;: &quot;集群&quot;,
      &quot;bk_pre_obj_id&quot;: &quot;&quot;,
      &quot;bk_pre_obj_name&quot;: &quot;&quot;
    },
    {
      &quot;bk_obj_id&quot;: &quot;set&quot;,
      &quot;bk_obj_name&quot;: &quot;集群&quot;,
      &quot;bk_supplier_account&quot;: &quot;0&quot;,
      &quot;bk_next_obj&quot;: &quot;module&quot;,
      &quot;bk_next_name&quot;: &quot;模块&quot;,
      &quot;bk_pre_obj_id&quot;: &quot;biz&quot;,
      &quot;bk_pre_obj_name&quot;: &quot;业务&quot;
    },
    {
      &quot;bk_obj_id&quot;: &quot;module&quot;,
      &quot;bk_obj_name&quot;: &quot;模块&quot;,
      &quot;bk_supplier_account&quot;: &quot;0&quot;,
      &quot;bk_next_obj&quot;: &quot;host&quot;,
      &quot;bk_next_name&quot;: &quot;主机&quot;,
      &quot;bk_pre_obj_id&quot;: &quot;set&quot;,
      &quot;bk_pre_obj_name&quot;: &quot;集群&quot;
    },
    {
      &quot;bk_obj_id&quot;: &quot;host&quot;,
      &quot;bk_obj_name&quot;: &quot;主机&quot;,
      &quot;bk_supplier_account&quot;: &quot;0&quot;,
      &quot;bk_next_obj&quot;: &quot;&quot;,
      &quot;bk_next_name&quot;: &quot;&quot;,
      &quot;bk_pre_obj_id&quot;: &quot;module&quot;,
      &quot;bk_pre_obj_name&quot;: &quot;模块&quot;
    }
  ]
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_obj_id</td>
<td>string</td>
<td>模型的唯一 ID</td>
</tr>
<tr>
<td>bk_obj_name</td>
<td>string</td>
<td>模型名称</td>
</tr>
<tr>
<td>bk_supplier_account</td>
<td>string</td>
<td>开发商帐户名称</td>
</tr>
<tr>
<td>bk_next_obj</td>
<td>string</td>
<td>当前模型的下一个模型唯一 ID</td>
</tr>
<tr>
<td>bk_next_name</td>
<td>string</td>
<td>当前模型的下一个模型名称</td>
</tr>
<tr>
<td>bk_pre_obj_id</td>
<td>string</td>
<td>当前模型的前一个模型的唯一 ID</td>
</tr>
<tr>
<td>bk_pre_obj_name</td>
<td>string</td>
<td>当前模型的前一个模型的名称</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/get_operation_log/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>获取操作日志</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>condition</td>
<td>object</td>
<td>否</td>
<td>查询条件</td>
</tr>
<tr>
<td>start</td>
<td>int</td>
<td>否</td>
<td>记录开始位置</td>
</tr>
<tr>
<td>limit</td>
<td>int</td>
<td>是</td>
<td>每页限制条数，最大 200</td>
</tr>
<tr>
<td>sort</td>
<td>string</td>
<td>否</td>
<td>排序字段</td>
</tr>
</tbody>
</table>
<h4 id="condition">condition 字段说明</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>audit_type</td>
<td>string</td>
<td>否</td>
<td>操作的资源类型大类</td>
</tr>
<tr>
<td>user</td>
<td>string</td>
<td>否</td>
<td>操作人</td>
</tr>
<tr>
<td>resource_type</td>
<td>string array</td>
<td>否</td>
<td>操作的具体资源类型</td>
</tr>
<tr>
<td>action</td>
<td>string array</td>
<td>否</td>
<td>操作类型</td>
</tr>
<tr>
<td>operate_from</td>
<td>string</td>
<td>否</td>
<td>操作的来源</td>
</tr>
<tr>
<td>operation_time</td>
<td>string array</td>
<td>否</td>
<td>操作开始和结束时间成对出现</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>否</td>
<td>业务 ID</td>
</tr>
<tr>
<td>resource_id</td>
<td>int</td>
<td>否</td>
<td>资源 ID</td>
</tr>
<tr>
<td>resource_name</td>
<td>string</td>
<td>否</td>
<td>资源名称</td>
</tr>
<tr>
<td>category</td>
<td>string</td>
<td>否</td>
<td>前端使用的资源分类</td>
</tr>
<tr>
<td>label</td>
<td>string array</td>
<td>否</td>
<td>资源标签</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;bk_supplier_account&quot;: &quot;0&quot;,
    &quot;condition&quot;: {
        &quot;audit_type&quot;: &quot;business_resource&quot;,
        &quot;user&quot;: &quot;admin&quot;,
        &quot;resource_type&quot;: [
            &quot;business&quot;,
            &quot;module&quot;
        ],
        &quot;action&quot;: [
            &quot;create&quot;,
            &quot;update&quot;
        ],
        &quot;operate_from&quot;: &quot;user&quot;,
        &quot;operation_time&quot;: [
            &quot;2020-04-03 00:00:00&quot;,
            &quot;2020-04-03 18:00:00&quot;
        ],
        &quot;bk_biz_id&quot;: 6,
        &quot;resource_id&quot;: 120,
        &quot;resource_name&quot;: &quot;test&quot;,
        &quot;category&quot;: &quot;business&quot;,
        &quot;label&quot;: [
            &quot;biz_topology&quot;
        ]
    },
    &quot;start&quot;: 0,
    &quot;limit&quot;: 10,
    &quot;sort&quot;: &quot;-operation_time&quot;
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: null,
    &quot;data&quot;: {
        &quot;count&quot;: 1,
        &quot;info&quot;: [
            {
                &quot;audit_type&quot;: &quot;business_resource&quot;,
                &quot;bk_supplier_account&quot;: &quot;0&quot;,
                &quot;user&quot;: &quot;admin&quot;,
                &quot;resource_type&quot;: &quot;module&quot;,
                &quot;action&quot;: &quot;create&quot;,
                &quot;operate_from&quot;: &quot;user&quot;,
                &quot;operation_detail&quot;: {
                    &quot;bk_biz_id&quot;: 6,
                    &quot;bk_biz_name&quot;: &quot;test_biz&quot;,
                    &quot;resource_id&quot;: 120,
                    &quot;resource_name&quot;: &quot;test&quot;,
                    &quot;details&quot;: {
                        &quot;pre_data&quot;: null,
                        &quot;cur_data&quot;: {
                            &quot;bk_bak_operator&quot;: &quot;&quot;,
                            &quot;bk_biz_id&quot;: 6,
                            &quot;bk_childid&quot;: null,
                            &quot;bk_module_id&quot;: 120,
                            &quot;bk_module_name&quot;: &quot;test&quot;,
                            &quot;bk_module_type&quot;: &quot;1&quot;,
                            &quot;bk_parent_id&quot;: 51,
                            &quot;bk_set_id&quot;: 51,
                            &quot;bk_supplier_account&quot;: &quot;0&quot;,
                            &quot;create_time&quot;: &quot;2020-04-03T09:55:30.574+08:00&quot;,
                            &quot;default&quot;: 0,
                            &quot;last_time&quot;: &quot;2020-04-03T09:55:30.574+08:00&quot;,
                            &quot;operator&quot;: &quot;&quot;
                        },
                        &quot;properties&quot;: [
                            {
                                &quot;bk_property_id&quot;: &quot;bk_biz_id&quot;,
                                &quot;bk_property_name&quot;: &quot;业务ID&quot;
                            },
                            {
                                &quot;bk_property_id&quot;: &quot;bk_set_id&quot;,
                                &quot;bk_property_name&quot;: &quot;集群ID&quot;
                            },
                            {
                                &quot;bk_property_id&quot;: &quot;bk_module_name&quot;,
                                &quot;bk_property_name&quot;: &quot;模块名&quot;
                            },
                            {
                                &quot;bk_property_id&quot;: &quot;bk_childid&quot;,
                                &quot;bk_property_name&quot;: &quot;&quot;
                            },
                            {
                                &quot;bk_property_id&quot;: &quot;bk_module_type&quot;,
                                &quot;bk_property_name&quot;: &quot;模块类型&quot;
                            },
                            {
                                &quot;bk_property_id&quot;: &quot;operator&quot;,
                                &quot;bk_property_name&quot;: &quot;主要维护人&quot;
                            },
                            {
                                &quot;bk_property_id&quot;: &quot;bk_bak_operator&quot;,
                                &quot;bk_property_name&quot;: &quot;备份维护人&quot;
                            }
                        ]
                    },
                    &quot;bk_obj_id&quot;: &quot;module&quot;
                },
                &quot;operation_time&quot;: &quot;2020-04-03 09:55:30&quot;,
                &quot;label&quot;: {
                    &quot;biz_topology&quot;: &quot;&quot;
                }
            }
        ]
    }
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>请求成功与否。true:请求成功；false 请求失败</td>
</tr>
<tr>
<td>code</td>
<td>int</td>
<td>错误编码。 0 表示 success，&gt;0 表示失败错误</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>请求失败返回的错误信息</td>
</tr>
<tr>
<td>data</td>
<td>object</td>
<td>请求返回的数据</td>
</tr>
</tbody>
</table>
<h4 id="data">data 字段说明</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>count</td>
<td>int</td>
<td>请求记录条数</td>
</tr>
<tr>
<td>info</td>
<td>object array</td>
<td>请求记录数据</td>
</tr>
</tbody>
</table>
<h4 id="info">info 字段说明</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>audit_type</td>
<td>string</td>
<td>操作的资源类型大类</td>
</tr>
<tr>
<td>user</td>
<td>string</td>
<td>操作人</td>
</tr>
<tr>
<td>bk_supplier_account</td>
<td>string</td>
<td>开发商 ID</td>
</tr>
<tr>
<td>resource_type</td>
<td>string</td>
<td>操作的具体资源类型</td>
</tr>
<tr>
<td>action</td>
<td>string</td>
<td>操作类型</td>
</tr>
<tr>
<td>operate_from</td>
<td>string</td>
<td>操作的来源</td>
</tr>
<tr>
<td>operation_detail</td>
<td>object</td>
<td>实际操作内容</td>
</tr>
<tr>
<td>operation_time</td>
<td>string</td>
<td>操作时间</td>
</tr>
<tr>
<td>label</td>
<td>object</td>
<td>资源标签</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/get_proc_template/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>获取单个进程模板信息，url 参数中指定进程模板 ID</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 ID</td>
</tr>
<tr>
<td>process_template_id</td>
<td>int</td>
<td>是</td>
<td>进程模板 ID</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
  &quot;bk_biz_id&quot;: 1,
  &quot;process_template_id&quot;: 49,
  &quot;bk_supplier_account&quot;: &quot;0&quot;
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
  &quot;result&quot;: true,
  &quot;code&quot;: 0,
  &quot;message&quot;: &quot;success&quot;,
  &quot;permission&quot;: null,
  &quot;data&quot;: {
    &quot;count&quot;: 1,
    &quot;info&quot;: [
      {
        &quot;bk_biz_id&quot;: 1,
        &quot;id&quot;: 49,
        &quot;name&quot;: &quot;10.27.0.9_p1_81&quot;,
        &quot;service_template_id&quot;: 50,
        &quot;bk_host_id&quot;: 11,
        &quot;bk_host_innerip&quot;: &quot;10.27.0.9&quot;,
        &quot;bk_module_id&quot;: 56,
        &quot;creator&quot;: &quot;admin&quot;,
        &quot;modifier&quot;: &quot;admin&quot;,
        &quot;create_time&quot;: &quot;2019-07-22T09:54:50.906+08:00&quot;,
        &quot;last_time&quot;: &quot;2019-07-22T09:54:50.906+08:00&quot;,
        &quot;bk_supplier_account&quot;: &quot;0&quot;,
        &quot;service_category_id&quot;: 22,
        &quot;process_instances&quot;: [
          {
            &quot;process&quot;: {
              &quot;bk_biz_id&quot;: 1,
              &quot;proc_num&quot;: 0,
              &quot;stop_cmd&quot;: &quot;&quot;,
              &quot;restart_cmd&quot;: &quot;&quot;,
              &quot;face_stop_cmd&quot;: &quot;&quot;,
              &quot;bk_process_id&quot;: 43,
              &quot;bk_func_name&quot;: &quot;p1&quot;,
              &quot;work_path&quot;: &quot;&quot;,
              &quot;bind_ip&quot;: &quot;0.0.0.0&quot;,
              &quot;priority&quot;: 0,
              &quot;reload_cmd&quot;: &quot;&quot;,
              &quot;bk_process_name&quot;: &quot;p1&quot;,
              &quot;port&quot;: &quot;81&quot;,
              &quot;pid_file&quot;: &quot;&quot;,
              &quot;auto_start&quot;: false,
              &quot;auto_time_gap&quot;: 0,
              &quot;last_time&quot;: &quot;2019-07-22T09:54:50.927+08:00&quot;,
              &quot;create_time&quot;: &quot;2019-07-22T09:54:50.927+08:00&quot;,
              &quot;bk_biz_id&quot;: 3,
              &quot;start_cmd&quot;: &quot;&quot;,
              &quot;bk_func_id&quot;: &quot;&quot;,
              &quot;user&quot;: &quot;&quot;,
              &quot;timeout&quot;: 0,
              &quot;protocol&quot;: &quot;1&quot;,
              &quot;description&quot;: &quot;&quot;,
              &quot;bk_supplier_account&quot;: &quot;0&quot;,
              &quot;bk_start_param_regex&quot;: &quot;&quot;
            },
            &quot;relation&quot;: {
              &quot;bk_biz_id&quot;: 1,
              &quot;bk_process_id&quot;: 43,
              &quot;service_instance_id&quot;: 49,
              &quot;process_template_id&quot;: 48,
              &quot;bk_host_id&quot;: 11,
              &quot;bk_supplier_account&quot;: &quot;0&quot;
            }
          }
        ]
      }
    ]
  }
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="response">response</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>请求成功与否。true:请求成功；false 请求失败</td>
</tr>
<tr>
<td>code</td>
<td>int</td>
<td>错误编码。 0 表示 success，&gt;0 表示失败错误</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>请求失败返回的错误信息</td>
</tr>
<tr>
<td>data</td>
<td>object</td>
<td>请求返回的数据</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/get_service_template/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>根据服务模板 ID 获取服务模板</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>service_template_id</td>
<td>int</td>
<td>是</td>
<td>服务模板 ID</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-json">{
  &quot;bk_supplier_account&quot;: &quot;0&quot;,
  &quot;service_template_id&quot;: 51
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;success&quot;,
    &quot;data&quot;: {
        &quot;bk_biz_id&quot;: 3,
        &quot;id&quot;: 51,
        &quot;name&quot;: &quot;mm2&quot;,
        &quot;service_category_id&quot;: 12,
        &quot;creator&quot;: &quot;admin&quot;,
        &quot;modifier&quot;: &quot;admin&quot;,
        &quot;create_time&quot;: &quot;2020-05-26T09:46:15.259Z&quot;,
        &quot;last_time&quot;: &quot;2020-05-26T09:46:15.259Z&quot;,
        &quot;bk_supplier_account&quot;: &quot;0&quot;
    }
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="response">response</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>请求成功与否。true:请求成功；false 请求失败</td>
</tr>
<tr>
<td>code</td>
<td>int</td>
<td>错误编码。 0 表示 success，&gt;0 表示失败错误</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>请求失败返回的错误信息</td>
</tr>
<tr>
<td>data</td>
<td>object</td>
<td>请求返回的数据</td>
</tr>
</tbody>
</table>
<h4 id="data">data 字段说明</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>integer</td>
<td>服务模板 ID</td>
</tr>
<tr>
<td>name</td>
<td>array</td>
<td>服务模板名称</td>
</tr>
<tr>
<td>service_category_id</td>
<td>integer</td>
<td>服务分类 ID</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/list_biz_hosts/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>根据业务 ID 查询业务下的主机，可附带其他的过滤信息，如集群 id,模块 id 等</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>page</td>
<td>dict</td>
<td>否</td>
<td>查询条件</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 id</td>
</tr>
<tr>
<td>bk_set_ids</td>
<td>array</td>
<td>否</td>
<td>集群 ID 列表，最多 200 条</td>
</tr>
<tr>
<td>set_cond</td>
<td>array</td>
<td>否</td>
<td>集群查询条件</td>
</tr>
<tr>
<td>bk_module_ids</td>
<td>array</td>
<td>否</td>
<td>模块 ID 列表，最多 500 条</td>
</tr>
<tr>
<td>host_property_filter</td>
<td>object</td>
<td>否</td>
<td>主机属性组合查询条件</td>
</tr>
<tr>
<td>fields</td>
<td>array</td>
<td>是</td>
<td>主机属性列表，控制返回结果的主机里有哪些字段，能够加速接口请求和减少网络流量传输</td>
</tr>
</tbody>
</table>
<h4 id="host_property_filter">host_property_filter</h4>
<p>该参数为主机属性字段过滤规则的组合，用于根据主机属性字段搜索主机。组合支持 AND 和 OR 两种方式，可以嵌套，最多嵌套 2 层。
过滤规则为四元组 <code>field</code>, <code>operator</code>, <code>value</code></p>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>说明</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>field</td>
<td>string</td>
<td>是</td>
<td>无</td>
<td>字段名</td>
<td></td>
</tr>
<tr>
<td>operator</td>
<td>string</td>
<td>是</td>
<td>无</td>
<td>操作符</td>
<td>可选值 equal,not_equal,in,not_in,less,less_or_equal,greater,greater_or_equal,between,not_between</td>
</tr>
<tr>
<td>value</td>
<td>-</td>
<td>否</td>
<td>无</td>
<td>操作数</td>
<td>不同的 operator 对应不同的 value 格式</td>
</tr>
</tbody>
</table>
<p>组装规则可参考: <a href="https://github.com/Tencent/bk-cmdb/blob/master/src/common/querybuilder/README.md">https://github.com/Tencent/bk-cmdb/blob/master/src/common/querybuilder/README.md</a></p>
<h4 id="set_cond">set_cond</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>field</td>
<td>string</td>
<td>是</td>
<td>取值为集群的字段</td>
</tr>
<tr>
<td>operator</td>
<td>string</td>
<td>是</td>
<td>取值为：$eq $ne</td>
</tr>
<tr>
<td>value</td>
<td>string</td>
<td>是</td>
<td>field 配置的集群字段所对应的值</td>
</tr>
</tbody>
</table>
<h4 id="page">page</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>start</td>
<td>int</td>
<td>是</td>
<td>记录开始位置</td>
</tr>
<tr>
<td>limit</td>
<td>int</td>
<td>是</td>
<td>每页限制条数,最大 500</td>
</tr>
<tr>
<td>sort</td>
<td>string</td>
<td>否</td>
<td>排序字段</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_supplier_account&quot;: &quot;0&quot;,
    &quot;page&quot;: {
        &quot;start&quot;: 0,
        &quot;limit&quot;: 10,
        &quot;sort&quot;: &quot;bk_host_id&quot;
    },
    &quot;set_cond&quot;: [
        {
            &quot;field&quot;: &quot;bk_set_name&quot;,
            &quot;operator&quot;: &quot;$eq&quot;,
            &quot;value&quot;: &quot;set1&quot;
        }
    ],
    &quot;bk_biz_id&quot;: 3,
    &quot;bk_module_ids&quot;: [54,56],
    &quot;fields&quot;: [
        &quot;bk_host_id&quot;,
        &quot;bk_cloud_id&quot;,
        &quot;bk_host_innerip&quot;,
        &quot;bk_os_type&quot;,
        &quot;bk_mac&quot;
    ],
    &quot;host_property_filter&quot;: {
        &quot;condition&quot;: &quot;AND&quot;,
        &quot;rules&quot;: [
            {
                &quot;field&quot;: &quot;bk_host_innerip&quot;,
                &quot;operator&quot;: &quot;begins_with&quot;,
                &quot;value&quot;: &quot;192.168&quot;
            },
            {
                &quot;condition&quot;: &quot;OR&quot;,
                &quot;rules&quot;: [
                    {
                        &quot;field&quot;: &quot;bk_os_type&quot;,
                        &quot;operator&quot;: &quot;not_in&quot;,
                        &quot;value&quot;: [
                            &quot;3&quot;
                        ]
                    },
                    {
                        &quot;field&quot;: &quot;bk_cloud_id&quot;,
                        &quot;operator&quot;: &quot;equal&quot;,
                        &quot;value&quot;: 0
                    }
                ]
            }
        ]
    }
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-json">{
  &quot;result&quot;: true,
  &quot;code&quot;: 0,
  &quot;message&quot;: &quot;success&quot;,
  &quot;data&quot;: {
    &quot;count&quot;: 2,
    &quot;info&quot;: [
      {
        &quot;bk_cloud_id&quot;: 0,
        &quot;bk_host_id&quot;: 1,
        &quot;bk_host_innerip&quot;: &quot;192.168.15.18&quot;,
        &quot;bk_mac&quot;: &quot;&quot;,
        &quot;bk_os_type&quot;: null
      },
      {
        &quot;bk_cloud_id&quot;: 0,
        &quot;bk_host_id&quot;: 2,
        &quot;bk_host_innerip&quot;: &quot;192.168.15.4&quot;,
        &quot;bk_mac&quot;: &quot;&quot;,
        &quot;bk_os_type&quot;: null
      }
    ]
  }
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>count</td>
<td>int</td>
<td>记录条数</td>
</tr>
<tr>
<td>info</td>
<td>array</td>
<td>主机实际数据</td>
</tr>
</tbody>
</table>
<h4 id="datainfo">data.info</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_isp_name</td>
<td>string</td>
<td>所属运营商</td>
<td>0:其它；1:电信；2:联通；3:移动</td>
</tr>
<tr>
<td>bk_sn</td>
<td>string</td>
<td>设备 SN</td>
<td></td>
</tr>
<tr>
<td>operator</td>
<td>string</td>
<td>主要维护人</td>
<td></td>
</tr>
<tr>
<td>bk_outer_mac</td>
<td>string</td>
<td>外网 MAC</td>
<td></td>
</tr>
<tr>
<td>bk_state_name</td>
<td>string</td>
<td>所在国家</td>
<td>CN:中国，详细值，请参考 CMDB 页面</td>
</tr>
<tr>
<td>bk_province_name</td>
<td>string</td>
<td>所在省份</td>
<td></td>
</tr>
<tr>
<td>import_from</td>
<td>string</td>
<td>录入方式</td>
<td>1:excel;2:agent;3:api</td>
</tr>
<tr>
<td>bk_sla</td>
<td>string</td>
<td>SLA 级别</td>
<td>1:L1;2:L2;3:L3</td>
</tr>
<tr>
<td>bk_service_term</td>
<td>int</td>
<td>质保年限</td>
<td>1-10</td>
</tr>
<tr>
<td>bk_os_type</td>
<td>string</td>
<td>操作系统类型</td>
<td>1:Linux;2:Windows;3:AIX</td>
</tr>
<tr>
<td>bk_os_version</td>
<td>string</td>
<td>操作系统版本</td>
<td></td>
</tr>
<tr>
<td>bk_os_bit</td>
<td>int</td>
<td>操作系统位数</td>
<td></td>
</tr>
<tr>
<td>bk_mem</td>
<td>string</td>
<td>内存容量</td>
<td></td>
</tr>
<tr>
<td>bk_mac</td>
<td>string</td>
<td>内网 MAC 地址</td>
<td></td>
</tr>
<tr>
<td>bk_host_outerip</td>
<td>string</td>
<td>外网 IP</td>
<td></td>
</tr>
<tr>
<td>bk_host_name</td>
<td>string</td>
<td>主机名称</td>
<td></td>
</tr>
<tr>
<td>bk_host_innerip</td>
<td>string</td>
<td>内网 IP</td>
<td></td>
</tr>
<tr>
<td>bk_host_id</td>
<td>int</td>
<td>主机 ID</td>
<td></td>
</tr>
<tr>
<td>bk_disk</td>
<td>int</td>
<td>磁盘容量</td>
<td></td>
</tr>
<tr>
<td>bk_cpu_module</td>
<td>string</td>
<td>CPU 型号</td>
<td></td>
</tr>
<tr>
<td>bk_cpu_mhz</td>
<td>int</td>
<td>CPU 频率</td>
<td></td>
</tr>
<tr>
<td>bk_cpu</td>
<td>int</td>
<td>CPU 逻辑核心数</td>
<td>1-1000000</td>
</tr>
<tr>
<td>bk_comment</td>
<td>string</td>
<td>备注</td>
<td></td>
</tr>
<tr>
<td>bk_cloud_id</td>
<td>int</td>
<td>云区域</td>
<td></td>
</tr>
<tr>
<td>bk_bak_operator</td>
<td>string</td>
<td>备份维护人</td>
<td></td>
</tr>
<tr>
<td>bk_asset_id</td>
<td>string</td>
<td>固资编号</td>
<td></td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/list_biz_hosts_topo/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>查询业务 id 业务下的主机和拓扑信息,可附带一些查询条件</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 id</td>
</tr>
<tr>
<td>page</td>
<td>dict</td>
<td>否</td>
<td>查询条件</td>
</tr>
<tr>
<td>host_property_filter</td>
<td>object</td>
<td>否</td>
<td>主机属性组合查询条件</td>
</tr>
<tr>
<td>fields</td>
<td>array</td>
<td>是</td>
<td>主机属性列表，控制返回结果的主机里有哪些字段，能够加速接口请求和减少网络流量传输</td>
</tr>
</tbody>
</table>
<h4 id="host_property_filter">host_property_filter</h4>
<p>该参数为主机属性字段过滤规则的组合，用于根据主机属性字段搜索主机。组合支持 AND 和 OR 两种方式，可以嵌套，最多嵌套 2 层。
过滤规则为四元组 <code>field</code>, <code>operator</code>, <code>value</code></p>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>说明</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>field</td>
<td>string</td>
<td>是</td>
<td>无</td>
<td>字段名</td>
<td></td>
</tr>
<tr>
<td>operator</td>
<td>string</td>
<td>是</td>
<td>无</td>
<td>操作符</td>
<td>可选值 equal,not_equal,in,not_in,less,less_or_equal,greater,greater_or_equal,between,not_between</td>
</tr>
<tr>
<td>value</td>
<td>-</td>
<td>否</td>
<td>无</td>
<td>操作数</td>
<td>不同的 operator 对应不同的 value 格式</td>
</tr>
</tbody>
</table>
<p>组装规则可参考: <a href="https://github.com/Tencent/bk-cmdb/blob/master/src/common/querybuilder/README.md">https://github.com/Tencent/bk-cmdb/blob/master/src/common/querybuilder/README.md</a></p>
<h4 id="page">page</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>start</td>
<td>int</td>
<td>是</td>
<td>记录开始位置</td>
</tr>
<tr>
<td>limit</td>
<td>int</td>
<td>是</td>
<td>每页限制条数,最大值为 500</td>
</tr>
<tr>
<td>sort</td>
<td>string</td>
<td>否</td>
<td>排序字段</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_supplier_account&quot;: &quot;0&quot;,
    &quot;page&quot;: {
        &quot;start&quot;: 0,
        &quot;limit&quot;: 10,
        &quot;sort&quot;: &quot;bk_host_id&quot;
    },
    &quot;fields&quot;: [
        &quot;bk_host_id&quot;,
        &quot;bk_cloud_id&quot;,
        &quot;bk_host_innerip&quot;,
        &quot;bk_os_type&quot;,
        &quot;bk_mac&quot;
    ],
    &quot;host_property_filter&quot;: {
        &quot;condition&quot;: &quot;AND&quot;,
        &quot;rules&quot;: [
            {
                &quot;field&quot;: &quot;bk_host_innerip&quot;,
                &quot;operator&quot;: &quot;begins_with&quot;,
                &quot;value&quot;: &quot;192.168&quot;
            },
            {
                &quot;condition&quot;: &quot;OR&quot;,
                &quot;rules&quot;: [
                    {
                        &quot;field&quot;: &quot;bk_os_type&quot;,
                        &quot;operator&quot;: &quot;not_in&quot;,
                        &quot;value&quot;: [
                            &quot;3&quot;
                        ]
                    },
                    {
                        &quot;field&quot;: &quot;bk_cloud_id&quot;,
                        &quot;operator&quot;: &quot;equal&quot;,
                        &quot;value&quot;: 0
                    }
                ]
            }
        ]
    }
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-json">{
  &quot;result&quot;: true,
  &quot;code&quot;: 0,
  &quot;message&quot;: &quot;success&quot;,
  &quot;data&quot;: {
    &quot;count&quot;: 3,
    &quot;info&quot;: [
      {
        &quot;host&quot;: {
          &quot;bk_cloud_id&quot;: 0,
          &quot;bk_host_id&quot;: 1,
          &quot;bk_host_innerip&quot;: &quot;192.168.15.18&quot;,
          &quot;bk_mac&quot;: &quot;&quot;,
          &quot;bk_os_type&quot;: null
        },
        &quot;topo&quot;: [
          {
            &quot;bk_set_id&quot;: 11,
            &quot;bk_set_name&quot;: &quot;set1&quot;,
            &quot;module&quot;: [
              {
                &quot;bk_module_id&quot;: 56,
                &quot;bk_module_name&quot;: &quot;m1&quot;
              }
            ]
          }
        ]
      },
      {
        &quot;host&quot;: {
          &quot;bk_cloud_id&quot;: 0,
          &quot;bk_host_id&quot;: 2,
          &quot;bk_host_innerip&quot;: &quot;192.168.15.4&quot;,
          &quot;bk_mac&quot;: &quot;&quot;,
          &quot;bk_os_type&quot;: null
        },
        &quot;topo&quot;: [
          {
            &quot;bk_set_id&quot;: 11,
            &quot;bk_set_name&quot;: &quot;set1&quot;,
            &quot;module&quot;: [
              {
                &quot;bk_module_id&quot;: 56,
                &quot;bk_module_name&quot;: &quot;m1&quot;
              }
            ]
          }
        ]
      },
      {
        &quot;host&quot;: {
          &quot;bk_cloud_id&quot;: 0,
          &quot;bk_host_id&quot;: 3,
          &quot;bk_host_innerip&quot;: &quot;192.168.15.12&quot;,
          &quot;bk_mac&quot;: &quot;&quot;,
          &quot;bk_os_type&quot;: null
        },
        &quot;topo&quot;: [
          {
            &quot;bk_set_id&quot;: 10,
            &quot;bk_set_name&quot;: &quot;空闲机池&quot;,
            &quot;module&quot;: [
              {
                &quot;bk_module_id&quot;: 54,
                &quot;bk_module_name&quot;: &quot;空闲机&quot;
              }
            ]
          }
        ]
      }
    ]
  }
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>count</td>
<td>int</td>
<td>记录条数</td>
</tr>
<tr>
<td>info</td>
<td>array</td>
<td>主机数据和拓扑信息</td>
</tr>
</tbody>
</table>
<h4 id="datainfo">data.info</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>host</td>
<td>dict</td>
<td>主机实际数据</td>
</tr>
<tr>
<td>topo</td>
<td>array</td>
<td>主机拓扑信息</td>
</tr>
</tbody>
</table>
<h4 id="datainfohost">data.info.host</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_isp_name</td>
<td>string</td>
<td>所属运营商</td>
<td>0:其它；1:电信；2:联通；3:移动</td>
</tr>
<tr>
<td>bk_sn</td>
<td>string</td>
<td>设备 SN</td>
<td></td>
</tr>
<tr>
<td>operator</td>
<td>string</td>
<td>主要维护人</td>
<td></td>
</tr>
<tr>
<td>bk_outer_mac</td>
<td>string</td>
<td>外网 MAC</td>
<td></td>
</tr>
<tr>
<td>bk_state_name</td>
<td>string</td>
<td>所在国家</td>
<td>CN:中国，详细值，请参考 CMDB 页面</td>
</tr>
<tr>
<td>bk_province_name</td>
<td>string</td>
<td>所在省份</td>
<td></td>
</tr>
<tr>
<td>import_from</td>
<td>string</td>
<td>录入方式</td>
<td>1:excel;2:agent;3:api</td>
</tr>
<tr>
<td>bk_sla</td>
<td>string</td>
<td>SLA 级别</td>
<td>1:L1;2:L2;3:L3</td>
</tr>
<tr>
<td>bk_service_term</td>
<td>int</td>
<td>质保年限</td>
<td>1-10</td>
</tr>
<tr>
<td>bk_os_type</td>
<td>string</td>
<td>操作系统类型</td>
<td>1:Linux;2:Windows;3:AIX</td>
</tr>
<tr>
<td>bk_os_version</td>
<td>string</td>
<td>操作系统版本</td>
<td></td>
</tr>
<tr>
<td>bk_os_bit</td>
<td>int</td>
<td>操作系统位数</td>
<td></td>
</tr>
<tr>
<td>bk_mem</td>
<td>string</td>
<td>内存容量</td>
<td></td>
</tr>
<tr>
<td>bk_mac</td>
<td>string</td>
<td>内网 MAC 地址</td>
<td></td>
</tr>
<tr>
<td>bk_host_outerip</td>
<td>string</td>
<td>外网 IP</td>
<td></td>
</tr>
<tr>
<td>bk_host_name</td>
<td>string</td>
<td>主机名称</td>
<td></td>
</tr>
<tr>
<td>bk_host_innerip</td>
<td>string</td>
<td>内网 IP</td>
<td></td>
</tr>
<tr>
<td>bk_host_id</td>
<td>int</td>
<td>主机 ID</td>
<td></td>
</tr>
<tr>
<td>bk_disk</td>
<td>int</td>
<td>磁盘容量</td>
<td></td>
</tr>
<tr>
<td>bk_cpu_module</td>
<td>string</td>
<td>CPU 型号</td>
<td></td>
</tr>
<tr>
<td>bk_cpu_mhz</td>
<td>int</td>
<td>CPU 频率</td>
<td></td>
</tr>
<tr>
<td>bk_cpu</td>
<td>int</td>
<td>CPU 逻辑核心数</td>
<td>1-1000000</td>
</tr>
<tr>
<td>bk_comment</td>
<td>string</td>
<td>备注</td>
<td></td>
</tr>
<tr>
<td>bk_cloud_id</td>
<td>int</td>
<td>云区域</td>
<td></td>
</tr>
<tr>
<td>bk_bak_operator</td>
<td>string</td>
<td>备份维护人</td>
<td></td>
</tr>
<tr>
<td>bk_asset_id</td>
<td>string</td>
<td>固资编号</td>
<td></td>
</tr>
</tbody>
</table>
<h4 id="datainfotopo">data.info.topo</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_set_id</td>
<td>int</td>
<td>主机所属的集群 ID</td>
</tr>
<tr>
<td>bk_set_name</td>
<td>string</td>
<td>主机所属的集群名字</td>
</tr>
<tr>
<td>module</td>
<td>array</td>
<td>主机所属的集群下模块信息</td>
</tr>
</tbody>
</table>
<h4 id="datainfotopomodule">data.info.topo.module</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_module_id</td>
<td>int</td>
<td>模块 ID</td>
</tr>
<tr>
<td>bk_module_name</td>
<td>string</td>
<td>模块名字</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/list_hosts_without_biz/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>没有业务信息的主机查询</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>否</td>
<td>业务 id</td>
</tr>
<tr>
<td>page</td>
<td>dict</td>
<td>是</td>
<td>查询条件</td>
</tr>
<tr>
<td>host_property_filter</td>
<td>object</td>
<td>否</td>
<td>主机属性组合查询条件</td>
</tr>
<tr>
<td>fields</td>
<td>array</td>
<td>是</td>
<td>主机属性列表，控制返回结果的主机里有哪些字段，能够加速接口请求和减少网络流量传输</td>
</tr>
</tbody>
</table>
<h4 id="host_property_filter">host_property_filter</h4>
<p>该参数为主机属性字段过滤规则的组合，用于根据主机属性字段搜索主机。组合支持 AND 和 OR 两种方式，可以嵌套，最多嵌套 2 层。
过滤规则为四元组 <code>field</code>, <code>operator</code>, <code>value</code></p>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>说明</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>field</td>
<td>string</td>
<td>是</td>
<td>无</td>
<td>字段名</td>
<td></td>
</tr>
<tr>
<td>operator</td>
<td>string</td>
<td>是</td>
<td>无</td>
<td>操作符</td>
<td>可选值 equal,not_equal,in,not_in,less,less_or_equal,greater,greater_or_equal,between,not_between</td>
</tr>
<tr>
<td>value</td>
<td>-</td>
<td>否</td>
<td>无</td>
<td>操作数</td>
<td>不同的 operator 对应不同的 value 格式</td>
</tr>
</tbody>
</table>
<p>组装规则可参考: <a href="https://github.com/Tencent/bk-cmdb/blob/master/src/common/querybuilder/README.md">https://github.com/Tencent/bk-cmdb/blob/master/src/common/querybuilder/README.md</a></p>
<h4 id="page">page</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>start</td>
<td>int</td>
<td>是</td>
<td>记录开始位置</td>
</tr>
<tr>
<td>limit</td>
<td>int</td>
<td>是</td>
<td>每页限制条数,最大 500</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_supplier_account&quot;: &quot;0&quot;,
    &quot;page&quot;: {
        &quot;start&quot;: 0,
        &quot;limit&quot;: 3
    },
    &quot;fields&quot;: [
        &quot;bk_host_id&quot;,
        &quot;bk_cloud_id&quot;,
        &quot;bk_host_innerip&quot;,
        &quot;bk_os_type&quot;,
        &quot;bk_mac&quot;
    ],
    &quot;host_property_filter&quot;: {
        &quot;condition&quot;: &quot;AND&quot;,
        &quot;rules&quot;: [
            {
                &quot;field&quot;: &quot;bk_host_innerip&quot;,
                &quot;operator&quot;: &quot;begins_with&quot;,
                &quot;value&quot;: &quot;192.168&quot;
            },
            {
                &quot;condition&quot;: &quot;OR&quot;,
                &quot;rules&quot;: [
                    {
                        &quot;field&quot;: &quot;bk_os_type&quot;,
                        &quot;operator&quot;: &quot;not_in&quot;,
                        &quot;value&quot;: [
                            &quot;3&quot;
                        ]
                    },
                    {
                        &quot;field&quot;: &quot;bk_cloud_id&quot;,
                        &quot;operator&quot;: &quot;equal&quot;,
                        &quot;value&quot;: 0
                    }
                ]
            }
        ]
    }
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-json">{
  &quot;result&quot;: true,
  &quot;code&quot;: 0,
  &quot;message&quot;: &quot;success&quot;,
  &quot;data&quot;: {
    &quot;count&quot;: 30,
    &quot;info&quot;: [
      {
        &quot;bk_cloud_id&quot;: 0,
        &quot;bk_host_id&quot;: 1,
        &quot;bk_host_innerip&quot;: &quot;192.168.15.18&quot;,
        &quot;bk_mac&quot;: &quot;&quot;,
        &quot;bk_os_type&quot;: null
      },
      {
        &quot;bk_cloud_id&quot;: 0,
        &quot;bk_host_id&quot;: 2,
        &quot;bk_host_innerip&quot;: &quot;192.168.15.4&quot;,
        &quot;bk_mac&quot;: &quot;&quot;,
        &quot;bk_os_type&quot;: null
      },
      {
        &quot;bk_cloud_id&quot;: 0,
        &quot;bk_host_id&quot;: 3,
        &quot;bk_host_innerip&quot;: &quot;192.168.15.12&quot;,
        &quot;bk_mac&quot;: &quot;&quot;,
        &quot;bk_os_type&quot;: null
      }
    ]
  }
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>count</td>
<td>int</td>
<td>记录条数</td>
</tr>
<tr>
<td>info</td>
<td>array</td>
<td>主机实际数据</td>
</tr>
</tbody>
</table>
<h4 id="datainfo">data.info</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_isp_name</td>
<td>string</td>
<td>所属运营商</td>
<td>0:其它；1:电信；2:联通；3:移动</td>
</tr>
<tr>
<td>bk_sn</td>
<td>string</td>
<td>设备 SN</td>
<td></td>
</tr>
<tr>
<td>operator</td>
<td>string</td>
<td>主要维护人</td>
<td></td>
</tr>
<tr>
<td>bk_outer_mac</td>
<td>string</td>
<td>外网 MAC</td>
<td></td>
</tr>
<tr>
<td>bk_state_name</td>
<td>string</td>
<td>所在国家</td>
<td>CN:中国，详细值，请参考 CMDB 页面</td>
</tr>
<tr>
<td>bk_province_name</td>
<td>string</td>
<td>所在省份</td>
<td></td>
</tr>
<tr>
<td>import_from</td>
<td>string</td>
<td>录入方式</td>
<td>1:excel;2:agent;3:api</td>
</tr>
<tr>
<td>bk_sla</td>
<td>string</td>
<td>SLA 级别</td>
<td>1:L1;2:L2;3:L3</td>
</tr>
<tr>
<td>bk_service_term</td>
<td>int</td>
<td>质保年限</td>
<td>1-10</td>
</tr>
<tr>
<td>bk_os_type</td>
<td>string</td>
<td>操作系统类型</td>
<td>1:Linux;2:Windows;3:AIX</td>
</tr>
<tr>
<td>bk_os_version</td>
<td>string</td>
<td>操作系统版本</td>
<td></td>
</tr>
<tr>
<td>bk_os_bit</td>
<td>int</td>
<td>操作系统位数</td>
<td></td>
</tr>
<tr>
<td>bk_mem</td>
<td>string</td>
<td>内存容量</td>
<td></td>
</tr>
<tr>
<td>bk_mac</td>
<td>string</td>
<td>内网 MAC 地址</td>
<td></td>
</tr>
<tr>
<td>bk_host_outerip</td>
<td>string</td>
<td>外网 IP</td>
<td></td>
</tr>
<tr>
<td>bk_host_name</td>
<td>string</td>
<td>主机名称</td>
<td></td>
</tr>
<tr>
<td>bk_host_innerip</td>
<td>string</td>
<td>内网 IP</td>
<td></td>
</tr>
<tr>
<td>bk_host_id</td>
<td>int</td>
<td>主机 ID</td>
<td></td>
</tr>
<tr>
<td>bk_disk</td>
<td>int</td>
<td>磁盘容量</td>
<td></td>
</tr>
<tr>
<td>bk_cpu_module</td>
<td>string</td>
<td>CPU 型号</td>
<td></td>
</tr>
<tr>
<td>bk_cpu_mhz</td>
<td>int</td>
<td>CPU 频率</td>
<td></td>
</tr>
<tr>
<td>bk_cpu</td>
<td>int</td>
<td>CPU 逻辑核心数</td>
<td>1-1000000</td>
</tr>
<tr>
<td>bk_comment</td>
<td>string</td>
<td>备注</td>
<td></td>
</tr>
<tr>
<td>bk_cloud_id</td>
<td>int</td>
<td>云区域</td>
<td></td>
</tr>
<tr>
<td>bk_bak_operator</td>
<td>string</td>
<td>备份维护人</td>
<td></td>
</tr>
<tr>
<td>bk_asset_id</td>
<td>string</td>
<td>固资编号</td>
<td></td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/list_process_detail_by_ids/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>查询某业务下进程 ID 对应的进程详情 (v3.9.8)</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必填</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>int64</td>
<td>Yes</td>
<td>进程所在的业务 ID</td>
</tr>
<tr>
<td>bk_process_ids</td>
<td>int64 array</td>
<td>Yes</td>
<td>进程 ID 列表，最多传 500 个</td>
</tr>
<tr>
<td>fields</td>
<td>string array</td>
<td>No</td>
<td>进程属性列表，控制返回结果的进程实例信息里有哪些字段，能够加速接口请求和减少网络流量传输<br>为空时返回进程所有字段,bk_process_id 为必返回字段</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;bk_process_ids&quot;: [
        43,
        44
    ],
    &quot;fields&quot;: [
        &quot;bk_process_id&quot;,
        &quot;bk_process_name&quot;,
        &quot;bk_func_id&quot;,
        &quot;bk_func_name&quot;
    ]
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;success&quot;,
    &quot;data&quot;: [
        {
            &quot;bk_func_id&quot;: &quot;&quot;,
            &quot;bk_func_name&quot;: &quot;pr1&quot;,
            &quot;bk_process_id&quot;: 43,
            &quot;bk_process_name&quot;: &quot;pr1&quot;
        },
        {
            &quot;bk_func_id&quot;: &quot;&quot;,
            &quot;bk_func_name&quot;: &quot;pr2&quot;,
            &quot;bk_process_id&quot;: 44,
            &quot;bk_process_name&quot;: &quot;pr2&quot;
        }
    ]
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>请求成功与否。true:请求成功；false 请求失败</td>
</tr>
<tr>
<td>code</td>
<td>int</td>
<td>错误编码。 0 表示 success，&gt;0 表示失败错误</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>请求失败返回的错误信息</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/list_process_instance/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>根据服务实例 ID 查询进程实例列表</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>service_instance_id</td>
<td>int</td>
<td>是</td>
<td>服务实例 ID</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
  &quot;bk_biz_id&quot;: 1,
  &quot;service_instance_id&quot;: 54
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
  &quot;result&quot;: true,
  &quot;code&quot;: 0,
  &quot;message&quot;: &quot;success&quot;,
  &quot;data&quot;: [
    {
      &quot;property&quot;: {
        &quot;auto_start&quot;: false,
        &quot;auto_time_gap&quot;: 60,
        &quot;bk_biz_id&quot;: 2,
        &quot;bk_func_id&quot;: &quot;&quot;,
        &quot;bk_func_name&quot;: &quot;java&quot;,
        &quot;bk_process_id&quot;: 46,
        &quot;bk_process_name&quot;: &quot;job_java&quot;,
        &quot;bk_start_param_regex&quot;: &quot;&quot;,
        &quot;bk_supplier_account&quot;: &quot;0&quot;,
        &quot;create_time&quot;: &quot;2019-06-05T14:59:12.065+08:00&quot;,
        &quot;description&quot;: &quot;&quot;,
        &quot;face_stop_cmd&quot;: &quot;&quot;,
        &quot;last_time&quot;: &quot;2019-06-05T14:59:12.065+08:00&quot;,
          &quot;bk_biz_id&quot;: 1,
        &quot;pid_file&quot;: &quot;&quot;,
        &quot;priority&quot;: 1,
        &quot;proc_num&quot;: 1,
        &quot;reload_cmd&quot;: &quot;&quot;,
        &quot;restart_cmd&quot;: &quot;&quot;,
        &quot;start_cmd&quot;: &quot;&quot;,
        &quot;stop_cmd&quot;: &quot;&quot;,
        &quot;timeout&quot;: 30,
        &quot;user&quot;: &quot;&quot;,
        &quot;work_path&quot;: &quot;/data/bkce&quot;,
        &quot;bind_info&quot;: [
            {
                &quot;enable&quot;: false,  
                &quot;ip&quot;: &quot;127.0.0.1&quot;,  
                &quot;port&quot;: &quot;100&quot;,  
                &quot;protocol&quot;: &quot;1&quot;, 
                &quot;template_row_id&quot;: 1  
            }
        ]
      },
      &quot;relation&quot;: {
          &quot;bk_biz_id&quot;: 1,
        &quot;bk_process_id&quot;: 46,
        &quot;service_instance_id&quot;: 54,
        &quot;process_template_id&quot;: 1,
        &quot;bk_host_id&quot;: 1,
        &quot;bk_supplier_account&quot;: &quot;&quot;
      }
    }
  ]
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="response">response</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>请求成功与否。true:请求成功；false 请求失败</td>
</tr>
<tr>
<td>code</td>
<td>int</td>
<td>错误编码。 0 表示 success，&gt;0 表示失败错误</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>请求失败返回的错误信息</td>
</tr>
<tr>
<td>data</td>
<td>array</td>
<td>请求返回的数据</td>
</tr>
</tbody>
</table>
<h4 id="data">data 字段说明</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>说明</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>property</td>
<td>object</td>
<td>进程属性信息</td>
<td></td>
</tr>
<tr>
<td>relation</td>
<td>object</td>
<td>进程与服务实例的关联信息</td>
<td></td>
</tr>
</tbody>
</table>
<h4 id="datainfoxpropertybind_infon">data.info[x].property.bind_info[n] 字段说明</h4>
<p>| 字段|类型|说明|
|---|---|---|---|
|enable|bool|端口是否启用||
|ip|string|绑定的 ip||
|port|string|绑定的端口||
|protocol|string|使用的协议||
|row_id|int|实例化使用的模板行索引，进程内唯一|</p><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/list_proc_template/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>根据服务模板 ID 查询进程模板信息</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>service_template_id</td>
<td>int</td>
<td>否</td>
<td>服务模板 ID</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
  &quot;bk_biz_id&quot;: 1,
  &quot;limit&quot;: {
    &quot;start&quot;: 0,
    &quot;limit&quot;: 1
  },
  &quot;with_name&quot;: true,
  &quot;bk_set_id&quot;: 15,
  &quot;bk_module_id&quot;: 8,
  &quot;bk_host_id&quot;: 11,
  &quot;service_instance_ids&quot;: [49],
  &quot;selectors&quot;: [{
    &quot;key&quot;: &quot;key1&quot;,
    &quot;operator&quot;: &quot;notin&quot;,
    &quot;values&quot;: [&quot;value1&quot;]
  }]
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;success&quot;,
    &quot;data&quot;: {
        &quot;count&quot;: 1,
        &quot;info&quot;: [
            {
                &quot;id&quot;: 50,
                &quot;bk_process_name&quot;: &quot;p1&quot;,
                &quot;bk_biz_id&quot;: 1,
                &quot;service_template_id&quot;: 51,
                &quot;property&quot;: {
                    &quot;proc_num&quot;: {
                        &quot;value&quot;: null,
                        &quot;as_default_value&quot;: false
                    },
                    &quot;stop_cmd&quot;: {
                        &quot;value&quot;: &quot;&quot;,
                        &quot;as_default_value&quot;: false
                    },
                    &quot;restart_cmd&quot;: {
                        &quot;value&quot;: &quot;&quot;,
                        &quot;as_default_value&quot;: false
                    },
                    &quot;face_stop_cmd&quot;: {
                        &quot;value&quot;: &quot;&quot;,
                        &quot;as_default_value&quot;: false
                    },
                    &quot;bk_func_name&quot;: {
                        &quot;value&quot;: &quot;p1&quot;,
                        &quot;as_default_value&quot;: true
                    },
                    &quot;work_path&quot;: {
                        &quot;value&quot;: &quot;&quot;,
                        &quot;as_default_value&quot;: false
                    },
                    &quot;priority&quot;: {
                        &quot;value&quot;: null,
                        &quot;as_default_value&quot;: false
                    },
                    &quot;reload_cmd&quot;: {
                        &quot;value&quot;: &quot;&quot;,
                        &quot;as_default_value&quot;: false
                    },
                    &quot;bk_process_name&quot;: {
                        &quot;value&quot;: &quot;p1&quot;,
                        &quot;as_default_value&quot;: true
                    },
                    &quot;pid_file&quot;: {
                        &quot;value&quot;: &quot;&quot;,
                        &quot;as_default_value&quot;: false
                    },
                    &quot;auto_start&quot;: {
                        &quot;value&quot;: false,
                        &quot;as_default_value&quot;: false
                    },
                    &quot;auto_time_gap&quot;: {
                        &quot;value&quot;: null,
                        &quot;as_default_value&quot;: false
                    },
                    &quot;start_cmd&quot;: {
                        &quot;value&quot;: &quot;&quot;,
                        &quot;as_default_value&quot;: false
                    },
                    &quot;bk_func_id&quot;: {
                        &quot;value&quot;: null,
                        &quot;as_default_value&quot;: false
                    },
                    &quot;user&quot;: {
                        &quot;value&quot;: &quot;&quot;,
                        &quot;as_default_value&quot;: false
                    },
                    &quot;timeout&quot;: {
                        &quot;value&quot;: null,
                        &quot;as_default_value&quot;: false
                    },
                    &quot;description&quot;: {
                        &quot;value&quot;: &quot;&quot;,
                        &quot;as_default_value&quot;: false
                    },
                    &quot;bk_start_param_regex&quot;: {
                        &quot;value&quot;: &quot;&quot;,
                        &quot;as_default_value&quot;: false
                    },
                    &quot;bind_info&quot;: {
                        &quot;value&quot;: [
                            {
                                &quot;enable&quot;: {
                                    &quot;value&quot;: false,
                                    &quot;as_default_value&quot;: true
                                },
                                &quot;ip&quot;: {
                                    &quot;value&quot;: &quot;1&quot;,
                                    &quot;as_default_value&quot;: true
                                },
                                &quot;port&quot;: {
                                    &quot;value&quot;: &quot;100&quot;,
                                    &quot;as_default_value&quot;: true
                                },
                                &quot;protocol&quot;: {
                                    &quot;value&quot;: &quot;1&quot;,
                                    &quot;as_default_value&quot;: true
                                },
                                &quot;row_id&quot;: 1
                            }
                        ],
                        &quot;as_default_value&quot;: true
                    }
                },
                &quot;creator&quot;: &quot;admin&quot;,
                &quot;modifier&quot;: &quot;admin&quot;,
                &quot;create_time&quot;: &quot;2019-06-19T15:24:04.763+08:00&quot;,
                &quot;last_time&quot;: &quot;2019-06-19T15:24:04.763+08:00&quot;,
                &quot;bk_supplier_account&quot;: &quot;0&quot;
            }
        ]
    }
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="response">response</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>请求成功与否。true:请求成功；false 请求失败</td>
</tr>
<tr>
<td>code</td>
<td>int</td>
<td>错误编码。 0 表示 success，&gt;0 表示失败错误</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>请求失败返回的错误信息</td>
</tr>
<tr>
<td>data</td>
<td>object</td>
<td>请求返回的数据</td>
</tr>
</tbody>
</table>
<h4 id="data">data 字段说明</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>说明</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>count</td>
<td>integer</td>
<td>总数</td>
<td></td>
</tr>
<tr>
<td>info</td>
<td>array</td>
<td>返回结果</td>
<td></td>
</tr>
</tbody>
</table>
<h4 id="info">info 字段说明</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>说明</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>integer</td>
<td>进程模板 ID</td>
<td></td>
</tr>
<tr>
<td>bk_process_name</td>
<td>string</td>
<td>进程模板名称</td>
<td></td>
</tr>
<tr>
<td>property</td>
<td>object</td>
<td>进程模板属性</td>
<td></td>
</tr>
</tbody>
</table>
<h4 id="datainfoxpropertybind_infovaluen">data.info[x].property.bind_info.value[n] 字段说明</h4>
<p>| 字段|类型|说明|
|---|---|---|---|
|enable|object|端口是否启用||
|ip|object|绑定的 ip||
|port|object|绑定的端口||
|protocol|object|使用的协议||
|row_id|int|模板行索引，进程内唯一|</p><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/list_resource_pool_hosts/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>查询资源池中的主机</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>page</td>
<td>dict</td>
<td>否</td>
<td>查询条件</td>
</tr>
<tr>
<td>host_property_filter</td>
<td>object</td>
<td>否</td>
<td>主机属性组合查询条件</td>
</tr>
<tr>
<td>fields</td>
<td>array</td>
<td>是</td>
<td>主机属性列表，控制返回结果的主机里有哪些字段，能够加速接口请求和减少网络流量传输</td>
</tr>
</tbody>
</table>
<h4 id="host_property_filter">host_property_filter</h4>
<p>该参数为主机属性字段过滤规则的组合，用于根据主机属性字段搜索主机。组合支持 AND 和 OR 两种方式，可以嵌套，最多嵌套 2 层。
过滤规则为四元组 <code>field</code>, <code>operator</code>, <code>value</code></p>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>必填</th>
<th>默认值</th>
<th>说明</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>field</td>
<td>string</td>
<td>是</td>
<td>无</td>
<td>字段名</td>
<td></td>
</tr>
<tr>
<td>operator</td>
<td>string</td>
<td>是</td>
<td>无</td>
<td>操作符</td>
<td>可选值 equal,not_equal,in,not_in,less,less_or_equal,greater,greater_or_equal,between,not_between</td>
</tr>
<tr>
<td>value</td>
<td>-</td>
<td>否</td>
<td>无</td>
<td>操作数</td>
<td>不同的 operator 对应不同的 value 格式</td>
</tr>
</tbody>
</table>
<p>组装规则可参考: <a href="https://github.com/Tencent/bk-cmdb/blob/master/src/common/querybuilder/README.md">https://github.com/Tencent/bk-cmdb/blob/master/src/common/querybuilder/README.md</a></p>
<h4 id="page">page</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>start</td>
<td>int</td>
<td>是</td>
<td>记录开始位置</td>
</tr>
<tr>
<td>limit</td>
<td>int</td>
<td>是</td>
<td>每页限制条数,最大 500</td>
</tr>
<tr>
<td>sort</td>
<td>string</td>
<td>否</td>
<td>排序字段</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_supplier_account&quot;: &quot;0&quot;,
    &quot;page&quot;: {
        &quot;start&quot;: 0,
        &quot;limit&quot;: 10,
        &quot;sort&quot;: &quot;bk_host_id&quot;
    },
    &quot;fields&quot;: [
        &quot;bk_host_id&quot;,
        &quot;bk_cloud_id&quot;,
        &quot;bk_host_innerip&quot;,
        &quot;bk_os_type&quot;,
        &quot;bk_mac&quot;
    ],
    &quot;host_property_filter&quot;: {
        &quot;condition&quot;: &quot;AND&quot;,
        &quot;rules&quot;: [
        {
            &quot;field&quot;: &quot;bk_host_outerip&quot;,
            &quot;operator&quot;: &quot;begins_with&quot;,
            &quot;value&quot;: &quot;127.0&quot;
        }, {
            &quot;condition&quot;: &quot;OR&quot;,
            &quot;rules&quot;: [{
                &quot;field&quot;: &quot;bk_os_type&quot;,
                &quot;operator&quot;: &quot;not_in&quot;,
                &quot;value&quot;: [&quot;3&quot;]
            }, {
                &quot;field&quot;: &quot;bk_sla&quot;,
                &quot;operator&quot;: &quot;equal&quot;,
                &quot;value&quot;: &quot;1&quot;
            }]
        }]
    }
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-json">{
  &quot;result&quot;: true,
  &quot;code&quot;: 0,
  &quot;message&quot;: &quot;success&quot;,
  &quot;data&quot;: {
    &quot;count&quot;: 1,
    &quot;info&quot;: [
      {
        &quot;bk_cloud_id&quot;: &quot;0&quot;,
        &quot;bk_host_id&quot;: 17,
        &quot;bk_host_innerip&quot;: &quot;192.168.1.1&quot;,
        &quot;bk_mac&quot;: &quot;&quot;,
        &quot;bk_os_type&quot;: &quot;1&quot;
      }
    ]
  }
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>count</td>
<td>int</td>
<td>记录条数</td>
</tr>
<tr>
<td>info</td>
<td>array</td>
<td>主机实际数据</td>
</tr>
</tbody>
</table>
<h4 id="datainfo">data.info</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_isp_name</td>
<td>string</td>
<td>所属运营商</td>
<td>0:其它；1:电信；2:联通；3:移动</td>
</tr>
<tr>
<td>bk_sn</td>
<td>string</td>
<td>设备 SN</td>
<td></td>
</tr>
<tr>
<td>operator</td>
<td>string</td>
<td>主要维护人</td>
<td></td>
</tr>
<tr>
<td>bk_outer_mac</td>
<td>string</td>
<td>外网 MAC</td>
<td></td>
</tr>
<tr>
<td>bk_state_name</td>
<td>string</td>
<td>所在国家</td>
<td>CN:中国，详细值，请参考 CMDB 页面</td>
</tr>
<tr>
<td>bk_province_name</td>
<td>string</td>
<td>所在省份</td>
<td></td>
</tr>
<tr>
<td>import_from</td>
<td>string</td>
<td>录入方式</td>
<td>1:excel;2:agent;3:api</td>
</tr>
<tr>
<td>bk_sla</td>
<td>string</td>
<td>SLA 级别</td>
<td>1:L1;2:L2;3:L3</td>
</tr>
<tr>
<td>bk_service_term</td>
<td>int</td>
<td>质保年限</td>
<td>1-10</td>
</tr>
<tr>
<td>bk_os_type</td>
<td>string</td>
<td>操作系统类型</td>
<td>1:Linux;2:Windows;3:AIX</td>
</tr>
<tr>
<td>bk_os_version</td>
<td>string</td>
<td>操作系统版本</td>
<td></td>
</tr>
<tr>
<td>bk_os_bit</td>
<td>int</td>
<td>操作系统位数</td>
<td></td>
</tr>
<tr>
<td>bk_mem</td>
<td>string</td>
<td>内存容量</td>
<td></td>
</tr>
<tr>
<td>bk_mac</td>
<td>string</td>
<td>内网 MAC 地址</td>
<td></td>
</tr>
<tr>
<td>bk_host_outerip</td>
<td>string</td>
<td>外网 IP</td>
<td></td>
</tr>
<tr>
<td>bk_host_name</td>
<td>string</td>
<td>主机名称</td>
<td></td>
</tr>
<tr>
<td>bk_host_innerip</td>
<td>string</td>
<td>内网 IP</td>
<td></td>
</tr>
<tr>
<td>bk_host_id</td>
<td>int</td>
<td>主机 ID</td>
<td></td>
</tr>
<tr>
<td>bk_disk</td>
<td>int</td>
<td>磁盘容量</td>
<td></td>
</tr>
<tr>
<td>bk_cpu_module</td>
<td>string</td>
<td>CPU 型号</td>
<td></td>
</tr>
<tr>
<td>bk_cpu_mhz</td>
<td>int</td>
<td>CPU 频率</td>
<td></td>
</tr>
<tr>
<td>bk_cpu</td>
<td>int</td>
<td>CPU 逻辑核心数</td>
<td>1-1000000</td>
</tr>
<tr>
<td>bk_comment</td>
<td>string</td>
<td>备注</td>
<td></td>
</tr>
<tr>
<td>bk_cloud_id</td>
<td>int</td>
<td>云区域</td>
<td></td>
</tr>
<tr>
<td>bk_bak_operator</td>
<td>string</td>
<td>备份维护人</td>
<td></td>
</tr>
<tr>
<td>bk_asset_id</td>
<td>string</td>
<td>固资编号</td>
<td></td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/list_service_category/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>查询服务分类列表，根据业务 ID 查询，共用服务分类也会返回</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 ID</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
  &quot;bk_biz_id&quot;: 1,
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
  &quot;result&quot;: true,
  &quot;code&quot;: 0,
  &quot;message&quot;: &quot;success&quot;,
  &quot;permission&quot;: null,
  &quot;data&quot;: {
    &quot;count&quot;: 20,
    &quot;info&quot;: [
      {
    &quot;bk_biz_id&quot;: 0,
        &quot;id&quot;: 16,
        &quot;name&quot;: &quot;Apache&quot;,
        &quot;bk_root_id&quot;: 14,
        &quot;bk_parent_id&quot;: 14,
        &quot;bk_supplier_account&quot;: &quot;0&quot;,
        &quot;is_built_in&quot;: true
      },
      {
    &quot;bk_biz_id&quot;: 0,
        &quot;id&quot;: 19,
        &quot;name&quot;: &quot;Ceph&quot;,
        &quot;bk_root_id&quot;: 18,
        &quot;bk_parent_id&quot;: 18,
        &quot;bk_supplier_account&quot;: &quot;0&quot;,
        &quot;is_built_in&quot;: true
      },
      {
    &quot;bk_biz_id&quot;: 1,
        &quot;id&quot;: 1,
        &quot;name&quot;: &quot;Default&quot;,
        &quot;bk_root_id&quot;: 1,
        &quot;bk_supplier_account&quot;: &quot;0&quot;,
        &quot;is_built_in&quot;: true
      }
    ]
  }
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="response">response</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>请求成功与否。true:请求成功；false 请求失败</td>
</tr>
<tr>
<td>code</td>
<td>int</td>
<td>错误编码。 0 表示 success，&gt;0 表示失败错误</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>请求失败返回的错误信息</td>
</tr>
<tr>
<td>data</td>
<td>object</td>
<td>请求返回的数据</td>
</tr>
</tbody>
</table>
<h4 id="data">data 字段说明</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>说明</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>count</td>
<td>integer</td>
<td>总数</td>
<td></td>
</tr>
<tr>
<td>info</td>
<td>array</td>
<td>返回结果</td>
<td></td>
</tr>
</tbody>
</table>
<h4 id="info">info 字段说明</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>说明</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>integer</td>
<td>服务分类 ID</td>
<td></td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>服务分类名称</td>
<td></td>
</tr>
<tr>
<td>bk_root_id</td>
<td>integer</td>
<td>根服务分类 ID</td>
<td></td>
</tr>
<tr>
<td>bk_parent_id</td>
<td>integer</td>
<td>父服务分类 ID</td>
<td></td>
</tr>
<tr>
<td>is_built_in</td>
<td>bool</td>
<td>是否内置</td>
<td></td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/list_service_instance/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>根据业务 id 查询服务实例列表,也可以加上模块 id 等信息查询</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 id</td>
</tr>
<tr>
<td>bk_module_id</td>
<td>int</td>
<td>否</td>
<td>模块 ID</td>
</tr>
<tr>
<td>selectors</td>
<td>int</td>
<td>否</td>
<td>label 过滤功能，operator 可选值: <code>=</code>,<code>!=</code>,<code>exists</code>,<code>!</code>,<code>in</code>,<code>notin</code></td>
</tr>
<tr>
<td>page</td>
<td>object</td>
<td>No</td>
<td>分页参数</td>
</tr>
<tr>
<td>search_key</td>
<td>string</td>
<td>No</td>
<td>名字过滤参数</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
  &quot;bk_biz_id&quot;: 1,
  &quot;page&quot;: {
    &quot;start&quot;: 0,
    &quot;limit&quot;: 1
  },
  &quot;bk_module_id&quot;: 56,
  &quot;search_key&quot;: &quot;&quot;,
  &quot;selectors&quot;: [{
    &quot;key&quot;: &quot;key1&quot;,
    &quot;operator&quot;: &quot;notin&quot;,
    &quot;values&quot;: [&quot;value1&quot;]
  },{
    &quot;key&quot;: &quot;key1&quot;,
    &quot;operator&quot;: &quot;in&quot;,
    &quot;values&quot;: [&quot;value1&quot;, &quot;value2&quot;]
  }]
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
  &quot;result&quot;: true,
  &quot;code&quot;: 0,
  &quot;message&quot;: &quot;success&quot;,
  &quot;data&quot;: {
    &quot;count&quot;: 1,
    &quot;info&quot;: [
      {
        &quot;bk_biz_id&quot;: 1,
        &quot;id&quot;: 72,
        &quot;name&quot;: &quot;t1&quot;,
        &quot;bk_host_id&quot;: 26,
        &quot;bk_module_id&quot;: 62,
        &quot;creator&quot;: &quot;admin&quot;,
        &quot;modifier&quot;: &quot;admin&quot;,
        &quot;create_time&quot;: &quot;2019-06-20T22:46:00.69+08:00&quot;,
        &quot;last_time&quot;: &quot;2019-06-20T22:46:00.69+08:00&quot;,
        &quot;bk_supplier_account&quot;: &quot;0&quot;
      }
    ]
  }
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="response">response</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>请求成功与否。true:请求成功；false 请求失败</td>
</tr>
<tr>
<td>code</td>
<td>int</td>
<td>错误编码。 0 表示 success，&gt;0 表示失败错误</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>请求失败返回的错误信息</td>
</tr>
<tr>
<td>data</td>
<td>object</td>
<td>请求返回的数据</td>
</tr>
</tbody>
</table>
<h4 id="data">data 字段说明</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>说明</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>count</td>
<td>integer</td>
<td>总数</td>
<td></td>
</tr>
<tr>
<td>info</td>
<td>array</td>
<td>返回结果</td>
<td></td>
</tr>
</tbody>
</table>
<h4 id="info">info 字段说明</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>说明</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>integer</td>
<td>服务实例 ID</td>
<td></td>
</tr>
<tr>
<td>name</td>
<td>array</td>
<td>服务实例名称</td>
<td></td>
</tr>
<tr>
<td>service_template_id</td>
<td>integer</td>
<td>服务模板 ID</td>
<td></td>
</tr>
<tr>
<td>bk_module_id</td>
<td>integer</td>
<td>模块 ID</td>
<td></td>
</tr>
<tr>
<td>bk_host_id</td>
<td>integer</td>
<td>主机 ID</td>
<td></td>
</tr>
<tr>
<td>bk_host_innerip</td>
<td>string</td>
<td>内网 IP</td>
<td></td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/list_service_instance_by_host/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>根据主机 id 获取绑定到主机上的服务实例列表</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_host_id</td>
<td>int</td>
<td>否</td>
<td>主机 ID</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
  &quot;bk_biz_id&quot;: 1,
  &quot;page&quot;: {
    &quot;start&quot;: 0,
    &quot;limit&quot;: 1
  },
  &quot;bk_host_id&quot;: 26
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
  &quot;result&quot;: true,
  &quot;code&quot;: 0,
  &quot;message&quot;: &quot;success&quot;,
  &quot;data&quot;: {
    &quot;count&quot;: 1,
    &quot;info&quot;: [
      {
        &quot;bk_biz_id&quot;: 1,
        &quot;id&quot;: 72,
        &quot;name&quot;: &quot;t1&quot;,
        &quot;bk_host_id&quot;: 26,
        &quot;bk_module_id&quot;: 62,
        &quot;creator&quot;: &quot;admin&quot;,
        &quot;modifier&quot;: &quot;admin&quot;,
        &quot;create_time&quot;: &quot;2019-06-20T22:46:00.69+08:00&quot;,
        &quot;last_time&quot;: &quot;2019-06-20T22:46:00.69+08:00&quot;,
        &quot;bk_supplier_account&quot;: &quot;0&quot;
      }
    ]
  }
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="response">response</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>请求成功与否。true:请求成功；false 请求失败</td>
</tr>
<tr>
<td>code</td>
<td>int</td>
<td>错误编码。 0 表示 success，&gt;0 表示失败错误</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>请求失败返回的错误信息</td>
</tr>
<tr>
<td>data</td>
<td>object</td>
<td>请求返回的数据</td>
</tr>
</tbody>
</table>
<h4 id="data">data 字段说明</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>说明</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>count</td>
<td>integer</td>
<td>总数</td>
<td></td>
</tr>
<tr>
<td>info</td>
<td>array</td>
<td>返回结果</td>
<td></td>
</tr>
</tbody>
</table>
<h4 id="info">info 字段说明</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>说明</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>integer</td>
<td>服务实例 ID</td>
<td></td>
</tr>
<tr>
<td>name</td>
<td>array</td>
<td>服务实例名称</td>
<td></td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/list_service_instance_detail/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>根据业务 id 查询服务实例列表(带进程信息)，可再附加上模块 id 等查询条件</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 ID</td>
</tr>
<tr>
<td>bk_module_id</td>
<td>int</td>
<td>否</td>
<td>模块 ID</td>
</tr>
<tr>
<td>bk_host_id</td>
<td>int</td>
<td>否</td>
<td>主机 ID</td>
</tr>
<tr>
<td>service_instance_ids</td>
<td>int</td>
<td>否</td>
<td>服务实例 ID 列表</td>
</tr>
<tr>
<td>selectors</td>
<td>int</td>
<td>否</td>
<td>label 过滤功能，operator 可选值: <code>=</code>,<code>!=</code>,<code>exists</code>,<code>!</code>,<code>in</code>,<code>notin</code></td>
</tr>
<tr>
<td>page</td>
<td>object</td>
<td>是</td>
<td>分页参数</td>
</tr>
</tbody>
</table>
<h4 id="page">page 字段说明</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>start</td>
<td>int</td>
<td>是</td>
<td>记录开始位置</td>
</tr>
<tr>
<td>limit</td>
<td>int</td>
<td>是</td>
<td>每页限制条数,最大 1000</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
  &quot;bk_biz_id&quot;: 1,
  &quot;page&quot;: {
    &quot;start&quot;: 0,
    &quot;limit&quot;: 10,
  },
  &quot;bk_module_id&quot;: 8,
  &quot;bk_host_id&quot;: 11,
  &quot;service_instance_ids&quot;: [49],
  &quot;selectors&quot;: [{
    &quot;key&quot;: &quot;key1&quot;,
    &quot;operator&quot;: &quot;notin&quot;,
    &quot;values&quot;: [&quot;value1&quot;]
  }]
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
  &quot;result&quot;: true,
  &quot;code&quot;: 0,
  &quot;message&quot;: &quot;success&quot;,
  &quot;permission&quot;: null,
  &quot;data&quot;: {
    &quot;count&quot;: 1,
    &quot;info&quot;: [
      {
        &quot;bk_biz_id&quot;: 1,
        &quot;id&quot;: 49,
        &quot;name&quot;: &quot;10.27.0.9_p1_81&quot;,
        &quot;service_template_id&quot;: 50,
        &quot;bk_host_id&quot;: 11,
        &quot;bk_module_id&quot;: 56,
        &quot;creator&quot;: &quot;admin&quot;,
        &quot;modifier&quot;: &quot;admin&quot;,
        &quot;create_time&quot;: &quot;2019-07-22T09:54:50.906+08:00&quot;,
        &quot;last_time&quot;: &quot;2019-07-22T09:54:50.906+08:00&quot;,
        &quot;bk_supplier_account&quot;: &quot;0&quot;,
        &quot;service_category_id&quot;: 22,
        &quot;process_instances&quot;: [
          {
            &quot;process&quot;: {
              &quot;bk_biz_id&quot;: 1,
              &quot;proc_num&quot;: 0,
              &quot;stop_cmd&quot;: &quot;&quot;,
              &quot;restart_cmd&quot;: &quot;&quot;,
              &quot;face_stop_cmd&quot;: &quot;&quot;,
              &quot;bk_process_id&quot;: 43,
              &quot;bk_func_name&quot;: &quot;p1&quot;,
              &quot;work_path&quot;: &quot;&quot;,
              &quot;bind_ip&quot;: &quot;0.0.0.0&quot;,
              &quot;priority&quot;: 0,
              &quot;reload_cmd&quot;: &quot;&quot;,
              &quot;bk_process_name&quot;: &quot;p1&quot;,
              &quot;port&quot;: &quot;81&quot;,
              &quot;pid_file&quot;: &quot;&quot;,
              &quot;auto_start&quot;: false,
              &quot;auto_time_gap&quot;: 0,
              &quot;last_time&quot;: &quot;2019-07-22T09:54:50.927+08:00&quot;,
              &quot;create_time&quot;: &quot;2019-07-22T09:54:50.927+08:00&quot;,
              &quot;bk_biz_id&quot;: 3,
              &quot;start_cmd&quot;: &quot;&quot;,
              &quot;bk_func_id&quot;: &quot;&quot;,
              &quot;user&quot;: &quot;&quot;,
              &quot;timeout&quot;: 0,
              &quot;protocol&quot;: &quot;1&quot;,
              &quot;description&quot;: &quot;&quot;,
              &quot;bk_supplier_account&quot;: &quot;0&quot;,
              &quot;bk_start_param_regex&quot;: &quot;&quot;
            },
            &quot;relation&quot;: {
              &quot;bk_biz_id&quot;: 1,
              &quot;bk_process_id&quot;: 43,
              &quot;service_instance_id&quot;: 49,
              &quot;process_template_id&quot;: 48,
              &quot;bk_host_id&quot;: 11,
              &quot;bk_supplier_account&quot;: &quot;0&quot;
            }
          }
        ]
      }
    ]
  }
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="response">response</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>请求成功与否。true:请求成功；false 请求失败</td>
</tr>
<tr>
<td>code</td>
<td>int</td>
<td>错误编码。 0 表示 success，&gt;0 表示失败错误</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>请求失败返回的错误信息</td>
</tr>
<tr>
<td>data</td>
<td>object</td>
<td>请求返回的数据</td>
</tr>
</tbody>
</table>
<h4 id="data">data 字段说明</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>说明</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>count</td>
<td>integer</td>
<td>总数</td>
<td></td>
</tr>
<tr>
<td>info</td>
<td>array</td>
<td>返回结果</td>
<td></td>
</tr>
</tbody>
</table>
<h4 id="info">info 字段说明</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>说明</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>integer</td>
<td>服务实例 ID</td>
<td></td>
</tr>
<tr>
<td>name</td>
<td>array</td>
<td>服务实例名称</td>
<td></td>
</tr>
<tr>
<td>service_template_id</td>
<td>integer</td>
<td>服务模板 ID</td>
<td></td>
</tr>
<tr>
<td>bk_host_id</td>
<td>integer</td>
<td>主机 ID</td>
<td></td>
</tr>
<tr>
<td>bk_host_innerip</td>
<td>string</td>
<td>主机 IP</td>
<td></td>
</tr>
<tr>
<td>bk_module_id</td>
<td>integer</td>
<td>模块 ID</td>
<td></td>
</tr>
<tr>
<td>creator</td>
<td>string</td>
<td>创建人</td>
<td></td>
</tr>
<tr>
<td>modifier</td>
<td>string</td>
<td>修改人</td>
<td></td>
</tr>
<tr>
<td>create_time</td>
<td>string</td>
<td>创建时间</td>
<td></td>
</tr>
<tr>
<td>last_time</td>
<td>string</td>
<td>修复时间</td>
<td></td>
</tr>
<tr>
<td>bk_supplier_account</td>
<td>string</td>
<td>供应商 ID</td>
<td></td>
</tr>
<tr>
<td>process_instances</td>
<td>数组</td>
<td>进程实例信息</td>
<td>包括</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>业务 ID</td>
<td>业务 ID</td>
</tr>
<tr>
<td>process_instances.process</td>
<td>object</td>
<td>进程实例详情</td>
<td>进程属性字段</td>
</tr>
<tr>
<td>process_instances.relation</td>
<td>object</td>
<td>进程实例的关联信息</td>
<td>比如主机 ID，进程模板 ID</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/list_service_instance_by_set_template/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>根据集群模版 id 获取服务实例列表</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>set_template_id</td>
<td>int</td>
<td>是</td>
<td>集群模版 ID</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
  &quot;bk_biz_id&quot;: 1,
  &quot;set_template_id&quot;:1,
  &quot;page&quot;: {
    &quot;start&quot;: 0,
    &quot;limit&quot;: 10
  }
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;bk_error_code&quot;: 0,
    &quot;bk_error_msg&quot;: &quot;success&quot;,
    &quot;permission&quot;: null,
    &quot;data&quot;: {
        &quot;count&quot;: 2,
        &quot;info&quot;: [
            {
                &quot;bk_biz_id&quot;: 3,
                &quot;id&quot;: 1,
                &quot;name&quot;: &quot;197.193.0.2_lgh-process-1&quot;,
                &quot;labels&quot;: null,
                &quot;service_template_id&quot;: 50,
                &quot;bk_host_id&quot;: 1,
                &quot;bk_module_id&quot;: 59,
                &quot;creator&quot;: &quot;admin&quot;,
                &quot;modifier&quot;: &quot;admin&quot;,
                &quot;create_time&quot;: &quot;2020-10-09T02:46:25.002Z&quot;,
                &quot;last_time&quot;: &quot;2020-10-09T02:46:25.002Z&quot;,
                &quot;bk_supplier_account&quot;: &quot;0&quot;
            },
            {
                &quot;bk_biz_id&quot;: 3,
                &quot;id&quot;: 3,
                &quot;name&quot;: &quot;127.0.122.2_lgh-process-1&quot;,
                &quot;labels&quot;: null,
                &quot;service_template_id&quot;: 50,
                &quot;bk_host_id&quot;: 3,
                &quot;bk_module_id&quot;: 59,
                &quot;creator&quot;: &quot;admin&quot;,
                &quot;modifier&quot;: &quot;admin&quot;,
                &quot;create_time&quot;: &quot;2020-10-09T03:04:19.859Z&quot;,
                &quot;last_time&quot;: &quot;2020-10-09T03:04:19.859Z&quot;,
                &quot;bk_supplier_account&quot;: &quot;0&quot;
            }
        ]
    }
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="response">response</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>请求成功与否。true:请求成功；false 请求失败</td>
</tr>
<tr>
<td>code</td>
<td>int</td>
<td>错误编码。 0 表示 success，&gt;0 表示失败错误</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>请求失败返回的错误信息</td>
</tr>
<tr>
<td>data</td>
<td>object</td>
<td>请求返回的数据</td>
</tr>
</tbody>
</table>
<h4 id="data">data 字段说明</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>说明</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>count</td>
<td>integer</td>
<td>总数</td>
<td></td>
</tr>
<tr>
<td>info</td>
<td>array</td>
<td>返回结果</td>
<td></td>
</tr>
</tbody>
</table>
<h4 id="info">info 字段说明</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>说明</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>integer</td>
<td>服务实例 ID</td>
<td></td>
</tr>
<tr>
<td>name</td>
<td>array</td>
<td>服务实例名称</td>
<td></td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/list_service_template/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>根据业务 id 查询服务模板列表,可加上服务分类 id 进一步查询</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 ID</td>
</tr>
<tr>
<td>service_category_id</td>
<td>int</td>
<td>否</td>
<td>服务分类 ID</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
  &quot;bk_biz_id&quot;: 1,
  &quot;service_category_id&quot;: 1,
  &quot;page&quot;: {
    &quot;start&quot;: 0,
    &quot;limit&quot;: 10,
    &quot;sort&quot;: &quot;-name&quot;
  }
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
  &quot;result&quot;: true,
  &quot;code&quot;: 0,
  &quot;message&quot;: &quot;success&quot;,
  &quot;permission&quot;: null,
  &quot;data&quot;: {
    &quot;count&quot;: 2,
    &quot;info&quot;: [
      {
        &quot;bk_biz_id&quot;: 1,
        &quot;id&quot;: 51,
        &quot;name&quot;: &quot;test3&quot;,
        &quot;service_category_id&quot;: 1,
        &quot;creator&quot;: &quot;admin&quot;,
        &quot;modifier&quot;: &quot;admin&quot;,
        &quot;create_time&quot;: &quot;2019-09-18T20:31:34.627+08:00&quot;,
        &quot;last_time&quot;: &quot;2019-09-18T20:31:34.627+08:00&quot;,
        &quot;bk_supplier_account&quot;: &quot;0&quot;
      },
      {
    &quot;bk_biz_id&quot;: 1,
        &quot;id&quot;: 50,
        &quot;name&quot;: &quot;test2&quot;,
        &quot;service_category_id&quot;: 1,
        &quot;creator&quot;: &quot;admin&quot;,
        &quot;modifier&quot;: &quot;admin&quot;,
        &quot;create_time&quot;: &quot;2019-09-18T20:31:29.607+08:00&quot;,
        &quot;last_time&quot;: &quot;2019-09-18T20:31:29.607+08:00&quot;,
        &quot;bk_supplier_account&quot;: &quot;0&quot;
      }
    ]
  }
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="response">response</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>请求成功与否。true:请求成功；false 请求失败</td>
</tr>
<tr>
<td>code</td>
<td>int</td>
<td>错误编码。 0 表示 success，&gt;0 表示失败错误</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>请求失败返回的错误信息</td>
</tr>
<tr>
<td>data</td>
<td>object</td>
<td>请求返回的数据</td>
</tr>
</tbody>
</table>
<h4 id="data">data 字段说明</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>说明</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>count</td>
<td>integer</td>
<td>总数</td>
<td></td>
</tr>
<tr>
<td>info</td>
<td>array</td>
<td>返回结果</td>
<td></td>
</tr>
</tbody>
</table>
<h4 id="info">info 字段说明</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>说明</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>integer</td>
<td>服务模板 ID</td>
<td></td>
</tr>
<tr>
<td>name</td>
<td>array</td>
<td>服务模板名称</td>
<td></td>
</tr>
<tr>
<td>service_category_id</td>
<td>integer</td>
<td>服务分类 ID</td>
<td></td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/list_set_template/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>根据业务 id 查询集群模板</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 ID</td>
</tr>
<tr>
<td>set_template_ids</td>
<td>array</td>
<td>否</td>
<td>集群模板 ID 数组</td>
</tr>
<tr>
<td>page</td>
<td>object</td>
<td>否</td>
<td>分页信息</td>
</tr>
</tbody>
</table>
<h4 id="page">page 字段说明</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>start</td>
<td>int</td>
<td>否</td>
<td>记录开始位置</td>
</tr>
<tr>
<td>limit</td>
<td>int</td>
<td>否</td>
<td>每页限制条数,最大 1000</td>
</tr>
<tr>
<td>sort</td>
<td>string</td>
<td>否</td>
<td>排序字段，'-'表示倒序</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-json">{
  &quot;bk_supplier_account&quot;: &quot;0&quot;,
  &quot;bk_biz_id&quot;: 10,
  &quot;set_template_ids&quot;:[1, 11],
  &quot;page&quot;: {
    &quot;start&quot;: 0,
    &quot;limit&quot;: 10,
    &quot;sort&quot;: &quot;-name&quot;
  }
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-json">{
  &quot;result&quot;: true,
  &quot;code&quot;: 0,
  &quot;message&quot;: &quot;success&quot;,
  &quot;permission&quot;: null,
  &quot;data&quot;: {
    &quot;count&quot;: 2,
    &quot;info&quot;: [
      {
        &quot;id&quot;: 1,
        &quot;name&quot;: &quot;zk1&quot;,
        &quot;bk_biz_id&quot;: 10,
        &quot;version&quot;: 0,
        &quot;creator&quot;: &quot;admin&quot;,
        &quot;modifier&quot;: &quot;admin&quot;,
        &quot;create_time&quot;: &quot;2020-03-16T15:09:23.859+08:00&quot;,
        &quot;last_time&quot;: &quot;2020-03-25T18:59:00.167+08:00&quot;,
        &quot;bk_supplier_account&quot;: &quot;0&quot;
      },
      {
        &quot;id&quot;: 11,
        &quot;name&quot;: &quot;q&quot;,
        &quot;bk_biz_id&quot;: 10,
        &quot;version&quot;: 0,
        &quot;creator&quot;: &quot;admin&quot;,
        &quot;modifier&quot;: &quot;admin&quot;,
        &quot;create_time&quot;: &quot;2020-03-16T15:10:05.176+08:00&quot;,
        &quot;last_time&quot;: &quot;2020-03-16T15:10:05.176+08:00&quot;,
        &quot;bk_supplier_account&quot;: &quot;0&quot;
      }
    ]
  }
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="response">response</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>请求成功与否。true:请求成功；false 请求失败</td>
</tr>
<tr>
<td>code</td>
<td>int</td>
<td>错误编码。 0 表示 success，&gt;0 表示失败错误</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>请求失败返回的错误信息</td>
</tr>
<tr>
<td>data</td>
<td>object</td>
<td>请求返回的数据</td>
</tr>
</tbody>
</table>
<h4 id="data">data 字段说明</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>count</td>
<td>int</td>
<td>总数</td>
</tr>
<tr>
<td>info</td>
<td>array</td>
<td>返回结果</td>
</tr>
</tbody>
</table>
<h4 id="info">info 字段说明</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>int</td>
<td>集群模板 ID</td>
</tr>
<tr>
<td>name</td>
<td>array</td>
<td>集群模板名称</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>业务 ID</td>
</tr>
<tr>
<td>version</td>
<td>int</td>
<td>集群模板版本</td>
</tr>
<tr>
<td>creator</td>
<td>string</td>
<td>创建者</td>
</tr>
<tr>
<td>modifier</td>
<td>string</td>
<td>最后修改人员</td>
</tr>
<tr>
<td>create_time</td>
<td>string</td>
<td>创建时间</td>
</tr>
<tr>
<td>last_time</td>
<td>string</td>
<td>更新时间</td>
</tr>
<tr>
<td>bk_supplier_account</td>
<td>string</td>
<td>开发商账号</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/list_set_template_related_service_template/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>根据业务 id 和集群模板 id,获取指定业务下某集群模版的服务模版列表</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>set_template_id</td>
<td>int</td>
<td>是</td>
<td>集群模版 ID</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 ID</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-json">{
  &quot;set_template_id&quot;: 1,
  &quot;bk_biz_id&quot;: 3
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;success&quot;,
    &quot;data&quot;: [
        {
            &quot;bk_biz_id&quot;: 3,
            &quot;id&quot;: 48,
            &quot;name&quot;: &quot;sm1&quot;,
            &quot;service_category_id&quot;: 2,
            &quot;creator&quot;: &quot;admin&quot;,
            &quot;modifier&quot;: &quot;admin&quot;,
            &quot;create_time&quot;: &quot;2020-05-15T14:14:57.691Z&quot;,
            &quot;last_time&quot;: &quot;2020-05-15T14:14:57.691Z&quot;,
            &quot;bk_supplier_account&quot;: &quot;0&quot;
        },
        {
            &quot;bk_biz_id&quot;: 3,
            &quot;id&quot;: 49,
            &quot;name&quot;: &quot;sm2&quot;,
            &quot;&quot;: 16,
            &quot;creator&quot;: &quot;admin&quot;,
            &quot;modifier&quot;: &quot;admin&quot;,
            &quot;create_time&quot;: &quot;2020-05-15T14:19:09.813Z&quot;,
            &quot;last_time&quot;: &quot;2020-05-15T14:19:09.813Z&quot;,
            &quot;bk_supplier_account&quot;: &quot;0&quot;
        }
    ]
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>请求成功与否。true:请求成功；false 请求失败</td>
</tr>
<tr>
<td>code</td>
<td>int</td>
<td>错误编码。 0 表示 success，&gt;0 表示失败错误</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>请求失败返回的错误信息</td>
</tr>
<tr>
<td>data</td>
<td>object</td>
<td>请求返回的数据</td>
</tr>
</tbody>
</table>
<p>data 字段说明：</p>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>业务 ID</td>
</tr>
<tr>
<td>id</td>
<td>int</td>
<td>服务模板 ID</td>
</tr>
<tr>
<td>name</td>
<td>array</td>
<td>服务模板名称</td>
</tr>
<tr>
<td>service_category_id</td>
<td>int</td>
<td>服务分类 ID</td>
</tr>
<tr>
<td>creator</td>
<td>string</td>
<td>创建者</td>
</tr>
<tr>
<td>modifier</td>
<td>string</td>
<td>最后修改人员</td>
</tr>
<tr>
<td>create_time</td>
<td>string</td>
<td>创建时间</td>
</tr>
<tr>
<td>last_time</td>
<td>string</td>
<td>更新时间</td>
</tr>
<tr>
<td>bk_supplier_account</td>
<td>string</td>
<td>开发商账号</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/remove_label_from_service_instance/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>根据业务 id 和服务实例 id，以及需要移除的标签，将指定业务下的服务实例移除标签</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 ID</td>
</tr>
<tr>
<td>instance_ids</td>
<td>array</td>
<td>是</td>
<td>服务实例 ID 列表</td>
</tr>
<tr>
<td>keys</td>
<td>array</td>
<td>是</td>
<td>需要移除的标签 key 列表</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
  &quot;bk_biz_id&quot;: 1,
  &quot;instance_ids&quot;: [60, 62],
  &quot;keys&quot;: [&quot;value1&quot;, &quot;value3&quot;]
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
  &quot;result&quot;: true,
  &quot;code&quot;: 0,
  &quot;message&quot;: &quot;success&quot;,
  &quot;permission&quot;: null,
  &quot;data&quot;: null
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="response">response</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>请求成功与否。true:请求成功；false 请求失败</td>
</tr>
<tr>
<td>code</td>
<td>int</td>
<td>错误编码。 0 表示 success，&gt;0 表示失败错误</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>请求失败返回的错误信息</td>
</tr>
<tr>
<td>data</td>
<td>object</td>
<td>请求返回的数据</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/resource_watch/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>监听系统资源变化产生的事件(v3.8 以上)</p>
<p><strong>该 watch 功能的主要特性包括：</strong></p>
<ul>
<li>
<p>在有限的时间内（目前为 3 小时,可能会调整，请勿依赖此时间）为用户提供高可用的数据变更 watch 服务。</p>
</li>
<li>
<p>在有限时间内，用户可以根据自己上一次事件的 cursor(游标)进行事件回溯或者追数据，适用于异常数据回溯，或者系统变更进行数据补录。</p>
</li>
<li>
<p>支持根据时间点进行变更数据回溯，支持根据游标进行变更数据回溯，支持从当前时间点进行数据变更 watch。</p>
</li>
<li>
<p>支持根据事件类型进行 watch 的能力，包括增、删、改。事件中包含全量的数据。</p>
</li>
<li>
<p>支持主机与主机关系数据变化的事件 watch 能力。</p>
</li>
<li>
<p>采用短长链的设计，当用户通过游标进行事件 watch 时，如果没有事件，则会保持会话连接，在 25s 内有事件变更则直接直接将事件推回。避免用户不断请求，同时保证用户能及时的拿到变更的数据。</p>
</li>
<li>
<p>支持批量事件 watch 能力，提升系统吞吐能力。</p>
</li>
<li>
<p>支持定制关注的事件数据字段，满足用户轻量级的 watch 需求。</p>
</li>
</ul>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_event_types</td>
<td>array   string</td>
<td>否</td>
<td>事件类型，如果填了，即为只关注此类型的事件。可选的值为：create(新增)/update(更新)/delete(删除)。如，若使用 create，则只关注该资源的新增事件。不填为空，则为关注所有。</td>
</tr>
<tr>
<td>bk_fields</td>
<td>array string</td>
<td>看情况</td>
<td>返回的事件中需要返回的字段列表，目前监听主机资源该字段为必填字段，不能置空，主机关系可以置空。置空则默认为返回所有字段。</td>
</tr>
<tr>
<td>bk_start_from</td>
<td>Int64</td>
<td>否</td>
<td>监听事件的起始时间，该值为 unix time 的秒数，即为从 UTC1970 年 1 月 1 日 0 时 0 分 0 秒起至你要 watch 的时间点的总秒数。</td>
</tr>
<tr>
<td>bk_cursor</td>
<td>string</td>
<td>否</td>
<td>监听事件的游标，代表了要开始或者继续 watch(监听)的事件地址，系统会返回这个游标的下一个、或一批事件。</td>
</tr>
<tr>
<td>bk_resource</td>
<td>string</td>
<td>是</td>
<td>要监听的资源类型，枚举值为：host, host_relation, biz, set, module, set_template。其中 host 代表主机详情事件，host_relation 代表主机的关系事件，biz 代表业务详情事件，set 代表集群详情事件，module 代表模块详情事件，set_template 代表集群模板详情事件。</td>
</tr>
<tr>
<td>bk_supplier_account</td>
<td>string</td>
<td>是</td>
<td>开发商账号</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;bk_event_types&quot;: [&quot;create&quot;,&quot;update&quot;,&quot;delete&quot;],
    &quot;bk_fields&quot;: [&quot;bk_host_innerip&quot;, &quot;bk_mac&quot;],
    &quot;bk_start_from&quot;: 12345678999,
    &quot;bk_cursor&quot;: &quot;MQ0yDTE1ODkyMDcyODENMQ01ZWI3ZWZjNTBiOTA5ZTYyMGFmYWQzZGY=&quot;,
    &quot;bk_resource&quot;: &quot;host&quot;,
    &quot;bk_supplier_account&quot;: &quot;0&quot;
}</code></pre>


<h2 id="_8">返回参数</h2>
<pre class="codehilite"><code class="language-json">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;success&quot;,
    &quot;permission&quot;: null,
    &quot;data&quot;: {
        &quot;bk_watched&quot;: true,
        &quot;bk_events&quot;: [
            {
                &quot;bk_cursor&quot;: &quot;MQ0yDTE1ODkyMDcyODENMQ01ZWI3ZWZjNTBiOTA5ZTYyMGFmYWQzZGY=&quot;,
                &quot;bk_resource&quot;: &quot;host&quot;,
                &quot;bk_event_type&quot;: &quot;update&quot;,
                &quot;bk_detail&quot;: {
                    &quot;bk_cpu&quot;: 2
                }
            },
            {
                &quot;bk_cursor&quot;: &quot;MQ0yDTE1ODkzNDExMDcNMQ01ZWI3ZWZjNTBiOTA5ZTYyMGFmYWQzZGY=&quot;,
                &quot;bk_resource&quot;: &quot;host&quot;,
                &quot;bk_event_type&quot;: &quot;update&quot;,
                &quot;bk_detail&quot;: {
                    &quot;bk_cpu&quot;: 2
                }
            }
        ]
    }
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="response">response</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>请求成功与否。true:请求成功；false 请求失败</td>
</tr>
<tr>
<td>code</td>
<td>int</td>
<td>错误编码。 0 表示 success，&gt;0 表示失败错误</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>请求失败返回的错误信息</td>
</tr>
<tr>
<td>data</td>
<td>Array</td>
<td>事件数据详情，是一个有序的数组，数组尾部的事件为新的事件。</td>
</tr>
</tbody>
</table>
<ul>
<li>data 数据描述</li>
</ul>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_watched</td>
<td>bool</td>
<td>是否监听到了事件，true：监听到了事件；false:未监听到事件</td>
</tr>
<tr>
<td>bk_events</td>
<td>监听到的事件详情</td>
<td>监听到的事件详情列表，最大长度为 200，后续可能会调，请勿依赖此长度。</td>
</tr>
</tbody>
</table>
<ul>
<li>bk_events 数据描述</li>
</ul>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_cursor</td>
<td>string</td>
<td>代表当前资源事件的游标值，调用方可以用该游标获取该事件后的下一个事件</td>
</tr>
<tr>
<td>bk_resource</td>
<td>enum string</td>
<td>该事件对应的资源类型</td>
</tr>
<tr>
<td>bk_event_type</td>
<td>enum string</td>
<td>该事件对应的事件类型，枚举值为：create(新增)/update(更新)/delete(删除)。</td>
</tr>
<tr>
<td>bk_detail</td>
<td>object</td>
<td>该事件的对应的资源的详情数据，不同的资源，对应的详情不同。</td>
</tr>
</tbody>
</table>
<h4 id="host_relation-bk_detail">host_relation 资源 bk_detail 字段数据示例</h4>
<pre class="codehilite"><code class="language-json">{
    &quot;bk_biz_id&quot; : 1,
    &quot;bk_host_id&quot; : 2,
    &quot;bk_module_id&quot; : 3,
    &quot;bk_set_id&quot; : 4,
    &quot;bk_supplier_account&quot; : &quot;0&quot;
}</code></pre>


<h4 id="host-bk_detail">host 资源 bk_detail 字段数据示例</h4>
<pre class="codehilite"><code class="language-json">{
    &quot;bk_host_name&quot; : &quot;hostname&quot;,
    &quot;bk_mem&quot; : null,
    &quot;bk_cloud_id&quot; : 0,
    &quot;operator&quot; : &quot;user&quot;,
    &quot;bk_cpu&quot; : null,
    &quot;bk_mac&quot; : &quot;&quot;,
    &quot;bk_host_innerip&quot; : &quot;192.168.1.1&quot;,  
    &quot;bk_supplier_account&quot; : &quot;0&quot;,
    ....
}</code></pre>


<h3 id="_10">使用说明</h3>
<p>该接口的使用的流程：</p>
<ol>
<li>
<p>确定起始的监听方式，分别可为：</p>
</li>
<li>
<p>1.1 指定从某一时间开始监听事件</p>
</li>
<li>
<p>1.2 指定当前时间开始监听事件</p>
</li>
<li>
<p>1.3 指定用游标 bk_cursor 位置开始监听事件</p>
</li>
</ol>
<p>确定后，发起请求。</p>
<ol>
<li>cmdb 返回符合你预期的事件列表：</li>
<li>2.1: 如果 bk_watched 为 ture, 表明已经监听到了事件，bk_events 中为事件详情列表，调用方可拿数组最后一个事件的 cursor，用 1.3 步骤中的方式继续进行下一次的 watch。</li>
<li>2.2: 如果 bk_watched 为 false，表明未监听到事件，bk_events 中只有一个事件，拿该事件的 cursor 进行下一次的 watch。</li>
</ol>
<p><strong>注意</strong>：</p>
<p>该事件是有过期时间的，目前为 3 小时，如果过期，事件将会释放，且过期的游标（cursor）也会失效。可以用以下两种方式重新 watch：</p>
<ol>
<li>指定从某一时间开始监听事件</li>
<li>指定当前时间开始监听事件</li>
</ol><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/search_biz_inst_topo/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>查询业务实例拓扑</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_supplier_account</td>
<td>string</td>
<td>否</td>
<td>开发商账号</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 id</td>
</tr>
<tr>
<td>level</td>
<td>int</td>
<td>否</td>
<td>拓扑的层级索引，索引取值从 0 开始，默认值为 2，当设置为 -1 的时候会读取完整的业务实例拓扑</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_supplier_account&quot;: &quot;123456789&quot;,
    &quot;bk_biz_id&quot;: 1,
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;success&quot;,
    &quot;data&quot;: [
        {
            &quot;bk_inst_id&quot;: 2,
            &quot;bk_inst_name&quot;: &quot;blueking&quot;,
            &quot;bk_obj_id&quot;: &quot;biz&quot;,
            &quot;bk_obj_name&quot;: &quot;business&quot;,
            &quot;child&quot;: [
                {
                    &quot;bk_inst_id&quot;: 3,
                    &quot;bk_inst_name&quot;: &quot;job&quot;,
                    &quot;bk_obj_id&quot;: &quot;set&quot;,
                    &quot;bk_obj_name&quot;: &quot;set&quot;,
                    &quot;child&quot;: [
                        {
                            &quot;bk_inst_id&quot;: 5,
                            &quot;bk_inst_name&quot;: &quot;job&quot;,
                            &quot;bk_obj_id&quot;: &quot;module&quot;,
                            &quot;bk_obj_name&quot;: &quot;module&quot;,
                            &quot;child&quot;: []
                        }
                    ]
                }
            ]
        }
    ]
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_inst_id</td>
<td>int</td>
<td>实例 ID</td>
</tr>
<tr>
<td>bk_inst_name</td>
<td>string</td>
<td>实例用于展示的名字</td>
</tr>
<tr>
<td>bk_obj_icon</td>
<td>string</td>
<td>模型图标的名字</td>
</tr>
<tr>
<td>bk_obj_id</td>
<td>string</td>
<td>模型 ID</td>
</tr>
<tr>
<td>bk_obj_name</td>
<td>string</td>
<td>模型用于展示的名字</td>
</tr>
<tr>
<td>child</td>
<td>array</td>
<td>当前节点下的所有实例的集合</td>
</tr>
</tbody>
</table>
<h4 id="child">child</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_inst_id</td>
<td>int</td>
<td>实例 ID</td>
</tr>
<tr>
<td>bk_inst_name</td>
<td>string</td>
<td>实例用于展示的名字</td>
</tr>
<tr>
<td>bk_obj_icon</td>
<td>string</td>
<td>模型图标的名字</td>
</tr>
<tr>
<td>bk_obj_id</td>
<td>string</td>
<td>模型 ID</td>
</tr>
<tr>
<td>bk_obj_name</td>
<td>string</td>
<td>模型用于展示的名字</td>
</tr>
<tr>
<td>child</td>
<td>array</td>
<td>当前节点下的所有实例的集合</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/search_business/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>查询业务</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_supplier_account</td>
<td>string</td>
<td>否</td>
<td>开发商账号</td>
</tr>
<tr>
<td>fields</td>
<td>array</td>
<td>否</td>
<td>指定查询的字段，参数为业务的任意属性，如果不填写字段信息，系统会返回业务的所有字段</td>
</tr>
<tr>
<td>condition</td>
<td>dict</td>
<td>否</td>
<td>查询条件，参数为业务的任意属性，如果不写代表搜索全部数据</td>
</tr>
<tr>
<td>page</td>
<td>dict</td>
<td>否</td>
<td>分页条件</td>
</tr>
</tbody>
</table>
<p>Note: 业务分为两类，未归档的业务和已归档的业务。
- 若要查询已归档的业务，请在 condition 中增加条件<code>bk_data_status:disabled</code>。
- 若要查询未归档的业务，请不要带字段"bk_data_status",或者在 condition 中增条件<code>bk_data_status: {"$ne":disabled"}</code>。</p>
<h4 id="page">page</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>start</td>
<td>int</td>
<td>是</td>
<td>记录开始位置</td>
</tr>
<tr>
<td>limit</td>
<td>int</td>
<td>是</td>
<td>每页限制条数,最大 200</td>
</tr>
<tr>
<td>sort</td>
<td>string</td>
<td>否</td>
<td>排序字段，通过在字段前面增加 -，如 sort:&#34;-field&#34; 可以表示按照字段 field 降序</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_supplier_account&quot;: &quot;123456789&quot;,
    &quot;fields&quot;: [
        &quot;bk_biz_id&quot;,
        &quot;bk_biz_name&quot;
    ],
    &quot;condition&quot;: {
        &quot;bk_biz_name&quot;: &quot;esb-test&quot;
    },
    &quot;page&quot;: {
        &quot;start&quot;: 0,
        &quot;limit&quot;: 10,
        &quot;sort&quot;: &quot;&quot;
    }
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: {
        &quot;count&quot;: 1,
        &quot;info&quot;: [
            {
                &quot;bk_biz_id&quot;: 1,
                &quot;bk_biz_name&quot;: &quot;esb-test&quot;
            }
        ]
    }
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>count</td>
<td>int</td>
<td>记录条数</td>
</tr>
<tr>
<td>info</td>
<td>array</td>
<td>业务实际数据</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/search_classifications/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>查询模型分类</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_supplier_account&quot;: &quot;0&quot;
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
     &quot;data&quot;: [
         {
            &quot;bk_classification_icon&quot;: &quot;icon-cc-business&quot;,
            &quot;bk_classification_id&quot;: &quot;bk_host_manage&quot;,
            &quot;bk_classification_name&quot;: &quot;主机管理&quot;,
            &quot;bk_classification_type&quot;: &quot;inner&quot;,
            &quot;id&quot;: 1
         }
     ]
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_classification_id</td>
<td>string</td>
<td>分类 ID，英文描述用于系统内部使用</td>
</tr>
<tr>
<td>bk_classification_name</td>
<td>string</td>
<td>分类名</td>
</tr>
<tr>
<td>bk_classification_type</td>
<td>string</td>
<td>用于对分类进行分类（如：inner 代码为内置分类，空字符串为自定义分类）</td>
</tr>
<tr>
<td>bk_classification_icon</td>
<td>string</td>
<td>模型分类的图标,取值可参考，取值可参考<a href="resource_define/classIcon.json">(classIcon.json)</a></td>
</tr>
<tr>
<td>id</td>
<td>int</td>
<td>数据记录 ID</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/search_cloud_area/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>查询云区域</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>condition</td>
<td>object</td>
<td>否</td>
<td>查询条件</td>
</tr>
<tr>
<td>bk_cloud_id</td>
<td>int</td>
<td>否</td>
<td>云区域 ID</td>
</tr>
<tr>
<td>bk_cloud_name</td>
<td>string</td>
<td>否</td>
<td>云区域名称</td>
</tr>
<tr>
<td>page</td>
<td>object</td>
<td>是</td>
<td>分页信息</td>
</tr>
</tbody>
</table>
<h4 id="page">page 字段说明</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>start</td>
<td>int</td>
<td>否</td>
<td>获取数据偏移位置</td>
</tr>
<tr>
<td>limit</td>
<td>int</td>
<td>是</td>
<td>过去数据条数限制，建议 为 200</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;condition&quot;: {
        &quot;bk_cloud_id&quot;: 12,
        &quot;bk_cloud_name&quot; &quot;aws&quot;,
    },
    &quot;page&quot;:{
        &quot;start&quot;:0,
        &quot;limit&quot;:10
    }
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
  &quot;result&quot;: true,
  &quot;code&quot;: 0,
  &quot;message&quot;: &quot;success&quot;,
  &quot;permission&quot;: null,
  &quot;data&quot;: {
    &quot;count&quot;: 10,
    &quot;info&quot;: [
         {
            &quot;bk_cloud_id&quot;: 0,
            &quot;bk_cloud_name&quot;: &quot;aws&quot;,
            &quot;bk_supplier_account&quot;: &quot;0&quot;,
            &quot;create_time&quot;: &quot;2019-05-20T14:59:48.354+08:00&quot;,
            &quot;last_time&quot;: &quot;2019-05-20T14:59:48.354+08:00&quot;
        },
        .....
    ]

  }
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="data">data</h4>
<p>| 名称  | 类型  | 说明 |
|---|---|---|---|
| count| int| 记录条数 |
| info| object array |  查询到的云区域列表信息 |</p>
<h4 id="datainfo">data.info 字段说明</h4>
<p>| 名称  | 类型  | 说明 |
|---|---|---|---|
| bk_cloud_id | int | 云区域 ID |
| bk_cloud_name | string  | 云区域名字 | 
| create_time | string | 创建时间 |
| last_time | string | 最后修改时间 |</p><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/search_custom_query/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>查询自定义查询</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_supplier_account</td>
<td>string</td>
<td>否</td>
<td>开发商账号</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 ID</td>
</tr>
<tr>
<td>condition</td>
<td>dict</td>
<td>否</td>
<td>查询条件，condition 字段为自定义查询的属性字段, 可以是 create_user,modify_user, name</td>
</tr>
<tr>
<td>start</td>
<td>int</td>
<td>是</td>
<td>记录开始位置</td>
</tr>
<tr>
<td>limit</td>
<td>int</td>
<td>是</td>
<td>每页限制条数,最大 200</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_supplier_account&quot;: &quot;123456789&quot;,
    &quot;bk_biz_id&quot;: 1,
    &quot;condition&quot;: {
        &quot;name&quot;: &quot;api1&quot;
    },
    &quot;start&quot;: 0,
    &quot;limit&quot;: 200
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: {
        &quot;count&quot;: 1,
        &quot;info&quot;: [
            {
                &quot;bk_biz_id&quot;: 1,
                &quot;id&quot;: &quot;bacfet4kd42325venmcg&quot;,
                &quot;name&quot;: &quot;api1&quot;,
                &quot;info&quot;: &quot;{\&quot;condition\&quot;:[{\&quot;bk_obj_id\&quot;:\&quot;biz\&quot;,\&quot;condition\&quot;:[{\&quot;field\&quot;:\&quot;default\&quot;,\&quot;operator\&quot;:\&quot;$ne\&quot;,\&quot;value\&quot;:1}],\&quot;fields\&quot;:[]},{\&quot;bk_obj_id\&quot;:\&quot;set\&quot;,\&quot;condition\&quot;:[],\&quot;fields\&quot;:[]},{\&quot;bk_obj_id\&quot;:\&quot;module\&quot;,\&quot;condition\&quot;:[],\&quot;fields\&quot;:[]},{\&quot;bk_obj_id\&quot;:\&quot;host\&quot;,\&quot;condition\&quot;:[{\&quot;field\&quot;:\&quot;bk_host_innerip\&quot;,\&quot;operator\&quot;:\&quot;$eq\&quot;,\&quot;value\&quot;:\&quot;127.0.0.1\&quot;}],\&quot;fields\&quot;:[\&quot;bk_host_innerip\&quot;,\&quot;bk_host_outerip\&quot;,\&quot;bk_agent_status\&quot;]}]}&quot;,
                &quot;create_user&quot;: &quot;admin&quot;,
                &quot;create_time&quot;: &quot;2018-03-27T16:22:43.271+08:00&quot;,
                &quot;modify_user&quot;: &quot;admin&quot;,
                &quot;last_time&quot;: &quot;2018-03-27T16:29:26.428+08:00&quot;
            }
        ]
    }
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>count</td>
<td>int</td>
<td>记录条数</td>
</tr>
<tr>
<td>info</td>
<td>array</td>
<td>自定义查询数据</td>
</tr>
</tbody>
</table>
<h4 id="datainfo">data.info</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>业务 ID</td>
</tr>
<tr>
<td>create_time</td>
<td>string</td>
<td>创建时间</td>
</tr>
<tr>
<td>create_user</td>
<td>string</td>
<td>创建者</td>
</tr>
<tr>
<td>id</td>
<td>string</td>
<td>自定义查询主键 ID</td>
</tr>
<tr>
<td>info</td>
<td>string</td>
<td>自定义查询信息</td>
</tr>
<tr>
<td>last_time</td>
<td>string</td>
<td>更新时间</td>
</tr>
<tr>
<td>modify_user</td>
<td>string</td>
<td>修改者</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>自定义查询命名</td>
</tr>
</tbody>
</table>
<h4 id="datainfoinfo">data.info.info</h4>
<p>| 字段      |  类型     |  描述      |
|-----------|------------|--------|------------|
| bk_obj_id |  string   | 对象名,可以为 biz,set,module,host,object |
| fields    |  array    | 查询输出字段 |
| condition |  array    | 查询条件 |</p>
<h4 id="datainfoinfocondition">data.info.info.condition</h4>
<p>| 字段      |  类型     |  描述      |
|-----------|------------|--------|------------|
| field     |  string    | 对象的字段 |
| operator  |  string    | 操作符, $eq 为相等，$ne 为不等，$in 为属于，$nin 为不属于 |
| value     |  string    | 字段对应的值 |</p><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/search_dynamic_group/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>查询动态分组列表 (V3.9.6)</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 ID</td>
</tr>
<tr>
<td>condition</td>
<td>dict</td>
<td>否</td>
<td>查询条件，condition 字段为自定义查询的属性字段, 可以是 create_user, modify_user, name</td>
</tr>
<tr>
<td>disable_counter</td>
<td>bool</td>
<td>否</td>
<td>是否返回总记录条数，默认返回</td>
</tr>
<tr>
<td>page</td>
<td>object</td>
<td>是</td>
<td>分页设置</td>
</tr>
</tbody>
</table>
<h4 id="page">page</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>start</td>
<td>int</td>
<td>是</td>
<td>记录开始位置</td>
</tr>
<tr>
<td>limit</td>
<td>int</td>
<td>是</td>
<td>每页限制条数,最大 200</td>
</tr>
<tr>
<td>sort</td>
<td>string</td>
<td>否</td>
<td>检索排序， 默认按照创建时间排序</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_biz_id&quot;: 1,
    &quot;disable_counter&quot;: true,
    &quot;condition&quot;: {
        &quot;name&quot;: &quot;my-dynamic-group&quot;
    },
    &quot;page&quot;:{
        &quot;start&quot;: 0,
        &quot;limit&quot;: 200
    }
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: {
        &quot;count&quot;: 0,
        &quot;info&quot;: [
            {
                &quot;bk_biz_id&quot;: 1,
                &quot;id&quot;: &quot;XXXXXXXX&quot;,
                &quot;name&quot;: &quot;my-dynamic-group&quot;,
                &quot;bk_obj_id&quot;: &quot;host&quot;,
                &quot;info&quot;: {
                    &quot;condition&quot;:[
                            {
                                &quot;bk_obj_id&quot;:&quot;set&quot;,
                                &quot;condition&quot;:[
                                    {
                                        &quot;field&quot;:&quot;default&quot;,
                                        &quot;operator&quot;:&quot;$ne&quot;,
                                        &quot;value&quot;:1
                                    }
                                ]
                            },
                            {
                                &quot;bk_obj_id&quot;:&quot;module&quot;,
                                &quot;condition&quot;:[
                                    {
                                        &quot;field&quot;:&quot;default&quot;,
                                        &quot;operator&quot;:&quot;$ne&quot;,
                                        &quot;value&quot;:1
                                    }
                                ]
                            },
                            {
                                &quot;bk_obj_id&quot;:&quot;host&quot;,
                                &quot;condition&quot;:[
                                    {
                                        &quot;field&quot;:&quot;bk_host_innerip&quot;,
                                        &quot;operator&quot;:&quot;$eq&quot;,
                                        &quot;value&quot;:&quot;127.0.0.1&quot;
                                    }
                                ]
                            }
                    ]
                },
                &quot;create_user&quot;: &quot;admin&quot;,
                &quot;create_time&quot;: &quot;2018-03-27T16:22:43.271+08:00&quot;,
                &quot;modify_user&quot;: &quot;admin&quot;,
                &quot;last_time&quot;: &quot;2018-03-27T16:29:26.428+08:00&quot;
            }
        ]
    }
}</code></pre>


<h3 id="_9">返回结果参数</h3>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>count</td>
<td>int</td>
<td>当前规则能匹配到的总记录条数（用于调用者进行预分页，实际单次请求返回数量以及数据是否全部拉取完毕以 JSON Array 解析数量为准）</td>
</tr>
<tr>
<td>info</td>
<td>array</td>
<td>自定义查询数据</td>
</tr>
</tbody>
</table>
<h4 id="datainfo">data.info</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>业务 ID</td>
</tr>
<tr>
<td>id</td>
<td>string</td>
<td>动态分组主键 ID</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>动态分组命名</td>
</tr>
<tr>
<td>bk_obj_id</td>
<td>string</td>
<td>动态分组的目标资源对象类型,目前可以为 host,set</td>
</tr>
<tr>
<td>info</td>
<td>object</td>
<td>动态分组信息</td>
</tr>
<tr>
<td>last_time</td>
<td>string</td>
<td>更新时间</td>
</tr>
<tr>
<td>modify_user</td>
<td>string</td>
<td>修改者</td>
</tr>
<tr>
<td>create_time</td>
<td>string</td>
<td>创建时间</td>
</tr>
<tr>
<td>create_user</td>
<td>string</td>
<td>创建者</td>
</tr>
</tbody>
</table>
<h4 id="datainfoinfocondition">data.info.info.condition</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_obj_id</td>
<td>string</td>
<td>对象名,可以为 set,module,host</td>
</tr>
<tr>
<td>condition</td>
<td>array</td>
<td>查询条件</td>
</tr>
</tbody>
</table>
<h4 id="datainfoinfoconditioncondition">data.info.info.condition.condition</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>field</td>
<td>string</td>
<td>对象的字段</td>
</tr>
<tr>
<td>operator</td>
<td>string</td>
<td>操作符, op 值为 eq(相等)/ne(不等)/in(属于)/nin(不属于)/like(模糊匹配)</td>
</tr>
<tr>
<td>value</td>
<td>object</td>
<td>字段对应的值</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/search_host_lock/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>根据主机 id 列表查询主机锁(v3.8.6)</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id_list</td>
<td>int array</td>
<td>是</td>
<td>主机 ID 列表</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
   &quot;id_list&quot;:[1, 2]
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;success&quot;,
    &quot;data&quot;: {
        1: true,
        2: false
    }
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>data</td>
<td>map[int]bool</td>
<td>请求返回的数据, key 是 ID，value 是否上锁</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/search_hostidentifier/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>根据条件查询主机身份</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>ip</td>
<td>dict</td>
<td>否</td>
<td>主机 ip 查询条件</td>
</tr>
<tr>
<td>page</td>
<td>dict</td>
<td>否</td>
<td>分页查询条件</td>
</tr>
</tbody>
</table>
<h4 id="ip">ip</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>data</td>
<td>array</td>
<td>否</td>
<td>主机 ip 列表</td>
</tr>
<tr>
<td>bk_cloud_id</td>
<td>int</td>
<td>否</td>
<td>云区域 ID</td>
</tr>
</tbody>
</table>
<h4 id="page">page</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>start</td>
<td>int</td>
<td>是</td>
<td>记录开始位置</td>
</tr>
<tr>
<td>limit</td>
<td>int</td>
<td>是</td>
<td>每页限制条数,最大值为 500</td>
</tr>
<tr>
<td>sort</td>
<td>string</td>
<td>否</td>
<td>排序字段</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;ip&quot;: {
        &quot;data&quot;: [
            &quot;192.168.0.1&quot;
        ],
        &quot;bk_cloud_id&quot;: 0
    },
    &quot;page&quot;:{
        &quot;start&quot;:0,
        &quot;limit&quot;:10,
        &quot;sort&quot;:&quot;bk_host_name&quot;
    }
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-json">{
  &quot;result&quot;: true,
  &quot;code&quot;: 0,
  &quot;message&quot;: &quot;success&quot;,
  &quot;data&quot;: {
        &quot;count&quot;: 1,
        &quot;info&quot;: [
            {
                &quot;bk_host_id&quot;: 4,
                &quot;bk_host_name&quot;: &quot;&quot;,
                &quot;bk_supplier_account&quot;: &quot;&quot;,
                &quot;bk_cloud_id&quot;: 0,
                &quot;bk_cloud_name&quot;: &quot;default area&quot;,
                &quot;bk_host_innerip&quot;: &quot;192.168.0.1&quot;,
                &quot;bk_host_outerip&quot;: &quot;&quot;,
                &quot;bk_os_type&quot;: &quot;&quot;,
                &quot;bk_os_name&quot;: &quot;&quot;,
                &quot;bk_mem&quot;: 0,
                &quot;bk_cpu&quot;: 0,
                &quot;bk_disk&quot;: 0,
                &quot;associations&quot;: {
                    &quot;51&quot;: {
                        &quot;bk_biz_id&quot;: 3,
                        &quot;bk_biz_name&quot;: &quot;test&quot;,
                        &quot;bk_set_id&quot;: 8,
                        &quot;bk_set_name&quot;: &quot;test&quot;,
                        &quot;bk_module_id&quot;: 51,
                        &quot;bk_module_name&quot;: &quot;test&quot;,
                        &quot;bk_service_status&quot;: &quot;1&quot;,
                        &quot;bk_set_env&quot;: &quot;3&quot;,
                         &quot;layer&quot;: {
                              &quot;bk_inst_id&quot;: 3,
                              &quot;bk_inst_name&quot;: &quot;a&quot;,
                              &quot;bk_obj_id&quot;: &quot;a&quot;,
                              &quot;child&quot;: {
                                    &quot;bk_inst_id&quot;: 5,
                                    &quot;bk_inst_name&quot;: &quot;b&quot;,
                                    &quot;bk_obj_id&quot;: &quot;b&quot;,
                                    &quot;child&quot;: {}
                              }
                        }
                    }
                },
                &quot;process&quot;: [
                    {
                        &quot;bk_process_id&quot;: 43,
                        &quot;bk_process_name&quot;: &quot;test&quot;,
                        &quot;bind_ip&quot;: &quot;&quot;,
                        &quot;port&quot;: &quot;8000&quot;,
                        &quot;protocol&quot;: &quot;1&quot;,
                        &quot;bk_func_id&quot;: &quot;&quot;,
                        &quot;bk_func_name&quot;: &quot;test&quot;,
                        &quot;bk_start_param_regex&quot;: &quot;&quot;,
                        &quot;bind_info&quot;: [
                            {
                                &quot;enable&quot;: false,  
                                &quot;ip&quot;: &quot;127.0.0.1&quot;,  
                                &quot;port&quot;: &quot;8000&quot;,  
                                &quot;protocol&quot;: &quot;1&quot;, 
                                &quot;template_row_id&quot;: 1  
                            }
                        ],
                        &quot;bind_modules&quot;: [
                            51
                        ]
                    }
                ]
            }
        ]
    }
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>count</td>
<td>int</td>
<td>记录条数</td>
</tr>
<tr>
<td>info</td>
<td>array</td>
<td>主机身份数据</td>
</tr>
</tbody>
</table>
<h4 id="datainfon">data.info[n]</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_host_id</td>
<td>int</td>
<td>主机 ID</td>
</tr>
<tr>
<td>bk_host_name</td>
<td>string</td>
<td>主机名称</td>
</tr>
<tr>
<td>bk_supplier_account</td>
<td>string</td>
<td>开发商账号</td>
</tr>
<tr>
<td>bk_cloud_id</td>
<td>int</td>
<td>云区域 ID</td>
</tr>
<tr>
<td>bk_cloud_name</td>
<td>string</td>
<td>云区域名称</td>
</tr>
<tr>
<td>bk_host_innerip</td>
<td>string</td>
<td>内网 IP</td>
</tr>
<tr>
<td>bk_host_outerip</td>
<td>string</td>
<td>外网 IP</td>
</tr>
<tr>
<td>bk_os_type</td>
<td>string</td>
<td>操作系统类型</td>
</tr>
<tr>
<td>bk_os_name</td>
<td>string</td>
<td>操作系统名称</td>
</tr>
<tr>
<td>bk_mem</td>
<td>string</td>
<td>内存容量</td>
</tr>
<tr>
<td>bk_cpu</td>
<td>int</td>
<td>CPU 逻辑核心数</td>
</tr>
<tr>
<td>bk_disk</td>
<td>int</td>
<td>磁盘容量</td>
</tr>
<tr>
<td>associations</td>
<td>dict</td>
<td>主机主线关联，key 为主机所属的模块 ID</td>
</tr>
<tr>
<td>process</td>
<td>array</td>
<td>主机进程信息</td>
</tr>
</tbody>
</table>
<h4 id="datainfonassociations">data.info[n].associations</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>主机所属的业务 ID</td>
</tr>
<tr>
<td>bk_biz_name</td>
<td>string</td>
<td>主机所属的业务名字</td>
</tr>
<tr>
<td>bk_set_id</td>
<td>int</td>
<td>主机所属的集群 ID</td>
</tr>
<tr>
<td>bk_set_name</td>
<td>string</td>
<td>主机所属的集群名字</td>
</tr>
<tr>
<td>bk_module_id</td>
<td>int</td>
<td>主机所属的模块 ID</td>
</tr>
<tr>
<td>bk_module_name</td>
<td>string</td>
<td>主机所属的模块名字</td>
</tr>
<tr>
<td>bk_service_status</td>
<td>enum</td>
<td>服务状态:1/2(1:开放,2:关闭)</td>
</tr>
<tr>
<td>bk_set_env</td>
<td>enum</td>
<td>环境类型：1/2/3(1:测试,2:体验,3:正式)</td>
</tr>
<tr>
<td>layer</td>
<td>dict</td>
<td>自定义层级信息</td>
</tr>
</tbody>
</table>
<h4 id="datainfonassociationslayer">data.info[n].associations.layer</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_inst_id</td>
<td>int</td>
<td>自定义层级实例 ID</td>
</tr>
<tr>
<td>bk_inst_name</td>
<td>string</td>
<td>自定义层级实例名字</td>
</tr>
<tr>
<td>bk_obj_id</td>
<td>int</td>
<td>自定义层级模型 ID</td>
</tr>
<tr>
<td>child</td>
<td>dict</td>
<td>自定义层级信息</td>
</tr>
</tbody>
</table>
<h4 id="datainfonprocess">data.info[n].process</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_process_id</td>
<td>int</td>
<td>进程 ID</td>
</tr>
<tr>
<td>bk_process_name</td>
<td>string</td>
<td>进程名</td>
</tr>
<tr>
<td>bind_ip</td>
<td>string</td>
<td>绑定 IP:1/2/3/4(1:127.0.0.1,2:0.0.0.0,3:第一内网 IP,4:第一外网 IP)</td>
</tr>
<tr>
<td>port</td>
<td>string</td>
<td>主机端口</td>
</tr>
<tr>
<td>protocol</td>
<td>enum</td>
<td>协议:1/2(1:tcp, 2:udp)</td>
</tr>
<tr>
<td>bk_func_id</td>
<td>int</td>
<td>功能 ID</td>
</tr>
<tr>
<td>bk_func_name</td>
<td>string</td>
<td>进程别名</td>
</tr>
<tr>
<td>bk_start_param_regex</td>
<td>string</td>
<td>进程启动参数</td>
</tr>
<tr>
<td>bind_modules</td>
<td>array</td>
<td>进程绑定的模块数组</td>
</tr>
<tr>
<td>bind_info</td>
<td>array</td>
<td>进程绑定信息</td>
</tr>
</tbody>
</table>
<h4 id="datainfonprocessbind_infox">data.info[n].process.bind_info[x] 描述</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>enable</td>
<td>bool</td>
<td>端口是否启用</td>
</tr>
<tr>
<td>ip</td>
<td>string</td>
<td>绑定的 ip</td>
</tr>
<tr>
<td>port</td>
<td>string</td>
<td>绑定的端口</td>
</tr>
<tr>
<td>protocol</td>
<td>string</td>
<td>使用的协议</td>
</tr>
<tr>
<td>row_id</td>
<td>int</td>
<td>实例化使用的模板行索引，进程内唯一</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/search_inst/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>根据关联关系实例查询模型实例</p>
<ul>
<li>该接口只适用于自定义层级模型和通用模型实例上，不适用于业务、集群、模块、主机等模型实例</li>
</ul>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_obj_id</td>
<td>string</td>
<td>是</td>
<td>模型 ID</td>
</tr>
<tr>
<td>page</td>
<td>object</td>
<td>是</td>
<td>分页参数</td>
</tr>
<tr>
<td>condition</td>
<td>object</td>
<td>否</td>
<td>具有关联关系的模型实例查询条件</td>
</tr>
<tr>
<td>fields</td>
<td>map</td>
<td>否</td>
<td>指定查询模型实例返回的字段,key 为模型 ID，value 为该查询模型要返回的模型属性字段</td>
</tr>
</tbody>
</table>
<h4 id="page">page</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>start</td>
<td>int</td>
<td>是</td>
<td>记录开始位置</td>
</tr>
<tr>
<td>limit</td>
<td>int</td>
<td>是</td>
<td>每页限制条数,最大 200</td>
</tr>
<tr>
<td>sort</td>
<td>string</td>
<td>否</td>
<td>排序字段</td>
</tr>
</tbody>
</table>
<h4 id="condition">condition</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>field</td>
<td>string</td>
<td>是</td>
<td>取值为模型的字段名</td>
</tr>
<tr>
<td>operator</td>
<td>string</td>
<td>是</td>
<td>取值为：$regex $eq $ne</td>
</tr>
<tr>
<td>value</td>
<td>string</td>
<td>是</td>
<td>field 配置的模型字段名所对应的值</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;bk_obj_id&quot;: &quot;bk_switch&quot;,
    &quot;bk_supplier_account&quot;: &quot;0&quot;,
    &quot;page&quot;: {
        &quot;start&quot;: 0,
        &quot;limit&quot;: 10,
        &quot;sort&quot;: &quot;bk_inst_id&quot;
    },
    &quot;fields&quot;: {
        &quot;bk_switch&quot;: [
            &quot;bk_asset_id&quot;,
            &quot;bk_inst_id&quot;,
            &quot;bk_inst_name&quot;,
            &quot;bk_obj_id&quot;
        ]
    },
    &quot;condition&quot;: {
        &quot;host&quot;: [
            {
                &quot;field&quot;: &quot;operator&quot;,
                &quot;operator&quot;: &quot;$regex&quot;,
                &quot;value&quot;: &quot;admin&quot;
            }
        ]
    }
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;success&quot;,
    &quot;permission&quot;: null,
    &quot;data&quot;: {
        &quot;count&quot;: 2,
        &quot;info&quot;: [
            {
                &quot;bk_asset_id&quot;: &quot;sw00001&quot;,
                &quot;bk_inst_id&quot;: 1,
                &quot;bk_inst_name&quot;: &quot;sw1&quot;,
                &quot;bk_obj_id&quot;: &quot;bk_switch&quot;
            },
            {
                &quot;bk_asset_id&quot;: &quot;sw00002&quot;,
                &quot;bk_inst_id&quot;: 2,
                &quot;bk_inst_name&quot;: &quot;sw2&quot;,
                &quot;bk_obj_id&quot;: &quot;bk_switch&quot;
            }
        ]
    }
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>count</td>
<td>int</td>
<td>记录条数</td>
</tr>
<tr>
<td>info</td>
<td>array</td>
<td>模型实例实际数据</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/search_inst_association_topo/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>查询实例关联拓扑</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_obj_id</td>
<td>string</td>
<td>是</td>
<td>无</td>
</tr>
<tr>
<td>bk_inst_id</td>
<td>int</td>
<td>是</td>
<td>无</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_supplier_account&quot;:&quot;0&quot;,
    &quot;bk_obj_id&quot;:&quot;test&quot;,
    &quot;bk_inst_id&quot;:1
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: [{
        &quot;bk_inst_id&quot;:0,
        &quot;bk_inst_name&quot;: &quot;&quot;,
        &quot;bk_obj_icon&quot;: &quot;icon-cc-business&quot;,
        &quot;bk_obj_id&quot;: &quot;biz&quot;,
        &quot;bk_obj_name&quot;: &quot;业务&quot;,
        &quot;count&quot;: 1,
        &quot;children&quot;: [{
            &quot;bk_inst_id&quot;: 2,
            &quot;bk_inst_name&quot;: &quot;蓝鲸&quot;,
            &quot;bk_obj_icon&quot;: &quot;&quot;,
            &quot;bk_obj_id&quot;: &quot;biz&quot;,
            &quot;bk_obj_name&quot;: &quot;业务&quot;
        }],

    }]
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_inst_id</td>
<td>int</td>
<td>实例 ID</td>
</tr>
<tr>
<td>bk_inst_name</td>
<td>string</td>
<td>实例用于展示的名字</td>
</tr>
<tr>
<td>bk_obj_icon</td>
<td>string</td>
<td>模型图标的名字</td>
</tr>
<tr>
<td>bk_obj_id</td>
<td>string</td>
<td>模型 ID</td>
</tr>
<tr>
<td>bk_obj_name</td>
<td>string</td>
<td>模型用于展示的名字</td>
</tr>
<tr>
<td>children</td>
<td>object array</td>
<td>本模型下所有被关联的实例的集合</td>
</tr>
<tr>
<td>count</td>
<td>int</td>
<td>children 包含节点的数量</td>
</tr>
</tbody>
</table>
<h4 id="children">children</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_inst_id</td>
<td>int</td>
<td>实例 ID</td>
</tr>
<tr>
<td>bk_inst_name</td>
<td>string</td>
<td>实例用于展示的名字</td>
</tr>
<tr>
<td>bk_obj_icon</td>
<td>string</td>
<td>模型图标的名字</td>
</tr>
<tr>
<td>bk_obj_id</td>
<td>string</td>
<td>模型 ID</td>
</tr>
<tr>
<td>bk_obj_name</td>
<td>string</td>
<td>模型用于展示的名字</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/search_inst_asst_object_inst_base_info/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>查询实例关联模型实例基本信息</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>fields</td>
<td>array</td>
<td>否</td>
<td>指定查询的字段，参数为业务的任意属性，如果不填写字段信息，系统会返回业务的所有字段</td>
</tr>
<tr>
<td>condition</td>
<td>dict</td>
<td>否</td>
<td>查询条件</td>
</tr>
<tr>
<td>page</td>
<td>dict</td>
<td>否</td>
<td>分页条件</td>
</tr>
</tbody>
</table>
<h4 id="condition">condition</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_obj_id</td>
<td>string</td>
<td>是</td>
<td>实例模型 ID</td>
</tr>
<tr>
<td>bk_inst_id</td>
<td>int</td>
<td>是</td>
<td>实例 ID</td>
</tr>
<tr>
<td>association_obj_id</td>
<td>string</td>
<td>是</td>
<td>关联对象的模型 ID， 返回 association_obj_id 模型与 bk_inst_id 实例有关联的实例基本数据（bk_inst_id,bk_inst_name）</td>
</tr>
<tr>
<td>is_target_object</td>
<td>bool</td>
<td>否</td>
<td>bk_obj_id 是否为目标模型， 默认 false， 关联关系中的源模型，否则是目标模型</td>
</tr>
</tbody>
</table>
<h4 id="page">page</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>start</td>
<td>int</td>
<td>否</td>
<td>记录开始位置,默认值 0</td>
</tr>
<tr>
<td>limit</td>
<td>int</td>
<td>否</td>
<td>每页限制条数,默认值 20,最大 200</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_supplier_account&quot;: &quot;123456789&quot;,
    &quot;condition&quot;: {
        &quot;bk_obj_id&quot;:&quot;bk_switch&quot;, 
        &quot;bk_inst_id&quot;:12, 
        &quot;association_obj_id&quot;:&quot;host&quot;, 
        &quot;is_target_object&quot;:true, 
    },
    &quot;page&quot;: {
        &quot;start&quot;: 0,
        &quot;limit&quot;: 10,
    }
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;success&quot;,
    &quot;permission&quot;: null,
    &quot;data&quot;: {
        &quot;count&quot;: 4,
        &quot;info&quot;: [
            {
                &quot;bk_inst_id&quot;: 1,
                &quot;bk_inst_name&quot;: &quot;127.0.0.3&quot;
            }
        ],
        &quot;page&quot;: {
            &quot;start&quot;: 0,
            &quot;limit&quot;: 1
        }
    }
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="data">data</h4>
<p>| 名称  | 类型  | 说明 |
|---|---|---|---|
| count| int| 记录条数 |
| info| object array |  关联对象的模型 ID， 实例关联模型的实例基本数据（bk_inst_id,bk_inst_name） |
| page| object|分页信息|</p>
<h4 id="datainfo">data.info 字段说明</h4>
<p>| 名称  | 类型  | 说明 |
|---|---|---|---|
| bk_inst_id | int | 实例 ID |
| bk_inst_name | string  | 实例名 | </p>
<h5 id="datainfobk_inst_iddatainfobk_inst_name">data.info.bk_inst_id,data.info.bk_inst_name 字段说明</h5>
<p>不同模型 bk_inst_id, bk_inst_name 对应的值</p>
<p>| 模型   | bk_inst_id   | bk_inst_name |
|---|---|---|---|
|业务 | bk_biz_id | bk_biz_name|
|集群 | bk_set_id | bk_set_name|
|模块 | bk_module_id | bk_module_name|
|进程 | bk_process_id | bk_process_name|
|主机 | bk_host_id | bk_host_inner_ip|
|通用模型 | bk_inst_id | bk_inst_name|</p>
<h4 id="datapage">data.page 字段说明</h4>
<p>| 名称  | 类型  | 说明 |
|---|---|---|---|
|start|int|服务端本次获取数据偏移位置|
|limit|int|服务端返回数据条数限制|</p><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/search_inst_by_object/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>查询给定模型的实例信息</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_supplier_account</td>
<td>string</td>
<td>否</td>
<td>开发商账号</td>
</tr>
<tr>
<td>bk_obj_id</td>
<td>string</td>
<td>是</td>
<td>自定义模型 ID</td>
</tr>
<tr>
<td>fields</td>
<td>array</td>
<td>否</td>
<td>指定查询的字段</td>
</tr>
<tr>
<td>condition</td>
<td>dict</td>
<td>否</td>
<td>查询条件</td>
</tr>
<tr>
<td>page</td>
<td>dict</td>
<td>否</td>
<td>分页条件</td>
</tr>
</tbody>
</table>
<h4 id="page">page</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>start</td>
<td>int</td>
<td>是</td>
<td>记录开始位置</td>
</tr>
<tr>
<td>limit</td>
<td>int</td>
<td>是</td>
<td>每页限制条数,最大 200</td>
</tr>
<tr>
<td>sort</td>
<td>string</td>
<td>否</td>
<td>排序字段</td>
</tr>
</tbody>
</table>
<h4 id="fields">fields 参数说明</h4>
<p>参数为查询的目标实例对应的模型定义的所有字段</p>
<h4 id="condition">condition 参数说明</h4>
<p>condition 参数为查询的目标实例对应的模型定义的所有字段</p>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_supplier_account&quot;: &quot;123456789&quot;,
    &quot;bk_obj_id&quot;: &quot;xxx&quot;,
    &quot;fields&quot;: [
    ],
    &quot;condition&quot;: {
    },
    &quot;page&quot;: {
        &quot;start&quot;: 0,
        &quot;limit&quot;: 10,
        &quot;sort&quot;: &quot;&quot;
    }
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;success&quot;,
    &quot;data&quot;: {
        &quot;count&quot;: 4,
        &quot;info&quot;: [
            {
                &quot;bk_inst_id&quot;: 0,
                &quot;bk_inst_name&quot;: &quot;default area&quot;,
                &quot;bk_supplier_account&quot;: &quot;123456789&quot;
            }
        ]
    }
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>count</td>
<td>int</td>
<td>info 集合中元素的数量</td>
</tr>
<tr>
<td>info</td>
<td>array</td>
<td>查询的模型的实例集合</td>
</tr>
</tbody>
</table>
<h4 id="info">info</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_inst_id</td>
<td>int</td>
<td>实例 ID</td>
</tr>
<tr>
<td>bk_inst_name</td>
<td>string</td>
<td>实例名</td>
</tr>
<tr>
<td>bk_supplier_account</td>
<td>string</td>
<td>开发商账号</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/search_module/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>查询模块</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_supplier_account</td>
<td>string</td>
<td>否</td>
<td>开发商账号</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 id</td>
</tr>
<tr>
<td>bk_set_id</td>
<td>int</td>
<td>否</td>
<td>集群 ID</td>
</tr>
<tr>
<td>fields</td>
<td>array</td>
<td>是</td>
<td>查询字段，字段来自于模块定义的属性字段</td>
</tr>
<tr>
<td>condition</td>
<td>dict</td>
<td>是</td>
<td>查询条件，字段来自于模块定义的属性字段</td>
</tr>
<tr>
<td>page</td>
<td>dict</td>
<td>是</td>
<td>分页条件</td>
</tr>
</tbody>
</table>
<h4 id="page">page</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>start</td>
<td>int</td>
<td>是</td>
<td>记录开始位置</td>
</tr>
<tr>
<td>limit</td>
<td>int</td>
<td>是</td>
<td>每页限制条数</td>
</tr>
<tr>
<td>sort</td>
<td>string</td>
<td>否</td>
<td>排序字段</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_supplier_account&quot;: &quot;123456789&quot;,
    &quot;bk_biz_id&quot;: 2,
    &quot;fields&quot;: [
        &quot;bk_module_name&quot;,
        &quot;bk_set_id&quot;
    ],
    &quot;condition&quot;: {
        &quot;bk_module_name&quot;: &quot;test&quot;
    },
    &quot;page&quot;: {
        &quot;start&quot;: 0,
        &quot;limit&quot;: 10
    }
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: {
        &quot;count&quot;: 2,
        &quot;info&quot;: [
            {
                &quot;bk_module_name&quot;: &quot;test&quot;,
                &quot;bk_set_id&quot;: 11
            },
            {
                &quot;bk_module_name&quot;: &quot;test&quot;,
                &quot;bk_set_id&quot;: 12
            }
        ]
    }
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>count</td>
<td>int</td>
<td>数据数量</td>
</tr>
<tr>
<td>info</td>
<td>array</td>
<td>结果集，其中，所有字段均为模块定义的属性字段</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/search_objects/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>根据可选条件查询模型</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>creator</td>
<td>string</td>
<td>否</td>
<td>本条数据创建者</td>
</tr>
<tr>
<td>modifier</td>
<td>string</td>
<td>否</td>
<td>本条数据的最后修改人员</td>
</tr>
<tr>
<td>bk_classification_id</td>
<td>string</td>
<td>否</td>
<td>对象模型的分类 ID，只能用英文字母序列命名</td>
</tr>
<tr>
<td>bk_obj_id</td>
<td>string</td>
<td>否</td>
<td>对象模型的 ID，只能用英文字母序列命名</td>
</tr>
<tr>
<td>bk_obj_name</td>
<td>string</td>
<td>否</td>
<td>对象模型的名字，用于展示，可以使用人类可以阅读的任何语言</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;creator&quot;: &quot;user&quot;,
    &quot;modifier&quot;: &quot;user&quot;,
    &quot;bk_classification_id&quot;: &quot;test&quot;,
    &quot;bk_obj_id&quot;: &quot;biz&quot;,
    &quot;bk_supplier_account&quot;:&quot;0&quot;
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: [
        {
            &quot;bk_classification_id&quot;: &quot;bk_organization&quot;,
            &quot;create_time&quot;: &quot;2018-03-08T11:30:28.005+08:00&quot;,
            &quot;creator&quot;: &quot;cc_system&quot;,
            &quot;description&quot;: &quot;&quot;,
            &quot;id&quot;: 4,
            &quot;bk_ispaused&quot;: false,
            &quot;ispre&quot;: true,
            &quot;last_time&quot;: null,
            &quot;modifier&quot;: &quot;&quot;,
            &quot;bk_obj_icon&quot;: &quot;icon-XXX&quot;,
            &quot;bk_obj_id&quot;: &quot;XX&quot;,
            &quot;bk_obj_name&quot;: &quot;XXX&quot;,
            &quot;position&quot;: &quot;{\&quot;test_obj\&quot;:{\&quot;x\&quot;:-253,\&quot;y\&quot;:137}}&quot;,
            &quot;bk_supplier_account&quot;: &quot;0&quot;
        }
    ]
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>int</td>
<td>数据记录的 ID</td>
</tr>
<tr>
<td>creator</td>
<td>string</td>
<td>本条数据创建者</td>
</tr>
<tr>
<td>modifier</td>
<td>string</td>
<td>本条数据的最后修改人员</td>
</tr>
<tr>
<td>bk_classification_id</td>
<td>string</td>
<td>对象模型的分类 ID，只能用英文字母序列命名</td>
</tr>
<tr>
<td>bk_obj_id</td>
<td>string</td>
<td>对象模型的 ID，只能用英文字母序列命名</td>
</tr>
<tr>
<td>bk_obj_name</td>
<td>string</td>
<td>对象模型的名字，用于展示</td>
</tr>
<tr>
<td>bk_supplier_account</td>
<td>string</td>
<td>开发商账号</td>
</tr>
<tr>
<td>bk_ispaused</td>
<td>bool</td>
<td>是否停用, true or false</td>
</tr>
<tr>
<td>ispre</td>
<td>bool</td>
<td>是否预定义, true or false</td>
</tr>
<tr>
<td>bk_obj_icon</td>
<td>string</td>
<td>对象模型的 ICON 信息，用于前端显示，取值可参考<a href="/static/esb/api_docs/res/cc/modleIcon.json">(modleIcon.json)</a></td>
</tr>
<tr>
<td>position</td>
<td>json object string</td>
<td>用于前端展示的坐标</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/search_object_attribute/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>可通过可选参数根据模型 id 或业务 id 查询对象模型属性</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_obj_id</td>
<td>string</td>
<td>否</td>
<td>模型 ID</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>否</td>
<td>业务 id，设置后查询结果包含业务自定义字段</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_obj_id&quot;: &quot;test&quot;,
    &quot;bk_supplier_account&quot;: &quot;0&quot;,
    &quot;bk_biz_id&quot;: 2
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
   &quot;data&quot;: [
       {
           &quot;bk_biz_id&quot;: 0,
           &quot;bk_asst_obj_id&quot;: &quot;&quot;,
           &quot;bk_asst_type&quot;: 0,
           &quot;create_time&quot;: &quot;2018-03-08T11:30:27.898+08:00&quot;,
           &quot;creator&quot;: &quot;cc_system&quot;,
           &quot;description&quot;: &quot;&quot;,
           &quot;editable&quot;: false,
           &quot;id&quot;: 51,
           &quot;isapi&quot;: false,
           &quot;isonly&quot;: true,
           &quot;ispre&quot;: true,
           &quot;isreadonly&quot;: false,
           &quot;isrequired&quot;: true,
           &quot;last_time&quot;: &quot;2018-03-08T11:30:27.898+08:00&quot;,
           &quot;bk_obj_id&quot;: &quot;process&quot;,
           &quot;option&quot;: &quot;&quot;,
           &quot;placeholder&quot;: &quot;&quot;,
           &quot;bk_property_group&quot;: &quot;default&quot;,
           &quot;bk_property_group_name&quot;: &quot;基础信息&quot;,
           &quot;bk_property_id&quot;: &quot;bk_process_name&quot;,
           &quot;bk_property_index&quot;: 0,
           &quot;bk_property_name&quot;: &quot;进程名称&quot;,
           &quot;bk_property_type&quot;: &quot;singlechar&quot;,
           &quot;bk_supplier_account&quot;: &quot;0&quot;,
           &quot;unit&quot;: &quot;&quot;
       },
       {
            &quot;bk_biz_id&quot;: 2,
            &quot;id&quot;: 7,
            &quot;bk_supplier_account&quot;: &quot;0&quot;,
            &quot;bk_obj_id&quot;: &quot;process&quot;,
            &quot;bk_property_id&quot;: &quot;biz_custom_field&quot;,
            &quot;bk_property_name&quot;: &quot;业务自定义字段&quot;,
            &quot;bk_property_group&quot;: &quot;biz_custom_group&quot;,
            &quot;bk_property_index&quot;: 4,
            &quot;unit&quot;: &quot;&quot;,
            &quot;placeholder&quot;: &quot;&quot;,
            &quot;editable&quot;: true,
            &quot;ispre&quot;: true,
            &quot;isrequired&quot;: false,
            &quot;isreadonly&quot;: false,
            &quot;isonly&quot;: false,
            &quot;bk_issystem&quot;: false,
            &quot;bk_isapi&quot;: false,
            &quot;bk_property_type&quot;: &quot;singlechar&quot;,
            &quot;option&quot;: &quot;&quot;,
            &quot;description&quot;: &quot;&quot;,
            &quot;creator&quot;: &quot;admin&quot;,
            &quot;create_time&quot;: &quot;2020-03-25 17:12:08&quot;,
            &quot;last_time&quot;: &quot;2020-03-25 17:12:08&quot;,
            &quot;bk_property_group_name&quot;: &quot;业务自定义分组&quot;
       }
   ]
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>creator</td>
<td>string</td>
<td>数据的创建者</td>
</tr>
<tr>
<td>description</td>
<td>string</td>
<td>数据的描述信息</td>
</tr>
<tr>
<td>editable</td>
<td>bool</td>
<td>表明数据是否可编辑</td>
</tr>
<tr>
<td>isonly</td>
<td>bool</td>
<td>表明唯一性</td>
</tr>
<tr>
<td>ispre</td>
<td>bool</td>
<td>true:预置字段,false:非内置字段</td>
</tr>
<tr>
<td>isreadonly</td>
<td>bool</td>
<td>true:只读，false:非只读</td>
</tr>
<tr>
<td>isrequired</td>
<td>bool</td>
<td>true:必填，false:可选</td>
</tr>
<tr>
<td>option</td>
<td>string</td>
<td>用户自定义内容，存储的内容及格式由调用方决定</td>
</tr>
<tr>
<td>unit</td>
<td>string</td>
<td>单位</td>
</tr>
<tr>
<td>placeholder</td>
<td>string</td>
<td>占位符</td>
</tr>
<tr>
<td>bk_property_group</td>
<td>string</td>
<td>字段分栏的名字</td>
</tr>
<tr>
<td>bk_obj_id</td>
<td>string</td>
<td>模型 ID</td>
</tr>
<tr>
<td>bk_supplier_account</td>
<td>string</td>
<td>开发商账号</td>
</tr>
<tr>
<td>bk_property_id</td>
<td>string</td>
<td>模型的属性 ID</td>
</tr>
<tr>
<td>bk_property_name</td>
<td>string</td>
<td>模型属性名，用于展示</td>
</tr>
<tr>
<td>bk_property_type</td>
<td>string</td>
<td>定义的属性字段用于存储数据的数据类型 （singlechar,longchar,int,enum,date,time,objuser,singleasst,multiasst,timezone,bool)</td>
</tr>
<tr>
<td>bk_asst_obj_id</td>
<td>string</td>
<td>如果有关联其它的模型，那么就必需设置此字段，否则就不需要设置</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>业务自定义字段的业务 id</td>
</tr>
</tbody>
</table>
<h4 id="bk_property_type">bk_property_type</h4>
<table>
<thead>
<tr>
<th>标识</th>
<th>名字</th>
</tr>
</thead>
<tbody>
<tr>
<td>singlechar</td>
<td>短字符</td>
</tr>
<tr>
<td>longchar</td>
<td>长字符</td>
</tr>
<tr>
<td>int</td>
<td>整形</td>
</tr>
<tr>
<td>enum</td>
<td>枚举类型</td>
</tr>
<tr>
<td>date</td>
<td>日期</td>
</tr>
<tr>
<td>time</td>
<td>时间</td>
</tr>
<tr>
<td>objuser</td>
<td>用户</td>
</tr>
<tr>
<td>singleasst</td>
<td>单关联</td>
</tr>
<tr>
<td>multiasst</td>
<td>多关联</td>
</tr>
<tr>
<td>timezone</td>
<td>时区</td>
</tr>
<tr>
<td>bool</td>
<td>布尔</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/search_object_topo/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>通过对象模型的分类 ID 查询普通模型拓扑</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_classification_id</td>
<td>string</td>
<td>是</td>
<td>对象模型的分类 ID，只能用英文字母序列命名</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_classification_id&quot;: &quot;test&quot;
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: [
        {
           &quot;arrows&quot;: &quot;to&quot;,
           &quot;from&quot;: {
               &quot;bk_classification_id&quot;: &quot;bk_host_manage&quot;,
               &quot;bk_obj_id&quot;: &quot;host&quot;,
               &quot;bk_obj_name&quot;: &quot;主机&quot;,
               &quot;position&quot;: &quot;{\&quot;bk_host_manage\&quot;:{\&quot;x\&quot;:-357,\&quot;y\&quot;:-344},\&quot;lhmtest\&quot;:{\&quot;x\&quot;:163,\&quot;y\&quot;:75}}&quot;,
               &quot;bk_supplier_account&quot;: &quot;0&quot;
           },
           &quot;label&quot;: &quot;switch_to_host&quot;,
           &quot;label_name&quot;: &quot;&quot;,
           &quot;label_type&quot;: &quot;&quot;,
           &quot;to&quot;: {
               &quot;bk_classification_id&quot;: &quot;bk_network&quot;,
               &quot;bk_obj_id&quot;: &quot;bk_switch&quot;,
               &quot;bk_obj_name&quot;: &quot;交换机&quot;,
               &quot;position&quot;: &quot;{\&quot;bk_network\&quot;:{\&quot;x\&quot;:-172,\&quot;y\&quot;:-160}}&quot;,
               &quot;bk_supplier_account&quot;: &quot;0&quot;
           }
        }
   ]
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>arrows</td>
<td>string</td>
<td>取值 to（单向） 或 to,from（双向）</td>
</tr>
<tr>
<td>label_name</td>
<td>string</td>
<td>关联关系的名字</td>
</tr>
<tr>
<td>label</td>
<td>string</td>
<td>表明 From 通过哪个字段关联到 To 的</td>
</tr>
<tr>
<td>from</td>
<td>string</td>
<td>对象模型的英文 id，拓扑关系的发起方</td>
</tr>
<tr>
<td>to</td>
<td>string</td>
<td>对象模型的英文 ID，拓扑关系的终止方</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/search_related_inst_asso/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>查询某实例所有的关联关系（包含其作为关联关系原模型和关联关系目标模型的情况）。(v3.5.36)</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">必选</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">bk_app_code</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">应用 ID</td>
</tr>
<tr>
<td align="left">bk_app_secret</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td align="left">bk_token</td>
<td align="left">string</td>
<td align="left">否</td>
<td align="left">当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td align="left">bk_username</td>
<td align="left">string</td>
<td align="left">否</td>
<td align="left">当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">类型</th>
<th align="left">必选</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">bk_inst_id</td>
<td align="left">int</td>
<td align="left">是</td>
<td align="left">实例 id</td>
</tr>
<tr>
<td align="left">bk_obj_id</td>
<td align="left">string</td>
<td align="left">是</td>
<td align="left">模型 id</td>
</tr>
<tr>
<td align="left">fields</td>
<td align="left">array</td>
<td align="left">Yes</td>
<td align="left">需要返回的字段</td>
</tr>
<tr>
<td align="left">start</td>
<td align="left">int</td>
<td align="left">否</td>
<td align="left">记录开始位置</td>
</tr>
<tr>
<td align="left">limit</td>
<td align="left">int</td>
<td align="left">否</td>
<td align="left">分页大小，最大值 500。</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;condition&quot;: {
        &quot;bk_inst_id&quot;: 8,
        &quot;bk_obj_id&quot;: &quot;bk_router&quot;
    },
    &quot;fields&quot;: [
        &quot;id&quot;,
        &quot;bk_inst_id&quot;,
        &quot;bk_obj_id&quot;,
        &quot;bk_asst_inst_id&quot;,
        &quot;bk_asst_obj_id&quot;,
        &quot;bk_obj_asst_id&quot;,
        &quot;bk_asst_id&quot;
        ],
    &quot;limit&quot;: {
        &quot;start&quot;:1,
        &quot;limit&quot;:2
    }
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;success&quot;,
    &quot;permission&quot;: null,
    &quot;data&quot;: {
        &quot;count&quot;: 2,
        &quot;info&quot;: [
            {
                &quot;id&quot;: 15,
                &quot;bk_inst_id&quot;: 10,
                &quot;bk_obj_id&quot;: &quot;bk_switch&quot;,
                &quot;bk_asst_inst_id&quot;: 8,
                &quot;bk_asst_obj_id&quot;: &quot;bk_router&quot;,
                &quot;bk_obj_asst_id&quot;: &quot;bk_switch_default_bk_router&quot;
            },
            {
                &quot;id&quot;: 14,
                &quot;bk_inst_id&quot;: 9,
                &quot;bk_obj_id&quot;: &quot;bk_switch&quot;,
                &quot;bk_asst_inst_id&quot;: 8,
                &quot;bk_asst_obj_id&quot;: &quot;bk_router&quot;,
                &quot;bk_obj_asst_id&quot;: &quot;bk_switch_default_bk_router&quot;
            }
        ]
    }
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="data">data</h4>
<p>| 名称  | 类型  | 说明 |
|---|---|---|---|
| count| int| 记录条数 |
| info| object array |  查询到的关联关系信息 |</p>
<h4 id="datainfo">data.info 字段说明</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>int64</td>
<td>关联 id</td>
</tr>
<tr>
<td>bk_inst_id</td>
<td>int64</td>
<td>源模型实例 id</td>
</tr>
<tr>
<td>bk_obj_id</td>
<td>string</td>
<td>关联关系源模型 id</td>
</tr>
<tr>
<td>bk_asst_inst_id</td>
<td>int64</td>
<td>关联关系目标模型 id</td>
</tr>
<tr>
<td>bk_asst_obj_id</td>
<td>string</td>
<td>目标模型实例 id</td>
</tr>
<tr>
<td>bk_obj_asst_id</td>
<td>string</td>
<td>自动生成的模型关联关系 id</td>
</tr>
<tr>
<td>bk_asst_id</td>
<td>string</td>
<td>关系名称</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/search_set/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>查询集群</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_supplier_account</td>
<td>string</td>
<td>否</td>
<td>开发商账号</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 id</td>
</tr>
<tr>
<td>fields</td>
<td>array</td>
<td>是</td>
<td>查询字段，所有字段均为 set 定义的字段，这些字段包括预置字段，也包括用户自定义字段</td>
</tr>
<tr>
<td>condition</td>
<td>dict</td>
<td>是</td>
<td>查询条件，所有字段均为 Set 定义的字段，这些字段包括预置字段，也包括用户自定义字段</td>
</tr>
<tr>
<td>page</td>
<td>dict</td>
<td>是</td>
<td>分页条件</td>
</tr>
</tbody>
</table>
<h4 id="page">page</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>start</td>
<td>int</td>
<td>是</td>
<td>记录开始位置</td>
</tr>
<tr>
<td>limit</td>
<td>int</td>
<td>是</td>
<td>每页限制条数,最大 200</td>
</tr>
<tr>
<td>sort</td>
<td>string</td>
<td>否</td>
<td>排序字段</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_supplier_account&quot;: &quot;123456789&quot;,
    &quot;bk_biz_id&quot;: 2,
    &quot;fields&quot;: [
        &quot;bk_set_name&quot;
    ],
    &quot;condition&quot;: {
        &quot;bk_set_name&quot;: &quot;test&quot;
    },
    &quot;page&quot;: {
        &quot;start&quot;: 0,
        &quot;limit&quot;: 10,
        &quot;sort&quot;: &quot;bk_set_name&quot;
    }
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: {
        &quot;count&quot;: 1,
        &quot;info&quot;: [
            {
                &quot;bk_set_name&quot;: &quot;test&quot;
            }
        ]
    }
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>count</td>
<td>int</td>
<td>数据数量</td>
</tr>
<tr>
<td>info</td>
<td>array</td>
<td>结果集，其中，所有字段均为集群定义的属性字段</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/search_subscription/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>查询事件订阅</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>page</td>
<td>object</td>
<td>否</td>
<td>分页参数</td>
</tr>
<tr>
<td>condition</td>
<td>object</td>
<td>否</td>
<td>查询条件</td>
</tr>
</tbody>
</table>
<h4 id="page">page</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>start</td>
<td>int</td>
<td>是</td>
<td>记录开始位置</td>
</tr>
<tr>
<td>limit</td>
<td>int</td>
<td>是</td>
<td>每页限制条数,最大 200</td>
</tr>
<tr>
<td>sort</td>
<td>string</td>
<td>否</td>
<td>排序字段</td>
</tr>
</tbody>
</table>
<h4 id="condition">condition</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>subscription_name</td>
<td>string</td>
<td>是</td>
<td>此处仅为示例数据，需要被设置为查询的字段</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_supplier_account&quot;:&quot;0&quot;,
    &quot;condition&quot;:{
        &quot;subscription_name&quot;:&quot;name&quot;
    },
    &quot;page&quot;:{
        &quot;start&quot;:0,
        &quot;limit&quot;:10,
        &quot;sort&quot;:&quot;HostName&quot;
    }
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;success&quot;,
    &quot;data&quot;: {
        &quot;count&quot;: 1,
        &quot;info&quot;: [
            {
                &quot;subscription_id&quot;: 1,
                &quot;subscription_name&quot;: &quot;mysubscribe&quot;,
                &quot;system_name&quot;: &quot;SystemName&quot;,
                &quot;callback_url&quot;: &quot;http://127.0.0.1:8080/callback&quot;,
                &quot;confirm_mode&quot;: &quot;httpstatus&quot;,
                &quot;confirm_pattern&quot;: &quot;200&quot;,
                &quot;time_out&quot;: 10,
                &quot;subscription_form&quot;: &quot;hostcreate&quot;,
                &quot;operator&quot;: &quot;user&quot;,
                &quot;bk_supplier_account&quot;: &quot;0&quot;,
                &quot;last_time&quot;: &quot;2017-09-19 16:57:07&quot;,
                &quot;statistics&quot;: {
                    &quot;total&quot;: 30,
                    &quot;failure&quot;: 2
                }
            }
        ]
    }
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>count</td>
<td>int</td>
<td>记录条数</td>
</tr>
<tr>
<td>info</td>
<td>object array</td>
<td>事件订阅的详情列表</td>
</tr>
</tbody>
</table>
<h4 id="info">info</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>subscription_id</td>
<td>int</td>
<td>订阅 ID</td>
</tr>
<tr>
<td>subscription_name</td>
<td>string</td>
<td>订阅名</td>
</tr>
<tr>
<td>system_name</td>
<td>string</td>
<td>系统名称</td>
</tr>
<tr>
<td>callback_url</td>
<td>string</td>
<td>回调地址</td>
</tr>
<tr>
<td>confirm_mode</td>
<td>string</td>
<td>回调成功确认模式，可选:httpstatus，regular</td>
</tr>
<tr>
<td>confirm_pattern</td>
<td>string</td>
<td>回调成功标志</td>
</tr>
<tr>
<td>subscription_form</td>
<td>string</td>
<td>订阅单，用","分隔</td>
</tr>
<tr>
<td>timeout</td>
<td>int</td>
<td>超时时间，单位：秒</td>
</tr>
<tr>
<td>operator</td>
<td>int</td>
<td>本条数据的最后更新人员</td>
</tr>
<tr>
<td>last_time</td>
<td>int</td>
<td>更新时间</td>
</tr>
<tr>
<td>statistics.total</td>
<td>int</td>
<td>推送总数</td>
</tr>
<tr>
<td>statistics.failure</td>
<td>int</td>
<td>推送失败数</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/search_topo_tree/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>根据业务名、自定义层级名、集群、模块名模糊搜索业务的拓扑树。</p>
<p>主机规则包括：
- 在多业务搜索下，如果扫描的业务数量超过一定数量，可以直接拒绝搜索，直接返回，报查询数据过多的错误，暂定为 20 个业务。
- 可以支持业务名、自定义层级名、集群、模块组合的查询方式进行模糊搜索。
- 除主机、模块外，其它的这些可以提供当前层级或者下一层级的拓扑信息，但是总的搜索的节点数量不能超过 50 个。如果超过 50 个，则直接拒绝搜索，报查询数据过多的错误。 </p>
<p>注意： 
- 该接口仅用于 web 页面搜索使用，不建议后台使用。
- 该接口有 5 分钟的缓存，在最极端的情况下，5 分钟内的数据可能会不对。
- 每次搜索会自动触发缓存更新，所以在数据不对的情况下，第二次搜索数据即准确。</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 ID，其中-1 代表所有业务，不能为 0。正整数值代表对应的业务 ID</td>
</tr>
<tr>
<td>bk_biz_name</td>
<td>string</td>
<td>是</td>
<td>业务名，业务名和业务 ID 可以选择只用一个，但不能同时为空。如果 bk_biz_id &gt; 0, 则 bk_biz_name 会被忽略,因为已经指定了具体的业务。</td>
</tr>
<tr>
<td>bk_set_name</td>
<td>string</td>
<td>否</td>
<td>集群名</td>
</tr>
<tr>
<td>bk_module_name</td>
<td>string</td>
<td>否</td>
<td>模块名</td>
</tr>
<tr>
<td>bk_level</td>
<td>object</td>
<td>否</td>
<td>自定义层级描述</td>
</tr>
</tbody>
</table>
<p>注意： bk_set_name, bk_module_name, bk_level 只能使用期中一个。 </p>
<ul>
<li>bk_level</li>
</ul>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_obj_id</td>
<td>string</td>
<td>是</td>
<td>自定义层级的模型名称</td>
</tr>
<tr>
<td>bk_inst_name</td>
<td>string</td>
<td>是</td>
<td>自定义层级的实例名称</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;bk_biz_id&quot;: 2,
    &quot;bk_biz_name&quot;: &quot;&quot;,
    &quot;bk_set_name&quot;: &quot;paas&quot;,
    &quot;bk_module_name&quot;: &quot;&quot;,
    &quot;bk_level&quot;: {
        &quot;bk_obj_id&quot;: &quot;&quot;,
        &quot;bk_inst_name&quot;: &quot;&quot;
    }
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-json">{
  &quot;result&quot;: true,
  &quot;code&quot;: 0,
  &quot;message&quot;: &quot;success&quot;,
  &quot;permission&quot;: null,
  &quot;data&quot;: [
    {
      &quot;bk_biz_id&quot;: 2,
      &quot;bk_biz_name&quot;: &quot;蓝鲸&quot;,
      &quot;bk_topo_tree&quot;: [
        {
          &quot;bk_obj_id&quot;: &quot;set&quot;,
          &quot;bk_inst_name&quot;: &quot;PaaS平台&quot;,
          &quot;bk_inst_id&quot;: 4,
          &quot;children&quot;: [
            {
              &quot;bk_obj_id&quot;: &quot;module&quot;,
              &quot;bk_inst_name&quot;: &quot;nginx&quot;,
              &quot;bk_inst_id&quot;: 15,
              &quot;children&quot;: null
            },
            {
              &quot;bk_obj_id&quot;: &quot;module&quot;,
              &quot;bk_inst_name&quot;: &quot;elasticsearch&quot;,
              &quot;bk_inst_id&quot;: 14,
              &quot;children&quot;: null
            },
            {
              &quot;bk_obj_id&quot;: &quot;module&quot;,
              &quot;bk_inst_name&quot;: &quot;nfs&quot;,
              &quot;bk_inst_id&quot;: 5000083,
              &quot;children&quot;: null
            }
          ]
        }
      ]
    }
  ]
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="data-array">data array</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>业务 ID</td>
</tr>
<tr>
<td>bk_biz_name</td>
<td>string</td>
<td>业务名</td>
</tr>
<tr>
<td>bk_topo_tree</td>
<td>Object Array</td>
<td>根据查询条件生成的拓扑树层级信息，该树包含查询对象到业务根节点的所有层级信息，及下一层级信息，但模块例外，没有下一层级。</td>
</tr>
</tbody>
</table>
<h4 id="bk_obj_tree-array">bk_obj_tree array</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_obj_id</td>
<td>string</td>
<td>对象类型，可以为自定义层级对名称，set,module 名称</td>
</tr>
<tr>
<td>bk_inst_name</td>
<td>string</td>
<td>对象名，如集群名、模块名等</td>
</tr>
<tr>
<td>bk_inst_id</td>
<td>Int</td>
<td>对象实例身份 id，唯一标识这个实例 ID</td>
</tr>
<tr>
<td>children</td>
<td>object array</td>
<td>表示该对象实例的子节点信息，可以是自定义层级集群、模块等</td>
</tr>
</tbody>
</table>
<h4 id="children-array">children array</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_obj_id</td>
<td>string</td>
<td>对象类型，可以为自定义层级对名称，set,module 名称</td>
</tr>
<tr>
<td>bk_inst_name</td>
<td>string</td>
<td>对象名，如集群名、模块名等</td>
</tr>
<tr>
<td>bk_inst_id</td>
<td>Int</td>
<td>对象实例身份 id，唯一标识这个实例 ID</td>
</tr>
</tbody>
</table>
<p>注意： 模块没有子层级，即没有 children.</p><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/subscribe_event/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>订阅事件</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>subscription_name</td>
<td>string</td>
<td>是</td>
<td>订阅的名字</td>
</tr>
<tr>
<td>system_name</td>
<td>string</td>
<td>是</td>
<td>订阅事件的系统的名字</td>
</tr>
<tr>
<td>callback_url</td>
<td>string</td>
<td>是</td>
<td>回调函数</td>
</tr>
<tr>
<td>confirm_mode</td>
<td>string</td>
<td>是</td>
<td>事件发送成功校验模式,可选 1-httpstatus,2-regular</td>
</tr>
<tr>
<td>confirm_pattern</td>
<td>string</td>
<td>是</td>
<td>callback 的 httpstatus 或正则</td>
</tr>
<tr>
<td>subscription_form</td>
<td>string</td>
<td>是</td>
<td>订阅的事件,以逗号分隔</td>
</tr>
<tr>
<td>timeout</td>
<td>int</td>
<td>是</td>
<td>发送事件超时时间</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
  &quot;bk_supplier_account&quot;: &quot;0&quot;,
  &quot;subscription_name&quot;:&quot;mysubscribe&quot;,
  &quot;system_name&quot;:&quot;SystemName&quot;,
  &quot;callback_url&quot;:&quot;http://127.0.0.1:8080/callback&quot;,
  &quot;confirm_mode&quot;:&quot;httpstatus&quot;,
  &quot;confirm_pattern&quot;:&quot;200&quot;,
  &quot;subscription_form&quot;:&quot;hostcreate&quot;,
  &quot;timeout&quot;:10
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;:{
        &quot;subscription_id&quot;: 1
    }
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>subscription_id</td>
<td>int</td>
<td>新增订阅的订阅 ID</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/sync_set_template_to_set/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>根据业务 id，集群模板 id,待同步集群 id 列表，将指定业务下的集群模板同步到集群</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 ID</td>
</tr>
<tr>
<td>set_template_id</td>
<td>int</td>
<td>是</td>
<td>集群模板 ID</td>
</tr>
<tr>
<td>bk_set_ids</td>
<td>array</td>
<td>是</td>
<td>待同步集群 ID 列表</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;bk_supplier_account&quot;: &quot;0&quot;,
    &quot;bk_biz_id&quot;: 20,
    &quot;set_template_id&quot;: 6,
    &quot;bk_set_ids&quot;: [46]
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;success&quot;,
    &quot;permission&quot;: null,
    &quot;data&quot;: null
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="response">response</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>请求成功与否。true:请求成功；false 请求失败</td>
</tr>
<tr>
<td>code</td>
<td>int</td>
<td>错误编码。 0 表示 success，&gt;0 表示失败错误</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>请求失败返回的错误信息</td>
</tr>
<tr>
<td>data</td>
<td>object</td>
<td>请求返回的数据</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/transfer_host_module/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>业务内主机转移模块</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_supplier_account</td>
<td>string</td>
<td>否</td>
<td>开发商账号</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 ID</td>
</tr>
<tr>
<td>bk_host_id</td>
<td>array</td>
<td>是</td>
<td>主机 ID</td>
</tr>
<tr>
<td>bk_module_id</td>
<td>array</td>
<td>是</td>
<td>模块 ID</td>
</tr>
<tr>
<td>is_increment</td>
<td>bool</td>
<td>是</td>
<td>覆盖或者追加,会删除原有关系. true 是更新，false 是覆盖</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_supplier_account&quot;: &quot;123456789&quot;,
    &quot;bk_biz_id&quot;: 1,
    &quot;bk_host_id&quot;: [
        9,
        10
    ],
    &quot;bk_module_id&quot;: [
        10
    ],
    &quot;is_increment&quot;: true
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: {}
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/transfer_host_to_faultmodule/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>上交主机到业务的故障机模块</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_supplier_account</td>
<td>string</td>
<td>否</td>
<td>开发商账号</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 ID</td>
</tr>
<tr>
<td>bk_host_id</td>
<td>array</td>
<td>是</td>
<td>主机 ID</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_supplier_account&quot;: &quot;123456789&quot;,
    &quot;bk_biz_id&quot;: 1,
    &quot;bk_host_id&quot;: [
        9,
        10
    ]
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: {}
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/transfer_host_to_idlemodule/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>上交主机到业务的空闲机模块</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_supplier_account</td>
<td>string</td>
<td>否</td>
<td>开发商账号</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 ID</td>
</tr>
<tr>
<td>bk_host_id</td>
<td>array</td>
<td>是</td>
<td>主机 ID</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_supplier_account&quot;: &quot;123456789&quot;,
    &quot;bk_biz_id&quot;: 1,
    &quot;bk_host_id&quot;: [
        9,
        10
    ]
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: {}
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/transfer_host_to_resourcemodule/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>上交主机至资源池</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_supplier_account</td>
<td>string</td>
<td>否</td>
<td>开发商账号</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 ID</td>
</tr>
<tr>
<td>bk_host_id</td>
<td>array</td>
<td>是</td>
<td>主机 ID</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_supplier_account&quot;: &quot;123456789&quot;,
    &quot;bk_biz_id&quot;: 1,
    &quot;bk_host_id&quot;: [
        9,
        10
    ]
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: {}
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/transfer_resourcehost_to_idlemodule/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>资源池主机分配至业务的空闲机模块</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_supplier_account</td>
<td>string</td>
<td>否</td>
<td>开发商账号</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 ID</td>
</tr>
<tr>
<td>bk_host_id</td>
<td>array</td>
<td>是</td>
<td>主机 ID</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_supplier_account&quot;: &quot;123456789&quot;,
    &quot;bk_biz_id&quot;: 1,
    &quot;bk_host_id&quot;: [
        9,
        10
    ]
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: {}
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/transfer_sethost_to_idle_module/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>根据业务 id,集群 id,模块 id,将指定业务集群模块下的主机上交到业务的空闲机模块</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 id</td>
</tr>
<tr>
<td>bk_set_id</td>
<td>int</td>
<td>是</td>
<td>集群 id</td>
</tr>
<tr>
<td>bk_module_id</td>
<td>int</td>
<td>是</td>
<td>模块 id</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_biz_id&quot;:10,
    &quot;bk_module_id&quot;:58,
    &quot;bk_set_id&quot;:1
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: &quot;sucess&quot;
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/unsubcribe_event/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>退订事件</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>subscription_id</td>
<td>int</td>
<td>是</td>
<td>订阅 ID</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_supplier_account&quot;:&quot;0&quot;,
    &quot;subscription_id&quot;:1
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;:&quot;success&quot;
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/update_biz_custom_field/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>更新业务自定义模型属性</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>int</td>
<td>是</td>
<td>目标数据的记录 ID</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 id</td>
</tr>
<tr>
<td>description</td>
<td>string</td>
<td>否</td>
<td>数据的描述信息</td>
</tr>
<tr>
<td>isonly</td>
<td>bool</td>
<td>否</td>
<td>表明唯一性</td>
</tr>
<tr>
<td>isreadonly</td>
<td>bool</td>
<td>否</td>
<td>表明是否只读</td>
</tr>
<tr>
<td>isrequired</td>
<td>bool</td>
<td>否</td>
<td>表明是否必填</td>
</tr>
<tr>
<td>bk_property_group</td>
<td>string</td>
<td>否</td>
<td>字段分栏的名字</td>
</tr>
<tr>
<td>option</td>
<td>object</td>
<td>否</td>
<td _min_:1_max_:2="&quot;min&quot;:1,&quot;max&quot;:2">用户自定义内容，存储的内容及格式由调用方决定, 以数字内容为例（</td>
</tr>
<tr>
<td>bk_property_name</td>
<td>string</td>
<td>否</td>
<td>模型属性名，用于展示</td>
</tr>
<tr>
<td>bk_property_type</td>
<td>string</td>
<td>否</td>
<td>定义的属性字段用于存储数据的数据类型（singlechar,longchar,int,enum,date,time,objuser,singleasst,multiasst,timezone,bool)</td>
</tr>
<tr>
<td>unit</td>
<td>string</td>
<td>否</td>
<td>单位</td>
</tr>
<tr>
<td>placeholder</td>
<td>string</td>
<td>否</td>
<td>占位符</td>
</tr>
<tr>
<td>bk_asst_obj_id</td>
<td>string</td>
<td>否</td>
<td>如果有关联其它的模型，那么就必需设置此字段，否则就不需要设置</td>
</tr>
</tbody>
</table>
<h4 id="bk_property_type">bk_property_type</h4>
<table>
<thead>
<tr>
<th>标识</th>
<th>名字</th>
</tr>
</thead>
<tbody>
<tr>
<td>singlechar</td>
<td>短字符</td>
</tr>
<tr>
<td>longchar</td>
<td>长字符</td>
</tr>
<tr>
<td>int</td>
<td>整形</td>
</tr>
<tr>
<td>enum</td>
<td>枚举类型</td>
</tr>
<tr>
<td>date</td>
<td>日期</td>
</tr>
<tr>
<td>time</td>
<td>时间</td>
</tr>
<tr>
<td>objuser</td>
<td>用户</td>
</tr>
<tr>
<td>singleasst</td>
<td>单关联</td>
</tr>
<tr>
<td>multiasst</td>
<td>多关联</td>
</tr>
<tr>
<td>timezone</td>
<td>时区</td>
</tr>
<tr>
<td>bool</td>
<td>布尔</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;id&quot;:1,
    &quot;bk_biz_id&quot;: 2,
    &quot;description&quot;:&quot;test&quot;,
    &quot;placeholder&quot;:&quot;test&quot;,
    &quot;unit&quot;:&quot;1&quot;,
    &quot;isonly&quot;:false,
    &quot;isreadonly&quot;:false,
    &quot;isrequired&quot;:false,
    &quot;bk_property_group&quot;:&quot;default&quot;,
    &quot;option&quot;:{&quot;min&quot;:1,&quot;max&quot;:4},
    &quot;bk_property_name&quot;:&quot;aaa&quot;,
    &quot;bk_property_type&quot;:&quot;int&quot;,
    &quot;bk_asst_obj_id&quot;:&quot;0&quot;
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;success&quot;,
    &quot;data&quot;: null
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/update_business/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>更新业务信息</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_supplier_account</td>
<td>string</td>
<td>否</td>
<td>开发商账号</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 id</td>
</tr>
<tr>
<td>data</td>
<td>dict</td>
<td>是</td>
<td>业务数据</td>
</tr>
</tbody>
</table>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_name</td>
<td>string</td>
<td>否</td>
<td>业务名</td>
</tr>
<tr>
<td>bk_biz_developer</td>
<td>string</td>
<td>否</td>
<td>开发人员</td>
</tr>
<tr>
<td>bk_biz_maintainer</td>
<td>string</td>
<td>否</td>
<td>运维人员</td>
</tr>
<tr>
<td>bk_biz_productor</td>
<td>string</td>
<td>否</td>
<td>产品人员</td>
</tr>
<tr>
<td>bk_biz_tester</td>
<td>string</td>
<td>否</td>
<td>测试人员</td>
</tr>
</tbody>
</table>
<p><strong>注意：此处的输入参数仅对必填以及系统内置的参数做了说明，其余需要填写的参数取决于用户自己定义的属性字段</strong></p>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_supplier_account&quot;: &quot;123456789&quot;,
    &quot;bk_biz_id&quot;: 1,
    &quot;data&quot;: {
        &quot;bk_biz_name&quot;: &quot;cc_app_test&quot;,
        &quot;bk_biz_maintainer&quot;: &quot;admin&quot;,
        &quot;bk_biz_productor&quot;: &quot;admin&quot;,
        &quot;bk_biz_developer&quot;: &quot;admin&quot;,
        &quot;bk_biz_tester&quot;: &quot;admin&quot;,
    }
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: {}
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/update_business_enable_status/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>根据业务 id 和状态值修改业务启用状态</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 id</td>
</tr>
<tr>
<td>flag</td>
<td>string</td>
<td>是</td>
<td>启用状态，为 disabled 或者 enable</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_biz_id&quot;: &quot;3&quot;,
    &quot;bk_supplier_account&quot;: &quot;0&quot;,
    &quot;flag&quot;: &quot;enable&quot;
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: &quot;success&quot;
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/update_classification/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>更新模型分类</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>int</td>
<td>否</td>
<td>目标数据的记录 ID，作为更新操作的条件</td>
</tr>
<tr>
<td>bk_classification_name</td>
<td>string</td>
<td>否</td>
<td>分类名</td>
</tr>
<tr>
<td>bk_classification_icon</td>
<td>string</td>
<td>否</td>
<td>模型分类的图标,取值可参考，取值可参考<a href="resource_define/classIcon.json">(classIcon.json)</a></td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;id&quot;: 1,
    &quot;bk_classification_name&quot;: &quot;cc_test_new&quot;,
    &quot;bk_classification_icon&quot;: &quot;icon-cc-business&quot;
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: &quot;success&quot;
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/update_cloud_area/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>更新云区域</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_cloud_id</td>
<td>int</td>
<td>是</td>
<td>云区域 ID</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_cloud_name&quot;: &quot;云区域1&quot;
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: &quot;success&quot;
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/update_custom_query/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>更新自定义查询</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_supplier_account</td>
<td>string</td>
<td>否</td>
<td>开发商账号</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 ID</td>
</tr>
<tr>
<td>id</td>
<td>string</td>
<td>是</td>
<td>主键 ID</td>
</tr>
<tr>
<td>info</td>
<td>string</td>
<td>否</td>
<td>通用查询条件</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>否</td>
<td>收藏的名称</td>
</tr>
</tbody>
</table>
<h4 id="info">info</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_obj_id</td>
<td>string</td>
<td>否</td>
<td>对象名,可以为 biz,set,module,host,object</td>
</tr>
<tr>
<td>fields</td>
<td>array</td>
<td>否</td>
<td>查询输出字段</td>
</tr>
<tr>
<td>condition</td>
<td>array</td>
<td>否</td>
<td>查询条件</td>
</tr>
</tbody>
</table>
<h4 id="infoconditioncondition">info.condition.condition</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>field</td>
<td>string</td>
<td>否</td>
<td>对象的字段</td>
</tr>
<tr>
<td>operator</td>
<td>string</td>
<td>否</td>
<td>操作符, $eq 为相等，$ne 为不等，$in 为属于，$nin 为不属于</td>
</tr>
<tr>
<td>value</td>
<td>string</td>
<td>否</td>
<td>字段对应的值</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_supplier_account&quot;: &quot;123456789&quot;,
    &quot;bk_biz_id&quot;: 1,
    &quot;id&quot;: &quot;xxx&quot;,
    &quot;info&quot;: &quot;{\&quot;condition\&quot;:[{\&quot;bk_obj_id\&quot;:\&quot;biz\&quot;,\&quot;condition\&quot;:[{\&quot;field\&quot;:\&quot;default\&quot;,\&quot;operator\&quot;:\&quot;$ne\&quot;,\&quot;value\&quot;:1}],\&quot;fields\&quot;:[]},{\&quot;bk_obj_id\&quot;:\&quot;set\&quot;,\&quot;condition\&quot;:[],\&quot;fields\&quot;:[]},{\&quot;bk_obj_id\&quot;:\&quot;module\&quot;,\&quot;condition\&quot;:[],\&quot;fields\&quot;:[]},{\&quot;bk_obj_id\&quot;:\&quot;host\&quot;,\&quot;condition\&quot;:[{\&quot;field\&quot;:\&quot;bk_host_innerip\&quot;,\&quot;operator\&quot;:\&quot;$eq\&quot;,\&quot;value\&quot;:\&quot;127.0.0.1\&quot;}],\&quot;fields\&quot;:[\&quot;bk_host_innerip\&quot;,\&quot;bk_host_outerip\&quot;,\&quot;bk_agent_status\&quot;]}]}&quot;,
    &quot;name&quot;: &quot;api1&quot;
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: {}
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/update_dynamic_group/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>更新动态分组 (V3.9.6)</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 ID</td>
</tr>
<tr>
<td>id</td>
<td>string</td>
<td>是</td>
<td>主键 ID</td>
</tr>
<tr>
<td>bk_obj_id</td>
<td>string</td>
<td>否</td>
<td>动态分组的目标资源对象类型, 目前可以为 host,set.更新规则时需同时提供该字段和 info 两个字段</td>
</tr>
<tr>
<td>info</td>
<td>object</td>
<td>否</td>
<td>通用查询条件</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>否</td>
<td>动态分组名称</td>
</tr>
</tbody>
</table>
<h4 id="infocondition">info.condition</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_obj_id</td>
<td>string</td>
<td>是</td>
<td>条件对象资源类型, host 类型的动态分组支持的 info.conditon:set,module,host；set 类型的动态分组支持的 info.condition:set</td>
</tr>
<tr>
<td>condition</td>
<td>array</td>
<td>是</td>
<td>查询条件</td>
</tr>
</tbody>
</table>
<h4 id="infoconditioncondition">info.condition.condition</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>field</td>
<td>string</td>
<td>是</td>
<td>对象的字段</td>
</tr>
<tr>
<td>operator</td>
<td>string</td>
<td>是</td>
<td>操作符, op 值为 eq(相等)/ne(不等)/in(属于)/nin(不属于)</td>
</tr>
<tr>
<td>value</td>
<td>object</td>
<td>是</td>
<td>字段对应的值</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_biz_id&quot;: 1,
    &quot;id&quot;: &quot;XXXXXXXX&quot;,
    &quot;bk_obj_id&quot;: &quot;host&quot;,
    &quot;name&quot;: &quot;my-dynamic-group&quot;,
    &quot;info&quot;: {
        &quot;condition&quot;:[
            {
                &quot;bk_obj_id&quot;:&quot;set&quot;,
                &quot;condition&quot;:[
                    {
                        &quot;field&quot;:&quot;default&quot;,
                        &quot;operator&quot;:&quot;$ne&quot;,
                        &quot;value&quot;:1
                    }
                ]
            },
            {
                &quot;bk_obj_id&quot;:&quot;module&quot;,
                &quot;condition&quot;:[
                    {
                        &quot;field&quot;:&quot;default&quot;,
                        &quot;operator&quot;:&quot;$ne&quot;,
                        &quot;value&quot;:1
                    }
                ]
            },
            {
                &quot;bk_obj_id&quot;:&quot;host&quot;,
                &quot;condition&quot;:[
                    {
                        &quot;field&quot;:&quot;bk_host_innerip&quot;,
                        &quot;operator&quot;:&quot;$eq&quot;,
                        &quot;value&quot;:&quot;127.0.0.1&quot;
                    }
                ]
            }
        ]
    }
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: {}
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/update_event_subscribe/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>修改订阅</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_supplier_account</td>
<td>string</td>
<td>是</td>
<td>开发商账号</td>
</tr>
<tr>
<td>subscription_id</td>
<td>int</td>
<td>是</td>
<td>订阅 ID</td>
</tr>
<tr>
<td>subscription_name</td>
<td>string</td>
<td>是</td>
<td>订阅的名字</td>
</tr>
<tr>
<td>system_name</td>
<td>string</td>
<td>是</td>
<td>订阅事件的系统的名字</td>
</tr>
<tr>
<td>callback_url</td>
<td>string</td>
<td>是</td>
<td>回调函数</td>
</tr>
<tr>
<td>confirm_mode</td>
<td>string</td>
<td>是</td>
<td>事件发送成功校验模式,可选 1-httpstatus,2-regular</td>
</tr>
<tr>
<td>confirm_pattern</td>
<td>string</td>
<td>是</td>
<td>callback 的 httpstatus 或正则</td>
</tr>
<tr>
<td>subscription_form</td>
<td>string</td>
<td>是</td>
<td>订阅的事件,以逗号分隔</td>
</tr>
<tr>
<td>timeout</td>
<td>int</td>
<td>是</td>
<td>发送事件超时时间</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
  &quot;bk_supplier_account&quot;: &quot;0&quot;,
  &quot;subscription_name&quot;:&quot;mysubscribe&quot;,
  &quot;subscription_id&quot;: 2,
  &quot;system_name&quot;:&quot;SystemName&quot;,
  &quot;callback_url&quot;:&quot;http://127.0.0.1:8080/callback&quot;,
  &quot;confirm_mode&quot;:&quot;httpstatus&quot;,
  &quot;confirm_pattern&quot;:&quot;200&quot;,
  &quot;subscription_form&quot;:&quot;hostcreate&quot;,
  &quot;timeout&quot;:10
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: &quot;success&quot;
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/update_host/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>更新主机属性</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_supplier_account</td>
<td>string</td>
<td>否</td>
<td>开发商账号</td>
</tr>
<tr>
<td>bk_host_id</td>
<td>string</td>
<td>是</td>
<td>主机 ID，多个以逗号分隔</td>
</tr>
<tr>
<td>data</td>
<td>dict</td>
<td>否</td>
<td>主机数据</td>
</tr>
</tbody>
</table>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_host_name</td>
<td>string</td>
<td>否</td>
<td>主机名</td>
</tr>
</tbody>
</table>
<p><strong>注意：输入的字段为主机定义的属性</strong></p>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_supplier_account&quot;: &quot;123456789&quot;,
    &quot;bk_host_id&quot;: &quot;1,2,3&quot;,
    &quot;data&quot;: {
        &quot;bk_host_name&quot;: &quot;test&quot;
    }
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: none
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/update_host_cloud_area_field/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>根据主机 id 列表和云区域 id,更新主机的云区域字段</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>否</td>
<td>业务 ID</td>
</tr>
<tr>
<td>bk_cloud_id</td>
<td>int</td>
<td>是</td>
<td>云区域 ID</td>
</tr>
<tr>
<td>bk_host_ids</td>
<td>array</td>
<td>是</td>
<td>主机 IDs, 最多 2000 个</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_host_ids&quot;: [43, 44], 
    &quot;bk_cloud_id&quot;: 27,
    &quot;bk_biz_id&quot;: 1
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
  &quot;result&quot;: true,
  &quot;code&quot;: 0,
  &quot;message&quot;: &quot;success&quot;,
  &quot;permission&quot;: null,
  &quot;data&quot;: &quot;&quot;
}</code></pre>


<h3 id="-ip">返回结果实例 - 云区域 + 内网 IP 重复</h3>
<pre class="codehilite"><code class="language-python">{
  &quot;result&quot;: false,
  &quot;code&quot;: 1199014,
  &quot;message&quot;: &quot;数据唯一性校验失败， bk_host_innerip 重复&quot;,
  &quot;permission&quot;: null,
  &quot;data&quot;: null
}</code></pre>


<h3 id="-">返回结果实例 - 一次操作主机数太多</h3>
<pre class="codehilite"><code class="language-python">{
  &quot;result&quot;: false,
  &quot;code&quot;: 1199077,
  &quot;message&quot;: &quot;一次操作记录数超过最大限制：2000&quot;,
  &quot;permission&quot;: null,
  &quot;data&quot;: null
}</code></pre>


<p>```bash</p>
<h3 id="_9">返回结果参数说明</h3>
<h4 id="response">response</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>请求成功与否。true:请求成功；false请求失败</td>
</tr>
<tr>
<td>code</td>
<td>int</td>
<td>错误编码。 0表示success，&gt;0表示失败错误</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>请求失败返回的错误信息</td>
</tr>
<tr>
<td>data</td>
<td>object</td>
<td>无数据返回</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/update_inst/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>更新对象实例</p>
<ul>
<li>该接口只适用于自定义层级模型和通用模型实例上，不适用于业务、集群、模块、主机等模型实例</li>
</ul>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_obj_id</td>
<td>string</td>
<td>是</td>
<td>模型 ID</td>
</tr>
<tr>
<td>bk_inst_id</td>
<td>int</td>
<td>是</td>
<td>实例 ID</td>
</tr>
<tr>
<td>bk_inst_name</td>
<td>string</td>
<td>否</td>
<td>实例名，也可以为其它自定义字段</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>否</td>
<td>业务 ID， 当删除的是自定义主线层级模型实例时则必传</td>
</tr>
</tbody>
</table>
<p>注意：当操作的是自定义主线层级模型实例时，而又有使用权限中心的，对于 cmdb 小于 3.9 的版本，还需要传包含实例所在业务 id 的 metadata 参数，否则会导致权限中心鉴权失败，格式为
"metadata": {
    "label": {
        "bk_biz_id": "64"
    }
}</p>
<h3 id="_7">请求参数示例(通用实例示例)</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;bk_supplier_account&quot;: &quot;0&quot;,
    &quot;bk_obj_id&quot;: &quot;1&quot;,
    &quot;bk_inst_id&quot;: 0,
    &quot;bk_inst_name&quot;: &quot;test&quot;
 }</code></pre>


<h3 id="json">json</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: &quot;success&quot;
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/update_module/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>更新模块</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_supplier_account</td>
<td>string</td>
<td>否</td>
<td>开发商账号</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 id</td>
</tr>
<tr>
<td>bk_set_id</td>
<td>int</td>
<td>是</td>
<td>集群 id</td>
</tr>
<tr>
<td>bk_module_id</td>
<td>int</td>
<td>是</td>
<td>模块 id</td>
</tr>
<tr>
<td>data</td>
<td>dict</td>
<td>是</td>
<td>模块数据</td>
</tr>
</tbody>
</table>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_module_name</td>
<td>string</td>
<td>否</td>
<td>模块名</td>
</tr>
</tbody>
</table>
<p><strong>注意：输入的字段为模块定义的属性</strong></p>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_supplier_account&quot;: &quot;123456789&quot;,
    &quot;bk_biz_id&quot;: 1,
    &quot;bk_set_id&quot;: 1,
    &quot;bk_module_id&quot;: 1,
    &quot;data&quot;: {
        &quot;bk_module_name&quot;: &quot;test&quot;
    }
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: {}
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/update_object/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>更新模型定义</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>int</td>
<td>否</td>
<td>对象模型的 ID，作为更新操作的条件</td>
</tr>
<tr>
<td>modifier</td>
<td>string</td>
<td>否</td>
<td>本条数据的最后修改人员</td>
</tr>
<tr>
<td>bk_classification_id</td>
<td>string</td>
<td>是</td>
<td>对象模型的分类 ID，只能用英文字母序列命名</td>
</tr>
<tr>
<td>bk_obj_name</td>
<td>string</td>
<td>否</td>
<td>对象模型的名字</td>
</tr>
<tr>
<td>bk_obj_icon</td>
<td>string</td>
<td>否</td>
<td>对象模型的 ICON 信息，用于前端显示，取值可参考<a href="/static/esb/api_docs/res/cc/modleIcon.json">(modleIcon.json)</a></td>
</tr>
<tr>
<td>position</td>
<td>json object string</td>
<td>否</td>
<td>用于前端展示的坐标</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;id&quot;: 1,
    &quot;modifier&quot;: &quot;admin&quot;,
    &quot;bk_classification_id&quot;: &quot;cc_test&quot;,
    &quot;bk_obj_name&quot;: &quot;cc2_test_inst&quot;,
    &quot;bk_supplier_account&quot;: &quot;0&quot;,
    &quot;bk_obj_icon&quot;: &quot;icon-cc-business&quot;,
    &quot;position&quot;:&quot;{\&quot;ff\&quot;:{\&quot;x\&quot;:-863,\&quot;y\&quot;:1}}&quot;
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: &quot;success&quot;
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/update_object_attribute/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>更新对象模型属性</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>int</td>
<td>是</td>
<td>目标数据的记录 ID</td>
</tr>
<tr>
<td>description</td>
<td>string</td>
<td>否</td>
<td>数据的描述信息</td>
</tr>
<tr>
<td>isonly</td>
<td>bool</td>
<td>否</td>
<td>表明唯一性</td>
</tr>
<tr>
<td>isreadonly</td>
<td>bool</td>
<td>否</td>
<td>表明是否只读</td>
</tr>
<tr>
<td>isrequired</td>
<td>bool</td>
<td>否</td>
<td>表明是否必填</td>
</tr>
<tr>
<td>bk_property_group</td>
<td>string</td>
<td>否</td>
<td>字段分栏的名字</td>
</tr>
<tr>
<td>option</td>
<td>string</td>
<td>否</td>
<td _min_:_1_max_:_2_="&quot;min&quot;:&quot;1&quot;,&quot;max&quot;:&quot;2&quot;">用户自定义内容，存储的内容及格式由调用方决定, 以数字内容为例（</td>
</tr>
<tr>
<td>bk_property_name</td>
<td>string</td>
<td>否</td>
<td>模型属性名，用于展示</td>
</tr>
<tr>
<td>bk_property_type</td>
<td>string</td>
<td>否</td>
<td>定义的属性字段用于存储数据的数据类型（singlechar,longchar,int,enum,date,time,objuser,singleasst,multiasst,timezone,bool)</td>
</tr>
<tr>
<td>unit</td>
<td>string</td>
<td>否</td>
<td>单位</td>
</tr>
<tr>
<td>placeholder</td>
<td>string</td>
<td>否</td>
<td>占位符</td>
</tr>
<tr>
<td>bk_asst_obj_id</td>
<td>string</td>
<td>否</td>
<td>如果有关联其它的模型，那么就必需设置此字段，否则就不需要设置</td>
</tr>
</tbody>
</table>
<h4 id="bk_property_type">bk_property_type</h4>
<table>
<thead>
<tr>
<th>标识</th>
<th>名字</th>
</tr>
</thead>
<tbody>
<tr>
<td>singlechar</td>
<td>短字符</td>
</tr>
<tr>
<td>longchar</td>
<td>长字符</td>
</tr>
<tr>
<td>int</td>
<td>整形</td>
</tr>
<tr>
<td>enum</td>
<td>枚举类型</td>
</tr>
<tr>
<td>date</td>
<td>日期</td>
</tr>
<tr>
<td>time</td>
<td>时间</td>
</tr>
<tr>
<td>objuser</td>
<td>用户</td>
</tr>
<tr>
<td>singleasst</td>
<td>单关联</td>
</tr>
<tr>
<td>multiasst</td>
<td>多关联</td>
</tr>
<tr>
<td>timezone</td>
<td>时区</td>
</tr>
<tr>
<td>bool</td>
<td>布尔</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;id&quot;:1,
    &quot;description&quot;:&quot;test&quot;,
    &quot;placeholder&quot;:&quot;test&quot;,
    &quot;unit&quot;:&quot;1&quot;,
    &quot;isonly&quot;:false,
    &quot;isreadonly&quot;:false,
    &quot;isrequired&quot;:false,
    &quot;bk_property_group&quot;:&quot;default&quot;,
    &quot;option&quot;:&quot;{\&quot;min\&quot;:\&quot;1\&quot;,\&quot;max\&quot;:\&quot;4\&quot;}&quot;,
    &quot;bk_property_name&quot;:&quot;aaa&quot;,
    &quot;bk_property_type&quot;:&quot;int&quot;,
    &quot;bk_asst_obj_id&quot;:&quot;0&quot;
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: &quot;success&quot;
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/update_object_topo_graphics/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>更新拓扑图</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_supplier_account</td>
<td>string</td>
<td>否</td>
<td>开发商账号</td>
</tr>
<tr>
<td>scope_type</td>
<td>string</td>
<td>是</td>
<td>图形范围类型,可选 global,biz,cls(当前只有 global)</td>
</tr>
<tr>
<td>scope_id</td>
<td>string</td>
<td>是</td>
<td>图形范围类型下的 ID,如果为 global,则填 0</td>
</tr>
<tr>
<td>action</td>
<td>string</td>
<td>是</td>
<td>更新方法,可选 update,override</td>
</tr>
<tr>
<td>data</td>
<td>list</td>
<td>否</td>
<td>更新数据</td>
</tr>
</tbody>
</table>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>node_type</td>
<td>string</td>
<td>是</td>
<td>节点类型,可选 obj,inst</td>
</tr>
<tr>
<td>bk_obj_id</td>
<td>string</td>
<td>是</td>
<td>对象模型的 ID</td>
</tr>
<tr>
<td>bk_inst_id</td>
<td>int</td>
<td>是</td>
<td>实例 ID</td>
</tr>
<tr>
<td>position</td>
<td>dict</td>
<td>否</td>
<td>节点在图中的位置</td>
</tr>
<tr>
<td>ext</td>
<td>dict</td>
<td>否</td>
<td>前端扩展字段</td>
</tr>
<tr>
<td>bk_obj_icon</td>
<td>string</td>
<td>否</td>
<td>对象模型的图标</td>
</tr>
</tbody>
</table>
<p><strong>注意</strong>：</p>
<ul>
<li>
<p>scope_type,scope_id 唯一确定一张图</p>
</li>
<li>
<p>node_type,bk_obj_id,bk_inst_id 三者唯一确定每张图的一个节点，故必填</p>
</li>
</ul>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_supplier_account&quot;: &quot;123456789&quot;,
    &quot;scope_type&quot;: &quot;global&quot;,
    &quot;scope_id&quot;: 0,
    &quot;action&quot;: &quot;update&quot;,
    &quot;data&quot;: [
        {
            &quot;node_type&quot;: &quot;obj&quot;,
            &quot;bk_obj_id&quot;: &quot;switch&quot;,
            &quot;bk_inst_id&quot;: 0,
            &quot;position&quot;: {
                &quot;x&quot;: 100,
                &quot;y&quot;: 100
            },
            &quot;ext&quot;: {},
            &quot;bk_obj_icon&quot;: &quot;icon-cc-switch2&quot;
        }
    ]
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;success&quot;,
    &quot;data&quot;: &quot;success&quot;
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/update_process_instance/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>批量更新进程信息</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>processes</td>
<td>array</td>
<td>是</td>
<td>进程信息</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
  &quot;bk_biz_id&quot;: 1,
  &quot;processes&quot;: [
    {
      &quot;bk_process_id&quot;: 43,
      &quot;bk_supplier_account&quot;: &quot;0&quot;,
      &quot;description&quot;: &quot;&quot;,
      &quot;start_cmd&quot;: &quot;&quot;,
      &quot;restart_cmd&quot;: &quot;&quot;,
      &quot;pid_file&quot;: &quot;&quot;,
      &quot;auto_start&quot;: false,
      &quot;timeout&quot;: 30,
      &quot;auto_time_gap&quot;: 60,
      &quot;reload_cmd&quot;: &quot;&quot;,
      &quot;bk_func_name&quot;: &quot;java&quot;,
      &quot;work_path&quot;: &quot;/data/bkce&quot;,
      &quot;stop_cmd&quot;: &quot;&quot;,
      &quot;face_stop_cmd&quot;: &quot;&quot;,
      &quot;bk_process_name&quot;: &quot;job_java&quot;,
      &quot;user&quot;: &quot;&quot;,
      &quot;proc_num&quot;: 1,
      &quot;priority&quot;: 1,
      &quot;bk_biz_id&quot;: 2,
      &quot;bk_func_id&quot;: &quot;&quot;,
      &quot;bind_info&quot;: [
        {
            &quot;enable&quot;: false,  
            &quot;ip&quot;: &quot;127.0.0.1&quot;,  
            &quot;port&quot;: &quot;100&quot;,  
            &quot;protocol&quot;: &quot;1&quot;, 
            &quot;template_row_id&quot;: 1  
        }
      ],
    }
  ]
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
  &quot;result&quot;: true,
  &quot;code&quot;: 0,
  &quot;message&quot;: &quot;success&quot;,
  &quot;data&quot;: [43]
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="response">response</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>请求成功与否。true:请求成功；false 请求失败</td>
</tr>
<tr>
<td>code</td>
<td>int</td>
<td>错误编码。 0 表示 success，&gt;0 表示失败错误</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>请求失败返回的错误信息</td>
</tr>
<tr>
<td>data</td>
<td>object</td>
<td>请求返回的数据</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/update_proc_template/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>更新进程模板信息</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>process_template_id</td>
<td>int</td>
<td>否</td>
<td>进程模板 ID</td>
</tr>
<tr>
<td>process_property</td>
<td>object</td>
<td>是</td>
<td>需要更新的进程模板字段信息</td>
</tr>
</tbody>
</table>
<h4 id="process_property">process_property 可以出现的字段</h4>
<p>注解：</p>
<p>as_default_value: 进程的值是否以模板为准
value: 进程的值，不同的字段类型不一样</p>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>proc_num</td>
<td>object</td>
<td>否</td>
<td _as_default_value_:="&quot;as_default_value&quot;:" _value_:="&quot;value&quot;:" false="false" null_="null,"></td>
</tr>
<tr>
<td>stop_cmd</td>
<td>object</td>
<td>否</td>
<td _as_default_value_:="&quot;&quot;,&quot;as_default_value&quot;:" _value_:="&quot;value&quot;:" false="false"></td>
</tr>
<tr>
<td>restart_cmd</td>
<td>object</td>
<td>否</td>
<td _as_default_value_:="&quot;&quot;,&quot;as_default_value&quot;:" _value_:="&quot;value&quot;:" false="false"></td>
</tr>
<tr>
<td>face_stop_cmd</td>
<td>object</td>
<td>否</td>
<td _as_default_value_:="&quot;&quot;,&quot;as_default_value&quot;:" _value_:="&quot;value&quot;:" false="false"></td>
</tr>
<tr>
<td>bk_func_name</td>
<td>object</td>
<td>否</td>
<td _a7_as_default_value_:="&quot;a7&quot;,&quot;as_default_value&quot;:" _value_:="&quot;value&quot;:" true="true"></td>
</tr>
<tr>
<td>work_path</td>
<td>object</td>
<td>否</td>
<td _as_default_value_:="&quot;&quot;,&quot;as_default_value&quot;:" _value_:="&quot;value&quot;:" false="false"></td>
</tr>
<tr>
<td>priority</td>
<td>object</td>
<td>否</td>
<td _value_:="&quot;value&quot;:" false="false" null_as_default_value_:="null,&quot;as_default_value&quot;:"></td>
</tr>
<tr>
<td>reload_cmd</td>
<td>object</td>
<td>否</td>
<td _as_default_value_:="&quot;&quot;,&quot;as_default_value&quot;:" _value_:="&quot;value&quot;:" false="false"></td>
</tr>
<tr>
<td>bk_process_name</td>
<td>object</td>
<td>否</td>
<td _a7_as_default_value_:="&quot;a7&quot;,&quot;as_default_value&quot;:" _value_:="&quot;value&quot;:" true="true"></td>
</tr>
<tr>
<td>pid_file</td>
<td>object</td>
<td>否</td>
<td _as_default_value_:="&quot;&quot;,&quot;as_default_value&quot;:" _value_:="&quot;value&quot;:" false="false"></td>
</tr>
<tr>
<td>auto_start</td>
<td>object</td>
<td>否</td>
<td _value_:="&quot;value&quot;:" null="null" null_as_default_value_:="null,&quot;as_default_value&quot;:"></td>
</tr>
<tr>
<td>auto_time_gap</td>
<td>object</td>
<td>否</td>
<td _value_:="&quot;value&quot;:" false="false" null_as_default_value_:="null,&quot;as_default_value&quot;:"></td>
</tr>
<tr>
<td>start_cmd</td>
<td>object</td>
<td>否</td>
<td _as_default_value_:="&quot;&quot;,&quot;as_default_value&quot;:" _value_:="&quot;value&quot;:" false="false"></td>
</tr>
<tr>
<td>bk_func_id</td>
<td>object</td>
<td>否</td>
<td _as_default_value_:="&quot;&quot;,&quot;as_default_value&quot;:" _value_:="&quot;value&quot;:" false="false"></td>
</tr>
<tr>
<td>user</td>
<td>object</td>
<td>否</td>
<td _as_default_value_:="&quot;&quot;,&quot;as_default_value&quot;:" _value_:="&quot;value&quot;:" false="false"></td>
</tr>
<tr>
<td>timeout</td>
<td>object</td>
<td>否</td>
<td _value_:="&quot;value&quot;:" false="false" null_as_default_value_:="null,&quot;as_default_value&quot;:"></td>
</tr>
<tr>
<td>description</td>
<td>object</td>
<td>否</td>
<td _1_as_default_value_:="&quot;1&quot;,&quot;as_default_value&quot;:" _value_:="&quot;value&quot;:" true="true"></td>
</tr>
<tr>
<td>bk_start_param_regex</td>
<td>object</td>
<td>否</td>
<td _as_default_value_:="&quot;&quot;,&quot;as_default_value&quot;:" _value_:="&quot;value&quot;:" false="false"></td>
</tr>
<tr>
<td>bind_info</td>
<td>object</td>
<td>否</td>
<td _value_:_as_default_value_:="&quot;value&quot;:[],,&quot;as_default_value&quot;:" true="true"></td>
</tr>
</tbody>
</table>
<h4 id="process_propertybind_infovaluen">process_property.bind_info.value[n] 可以出现的字段</h4>
<p>注意：</p>
<p>修改 bind_info 的时候，必须先获取原有进程的 bind_info 的内容， 然后在进程已有的 bind_info 上修改，将修改后的内容传递给修改结构。</p>
<p>注解：</p>
<p>as_default_value: 进程的值是否以模板为准
value: 进程的值，不同的字段类型不一样</p>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>enable</td>
<td>object</td>
<td>否</td>
<td _value_:="&quot;value&quot;:" false_as_default_value_:="false,&quot;as_default_value&quot;:" true="true"></td>
</tr>
<tr>
<td>ip</td>
<td>object</td>
<td>否</td>
<td _1_as_default_value_:="&quot;1&quot;,&quot;as_default_value&quot;:" _value_:="&quot;value&quot;:" true="true"></td>
</tr>
<tr>
<td>port</td>
<td>object</td>
<td>否</td>
<td _100_as_default_value_:="&quot;100&quot;,&quot;as_default_value&quot;:" _value_:="&quot;value&quot;:" true="true"></td>
</tr>
<tr>
<td>protocol</td>
<td>object</td>
<td>否</td>
<td _1_as_default_value_:="&quot;1&quot;,&quot;as_default_value&quot;:" _value_:="&quot;value&quot;:" true="true"></td>
</tr>
<tr>
<td>row_id</td>
<td>int</td>
<td>否</td>
<td>唯一表示 id,新加的行可以设置为空，更新必须保持原值</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
  &quot;bk_biz_id&quot;: 1,
  &quot;process_template_id&quot;: 50,
  &quot;process_property&quot;: {
    &quot;user&quot;: {
      &quot;as_default_value&quot;: true,
      &quot;value&quot;: &quot;root100&quot;
    },
    &quot;proc_num&quot;: {
      &quot;as_default_value&quot;: true,
      &quot;value&quot;: 300
    }
  }
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
  &quot;result&quot;: true,
  &quot;code&quot;: 0,
  &quot;message&quot;: &quot;success&quot;,
  &quot;data&quot;: {
    &quot;id&quot;: 50,
    &quot;bk_process_name&quot;: &quot;p1&quot;,
    &quot;bk_biz_id&quot;: 1,
    &quot;service_template_id&quot;: 51,
    &quot;property&quot;: {
      &quot;proc_num&quot;: {
        &quot;value&quot;: 300,
        &quot;as_default_value&quot;: false
      },
      &quot;stop_cmd&quot;: {
        &quot;value&quot;: &quot;&quot;,
        &quot;as_default_value&quot;: false
      },
      &quot;restart_cmd&quot;: {
        &quot;value&quot;: &quot;&quot;,
        &quot;as_default_value&quot;: false
      },
      &quot;face_stop_cmd&quot;: {
        &quot;value&quot;: &quot;&quot;,
        &quot;as_default_value&quot;: false
      },
      &quot;bk_func_name&quot;: {
        &quot;value&quot;: &quot;p1&quot;,
        &quot;as_default_value&quot;: true
      },
      &quot;work_path&quot;: {
        &quot;value&quot;: &quot;&quot;,
        &quot;as_default_value&quot;: false
      },
      &quot;bind_ip&quot;: {
        &quot;value&quot;: &quot;1&quot;,
        &quot;as_default_value&quot;: false
      },
      &quot;priority&quot;: {
        &quot;value&quot;: null,
        &quot;as_default_value&quot;: false
      },
      &quot;reload_cmd&quot;: {
        &quot;value&quot;: &quot;&quot;,
        &quot;as_default_value&quot;: false
      },
      &quot;bk_process_name&quot;: {
        &quot;value&quot;: &quot;p1&quot;,
        &quot;as_default_value&quot;: true
      },
      &quot;port&quot;: {
        &quot;value&quot;: &quot;&quot;,
        &quot;as_default_value&quot;: false
      },
      &quot;pid_file&quot;: {
        &quot;value&quot;: &quot;&quot;,
        &quot;as_default_value&quot;: false
      },
      &quot;auto_start&quot;: {
        &quot;value&quot;: false,
        &quot;as_default_value&quot;: false
      },
      &quot;auto_time_gap&quot;: {
        &quot;value&quot;: null,
        &quot;as_default_value&quot;: false
      },
      &quot;start_cmd&quot;: {
        &quot;value&quot;: &quot;&quot;,
        &quot;as_default_value&quot;: false
      },
      &quot;bk_func_id&quot;: {
        &quot;value&quot;: null,
        &quot;as_default_value&quot;: false
      },
      &quot;user&quot;: {
        &quot;value&quot;: &quot;root100&quot;,
        &quot;as_default_value&quot;: false
      },
      &quot;timeout&quot;: {
        &quot;value&quot;: null,
        &quot;as_default_value&quot;: false
      },
      &quot;protocol&quot;: {
        &quot;value&quot;: &quot;1&quot;,
        &quot;as_default_value&quot;: false
      },
      &quot;description&quot;: {
        &quot;value&quot;: &quot;&quot;,
        &quot;as_default_value&quot;: false
      },
      &quot;bk_start_param_regex&quot;: {
        &quot;value&quot;: &quot;&quot;,
        &quot;as_default_value&quot;: false
      },
      &quot;bind_info&quot;: {
        &quot;value&quot;: [
            {
                &quot;enable&quot;: {
                    &quot;value&quot;: false,
                    &quot;as_default_value&quot;: true
                },
                &quot;ip&quot;: {
                    &quot;value&quot;: &quot;1&quot;,
                    &quot;as_default_value&quot;: true
                },
                &quot;port&quot;: {
                    &quot;value&quot;: &quot;100&quot;,
                    &quot;as_default_value&quot;: true
                },
                &quot;protocol&quot;: {
                    &quot;value&quot;: &quot;1&quot;,
                    &quot;as_default_value&quot;: true
                },
                &quot;row_id&quot;: 1
            }
        ],
        &quot;as_default_value&quot;: true
      }
    },
    &quot;creator&quot;: &quot;admin&quot;,
    &quot;modifier&quot;: &quot;admin&quot;,
    &quot;create_time&quot;: &quot;2019-06-19T15:24:04.763+08:00&quot;,
    &quot;last_time&quot;: &quot;2019-06-21T16:25:03.962512+08:00&quot;,
    &quot;bk_supplier_account&quot;: &quot;0&quot;
  }
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="response">response</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>请求成功与否。true:请求成功；false 请求失败</td>
</tr>
<tr>
<td>code</td>
<td>int</td>
<td>错误编码。 0 表示 success，&gt;0 表示失败错误</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>请求失败返回的错误信息</td>
</tr>
<tr>
<td>data</td>
<td>object</td>
<td>更新后的进程模板信息</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/update_service_category/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>更新服务模板信息（目前仅名称字段可更新）</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>int</td>
<td>否</td>
<td>服务模板 ID</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>否</td>
<td>服务模板名称</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
  &quot;bk_biz_id&quot;: 1,
  &quot;id&quot;: 3,
  &quot;name&quot;: &quot;222&quot;
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
  &quot;result&quot;: true,
  &quot;code&quot;: 0,
  &quot;message&quot;: &quot;success&quot;,
  &quot;data&quot;: {
    &quot;bk_biz_id&quot;: 1,
    &quot;id&quot;: 3,
    &quot;name&quot;: &quot;222&quot;,
    &quot;root_id&quot;: 3,
    &quot;bk_supplier_account&quot;: &quot;0&quot;,
    &quot;is_built_in&quot;: false
  }
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="response">response</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>请求成功与否。true:请求成功；false 请求失败</td>
</tr>
<tr>
<td>code</td>
<td>int</td>
<td>错误编码。 0 表示 success，&gt;0 表示失败错误</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>请求失败返回的错误信息</td>
</tr>
<tr>
<td>data</td>
<td>object</td>
<td>更新后的服务分类信息</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/update_service_template/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>更新服务模板名称信息</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>int</td>
<td>是</td>
<td>服务模板名称</td>
</tr>
<tr>
<td>id</td>
<td>int</td>
<td>是</td>
<td>服务模板 ID</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
  &quot;bk_biz_id&quot;: 1,
  &quot;name&quot;: &quot;test1&quot;,
  &quot;id&quot;: 50,
  &quot;service_category_id&quot;: 3
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
  &quot;result&quot;: true,
  &quot;code&quot;: 0,
  &quot;message&quot;: &quot;success&quot;,
  &quot;data&quot;: {
    &quot;bk_biz_id&quot;: 1,
    &quot;id&quot;: 50,
    &quot;name&quot;: &quot;test1&quot;,
    &quot;service_category_id&quot;: 3,
    &quot;creator&quot;: &quot;admin&quot;,
    &quot;modifier&quot;: &quot;admin&quot;,
    &quot;create_time&quot;: &quot;2019-06-05T11:22:22.951+08:00&quot;,
    &quot;last_time&quot;: &quot;2019-06-05T11:22:22.951+08:00&quot;,
    &quot;bk_supplier_account&quot;: &quot;0&quot;
  }
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="response">response</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>请求成功与否。true:请求成功；false 请求失败</td>
</tr>
<tr>
<td>code</td>
<td>int</td>
<td>错误编码。 0 表示 success，&gt;0 表示失败错误</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>请求失败返回的错误信息</td>
</tr>
<tr>
<td>data</td>
<td>object</td>
<td>更新后的服务模板信息</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/update_set/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>更新集群</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_supplier_account</td>
<td>string</td>
<td>否</td>
<td>开发商账号</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 id</td>
</tr>
<tr>
<td>bk_set_id</td>
<td>int</td>
<td>是</td>
<td>集群 id</td>
</tr>
<tr>
<td>data</td>
<td>dict</td>
<td>否</td>
<td>集群数据</td>
</tr>
</tbody>
</table>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_parent_id</td>
<td>int</td>
<td>否</td>
<td>父节点的 ID</td>
</tr>
<tr>
<td>bk_set_name</td>
<td>string</td>
<td>否</td>
<td>集群名字</td>
</tr>
</tbody>
</table>
<p><strong>注意：用户自定义的字段也可以作为参数传入</strong></p>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_supplier_account&quot;: &quot;123456789&quot;,
    &quot;bk_biz_id&quot;: 1,
    &quot;bk_set_id&quot;: 1,
    &quot;data&quot;: {
        &quot;bk_set_name&quot;: &quot;test&quot;
    }
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: {}
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/cc/update_set_template/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>根据业务 id 和集群模板 id,编辑指定业务下的集群模板</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 ID</td>
</tr>
<tr>
<td>set_template_id</td>
<td>int</td>
<td>是</td>
<td>集群模板 ID</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>二选一</td>
<td>集群模板名称</td>
</tr>
<tr>
<td>service_template_ids</td>
<td>array</td>
<td>二选一</td>
<td>服务模板 ID 列表</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;bk_supplier_account&quot;: &quot;0&quot;,
    &quot;name&quot;: &quot;test&quot;,
    &quot;bk_biz_id&quot;: 20,
    &quot;set_template_id&quot;: 6,
    &quot;service_template_ids&quot;: [59]
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;success&quot;,
    &quot;permission&quot;: null,
    &quot;data&quot;: {
        &quot;id&quot;: 6,
        &quot;name&quot;: &quot;test&quot;,
        &quot;bk_biz_id&quot;: 20,
        &quot;version&quot;: 0,
        &quot;creator&quot;: &quot;admin&quot;,
        &quot;modifier&quot;: &quot;admin&quot;,
        &quot;create_time&quot;: &quot;2019-11-27T17:24:10.671658+08:00&quot;,
        &quot;last_time&quot;: &quot;2019-11-27T17:24:10.671658+08:00&quot;,
        &quot;bk_supplier_account&quot;: &quot;0&quot;
    }
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="response">response</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>请求成功与否。true:请求成功；false 请求失败</td>
</tr>
<tr>
<td>code</td>
<td>int</td>
<td>错误编码。 0 表示 success，&gt;0 表示失败错误</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>请求失败返回的错误信息</td>
</tr>
<tr>
<td>data</td>
<td>object</td>
<td>请求返回的数据</td>
</tr>
</tbody>
</table>
<h4 id="data">data 字段说明</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>int</td>
<td>集群模板 ID</td>
</tr>
<tr>
<td>name</td>
<td>array</td>
<td>集群模板名称</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>业务 ID</td>
</tr>
<tr>
<td>version</td>
<td>int</td>
<td>集群模板版本</td>
</tr>
<tr>
<td>creator</td>
<td>string</td>
<td>创建者</td>
</tr>
<tr>
<td>modifier</td>
<td>string</td>
<td>最后修改人员</td>
</tr>
<tr>
<td>create_time</td>
<td>string</td>
<td>创建时间</td>
</tr>
<tr>
<td>last_time</td>
<td>string</td>
<td>更新时间</td>
</tr>
<tr>
<td>bk_supplier_account</td>
<td>string</td>
<td>开发商账号</td>
</tr>
</tbody>
</table><h2 id="api">蓝鲸管控平台 API 简介</h2>
<table>
<thead>
<tr>
<th>资源名称</th>
<th>资源描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="./get_agent_info.md">get_agent_info</a></td>
<td>Agent 心跳信息查询</td>
</tr>
<tr>
<td><a href="./get_agent_status.md">get_agent_status</a></td>
<td>Agent 在线状态查询</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/gse/get_agent_info/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>查询 agent 心跳详细信息。数据非实时，延时 1 分钟内。</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_supplier_account</td>
<td>string</td>
<td>是</td>
<td>开发商账号</td>
</tr>
<tr>
<td>hosts</td>
<td>array</td>
<td>是</td>
<td>主机列表</td>
</tr>
</tbody>
</table>
<h4 id="hosts">hosts</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_cloud_id</td>
<td>int</td>
<td>是</td>
<td>云区域 ID</td>
</tr>
<tr>
<td>ip</td>
<td>string</td>
<td>是</td>
<td>IP 地址</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_supplier_account&quot;: &quot;0&quot;,
    &quot;hosts&quot;: [
        {
            &quot;ip&quot;: &quot;10.0.0.1&quot;,
            &quot;bk_cloud_id&quot;: 0
        }
    ]
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: {
        &quot;0:10.0.0.1&quot;: {
            &quot;ip&quot;: &quot;10.0.0.1&quot;,
            &quot;version&quot;: &quot;V0.01R060D38&quot;,
            &quot;bk_cloud_id&quot;: 0,
            &quot;parent_ip&quot;: &quot;10.0.0.2&quot;,
            &quot;parent_port&quot;: 50000
        }
    }
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>key</td>
<td>string</td>
<td>格式为：bk_cloud_id:ip</td>
</tr>
<tr>
<td>value.ip</td>
<td>string</td>
<td>主机 IP 地址</td>
</tr>
<tr>
<td>value.bk_cloud_id</td>
<td>int</td>
<td>云区域 ID</td>
</tr>
<tr>
<td>value.version</td>
<td>string</td>
<td>agent 版本号</td>
</tr>
<tr>
<td>value.parent_ip</td>
<td>string</td>
<td>agent 的上级节点 ip</td>
</tr>
<tr>
<td>value.parent_port</td>
<td>int</td>
<td>agent 的上级节点端口</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/gse/get_agent_status/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>查询 agent 实时在线状态</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_supplier_account</td>
<td>string</td>
<td>是</td>
<td>开发商账号</td>
</tr>
<tr>
<td>hosts</td>
<td>array</td>
<td>是</td>
<td>主机列表</td>
</tr>
</tbody>
</table>
<h4 id="hosts">hosts</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_cloud_id</td>
<td>int</td>
<td>是</td>
<td>云区域 ID</td>
</tr>
<tr>
<td>ip</td>
<td>string</td>
<td>是</td>
<td>IP 地址</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_supplier_account&quot;: &quot;0&quot;,
    &quot;hosts&quot;: [
        {
            &quot;ip&quot;: &quot;10.0.0.1&quot;,
            &quot;bk_cloud_id&quot;: 0
        }
    ]
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: {
        &quot;0:10.0.0.1&quot;: {
            &quot;ip&quot;: &quot;10.0.0.1&quot;,
            &quot;bk_cloud_id&quot;: 0,
            &quot;bk_agent_alive&quot;: 1
        }
    }
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>key</td>
<td>string</td>
<td>格式为：bk_cloud_id:ip</td>
</tr>
<tr>
<td>value.ip</td>
<td>string</td>
<td>主机 IP 地址</td>
</tr>
<tr>
<td>value.bk_cloud_id</td>
<td>int</td>
<td>云区域 ID</td>
</tr>
<tr>
<td>value.bk_agent_alive</td>
<td>int</td>
<td>agent 在线状态，0 为不在线，1 为在线</td>
</tr>
</tbody>
</table><h2 id="api">作业平台 API 简介</h2>
<p><strong>作业平台（Job）是一套基于蓝鲸智云管控平台 Agent 管道之上的基础操作平台，具备大并发处理能力；除了支持脚本执行、文件拉取/分发、定时任务等一系列可实现的基础运维场景以外，还运用流程化的理念很好的将零碎的单个任务组装成一个作业流程；而每个任务都可做为一个原子节点，提供给其它系统和平台调度，实现调度自动化。</strong></p>
<table>
<thead>
<tr>
<th>资源名称</th>
<th>资源描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="./execute_job.md">execute_job</a></td>
<td>启动作业</td>
</tr>
<tr>
<td><a href="./fast_execute_script.md">fast_execute_script</a></td>
<td>快速执行脚本</td>
</tr>
<tr>
<td><a href="./fast_execute_sql.md">fast_execute_sql</a></td>
<td>快速执行 SQL</td>
</tr>
<tr>
<td><a href="./fast_push_file.md">fast_push_file</a></td>
<td>快速分发文件</td>
</tr>
<tr>
<td><a href="./get_cron_list.md">get_cron_list</a></td>
<td>查询业务下定时作业信息</td>
</tr>
<tr>
<td><a href="./get_job_detail.md">get_job_detail</a></td>
<td>查询作业模板详情</td>
</tr>
<tr>
<td><a href="./get_job_instance_log.md">get_job_instance_log</a></td>
<td>根据作业实例 ID 查询作业执行日志</td>
</tr>
<tr>
<td><a href="./get_job_instance_status.md">get_job_instance_status</a></td>
<td>查询作业执行状态</td>
</tr>
<tr>
<td><a href="./get_job_list.md">get_job_list</a></td>
<td>查询作业模板</td>
</tr>
<tr>
<td><a href="./get_os_account.md">get_os_account</a></td>
<td>查询业务下的执行账号</td>
</tr>
<tr>
<td><a href="./get_own_db_account_list.md">get_own_db_account_list</a></td>
<td>查询用户有权限的 DB 帐号列表</td>
</tr>
<tr>
<td><a href="./get_public_script_list.md">get_public_script_list</a></td>
<td>查询公共脚本列表</td>
</tr>
<tr>
<td><a href="./get_script_detail.md">get_script_detail</a></td>
<td>查询脚本详情</td>
</tr>
<tr>
<td><a href="./get_script_list.md">get_script_list</a></td>
<td>查询脚本列表</td>
</tr>
<tr>
<td><a href="./get_step_instance_status.md">get_step_instance_status</a></td>
<td>查询作业步骤的执行状态</td>
</tr>
<tr>
<td><a href="./operate_job_instance.md">operate_job_instance</a></td>
<td>作业实例操作</td>
</tr>
<tr>
<td><a href="./operate_step_instance.md">operate_step_instance</a></td>
<td>步骤实例操作</td>
</tr>
<tr>
<td><a href="./push_config_file.md">push_config_file</a></td>
<td>分发配置文件</td>
</tr>
<tr>
<td><a href="./save_cron.md">save_cron</a></td>
<td>新建或保存定时作业</td>
</tr>
<tr>
<td><a href="./update_cron_status.md">update_cron_status</a></td>
<td>更新定时作业状态</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/job/execute_job/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>根据执行方案 ID 启动作业执行方案。</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>long</td>
<td>是</td>
<td>业务 ID</td>
</tr>
<tr>
<td>bk_job_id</td>
<td>long</td>
<td>是</td>
<td>作业执行方案 ID</td>
</tr>
<tr>
<td>global_vars</td>
<td>array</td>
<td>否</td>
<td>全局变量信息，作业执行方案包含的全局变量和类型，可以通过接口“查询作业执行方案详情” (get_job_detail)获取。对于作业执行方案中的全局变量值，如果 global_vars 包含该变量信息，那么会使用 api 指定的值；否则使用全局变量默认值</td>
</tr>
<tr>
<td>bk_callback_url</td>
<td>string</td>
<td>否</td>
<td>回调 URL，当任务执行完成后，JOB 会调用该 URL 告知任务执行结果。回调协议参考 callback_protocol 组件文档</td>
</tr>
</tbody>
</table>
<h4 id="global_vars">global_vars</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>long</td>
<td>否</td>
<td>全局变量 id，唯一标识。如果 id 为空，那么使用 name 作为唯一标识</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>否</td>
<td>全局变量 name</td>
</tr>
<tr>
<td>value</td>
<td>string</td>
<td>否</td>
<td>全局变量值。如果使用主机变量，请使用 target_server</td>
</tr>
<tr>
<td>custom_query_id</td>
<td>array</td>
<td>否</td>
<td><em>deprecated</em>，请使用 target_server.dynamic_group_id_list 替代。配置平台上的自定义分组 ID</td>
</tr>
<tr>
<td>ip_list</td>
<td>array</td>
<td>否</td>
<td><em>deprecated</em>，请使用 target_server.iplist 替代。静态 IP 列表</td>
</tr>
<tr>
<td>target_server</td>
<td>dict</td>
<td>否</td>
<td>目标服务器</td>
</tr>
</tbody>
</table>
<h4 id="target_server">target_server</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>ip_list</td>
<td>array</td>
<td>否</td>
<td>静态 IP 列表</td>
</tr>
<tr>
<td>dynamic_group_id_list</td>
<td>array</td>
<td>否</td>
<td>动态分组 ID 列表</td>
</tr>
<tr>
<td>topo_node_list</td>
<td>array</td>
<td>否</td>
<td>动态 topo 节点列表</td>
</tr>
</tbody>
</table>
<h4 id="ip_list">ip_list</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_cloud_id</td>
<td>int</td>
<td>是</td>
<td>云区域 ID</td>
</tr>
<tr>
<td>ip</td>
<td>string</td>
<td>是</td>
<td>IP 地址</td>
</tr>
</tbody>
</table>
<h4 id="topo_node_list">topo_node_list</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>long</td>
<td>是</td>
<td>动态 topo 节点 ID，对应 CMDB API 中的 bk_inst_id</td>
</tr>
<tr>
<td>node_type</td>
<td>string</td>
<td>是</td>
<td>动态 topo 节点类型，对应 CMDB API 中的 bk_obj_id,比如"module","set"</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_biz_id&quot;: 1,
    &quot;bk_job_id&quot;: 100,
    &quot;global_vars&quot;: [{
            &quot;id&quot;: 436,
            &quot;target_server&quot;: {
                &quot;dynamic_group_id_list&quot;: [&quot;blo8gojho0skft7pr5q0&quot;, &quot;blo8gojho0sabc7priuy&quot;],
                &quot;ip_list&quot;: [{
                        &quot;bk_cloud_id&quot;: 0,
                        &quot;ip&quot;: &quot;10.0.0.1&quot;
                    }, {
                        &quot;bk_cloud_id&quot;: 0,
                        &quot;ip&quot;: &quot;10.0.0.2&quot;
                    }
                ],
                &quot;topo_node_list&quot;: [{
                        &quot;id&quot;: 1000,
                        &quot;node_type&quot;: &quot;module&quot;
                    }
                ]
            }
        }, {
            &quot;id&quot;: 437,
            &quot;value&quot;: &quot;new String value&quot;
        }
    ]
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;success&quot;,
    &quot;data&quot;: {
        &quot;job_instance_name&quot;: &quot;Test&quot;,
        &quot;job_instance_id&quot;: 10000
    }
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/job/fast_execute_script/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>快速执行脚本</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>long</td>
<td>是</td>
<td>业务 ID</td>
</tr>
<tr>
<td>script_id</td>
<td>long</td>
<td>否</td>
<td>脚本 ID</td>
</tr>
<tr>
<td>task_name</td>
<td>string</td>
<td>否</td>
<td>自定义作业名称</td>
</tr>
<tr>
<td>script_content</td>
<td>string</td>
<td>否</td>
<td>脚本内容 Base64，如果同时传了 script_id 和 script_content，则 script_id 优先</td>
</tr>
<tr>
<td>script_param</td>
<td>string</td>
<td>否</td>
<td>脚本参数 Base64。注意：如果有多个参数，比如&#34;param1 param2&#34;这种，需要对&#34;param1 param2&#34;整体进行 base64 编码，而不是对每个参数进行 base64 编码再拼接起来</td>
</tr>
<tr>
<td>script_timeout</td>
<td>long</td>
<td>否</td>
<td>脚本超时时间，秒。默认 1000，取值范围 60-86400</td>
</tr>
<tr>
<td>account</td>
<td>string</td>
<td>是</td>
<td>执行帐号名/别名</td>
</tr>
<tr>
<td>is_param_sensitive</td>
<td>int</td>
<td>否</td>
<td>敏感参数将会在执行详情页面上隐藏, 0:不是（默认），1:是</td>
</tr>
<tr>
<td>script_type</td>
<td>int</td>
<td>否</td>
<td>脚本类型：1(shell 脚本)、2(bat 脚本)、3(perl 脚本)、4(python 脚本)、5(Powershell 脚本)</td>
</tr>
<tr>
<td>custom_query_id</td>
<td>array</td>
<td>否</td>
<td><em>deprecated</em>，请使用 target_server.dynamic_group_id_list 替代。配置平台上的自定义分组 ID</td>
</tr>
<tr>
<td>ip_list</td>
<td>array</td>
<td>否</td>
<td><em>deprecated</em>，请使用 target_server.iplist 替代。静态 IP 列表</td>
</tr>
<tr>
<td>target_server</td>
<td>dict</td>
<td>否</td>
<td>目标服务器</td>
</tr>
<tr>
<td>bk_callback_url</td>
<td>string</td>
<td>否</td>
<td>回调 URL，当任务执行完成后，JOB 会调用该 URL 告知任务执行结果。回调协议参考 callback_protocol 组件文档</td>
</tr>
</tbody>
</table>
<h4 id="target_server">target_server</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>ip_list</td>
<td>array</td>
<td>否</td>
<td>静态 IP 列表</td>
</tr>
<tr>
<td>dynamic_group_id_list</td>
<td>array</td>
<td>否</td>
<td>动态分组 ID 列表</td>
</tr>
<tr>
<td>topo_node_list</td>
<td>array</td>
<td>否</td>
<td>动态 topo 节点列表</td>
</tr>
</tbody>
</table>
<h4 id="ip_list">ip_list</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_cloud_id</td>
<td>long</td>
<td>是</td>
<td>云区域 ID</td>
</tr>
<tr>
<td>ip</td>
<td>string</td>
<td>是</td>
<td>IP 地址</td>
</tr>
</tbody>
</table>
<h4 id="topo_node_list">topo_node_list</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>long</td>
<td>是</td>
<td>动态 topo 节点 ID，对应 CMDB API 中的 bk_inst_id</td>
</tr>
<tr>
<td>node_type</td>
<td>string</td>
<td>是</td>
<td>动态 topo 节点类型，对应 CMDB API 中的 bk_obj_id,比如"module","set"</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_biz_id&quot;: 1,
    &quot;script_id&quot;: 1,
    &quot;script_content&quot;: &quot;ZWNobyAkMQ==&quot;,
    &quot;script_param&quot;: &quot;aGVsbG8=&quot;,
    &quot;script_timeout&quot;: 1000,
    &quot;account&quot;: &quot;root&quot;,
    &quot;is_param_sensitive&quot;: 0,
    &quot;script_type&quot;: 1,
    &quot;target_server&quot;: {
        &quot;dynamic_group_id_list&quot;: [&quot;blo8gojho0skft7pr5q0&quot;, &quot;blo8gojho0sabc7priuy&quot;],
        &quot;ip_list&quot;: [{
                &quot;bk_cloud_id&quot;: 0,
                &quot;ip&quot;: &quot;10.0.0.1&quot;
            }, {
                &quot;bk_cloud_id&quot;: 0,
                &quot;ip&quot;: &quot;10.0.0.2&quot;
            }
        ],
        &quot;topo_node_list&quot;: [{
                &quot;id&quot;: 1000,
                &quot;node_type&quot;: &quot;module&quot;
            }
        ]
    }
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;success&quot;,
    &quot;data&quot;: {
        &quot;job_instance_name&quot;: &quot;API Quick execution script1521100521303&quot;,
        &quot;job_instance_id&quot;: 10000
    }
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/job/fast_execute_sql/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>快速执行 SQL 脚本</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>long</td>
<td>是</td>
<td>业务 ID</td>
</tr>
<tr>
<td>script_id</td>
<td>long</td>
<td>否</td>
<td>SQL 脚本 ID</td>
</tr>
<tr>
<td>script_content</td>
<td>string</td>
<td>否</td>
<td>脚本内容 Base64，如果同时传了 script_id 和 script_content，则 script_id 优先</td>
</tr>
<tr>
<td>script_timeout</td>
<td>int</td>
<td>否</td>
<td>脚本超时时间，秒。默认 1000，取值范围 60-86400</td>
</tr>
<tr>
<td>db_account_id</td>
<td>long</td>
<td>是</td>
<td>SQL 执行的 db 帐号 ID，必填, 从帐号管理-DB 帐号处获得。</td>
</tr>
<tr>
<td>custom_query_id</td>
<td>array</td>
<td>否</td>
<td><em>deprecated</em>，请使用 target_server.dynamic_group_id_list 替代。配置平台上的自定义分组 ID</td>
</tr>
<tr>
<td>ip_list</td>
<td>array</td>
<td>否</td>
<td><em>deprecated</em>，请使用 target_server.iplist 替代。静态 IP 列表</td>
</tr>
<tr>
<td>target_server</td>
<td>dict</td>
<td>否</td>
<td>目标服务器</td>
</tr>
<tr>
<td>bk_callback_url</td>
<td>string</td>
<td>否</td>
<td>回调 URL，当任务执行完成后，JOB 会调用该 URL 告知任务执行结果。回调协议参考 callback_protocol 组件文档</td>
</tr>
</tbody>
</table>
<h4 id="target_server">target_server</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>ip_list</td>
<td>array</td>
<td>否</td>
<td>静态 IP 列表</td>
</tr>
<tr>
<td>dynamic_group_id_list</td>
<td>array</td>
<td>否</td>
<td>动态分组 ID 列表</td>
</tr>
<tr>
<td>topo_node_list</td>
<td>array</td>
<td>否</td>
<td>动态 topo 节点列表</td>
</tr>
</tbody>
</table>
<h4 id="ip_list">ip_list</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_cloud_id</td>
<td>long</td>
<td>是</td>
<td>云区域 ID</td>
</tr>
<tr>
<td>ip</td>
<td>string</td>
<td>是</td>
<td>IP 地址</td>
</tr>
</tbody>
</table>
<h4 id="topo_node_list">topo_node_list</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>long</td>
<td>是</td>
<td>动态 topo 节点 ID，对应 CMDB API 中的 bk_inst_id</td>
</tr>
<tr>
<td>node_type</td>
<td>string</td>
<td>是</td>
<td>动态 topo 节点类型，对应 CMDB API 中的 bk_obj_id,比如"module","set"</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_biz_id&quot;: 1,
    &quot;script_id&quot;: 1,
    &quot;script_content&quot;: &quot;c2hvdyBkYXRhYmFzZXM7&quot;,
    &quot;script_timeout&quot;: 1000,
    &quot;db_account_id&quot;: 32,
    &quot;target_server&quot;: {
        &quot;dynamic_group_id_list&quot;: [&quot;blo8gojho0skft7pr5q0&quot;, &quot;blo8gojho0sabc7priuy&quot;],
        &quot;ip_list&quot;: [{
                &quot;bk_cloud_id&quot;: 0,
                &quot;ip&quot;: &quot;10.0.0.1&quot;
            }, {
                &quot;bk_cloud_id&quot;: 0,
                &quot;ip&quot;: &quot;10.0.0.2&quot;
            }
        ],
        &quot;topo_node_list&quot;: [{
                &quot;id&quot;: 1000,
                &quot;node_type&quot;: &quot;module&quot;
            }
        ]
    }
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;success&quot;,
    &quot;data&quot;: {
        &quot;job_instance_name&quot;: &quot;API Quick SQL Execution1524454292038&quot;,
        &quot;job_instance_id&quot;: 10000
    }
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/job/fast_push_file/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>快速分发文件</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>long</td>
<td>是</td>
<td>业务 ID</td>
</tr>
<tr>
<td>account</td>
<td>string</td>
<td>是</td>
<td>执行帐号名/别名</td>
</tr>
<tr>
<td>file_target_path</td>
<td>string</td>
<td>是</td>
<td>文件传输目标路径</td>
</tr>
<tr>
<td>file_source</td>
<td>array</td>
<td>是</td>
<td>源文件对象数组，见下面 file_source 定义</td>
</tr>
<tr>
<td>timeout</td>
<td>int</td>
<td>否</td>
<td>任务超时时间，秒，默认值为 7200。取值范围 60-86400。</td>
</tr>
<tr>
<td>download_speed_limit</td>
<td>int</td>
<td>否</td>
<td>下载限速，单位 MB。如果未传入该参数，表示不限速</td>
</tr>
<tr>
<td>upload_speed_limit</td>
<td>int</td>
<td>否</td>
<td>上传限速，单位 MB。如果未传入该参数，表示不限速</td>
</tr>
<tr>
<td>custom_query_id</td>
<td>array</td>
<td>否</td>
<td><em>deprecated</em>，请使用 target_server.dynamic_group_id_list 替代。配置平台上的自定义分组 ID</td>
</tr>
<tr>
<td>ip_list</td>
<td>array</td>
<td>否</td>
<td><em>deprecated</em>，请使用 target_server.iplist 替代。静态 IP 列表</td>
</tr>
<tr>
<td>target_server</td>
<td>dict</td>
<td>否</td>
<td>目标服务器</td>
</tr>
<tr>
<td>bk_callback_url</td>
<td>string</td>
<td>否</td>
<td>回调 URL，当任务执行完成后，JOB 会调用该 URL 告知任务执行结果。回调协议参考 callback_protocol 组件文档</td>
</tr>
</tbody>
</table>
<h4 id="file_source">file_source</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>files</td>
<td>array</td>
<td>是</td>
<td>源文件的绝对路径数组，支持多个文件</td>
</tr>
<tr>
<td>account</td>
<td>string</td>
<td>是</td>
<td>执行帐号名/别名</td>
</tr>
<tr>
<td>custom_query_id</td>
<td>array</td>
<td>否</td>
<td><em>deprecated</em>，请使用 target_server.dynamic_group_id_list 替代。配置平台上的自定义分组 ID</td>
</tr>
<tr>
<td>ip_list</td>
<td>array</td>
<td>否</td>
<td><em>deprecated</em>，请使用 target_server.iplist 替代。静态 IP 列表</td>
</tr>
<tr>
<td>target_server</td>
<td>dict</td>
<td>否</td>
<td>目标服务器</td>
</tr>
</tbody>
</table>
<h4 id="target_server">target_server</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>ip_list</td>
<td>array</td>
<td>否</td>
<td>静态 IP 列表</td>
</tr>
<tr>
<td>dynamic_group_id_list</td>
<td>array</td>
<td>否</td>
<td>动态分组 ID 列表</td>
</tr>
<tr>
<td>topo_node_list</td>
<td>array</td>
<td>否</td>
<td>动态 topo 节点列表</td>
</tr>
</tbody>
</table>
<h4 id="ip_list">ip_list</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_cloud_id</td>
<td>long</td>
<td>是</td>
<td>云区域 ID</td>
</tr>
<tr>
<td>ip</td>
<td>string</td>
<td>是</td>
<td>IP 地址</td>
</tr>
</tbody>
</table>
<h4 id="topo_node_list">topo_node_list</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>long</td>
<td>是</td>
<td>动态 topo 节点 ID，对应 CMDB API 中的 bk_inst_id</td>
</tr>
<tr>
<td>node_type</td>
<td>string</td>
<td>是</td>
<td>动态 topo 节点类型，对应 CMDB API 中的 bk_obj_id,比如"module","set"</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_biz_id&quot;: 1,
    &quot;file_target_path&quot;: &quot;/tmp/&quot;,
    &quot;file_source&quot;: [{
            &quot;files&quot;: [
                &quot;/tmp/REGEX:[a-z]*.txt&quot;
            ],
            &quot;account&quot;: &quot;root&quot;,
            &quot;target_server&quot;: {
                &quot;dynamic_group_id_list&quot;: [&quot;blo8gojho0skft7pr5q0&quot;, &quot;blo8gojho0sabc7priuy&quot;],
                &quot;ip_list&quot;: [{
                        &quot;bk_cloud_id&quot;: 0,
                        &quot;ip&quot;: &quot;10.0.0.1&quot;
                    }, {
                        &quot;bk_cloud_id&quot;: 0,
                        &quot;ip&quot;: &quot;10.0.0.2&quot;
                    }
                ],
                &quot;topo_node_list&quot;: [{
                        &quot;id&quot;: 1000,
                        &quot;node_type&quot;: &quot;module&quot;
                    }
                ]
            }
        }
    ],
    &quot;target_server&quot;: {
        &quot;dynamic_group_id_list&quot;: [&quot;blo8gojho0skft7pr5q0&quot;, &quot;blo8gojho0sabc7priuy&quot;],
        &quot;ip_list&quot;: [{
                &quot;bk_cloud_id&quot;: 0,
                &quot;ip&quot;: &quot;10.0.0.1&quot;
            }, {
                &quot;bk_cloud_id&quot;: 0,
                &quot;ip&quot;: &quot;10.0.0.2&quot;
            }
        ],
        &quot;topo_node_list&quot;: [{
                &quot;id&quot;: 1000,
                &quot;node_type&quot;: &quot;module&quot;
            }
        ]
    },
    &quot;account&quot;: &quot;root&quot;,
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;success&quot;,
    &quot;data&quot;: {
        &quot;job_instance_name&quot;: &quot;API Quick Distribution File1521101427176&quot;,
        &quot;job_instance_id&quot;: 10000
    }
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/job/get_cron_list/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>查询业务下定时作业信息</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>long</td>
<td>是</td>
<td>业务 ID</td>
</tr>
<tr>
<td>cron_name</td>
<td>string</td>
<td>否</td>
<td>定时作业名称</td>
</tr>
<tr>
<td>cron_id</td>
<td>long</td>
<td>否</td>
<td>定时任务 ID，如果存在则忽略其他筛选条件，只查询这个指定的作业信息</td>
</tr>
<tr>
<td>cron_status</td>
<td>int</td>
<td>否</td>
<td>定时作业状态：1.已启动、2.已暂停</td>
</tr>
<tr>
<td>creator</td>
<td>string</td>
<td>否</td>
<td>定时作业创建人帐号</td>
</tr>
<tr>
<td>create_time_start</td>
<td>string</td>
<td>否</td>
<td>创建起始时间，YYYY-MM-DD 格式</td>
</tr>
<tr>
<td>create_time_end</td>
<td>string</td>
<td>否</td>
<td>创建结束时间，YYYY-MM-DD 格式</td>
</tr>
<tr>
<td>last_modify_user</td>
<td>string</td>
<td>否</td>
<td>作业修改人帐号</td>
</tr>
<tr>
<td>last_modify_time_start</td>
<td>string</td>
<td>否</td>
<td>最后修改起始时间，YYYY-MM-DD 格式</td>
</tr>
<tr>
<td>last_modify_time_end</td>
<td>string</td>
<td>否</td>
<td>最后修改结束时间，YYYY-MM-DD 格式</td>
</tr>
<tr>
<td>start</td>
<td>int</td>
<td>否</td>
<td>默认 0 表示从第 1 条记录开始返回</td>
</tr>
<tr>
<td>length</td>
<td>int</td>
<td>否</td>
<td>返回记录数量，不传此参数默认返回全部</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_biz_id&quot;: 1,
    &quot;cron_name&quot;: &quot;test&quot;,
    &quot;cron_id&quot;: 1,
    &quot;cron_status&quot;: 1,
    &quot;creator&quot;: &quot;admin&quot;,
    &quot;create_time_start&quot;: &quot;2018-03-02&quot;,
    &quot;create_time_end&quot;: &quot;2018-03-23&quot;,
    &quot;last_modify_user&quot;: &quot;admin&quot;,
    &quot;last_modify_time_start&quot;: &quot;2018-03-02&quot;,
    &quot;last_modify_time_end&quot;: &quot;2018-03-23&quot;,
    &quot;start&quot;: 0,
    &quot;length&quot;: 100
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: [
         {
            &quot;bk_biz_id&quot;: 1,
            &quot;bk_job_id&quot;: 100,
            &quot;job_name&quot;: &quot;job name&quot;,
            &quot;cron_id&quot;: 50,
            &quot;cron_name&quot;: &quot;test&quot;,
            &quot;cron_status&quot;: 1,
            &quot;cron_expression&quot;: &quot;0/5 * * * ?&quot;,
            &quot;creator&quot;: &quot;admin&quot;,
            &quot;create_time&quot;: &quot;2018-03-14 15:46:01 +0800&quot;,
            &quot;last_modify_user&quot;: &quot;admin&quot;,
            &quot;last_modify_time&quot;: &quot;2018-03-14 15:48:57 +0800&quot;
        }
    ]
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>long</td>
<td>业务 ID</td>
</tr>
<tr>
<td>bk_job_id</td>
<td>long</td>
<td>作业模板 ID</td>
</tr>
<tr>
<td>job_name</td>
<td>string</td>
<td>作业名称</td>
</tr>
<tr>
<td>cron_id</td>
<td>long</td>
<td>定时作业 ID</td>
</tr>
<tr>
<td>cron_name</td>
<td>string</td>
<td>定时作业名称</td>
</tr>
<tr>
<td>cron_status</td>
<td>string</td>
<td>定时作业状态：1.已启动、2.已暂停</td>
</tr>
<tr>
<td>cron_expression</td>
<td>string</td>
<td>定时任务 crontab 的定时规则，新建时必填，修改时选填，各字段含义为：分 时 日 月 周，如: 0/5 * * * ? 表示每 5 分钟执行一次</td>
</tr>
<tr>
<td>creator</td>
<td>string</td>
<td>作业创建人帐号</td>
</tr>
<tr>
<td>create_time</td>
<td>string</td>
<td>创建时间，YYYY-MM-DD HH:mm:ss 格式</td>
</tr>
<tr>
<td>last_modify_user</td>
<td>string</td>
<td>作业修改人帐号</td>
</tr>
<tr>
<td>last_modify_time</td>
<td>string</td>
<td>最后修改时间，YYYY-MM-DD HH:mm:ss 格式</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/job/get_job_detail/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>根据作业执行方案 ID 查询作业执行方案详情</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>long</td>
<td>是</td>
<td>业务 ID</td>
</tr>
<tr>
<td>bk_job_id</td>
<td>long</td>
<td>是</td>
<td>作业执行方案 ID</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_biz_id&quot;: 1,
    &quot;bk_job_id&quot;: 100
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: {
        &quot;bk_biz_id&quot;: 1,
        &quot;bk_job_id&quot;: 100,
        &quot;name&quot;: &quot;test&quot;,
        &quot;creator&quot;: &quot;admin&quot;,
        &quot;create_time&quot;: &quot;2018-03-15 12:46:24 +0800&quot;,
        &quot;last_modify_user&quot;: &quot;admin&quot;,
        &quot;last_modify_time&quot;: &quot;2018-03-16 09:58:47 +0800&quot;,
        &quot;global_vars&quot;: [{
                &quot;id&quot;: 11,
                &quot;category&quot;: 1,
                &quot;name&quot;: &quot;varName&quot;,
                &quot;value&quot;: &quot;value is Me&quot;,
                &quot;description&quot;: &quot;hello&quot;
            }, {
                &quot;id&quot;: 12,
                &quot;category&quot;: 3,
                &quot;name&quot;: &quot;servers&quot;,
                &quot;target_server&quot;: {
                    &quot;dynamic_group_id_list&quot;: [&quot;blo8gojho0skft7pr5q0&quot;, &quot;blo8gojho0sabc7priuy&quot;],
                    &quot;ip_list&quot;: [{
                            &quot;bk_cloud_id&quot;: 0,
                            &quot;ip&quot;: &quot;10.0.0.1&quot;
                        }, {
                            &quot;bk_cloud_id&quot;: 0,
                            &quot;ip&quot;: &quot;10.0.0.2&quot;
                        }
                    ],
                    &quot;topo_node_list&quot;: [{
                            &quot;id&quot;: 1000,
                            &quot;node_type&quot;: &quot;module&quot;
                        }
                    ]
                },
                &quot;step_ids&quot;: [
                    1059,
                    1060
                ],
                &quot;description&quot;: &quot;&quot;
            }
        ],
        &quot;steps&quot;: [{
                &quot;type&quot;: 1,
                &quot;name&quot;: &quot;xxx&quot;,
                &quot;step_id&quot;: 1059,
                &quot;script_type&quot;: 1,
                &quot;script_id&quot;: 1078,
                &quot;script_timeout&quot;: 1000,
                &quot;script_content&quot;: &quot;echo $1 $2 $3&quot;,
                &quot;script_param&quot;: &quot;a1 a2 a3&quot;,
                &quot;is_param_sensitive&quot;: 0,
                &quot;creator&quot;: &quot;admin&quot;,
                &quot;account&quot;: &quot;root&quot;,
                &quot;create_time&quot;: &quot;2018-03-15 12:46:24 +0800&quot;,
                &quot;last_modify_time&quot;: &quot;2018-03-16 09:58:47 +0800&quot;,
                &quot;last_modify_user&quot;: &quot;admin&quot;
            }, {
                &quot;type&quot;: 2,
                &quot;step_id&quot;: 1060,
                &quot;name&quot;: &quot;xxx&quot;,
                &quot;creator&quot;: &quot;admin&quot;,
                &quot;account&quot;: &quot;root&quot;,
                &quot;create_time&quot;: &quot;2018-03-15 12:46:24 +0800&quot;,
                &quot;last_modify_time&quot;: &quot;2018-03-16 14:19:02 +0800&quot;,
                &quot;last_modify_user&quot;: &quot;admin&quot;,
                &quot;file_target_path&quot;: &quot;/tmp/&quot;,
                &quot;file_source&quot;: [{
                        &quot;files&quot;: [
                            &quot;/tmp/REGEX:[a-z]*.txt&quot;,
                        ],
                        &quot;account&quot;: &quot;root&quot;,
                        &quot;target_server&quot;: {
                            &quot;dynamic_group_id_list&quot;: [&quot;blo8gojho0skft7pr5q0&quot;, &quot;blo8gojho0sabc7priuy&quot;],
                            &quot;ip_list&quot;: [{
                                    &quot;bk_cloud_id&quot;: 0,
                                    &quot;ip&quot;: &quot;10.0.0.3&quot;
                                }, {
                                    &quot;bk_cloud_id&quot;: 0,
                                    &quot;ip&quot;: &quot;10.0.0.4&quot;
                                }
                            ],
                            &quot;topo_node_list&quot;: [{
                                    &quot;id&quot;: 1000,
                                    &quot;node_type&quot;: &quot;module&quot;
                                }
                            ]
                        }
                    }
                ]
            }
        ]
    }
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>long</td>
<td>业务 ID</td>
</tr>
<tr>
<td>bk_job_id</td>
<td>long</td>
<td>作业模板 ID</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>作业名称</td>
</tr>
<tr>
<td>creator</td>
<td>string</td>
<td>作业创建人帐号</td>
</tr>
<tr>
<td>create_time</td>
<td>string</td>
<td>创建时间，YYYY-MM-DD HH:mm:ss 格式</td>
</tr>
<tr>
<td>last_modify_user</td>
<td>string</td>
<td>作业修改人帐号</td>
</tr>
<tr>
<td>last_modify_time</td>
<td>string</td>
<td>最后修改时间，YYYY-MM-DD HH:mm:ss 格式</td>
</tr>
<tr>
<td>steps</td>
<td>array</td>
<td>步骤对象</td>
</tr>
<tr>
<td>global_vars</td>
<td>dict</td>
<td>全局变量信息</td>
</tr>
</tbody>
</table>
<h4 id="steps">steps</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>step_id</td>
<td>long</td>
<td>作业步骤 ID</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>作业步骤名称</td>
</tr>
<tr>
<td>type</td>
<td>int</td>
<td>步骤类型：1.脚本步骤; 2.文件步骤; 3.人工确认步骤</td>
</tr>
<tr>
<td>creator</td>
<td>string</td>
<td>作业步骤创建人帐号</td>
</tr>
<tr>
<td>create_time</td>
<td>string</td>
<td>创建时间，YYYY-MM-DD HH:mm:ss 格式</td>
</tr>
<tr>
<td>last_modify_user</td>
<td>string</td>
<td>作业步骤修改人帐号</td>
</tr>
<tr>
<td>last_modify_time</td>
<td>string</td>
<td>最后修改时间，YYYY-MM-DD HH:mm:ss</td>
</tr>
<tr>
<td>script_id</td>
<td>long</td>
<td>脚本 ID。当 type=1 时才有这个字段。</td>
</tr>
<tr>
<td>script_param</td>
<td>string</td>
<td>脚本参数</td>
</tr>
<tr>
<td>script_content</td>
<td>string</td>
<td>脚本内容。当 type=1 时才有这个字段。</td>
</tr>
<tr>
<td>script_timeout</td>
<td>int</td>
<td>脚本超时时间，秒。默认 3600，取值范围 60-86400</td>
</tr>
<tr>
<td>account</td>
<td>string</td>
<td>执行帐号名/别名</td>
</tr>
<tr>
<td>is_param_sensitive</td>
<td>int</td>
<td>是否敏感参数, 0.不是（默认），1.是。当 type=1 时才有这个字段。</td>
</tr>
<tr>
<td>db_account_id</td>
<td>long</td>
<td>SQL 执行的 db 帐号 ID</td>
</tr>
<tr>
<td>script_type</td>
<td>int</td>
<td>脚本类型：1(shell 脚本)、2(bat 脚本)、3(perl 脚本)、4(python 脚本)、5(Powershell 脚本)、6(SQL).当 type=1 时有这个字段</td>
</tr>
<tr>
<td>file_target_path</td>
<td>string</td>
<td>文件传输目标路径，当 type=2 时并且有值时才有这个字段</td>
</tr>
<tr>
<td>file_source</td>
<td>array</td>
<td>源文件对象数组，当 type=2 时并且有值时才有这个字段，见下面 file_source 定义</td>
</tr>
<tr>
<td>ip_list</td>
<td>array</td>
<td><em>deprecated</em>，请使用 target_server.ip_list 参数替换。IP 对象数组，见下面 ip_list 结构定义</td>
</tr>
<tr>
<td>custom_query_id</td>
<td>array</td>
<td><em>deprecated</em>，请使用 target_server.dynamic_group_id_list 参数替换。配置平台上的动态分组 id 列表，有值时才有这个字段</td>
</tr>
<tr>
<td>target_server</td>
<td>dict</td>
<td>目标服务器</td>
</tr>
</tbody>
</table>
<h4 id="global_vars">global_vars</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>long</td>
<td>全局变量 ID，唯一标识</td>
</tr>
<tr>
<td>category</td>
<td>int</td>
<td>全局变量类型：1:字符，2:命名空间，3:主机列表，4:密码</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>全局变量的名称</td>
</tr>
<tr>
<td>value</td>
<td>string</td>
<td>字符、命名空间、密码类型的全局变量值</td>
</tr>
<tr>
<td>description</td>
<td>string</td>
<td>变量描述</td>
</tr>
<tr>
<td>custom_query_id</td>
<td>array</td>
<td><em>deprecated</em>，请使用 target_server.ip_list.参数替换。配置平台上的自定义分组 ID 列表，当 type=2 时并且有值时才有这个字段</td>
</tr>
<tr>
<td>ip_list</td>
<td>array</td>
<td><em>deprecated</em>，请使用 target_server.dynamic_group_id_list 参数替换。IP 对象数组，当 type=2 时并且有值时才有这个字段，见下面 ip_list 结构定义</td>
</tr>
<tr>
<td>target_server</td>
<td>dict</td>
<td>目标服务器</td>
</tr>
<tr>
<td>step_ids</td>
<td>array</td>
<td>引用了这个 IP 全局变量的步骤 ID 列表</td>
</tr>
</tbody>
</table>
<h4 id="file_source">file_source</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>files</td>
<td>array</td>
<td>源文件的绝对路径数组，支持多个文件</td>
</tr>
<tr>
<td>account</td>
<td>string</td>
<td>执行帐号名/别名</td>
</tr>
<tr>
<td>ip_list</td>
<td>array</td>
<td><em>deprecated</em>，请使用 target_server.ip_list 参数替换。IP 对象数组，当有值时才有这个字段，见下面 ip_list 结构定义</td>
</tr>
<tr>
<td>custom_query_id</td>
<td>array</td>
<td><em>deprecated</em>，请使用 target_server.dynamic_group_id_list 参数替换。配置平台上的动态分组 ID 列表，当有值时才有这个字段</td>
</tr>
<tr>
<td>target_server</td>
<td>dict</td>
<td>目标服务器</td>
</tr>
</tbody>
</table>
<h4 id="target_server">target_server</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>ip_list</td>
<td>array</td>
<td>否</td>
<td>静态 IP 列表</td>
</tr>
<tr>
<td>dynamic_group_id_list</td>
<td>array</td>
<td>否</td>
<td>动态分组 ID 列表</td>
</tr>
<tr>
<td>topo_node_list</td>
<td>array</td>
<td>否</td>
<td>动态 topo 节点列表</td>
</tr>
</tbody>
</table>
<h4 id="ip_list">ip_list</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_cloud_id</td>
<td>long</td>
<td>是</td>
<td>云区域 ID</td>
</tr>
<tr>
<td>ip</td>
<td>string</td>
<td>是</td>
<td>IP 地址</td>
</tr>
</tbody>
</table>
<h4 id="topo_node_list">topo_node_list</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>long</td>
<td>是</td>
<td>动态 topo 节点 ID，对应 CMDB API 中的 bk_inst_id</td>
</tr>
<tr>
<td>node_type</td>
<td>string</td>
<td>是</td>
<td>动态 topo 节点类型，对应 CMDB API 中的 bk_obj_id,比如"module","set"</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/job/get_job_instance_log/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>根据作业实例 ID 查询作业执行日志</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>long</td>
<td>是</td>
<td>业务 ID</td>
</tr>
<tr>
<td>job_instance_id</td>
<td>long</td>
<td>是</td>
<td>作业实例 ID</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_biz_id&quot;: 1,
    &quot;job_instance_id&quot;: 100
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: [
        {
            &quot;is_finished&quot;: true,
            &quot;step_instance_id&quot;: 90000,
            &quot;name&quot;: &quot;test&quot;,
            &quot;status&quot;: 3,
            &quot;step_results&quot;: [
                {
                    &quot;ip_status&quot;: 9,
                    &quot;tag&quot;: &quot;xxx&quot;,
                    &quot;ip_logs&quot;: [
                        {
                            &quot;retry_count&quot;: 0,
                            &quot;total_time&quot;: 60.599,
                            &quot;start_time&quot;: &quot;2018-03-15 14:39:30 +0800&quot;,
                            &quot;end_time&quot;: &quot;2018-03-15 14:40:31 +0800&quot;,
                            &quot;ip&quot;: &quot;10.0.0.1&quot;,
                            &quot;bk_cloud_id&quot;: 0,
                            &quot;error_code&quot;: 0,
                            &quot;exit_code&quot;: 0,
                            &quot;log_content&quot;: &quot;[2018-03-15 14:39:30][PID:56875] job_start\n&quot;
                        }
                    ]
                }
            ]
        }
    ]
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>is_finished</td>
<td>bool</td>
<td>作业是否结束</td>
</tr>
<tr>
<td>step_instance_id</td>
<td>long</td>
<td>作业步骤实例 ID</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>作业实例名称</td>
</tr>
<tr>
<td>status</td>
<td>int</td>
<td>作业状态码: 1.未执行; 2.正在执行; 3.执行成功; 4.执行失败; 5.跳过; 6.忽略错误; 7.等待用户; 8.手动结束; 9.状态异常; 10.步骤强制终止中; 11.步骤强制终止成功</td>
</tr>
<tr>
<td>step_results</td>
<td>array</td>
<td>当前步骤下所有 ip 的日志，按 tag 分类或 ip 的执行状态(ip_status)归类存放</td>
</tr>
</tbody>
</table>
<h4 id="step_result">step_result</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>ip_status</td>
<td>int</td>
<td>主机任务状态码，1.Agent 异常; 3.上次已成功; 5.等待执行; 7.正在执行; 9.执行成功; 11.任务失败; 12.任务下发失败; 13.任务超时; 15.任务日志错误; 101.脚本执行失败; 102.脚本执行超时; 103.脚本执行被终止; 104.脚本返回码非零; 202.文件传输失败; 203.源文件不存在; 310.Agent 异常; 311.用户名不存在; 320.文件获取失败; 321.文件超出限制; 329.文件传输错误; 399.任务执行出错</td>
</tr>
<tr>
<td>tag</td>
<td>string</td>
<td>脚本用 job_success/job_fail 函数返回的标签内容</td>
</tr>
<tr>
<td>ip_logs</td>
<td>array</td>
<td>ip 日志内容</td>
</tr>
</tbody>
</table>
<h4 id="ip_logs">ip_logs</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>start_time</td>
<td>string</td>
<td>开始执行时间，YYYY-MM-DD HH:mm:ss</td>
</tr>
<tr>
<td>end_time</td>
<td>string</td>
<td>执行结束时间，YYYY-MM-DD HH:mm:ss 格式</td>
</tr>
<tr>
<td>total_time</td>
<td>float</td>
<td>总耗时，秒</td>
</tr>
<tr>
<td>retry_count</td>
<td>int</td>
<td>步骤重试次数</td>
</tr>
<tr>
<td>error_code</td>
<td>int</td>
<td>作业执行中出错码</td>
</tr>
<tr>
<td>exit_code</td>
<td>int</td>
<td>shell 脚本退出码; 0 正常; 非 0 异常</td>
</tr>
<tr>
<td>bk_cloud_id</td>
<td>long</td>
<td>云区域 ID</td>
</tr>
<tr>
<td>ip</td>
<td>string</td>
<td>IP 地址</td>
</tr>
<tr>
<td>log_content</td>
<td>string</td>
<td>作业脚本输出的日志内容</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/job/get_job_instance_status/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>根据作业实例 ID 查询作业执行状态</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>long</td>
<td>是</td>
<td>业务 ID</td>
</tr>
<tr>
<td>job_instance_id</td>
<td>long</td>
<td>是</td>
<td>作业实例 ID</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_biz_id&quot;: 1,
    &quot;job_instance_id&quot;: 100
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: {
        &quot;is_finished&quot;: true,
        &quot;job_instance&quot;: {
            &quot;job_instance_id&quot;: 100,
            &quot;bk_biz_id&quot;: 1,
            &quot;name&quot;: &quot;API Quick execution script1521089795887&quot;,
            &quot;start_way&quot;: 2,
            &quot;operator&quot;: &quot;admin&quot;,
            &quot;bk_job_id&quot;: -1,
            &quot;create_time&quot;: &quot;2018-03-15 12:56:35 +0800&quot;,
            &quot;status&quot;: 4,
            &quot;start_time&quot;: &quot;2018-03-15 12:56:35 +0800&quot;,
            &quot;end_time&quot;: &quot;2018-03-15 12:56:39 +0800&quot;,
            &quot;total_time&quot;: 3.169,
            &quot;current_step_instance_id&quot;: 75
        },
        &quot;blocks&quot;: [
            {
                &quot;type&quot;: 1,
                &quot;step_instances&quot;: [
                    {
                        &quot;status&quot;: 4,
                        &quot;total_time&quot;: 3.169,
                        &quot;name&quot;: &quot;API Quick execution scriptxxx&quot;,
                        &quot;step_instance_id&quot;: 75,
                        &quot;operator&quot;: &quot;admin&quot;,
                        &quot;retry_count&quot;: 0,
                        &quot;create_time&quot;: &quot;2018-03-15 12:56:35 +0800&quot;,
                        &quot;end_time&quot;: &quot;2018-03-15 12:56:39 +0800&quot;,
                        &quot;step_id&quot;: -1,
                        &quot;type&quot;: 1,
                        &quot;start_time&quot;: &quot;2018-03-15 12:56:35 +0800&quot;,
                        &quot;step_ip_status&quot;: [
                            {
                                &quot;ip&quot;: &quot;10.0.0.1&quot;,
                                &quot;bk_cloud_id&quot;: 0,
                                &quot;status&quot;: 9
                            }
                        ]
                    }
                ]
            }
        ]
    }
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>is_finished</td>
<td>bool</td>
<td>作业是否结束</td>
</tr>
<tr>
<td>job_instance</td>
<td>dict</td>
<td>作业实例基本信息</td>
</tr>
<tr>
<td>blocks</td>
<td>array</td>
<td>作业步骤分组。兼容字段，当前版本暂无步骤分组设计</td>
</tr>
</tbody>
</table>
<h4 id="job_instance">job_instance</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>string</td>
<td>作业实例名称</td>
</tr>
<tr>
<td>status</td>
<td>int</td>
<td>作业状态码: 1.未执行; 2.正在执行; 3.执行成功; 4.执行失败; 5.跳过; 6.忽略错误; 7.等待用户; 8.手动结束; 9.状态异常; 10.步骤强制终止中; 11.步骤强制终止成功</td>
</tr>
<tr>
<td>operator</td>
<td>string</td>
<td>作业执行人帐号</td>
</tr>
<tr>
<td>create_time</td>
<td>string</td>
<td>创建时间，YYYY-MM-DD HH:mm:ss 格式</td>
</tr>
<tr>
<td>start_time</td>
<td>string</td>
<td>开始执行时间，YYYY-MM-DD HH:mm:ss 格式</td>
</tr>
<tr>
<td>end_time</td>
<td>string</td>
<td>执行结束时间，YYYY-MM-DD HH:mm:ss 格式</td>
</tr>
<tr>
<td>total_time</td>
<td>float</td>
<td>总耗时，秒</td>
</tr>
<tr>
<td>start_way</td>
<td>int</td>
<td>作业启动方式: 1.页面启动; 2.API 调用; 3.定时任务</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>long</td>
<td>业务 ID</td>
</tr>
<tr>
<td>bk_job_id</td>
<td>long</td>
<td>作业模板 ID，如果不是从作业模板启动的则为-1</td>
</tr>
<tr>
<td>job_instance_id</td>
<td>long</td>
<td>作业实例 ID</td>
</tr>
<tr>
<td>current_step_instance_id</td>
<td>long</td>
<td>当前执行的步骤实例 ID</td>
</tr>
</tbody>
</table>
<h4 id="step_instances">step_instances</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>step_id</td>
<td>long</td>
<td>作业模板步骤 ID，如果不是从作业模板启动的则为-1</td>
</tr>
<tr>
<td>step_instance_id</td>
<td>long</td>
<td>作业步骤实例 ID</td>
</tr>
<tr>
<td>type</td>
<td>int</td>
<td>步骤类型：1.脚本步骤; 2.文件步骤; 4.SQL 步骤</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>作业实例名称</td>
</tr>
<tr>
<td>status</td>
<td>int</td>
<td>作业步骤状态码: 1.未执行; 2.正在执行; 3.执行成功; 4.执行失败; 5.跳过; 6.忽略错误; 7.等待用户; 8.手动结束; 9.状态异常; 10.步骤强制终止中; 11.步骤强制终止成功; 12.步骤强制终止失败</td>
</tr>
<tr>
<td>operator</td>
<td>string</td>
<td>作业执行人帐号</td>
</tr>
<tr>
<td>create_time</td>
<td>string</td>
<td>创建时间，YYYY-MM-DD HH:mm:ss 格式</td>
</tr>
<tr>
<td>start_time</td>
<td>string</td>
<td>开始执行时间，YYYY-MM-DD HH:mm:ss 格式</td>
</tr>
<tr>
<td>end_time</td>
<td>string</td>
<td>执行结束时间，YYYY-MM-DD HH:mm:ss 格式</td>
</tr>
<tr>
<td>total_time</td>
<td>float</td>
<td>总耗时，秒</td>
</tr>
<tr>
<td>retry_count</td>
<td>int</td>
<td>步骤重试次数</td>
</tr>
<tr>
<td>step_ip_status</td>
<td>array</td>
<td>每个服务器的作业执行状态</td>
</tr>
</tbody>
</table>
<h4 id="step_ip_status-description">step_ip_status Description</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>ip</td>
<td>string</td>
<td>IP</td>
</tr>
<tr>
<td>bk_cloud_id</td>
<td>long</td>
<td>云区域 ID</td>
</tr>
<tr>
<td>status</td>
<td>int</td>
<td>作业执行状态:1.Agent 异常; 5.等待执行; 7.正在执行; 9.执行成功; 11.执行失败; 12.任务下发失败; 403.任务强制终止成功; 404.任务强制终止失败</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/job/get_job_list/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>查询作业执行方案列表</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>long</td>
<td>是</td>
<td>业务 ID</td>
</tr>
<tr>
<td>creator</td>
<td>string</td>
<td>否</td>
<td>作业执行方案创建人帐号</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>否</td>
<td>作业执行方案名称，模糊匹配</td>
</tr>
<tr>
<td>create_time_start</td>
<td>string</td>
<td>否</td>
<td>创建起始时间，YYYY-MM-DD 格式</td>
</tr>
<tr>
<td>create_time_end</td>
<td>string</td>
<td>否</td>
<td>创建结束时间，YYYY-MM-DD 格式</td>
</tr>
<tr>
<td>last_modify_user</td>
<td>string</td>
<td>否</td>
<td>作业执行方案修改人帐号</td>
</tr>
<tr>
<td>last_modify_time_start</td>
<td>string</td>
<td>否</td>
<td>最后修改起始时间，YYYY-MM-DD 格式</td>
</tr>
<tr>
<td>last_modify_time_end</td>
<td>string</td>
<td>否</td>
<td>最后修改结束时间，YYYY-MM-DD 格式</td>
</tr>
<tr>
<td>start</td>
<td>int</td>
<td>否</td>
<td>默认 0 表示从第 1 条记录开始返回</td>
</tr>
<tr>
<td>length</td>
<td>int</td>
<td>否</td>
<td>返回记录数量，不传此参数默认返回全部</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_biz_id&quot;: 1,
    &quot;creator&quot;: &quot;admin&quot;,
    &quot;name&quot;: &quot;test&quot;,
    &quot;create_time_start&quot;: &quot;2016-02-22&quot;,
    &quot;create_time_end&quot;: &quot;2016-02-22&quot;,
    &quot;last_modify_user&quot;: &quot;admin&quot;,
    &quot;last_modify_time_start&quot;: &quot;2016-02-22&quot;,
    &quot;last_modify_time_end&quot;: &quot;2016-02-22&quot;,
    &quot;start&quot;: 0,
    &quot;length&quot;: 100
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;success&quot;,
    &quot;data&quot;: [
        {
            &quot;bk_biz_id&quot;: 1,
            &quot;bk_job_id&quot;: 100,
            &quot;name&quot;: &quot;test&quot;,
            &quot;creator&quot;: &quot;admin&quot;,
            &quot;last_modify_user&quot;: &quot;admin&quot;,
            &quot;create_time&quot;: &quot;2018-01-23 15:05:41 +0800&quot;,
            &quot;last_modify_time&quot;: &quot;2018-01-23 16:04:51 +0800&quot;
        }
    ]
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>long</td>
<td>业务 ID</td>
</tr>
<tr>
<td>bk_job_id</td>
<td>long</td>
<td>作业执行方案 ID</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>作业执行方案名称</td>
</tr>
<tr>
<td>creator</td>
<td>string</td>
<td>创建人帐号</td>
</tr>
<tr>
<td>create_time</td>
<td>string</td>
<td>创建时间，YYYY-MM-DD HH:mm:ss 格式</td>
</tr>
<tr>
<td>last_modify_user</td>
<td>string</td>
<td>修改人帐号</td>
</tr>
<tr>
<td>last_modify_time</td>
<td>string</td>
<td>最后修改时间，YYYY-MM-DD HH:mm:ss 格式</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/job/get_os_account/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>查询业务下的执行账号</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>long</td>
<td>是</td>
<td>业务 ID</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_biz_id&quot;: 1
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;success&quot;,
    &quot;data&quot;: [
        {
            &quot;id&quot;: 2,
            &quot;account&quot;: &quot;Administrator&quot;,
            &quot;creator&quot;: &quot;system&quot;,
            &quot;os&quot;: &quot;Windows&quot;,
            &quot;alias&quot;: &quot;Administrator&quot;,
            &quot;bk_biz_id&quot;: 2,
            &quot;create_time&quot;: &quot;2018-03-22 15:36:31&quot;
        },
        {
            &quot;id&quot;: 19,
            &quot;account&quot;: &quot;SDFDSFDFDS&quot;,
            &quot;creator&quot;: &quot;admin&quot;,
            &quot;os&quot;: null,
            &quot;alias&quot;: &quot;SDFDSFDFDS&quot;,
            &quot;bk_biz_id&quot;: 2,
            &quot;create_time&quot;: &quot;2018-08-10 11:49:20&quot;
        }
    ]
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>long</td>
<td>账号 ID</td>
</tr>
<tr>
<td>account</td>
<td>string</td>
<td>账号名称</td>
</tr>
<tr>
<td>creator</td>
<td>string</td>
<td>账号创建人</td>
</tr>
<tr>
<td>os</td>
<td>string</td>
<td>账号对应的 OS</td>
</tr>
<tr>
<td>alias</td>
<td>string</td>
<td>账号别名</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>long</td>
<td>业务 ID</td>
</tr>
<tr>
<td>create_time</td>
<td>string</td>
<td>账号创建时间</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/job/get_own_db_account_list/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>查询用户有权限的 DB 帐号列表</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>long</td>
<td>是</td>
<td>业务 ID</td>
</tr>
<tr>
<td>start</td>
<td>int</td>
<td>否</td>
<td>默认 0 表示从第 1 条记录开始返回</td>
</tr>
<tr>
<td>length</td>
<td>int</td>
<td>否</td>
<td>返回记录数量，不传此参数默认返回全部</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_biz_id&quot;: 1,
    &quot;start&quot;: 0,
    &quot;length&quot;: 100
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;success&quot;,
    &quot;data&quot;: [
        {
            &quot;db_account_id&quot;: 1000,
            &quot;db_alias&quot;: &quot;mysql&quot;
        }
    ]
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>db_account_id</td>
<td>long</td>
<td>db 帐号 ID,主键，执行脚本或作业的接口请求传递参数时用此参数</td>
</tr>
<tr>
<td>db_alias</td>
<td>string</td>
<td>帐号别名</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/job/get_public_script_list/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>查询公共脚本列表</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>return_script_content</td>
<td>bool</td>
<td>否</td>
<td>是否需要返回脚本内容。true:返回脚本内容；false：不返回脚本内容。默认为 false。</td>
</tr>
<tr>
<td>start</td>
<td>int</td>
<td>否</td>
<td>默认 0 表示从第 1 条记录开始返回</td>
</tr>
<tr>
<td>length</td>
<td>int</td>
<td>否</td>
<td>分页查询-每页纪录数，默认为 20。如果传入 0 或者不传，表示不分页</td>
</tr>
<tr>
<td>script_type</td>
<td>int</td>
<td>否</td>
<td>脚本类型。0：所有脚本类型，1：shell，2：bat，3：perl，4：python，5：powershell，6：sql。默认值为 0</td>
</tr>
<tr>
<td>script_name</td>
<td>string</td>
<td>否</td>
<td>脚本名称，支持模糊查询</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;start&quot;: 0,
    &quot;length&quot;: 10,
    &quot;return_script_content&quot;: false
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;success&quot;,
    &quot;data&quot;: {
        &quot;data&quot;: [
            {
                &quot;id&quot;: 6862,
                &quot;name&quot;: &quot;a.sh&quot;,
                &quot;version&quot;: &quot;admin.20180627172306&quot;,
                &quot;tag&quot;: &quot;v1.0&quot;,
                &quot;type&quot;: 1,
                &quot;creator&quot;: &quot;admin&quot;,
                &quot;public&quot;: true,
                &quot;bk_biz_id&quot;: 2,
                &quot;create_time&quot;: &quot;2018-06-27 17:23:06&quot;,
                &quot;last_modify_user&quot;: &quot;admin&quot;,
                &quot;last_modify_time&quot;: &quot;2018-06-27 17:23:06&quot;
            },
            {
                &quot;id&quot;: 36,
                &quot;name&quot;: &quot;build_version&quot;,
                &quot;version&quot;: &quot;admin.20180723154537&quot;,
                &quot;tag&quot;: &quot;v1.0&quot;,
                &quot;type&quot;: 1,
                &quot;creator&quot;: &quot;admin&quot;,
                &quot;public&quot;: true,
                &quot;bk_biz_id&quot;: 2,
                &quot;create_time&quot;: &quot;2018-07-23 15:45:37&quot;,
                &quot;last_modify_user&quot;: &quot;admin&quot;,
                &quot;last_modify_time&quot;: &quot;2018-07-23 17:24:17&quot;
            }
        ],
        &quot;start&quot;: 0,
        &quot;page_size&quot;: 10,
        &quot;total_record_size&quot;: 2
    }
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>long</td>
<td>脚本 ID</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>脚本名称</td>
</tr>
<tr>
<td>version</td>
<td>string</td>
<td>脚本版本号</td>
</tr>
<tr>
<td>tag</td>
<td>string</td>
<td>脚本版本描述</td>
</tr>
<tr>
<td>type</td>
<td>int</td>
<td>脚本类型</td>
</tr>
<tr>
<td>creator</td>
<td>string</td>
<td>脚本创建人</td>
</tr>
<tr>
<td>public</td>
<td>bool</td>
<td>是否公共脚本</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>long</td>
<td>业务 ID</td>
</tr>
<tr>
<td>create_time</td>
<td>string</td>
<td>脚本创建时间</td>
</tr>
<tr>
<td>last_modify_user</td>
<td>string</td>
<td>脚本最近一次修改人</td>
</tr>
<tr>
<td>last_modify_time</td>
<td>string</td>
<td>脚本最近一次修改时间</td>
</tr>
<tr>
<td>content</td>
<td>string</td>
<td>脚本内容</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/job/get_script_detail/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>查询脚本详情</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>long</td>
<td>否</td>
<td>业务 ID，如果查询公共脚本可不传</td>
</tr>
<tr>
<td>id</td>
<td>long</td>
<td>是</td>
<td>脚本 ID</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_biz_id&quot;: 1,
    &quot;id&quot;: 18
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;success&quot;,
    &quot;data&quot;: {
        &quot;id&quot;: 18,
        &quot;name&quot;: &quot;test&quot;,
        &quot;version&quot;: &quot;admin.20180723160606&quot;,
        &quot;tag&quot;: &quot;v1.0&quot;,
        &quot;type&quot;: 1,
        &quot;creator&quot;: &quot;admin&quot;,
        &quot;content&quot;: &quot;xxx&quot;,
        &quot;public&quot;: false,
        &quot;bk_biz_id&quot;: 1,
        &quot;create_time&quot;: &quot;2018-07-23 16:06:06&quot;,
        &quot;last_modify_user&quot;: &quot;admin&quot;,
        &quot;last_modify_time&quot;: &quot;2018-07-23 16:06:08&quot;
    },
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>long</td>
<td>脚本 ID</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>脚本名称</td>
</tr>
<tr>
<td>version</td>
<td>string</td>
<td>脚本版本号</td>
</tr>
<tr>
<td>tag</td>
<td>string</td>
<td>脚本版本描述</td>
</tr>
<tr>
<td>type</td>
<td>int</td>
<td>脚本类型</td>
</tr>
<tr>
<td>creator</td>
<td>string</td>
<td>脚本创建人</td>
</tr>
<tr>
<td>public</td>
<td>bool</td>
<td>是否公共脚本</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>long</td>
<td>业务 ID</td>
</tr>
<tr>
<td>create_time</td>
<td>string</td>
<td>脚本创建时间</td>
</tr>
<tr>
<td>last_modify_user</td>
<td>string</td>
<td>脚本最近一次修改人</td>
</tr>
<tr>
<td>last_modify_time</td>
<td>string</td>
<td>脚本最近一次修改时间</td>
</tr>
<tr>
<td>content</td>
<td>string</td>
<td>脚本内容</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/job/get_script_list/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>查询业务脚本列表</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>long</td>
<td>否</td>
<td>业务 ID，如果查询公共脚本可不传</td>
</tr>
<tr>
<td>return_script_content</td>
<td>bool</td>
<td>否</td>
<td>是否需要返回脚本内容。true:返回脚本内容；false：不返回脚本内容。默认为 false。</td>
</tr>
<tr>
<td>start</td>
<td>int</td>
<td>否</td>
<td>默认 0 表示从第 1 条记录开始返回</td>
</tr>
<tr>
<td>length</td>
<td>int</td>
<td>否</td>
<td>分页查询-每页纪录数，默认为 20。如果传入 0 或者不传，表示不分页</td>
</tr>
<tr>
<td>script_type</td>
<td>int</td>
<td>否</td>
<td>脚本类型。0：所有脚本类型，1：shell，2：bat，3：perl，4：python，5：powershell，6：sql。默认值为 0</td>
</tr>
<tr>
<td>script_name</td>
<td>string</td>
<td>否</td>
<td>脚本名称，支持模糊查询</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_biz_id&quot;: 1,
    &quot;start&quot;: 0,
    &quot;length&quot;: 10,
    &quot;is_public&quot;: false,
    &quot;return_script_content&quot;: false
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;success&quot;,
    &quot;data&quot;: {
        &quot;data&quot;: [
            {
                &quot;id&quot;: 6862,
                &quot;name&quot;: &quot;a.sh&quot;,
                &quot;version&quot;: &quot;admin.20180627172306&quot;,
                &quot;tag&quot;: &quot;v1.0&quot;,
                &quot;type&quot;: 1,
                &quot;creator&quot;: &quot;admin&quot;,
                &quot;public&quot;: false,
                &quot;bk_biz_id&quot;: 2,
                &quot;create_time&quot;: &quot;2018-06-27 17:23:06&quot;,
                &quot;last_modify_user&quot;: &quot;admin&quot;,
                &quot;last_modify_time&quot;: &quot;2018-06-27 17:23:06&quot;
            },
            {
                &quot;id&quot;: 36,
                &quot;name&quot;: &quot;build_version&quot;,
                &quot;version&quot;: &quot;admin.20180723154537&quot;,
                &quot;tag&quot;: &quot;v1.0&quot;,
                &quot;type&quot;: 1,
                &quot;creator&quot;: &quot;admin&quot;,
                &quot;public&quot;: false,
                &quot;bk_biz_id&quot;: 2,
                &quot;create_time&quot;: &quot;2018-07-23 15:45:37&quot;,
                &quot;last_modify_user&quot;: &quot;admin&quot;,
                &quot;last_modify_time&quot;: &quot;2018-07-23 17:24:17&quot;
            }
        ],
        &quot;start&quot;: 0,
        &quot;page_size&quot;: 10,
        &quot;total_record_size&quot;: 2
    }
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>long</td>
<td>脚本 ID</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>脚本名称</td>
</tr>
<tr>
<td>version</td>
<td>string</td>
<td>脚本版本号</td>
</tr>
<tr>
<td>tag</td>
<td>string</td>
<td>脚本版本描述</td>
</tr>
<tr>
<td>type</td>
<td>int</td>
<td>脚本类型</td>
</tr>
<tr>
<td>creator</td>
<td>string</td>
<td>脚本创建人</td>
</tr>
<tr>
<td>public</td>
<td>bool</td>
<td>是否公共脚本</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>long</td>
<td>业务 ID</td>
</tr>
<tr>
<td>create_time</td>
<td>string</td>
<td>脚本创建时间</td>
</tr>
<tr>
<td>last_modify_user</td>
<td>string</td>
<td>脚本最近一次修改人</td>
</tr>
<tr>
<td>last_modify_time</td>
<td>string</td>
<td>脚本最近一次修改时间</td>
</tr>
<tr>
<td>content</td>
<td>string</td>
<td>脚本内容</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/job/get_step_instance_status/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>查询作业步骤实例的执行状态</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h3 id="_6">接口参数</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>long</td>
<td>是</td>
<td>业务 ID</td>
</tr>
<tr>
<td>params</td>
<td>dict</td>
<td>是</td>
<td>请求参数结构</td>
</tr>
</tbody>
</table>
<h4 id="params">params</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>job_instance_id</td>
<td>long</td>
<td>是</td>
<td>作业实例 ID</td>
</tr>
<tr>
<td>step_instance_id</td>
<td>long</td>
<td>是</td>
<td>作业步骤实例 ID</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_biz_id&quot;: 2,
    &quot;params&quot;: {
        &quot;job_instance_id&quot;: 490001,
        &quot;step_instance_id&quot;: 790001
    }
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;OK&quot;,
    &quot;data&quot;: {
        &quot;is_finished&quot;: true,
        &quot;step_instance_analyse_result&quot;: [
            {
                &quot;result_type&quot;: 3,
                &quot;result_type_text&quot;: &quot;Success&quot;,
                &quot;count&quot;: 1,
                &quot;ip_list&quot;: [
                    {
                        &quot;bk_cloud_id&quot;: 0,
                        &quot;ip&quot;: &quot;10.25.0.2&quot;
                    }
                ]
            }
        ],
        &quot;step_instance_detail&quot;: {
            &quot;step_instance_id&quot;: 790001,
            &quot;name&quot;: &quot;my_job&quot;,
            &quot;type&quot;: 1,
            &quot;operator&quot;: &quot;admin&quot;,
            &quot;status&quot;: 3,
            &quot;step_id&quot;: 10000,
            &quot;job_instance_id&quot;: 490001,
            &quot;bk_biz_id&quot;: 2,
            &quot;target_ips&quot;: &quot;0:10.25.0.2&quot;,
            &quot;abnormal_agent_ips&quot;:&quot;&quot;,
            &quot;retry_count&quot;: 0,
            &quot;start_time&quot;: &quot;2019-06-07 12:15:14&quot;,
            &quot;end_time&quot;: &quot;2019-06-07 12:15:42&quot;,
            &quot;total_time&quot;: 28.395,
            &quot;total_ip_num&quot;: 1,
            &quot;abnormal_agent_ip_num&quot;: 0,
            &quot;running_ip_num&quot;: 1,
            &quot;fail_ip_num&quot;: 1,
            &quot;success_ip_num&quot;: 0
        }
    }
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>is_finished</td>
<td>boolean</td>
<td>作业步骤是否结束</td>
</tr>
<tr>
<td>step_instance_detail</td>
<td>dict</td>
<td>步骤实例执行详情</td>
</tr>
<tr>
<td>step_instance_analyse_result</td>
<td>dict</td>
<td>作业步骤执行结果分析</td>
</tr>
</tbody>
</table>
<h4 id="step_instance_detail">step_instance_detail</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>step_instance_id</td>
<td>long</td>
<td>作业步骤实例 ID</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>步骤名称</td>
</tr>
<tr>
<td>type</td>
<td>int</td>
<td>步骤类型: 1.脚本执行; 2.文件分发; 3.人工确认</td>
</tr>
<tr>
<td>operator</td>
<td>string</td>
<td>作业执行人帐号</td>
</tr>
<tr>
<td>status</td>
<td>int</td>
<td>步骤执行状态码: 1.未执行; 2.正在执行; 3.执行成功; 4.执行失败; 5.跳过; 6.忽略错误; 7.等待用户; 8.手动结束; 9.状态异常; 10.步骤强制终止中; 11.步骤强制终止成功</td>
</tr>
<tr>
<td>step_id</td>
<td>long</td>
<td>步骤 ID</td>
</tr>
<tr>
<td>job_instance_id</td>
<td>long</td>
<td>作业实例 ID</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>业务 ID</td>
</tr>
<tr>
<td>target_ips</td>
<td>string</td>
<td>目标服务器 IP 列表，格式:IP1,IP2,IP2</td>
</tr>
<tr>
<td>abnormal_agent_ips</td>
<td>string</td>
<td>作业执行异常服务器的 IP 列表，格式:IP1,IP2,IP2</td>
</tr>
<tr>
<td>retry_count</td>
<td>int</td>
<td>步骤重试次数</td>
</tr>
<tr>
<td>start_time</td>
<td>string</td>
<td>开始执行时间，YYYY-MM-DD HH:mm:ss 格式</td>
</tr>
<tr>
<td>end_time</td>
<td>string</td>
<td>执行结束时间，YYYY-MM-DD HH:mm:ss 格式</td>
</tr>
<tr>
<td>total_time</td>
<td>float</td>
<td>步骤总耗时,秒</td>
</tr>
<tr>
<td>total_ip_num</td>
<td>int</td>
<td>目标服务器数量</td>
</tr>
<tr>
<td>abnormal_agent_ip_num</td>
<td>int</td>
<td>执行异常服务器数量</td>
</tr>
<tr>
<td>running_ip_num</td>
<td>int</td>
<td>正在执行当前步骤的服务器数量</td>
</tr>
<tr>
<td>fail_ip_num</td>
<td>int</td>
<td>当前步骤执行失败的服务器数量</td>
</tr>
<tr>
<td>success_ip_num</td>
<td>int</td>
<td>作业执行成功的服务器数量</td>
</tr>
</tbody>
</table>
<h4 id="step_analyse_result">step_analyse_result</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>result_type</td>
<td>int</td>
<td>执行结果类型</td>
</tr>
<tr>
<td>result_type_text</td>
<td>int</td>
<td>执行结果类型描述</td>
</tr>
<tr>
<td>count</td>
<td>int</td>
<td>服务器数目</td>
</tr>
<tr>
<td>ip_list</td>
<td>array</td>
<td>服务器 IP 列表</td>
</tr>
</tbody>
</table>
<h4 id="ip_list">ip_list</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_cloud_id</td>
<td>long</td>
<td>云区域 ID</td>
</tr>
<tr>
<td>ip</td>
<td>string</td>
<td>IP</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/job/operate_job_instance/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>用于对执行的作业实例进行操作，例如终止作业。</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>long</td>
<td>是</td>
<td>业务 ID</td>
</tr>
<tr>
<td>job_instance_id</td>
<td>long</td>
<td>是</td>
<td>作业实例 ID</td>
</tr>
<tr>
<td>operation_code</td>
<td>int</td>
<td>是</td>
<td>操作类型：1、终止作业</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_biz_id&quot;: 1,
    &quot;job_instance_id&quot;: 100,
    &quot;operation_code&quot;: 1
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;success&quot;,
    &quot;data&quot;: {
        &quot;job_instance_id&quot;: 100
    }
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/job/operate_step_instance/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>用于对执行的实例的步骤进行操作，例如重试，忽略错误等。</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>long</td>
<td>是</td>
<td>业务 ID</td>
</tr>
<tr>
<td>job_instance_id</td>
<td>long</td>
<td>是</td>
<td>作业实例 ID</td>
</tr>
<tr>
<td>step_instance_id</td>
<td>long</td>
<td>是</td>
<td>步骤实例 ID</td>
</tr>
<tr>
<td>operation_code</td>
<td>int</td>
<td>是</td>
<td>操作类型：2、失败 IP 重做，3、忽略错误，4、执行，5、跳过，6、确认继续 8、全部重试，9、终止确认流程，10-重新发起确认</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_biz_id&quot;: 1,
    &quot;job_instance_id&quot;: 100,
    &quot;step_instance_id&quot;: 200,
    &quot;operation_code&quot;: 2
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;success&quot;,
    &quot;data&quot;: {
        &quot;step_instance_id&quot;: 200,
        &quot;job_instance_id&quot;: 100
    }
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/job/push_config_file/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>分发配置文件，此接口用于分发配置文件等小的纯文本文件</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>long</td>
<td>是</td>
<td>业务 ID</td>
</tr>
<tr>
<td>account</td>
<td>string</td>
<td>是</td>
<td>执行帐号名/别名</td>
</tr>
<tr>
<td>file_target_path</td>
<td>string</td>
<td>是</td>
<td>文件传输目标路径</td>
</tr>
<tr>
<td>file_list</td>
<td>array</td>
<td>是</td>
<td>源文件对象数组，见下面 file_list 定义</td>
</tr>
<tr>
<td>ip_list</td>
<td>array</td>
<td>是</td>
<td>IP 对象数组，见下面 ip_list 结构定义</td>
</tr>
</tbody>
</table>
<h4 id="file_list">file_list</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>file_name</td>
<td>string</td>
<td>是</td>
<td>文件名称</td>
</tr>
<tr>
<td>content</td>
<td>string</td>
<td>是</td>
<td>文件内容 Base64</td>
</tr>
</tbody>
</table>
<h4 id="ip_list">ip_list</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_cloud_id</td>
<td>long</td>
<td>是</td>
<td>云区域 ID</td>
</tr>
<tr>
<td>ip</td>
<td>string</td>
<td>是</td>
<td>IP 地址</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_biz_id&quot;: 1,
    &quot;account&quot;: &quot;root&quot;,
    &quot;file_target_path&quot;: &quot;/tmp/&quot;,
    &quot;file_list&quot;: [
        {
            &quot;file_name&quot;: &quot;a.txt&quot;,
            &quot;content&quot;: &quot;aGVsbG8gd29ybGQh&quot;
        }
    ],
    &quot;ip_list&quot;: [
        {
            &quot;bk_cloud_id&quot;: 0,
            &quot;ip&quot;: &quot;10.0.0.1&quot;
        }
    ]
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;success&quot;,
    &quot;data&quot;: {
        &quot;job_instance_name&quot;: &quot;API GSE PUSH FILE1521107826893&quot;,
        &quot;job_instance_id&quot;: 10000
    }
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/job/save_cron/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>新建或保存定时作业；新建定时作业，定时任务状态默认为暂停。</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>long</td>
<td>是</td>
<td>业务 ID</td>
</tr>
<tr>
<td>bk_job_id</td>
<td>long</td>
<td>是</td>
<td>要定时执行的作业的作业执行方案 ID</td>
</tr>
<tr>
<td>cron_id</td>
<td>long</td>
<td>否</td>
<td>定时任务 ID，更新定时任务时，必须传这个值</td>
</tr>
<tr>
<td>cron_name</td>
<td>string</td>
<td>否</td>
<td>定时作业名称，新建时必填，修改时选填</td>
</tr>
<tr>
<td>cron_expression</td>
<td>string</td>
<td>否</td>
<td>定时任务 crontab 的定时规则，新建时必填，修改时选填，各字段含义为：分 时 日 月 周，如: 0/5 * * * ? 表示每 5 分钟执行一次</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_biz_id&quot;: 1,
    &quot;bk_job_id&quot;: 100,
    &quot;cron_name&quot;: &quot;test&quot;,
    &quot;cron_expression&quot;: &quot;0/5 * * * ?&quot;
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;success&quot;,
    &quot;data&quot;: {
        &quot;cron_id&quot;: 1
    }
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/job/update_cron_status/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>更新定时作业状态，如启动或暂停</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>long</td>
<td>是</td>
<td>业务 ID</td>
</tr>
<tr>
<td>cron_status</td>
<td>int</td>
<td>是</td>
<td>定时状态，1.启动、2.暂停</td>
</tr>
<tr>
<td>cron_id</td>
<td>long</td>
<td>是</td>
<td>定时作业 ID</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_biz_id&quot;: 1,
    &quot;cron_status&quot;: 1,
    &quot;cron_id&quot;: 2
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;success&quot;,
    &quot;data&quot;: {
        &quot;cron_id&quot;: 2
    }
}</code></pre><h2 id="api-api">蓝鲸 API 网关 API 简介</h2>
<table>
<thead>
<tr>
<th>资源名称</th>
<th>资源描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="./get_components.md">get_components</a></td>
<td>获取指定系统的组件列表</td>
</tr>
<tr>
<td><a href="./get_systems.md">get_systems</a></td>
<td>获取系统列表</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/esb/get_components/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>获取指定系统的组件列表</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>system_names</td>
<td>list</td>
<td>是</td>
<td>系统名称, 可通过组件 get_systems 获取</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;system_names&quot;: [&quot;BK_LOGIN&quot;, &quot;XXXX&quot;]
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;data&quot;: [
        {
            &quot;name&quot;: &quot;get_all_users&quot;,
            &quot;label&quot;: &quot;获取所有用户信息&quot;,
            &quot;version&quot;: &quot;v2&quot;,
            &quot;method&quot;: &quot;GET&quot;,
            &quot;path&quot;: &quot;/api/c/compapi/v2/bk_login/get_all_users/&quot;,
            &quot;system_id&quot;: 1,
            &quot;system_name&quot;: &quot;BK_LOGIN&quot;,
            &quot;type&quot;: 2,
            &quot;category&quot;: &quot;component&quot;,
        },
        {
            &quot;name&quot;: &quot;get_api_check_component_exist&quot;,
            &quot;label&quot;: &quot;check_component_exist&quot;,
            &quot;version&quot;: &quot;&quot;,
            &quot;method&quot;: &quot;GET&quot;,
            &quot;path&quot;: &quot;/api/c/self-service-api/api/check_component_exist/&quot;,
            &quot;system_id&quot;: 6,
            &quot;system_name&quot;: &quot;XXXX&quot;,
            &quot;type&quot;: 2,
            &quot;category&quot;: &quot;buffet_component&quot;,
        }
    ],
    &quot;message&quot;: &quot;&quot;
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>method</td>
<td>string</td>
<td>建议请求方法</td>
</tr>
<tr>
<td>version</td>
<td>string</td>
<td>组件版本</td>
</tr>
<tr>
<td>system_id</td>
<td>int</td>
<td>所属系统 id</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>组件名称</td>
</tr>
<tr>
<td>path</td>
<td>string</td>
<td>组件第三方系统路径</td>
</tr>
<tr>
<td>type</td>
<td>int</td>
<td>1 query, 2 operate</td>
</tr>
<tr>
<td>label</td>
<td>string</td>
<td>组件标签</td>
</tr>
<tr>
<td>category</td>
<td>string</td>
<td>组件类型, component or buffet_component</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/esb/get_systems/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>获取 ESB 中的组件系统列表</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h3 id="_6">请求参数示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;
}</code></pre>


<h3 id="_7">返回结果示例</h3>
<pre class="codehilite"><code class="language-python">{
    &quot;result&quot;: true
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;OK&quot;,
    &quot;data&quot;: [
        {
            &quot;id&quot;: 1,
            &quot;name&quot;: &quot;BK_LOGIN&quot;,
            &quot;label&quot;: &quot;蓝鲸统一登录&quot;,
            &quot;remark&quot;: &quot;蓝鲸统一登录，管理用户登录验证，及用户信息&quot;
        },
        {
            &quot;id&quot;: 2,
            &quot;name&quot;: &quot;BK_PAAS&quot;,
            &quot;label&quot;: &quot;蓝鲸开发者中心&quot;,
            &quot;remark&quot;: &quot;蓝鲸开发者中心&quot;
        }
    ]
}</code></pre>


<h3 id="_8">返回结果参数说明</h3>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>int</td>
<td>系统 id</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>系统名称</td>
</tr>
<tr>
<td>label</td>
<td>string</td>
<td>系统标签</td>
</tr>
<tr>
<td>remark</td>
<td>string</td>
<td>备注</td>
</tr>
</tbody>
</table><h2 id="api">流程服务 API 文档简介</h2>
<table>
<thead>
<tr>
<th>资源名称</th>
<th>资源描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="./callback_failed_ticket.md">callback_failed_ticket</a></td>
<td>回调失败的单号</td>
</tr>
<tr>
<td><a href="./create_ticket.md">create_ticket</a></td>
<td>创建单据</td>
</tr>
<tr>
<td><a href="./get_service_catalogs.md">get_service_catalogs</a></td>
<td>服务目录查询</td>
</tr>
<tr>
<td><a href="./get_service_detail.md">get_service_detail</a></td>
<td>服务详情查询</td>
</tr>
<tr>
<td><a href="./get_service_roles.md">get_service_roles</a></td>
<td>获取服务角色</td>
</tr>
<tr>
<td><a href="./get_services.md">get_services</a></td>
<td>服务列表查询</td>
</tr>
<tr>
<td><a href="./get_ticket_info.md">get_ticket_info</a></td>
<td>单据详情查询</td>
</tr>
<tr>
<td><a href="./get_ticket_logs.md">get_ticket_logs</a></td>
<td>单据日志查询</td>
</tr>
<tr>
<td><a href="./get_ticket_status.md">get_ticket_status</a></td>
<td>单据状态查询</td>
</tr>
<tr>
<td><a href="./get_tickets.md">get_tickets</a></td>
<td>获取单据列表</td>
</tr>
<tr>
<td><a href="./operate_node.md">operate_node</a></td>
<td>处理单据节点</td>
</tr>
<tr>
<td><a href="./operate_ticket.md">operate_ticket</a></td>
<td>处理单据</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/itsm/callback_failed_ticket/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>回调失败的单号</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-json">{  
    &quot;bk_app_secret&quot;: &quot;xxxx&quot;, 
    &quot;bk_app_code&quot;: &quot;xxxx&quot;, 
    &quot;bk_token&quot;: &quot;xxxx&quot;
}  </code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;message&quot;: &quot;success&quot;,
    &quot;code&quot;: 0,
    &quot;data&quot;: [&quot;NO2019090519542603&quot;],
    &quot;result&quot;: true
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>返回结果，true 为成功，false 为失败</td>
</tr>
<tr>
<td>code</td>
<td>int</td>
<td>返回码，0 表示成功，其他值表示失败</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>错误信息</td>
</tr>
<tr>
<td>data</td>
<td>list</td>
<td>单号列表</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/itsm/create_ticket/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>创建单据接口</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>service_id</td>
<td>int</td>
<td>否</td>
<td>服务 id</td>
</tr>
<tr>
<td>creator</td>
<td>string</td>
<td>是</td>
<td>单据创建者</td>
</tr>
<tr>
<td>fields</td>
<td>array</td>
<td>是</td>
<td>提单字段</td>
</tr>
<tr>
<td>fast_approval</td>
<td>boolean</td>
<td>否</td>
<td>是否为单点快速审批单</td>
</tr>
<tr>
<td>meta</td>
<td>dict</td>
<td>否</td>
<td>扩展信息</td>
</tr>
</tbody>
</table>
<h3 id="meta">meta</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>callback_url</td>
<td>string</td>
<td>否</td>
<td>回调 url，若有则会触发回调</td>
</tr>
<tr>
<td>state_processors</td>
<td>object</td>
<td>否</td>
<td>节点处理人，若有则走单时会按此处理人设置</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;bk_app_secret&quot;: &quot;xxxx&quot;,
    &quot;bk_app_code&quot;: &quot;xxxx&quot;,
    &quot;bk_token&quot;: &quot;xxxx&quot;,
    &quot;service_id&quot;: 17,
    &quot;creator&quot;: &quot;xxx&quot;,
    &quot;fields&quot;: [{
        &quot;key&quot;: &quot;title&quot;,
        &quot;value&quot;: &quot;测试内置审批&quot;
    }, {
        &quot;key&quot;: &quot;APPROVER&quot;,
        &quot;value&quot;: &quot;xx,xxx,xxxx&quot;
    }, {
        &quot;key&quot;: &quot;APPROVAL_CONTENT&quot;,
        &quot;value&quot;: &quot;这是一个审批单&quot;
    }],
    &quot;fast_approval&quot;: false,
    &quot;meta&quot;: {
        &quot;callback_url&quot;: &quot;http://***&quot;,
        &quot;state_processors&quot;: {
            &quot;407&quot;: &quot;xxx,xxxx&quot;
        }
    }
}  </code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;message&quot;: &quot;success&quot;,
    &quot;code&quot;: 0,
    &quot;data&quot;: {
        &quot;sn&quot;: &quot;NO2019090519542603&quot;
    },
    &quot;result&quot;: true
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>返回结果，true 为成功，false 为失败</td>
</tr>
<tr>
<td>code</td>
<td>int</td>
<td>返回码，0 表示成功，其他值表示失败</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>错误信息</td>
</tr>
<tr>
<td>data</td>
<td>object</td>
<td>返回数据</td>
</tr>
</tbody>
</table>
<h3 id="data">data</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>sn</td>
<td>string</td>
<td>单号</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/itsm/get_service_catalogs/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>服务目录查询</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>has_service</td>
<td>string</td>
<td>否</td>
<td>默认返回全部服务目录，has_service="true"时只返回绑定了服务项的目录</td>
</tr>
<tr>
<td>service_key</td>
<td>string</td>
<td>否</td>
<td>服务项 key 值，支持通过服务项 key 值过滤绑定了服务的服务目录</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;bk_app_secret&quot;: &quot;xxxx&quot;,
    &quot;bk_app_code&quot;: &quot;xxxx&quot;,
    &quot;bk_token&quot;: &quot;xxxx&quot;,
    &quot;has_service&quot;: &quot;true&quot;,
    &quot;service_key&quot;: &quot;change&quot;
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;message&quot;: &quot;success&quot;,
    &quot;code&quot;: 0,
    &quot;data&quot;: [
        {
            &quot;name&quot;: &quot;根目录&quot;,
            &quot;level&quot;: 0,
            &quot;id&quot;: 1,
            &quot;key&quot;: &quot;root&quot;,
            &quot;desc&quot;: &quot;&quot;,
            &quot;children&quot;: [
                {
                    &quot;name&quot;: &quot;基础配置&quot;,
                    &quot;level&quot;: 1,
                    &quot;id&quot;: 10,
                    &quot;key&quot;: &quot;JICHUPEIZHI&quot;,
                    &quot;children&quot;: [
                        {
                            &quot;name&quot;: &quot;业务管理&quot;,
                            &quot;level&quot;: 2,
                            &quot;id&quot;: 12,
                            &quot;key&quot;: &quot;YEWUGUANLI&quot;,
                            &quot;children&quot;: [],
                            &quot;desc&quot;: &quot;&quot;
                        }
                    ],
                    &quot;desc&quot;: &quot;&quot;
                }
            ]
        }
    ],
    &quot;result&quot;: true
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>返回结果，true 为成功，false 为失败</td>
</tr>
<tr>
<td>code</td>
<td>int</td>
<td>返回码，0 表示成功，其他值表示失败</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>错误信息</td>
</tr>
<tr>
<td>data</td>
<td>array</td>
<td>返回数据</td>
</tr>
</tbody>
</table>
<h3 id="data">data</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>int</td>
<td>服务目录 id</td>
</tr>
<tr>
<td>key</td>
<td>string</td>
<td>服务目录唯一标识</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>服务目录名称</td>
</tr>
<tr>
<td>level</td>
<td>int</td>
<td>服务目录等级</td>
</tr>
<tr>
<td>desc</td>
<td>string</td>
<td>服务目录描述</td>
</tr>
<tr>
<td>children</td>
<td>array</td>
<td>服务目录子目录</td>
</tr>
</tbody>
</table>
<h3 id="children">children</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>int</td>
<td>服务目录 id</td>
</tr>
<tr>
<td>key</td>
<td>string</td>
<td>服务目录唯一标识</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>服务目录名称</td>
</tr>
<tr>
<td>level</td>
<td>int</td>
<td>服务目录等级</td>
</tr>
<tr>
<td>desc</td>
<td>string</td>
<td>服务目录描述</td>
</tr>
<tr>
<td>children</td>
<td>array</td>
<td>服务目录子目录</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/itsm/get_service_detail/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>服务详情查询，支持根据指定的服务 ID 查询服务详情</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>service_id</td>
<td>int</td>
<td>是</td>
<td>服务 id</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-json">{  
    &quot;bk_app_secret&quot;: &quot;xxxx&quot;, 
    &quot;bk_app_code&quot;: &quot;xxxx&quot;, 
    &quot;bk_token&quot;: &quot;xxxx&quot;, 
    &quot;service_id&quot;: 1
}  </code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;message&quot;: &quot;success&quot;,
    &quot;code&quot;: 0,
    &quot;data&quot;: {
        &quot;service_id&quot;: 5,
        &quot;workflow_id&quot;: 15,
        &quot;name&quot;: &quot;test3&quot;,
        &quot;service_type&quot;: &quot;event&quot;,
        &quot;desc&quot;: &quot;&quot;,
        &quot;fields&quot;: [
            {
                &quot;id&quot;: 1,
                &quot;key&quot;: &quot;title&quot;,
                &quot;type&quot;: &quot;STRING&quot;,
                &quot;name&quot;: &quot;标题&quot;,
                &quot;desc&quot;: &quot;请输入标题&quot;,
                &quot;choice&quot;: [],
                &quot;validate_type&quot;: &quot;REQUIRE&quot;,
                &quot;regex&quot;: &quot;&quot;,
                &quot;meta&quot;: {}
            },
            {
                &quot;id&quot;: 96,
                &quot;key&quot;: &quot;CESHILEIXING&quot;,
                &quot;type&quot;: &quot;SELECT&quot;,
                &quot;name&quot;: &quot;测试类型&quot;,
                &quot;desc&quot;: &quot;&quot;,
                &quot;choice&quot;: [
                    {
                        &quot;name&quot;: &quot;变更&quot;,
                        &quot;key&quot;: &quot;BIANGENG&quot;
                    },
                    {
                        &quot;name&quot;: &quot;请求&quot;,
                        &quot;key&quot;: &quot;QINGQIU&quot;
                    }
                ],
                &quot;validate_type&quot;: &quot;REQUIRE&quot;,
                &quot;regex&quot;: &quot;EMPTY&quot;,
                &quot;meta&quot;: {}
            },
            {
                &quot;id&quot;: 97,
                &quot;key&quot;: &quot;ZIDINGYIBIAOGE&quot;,
                &quot;type&quot;: &quot;CUSTOMTABLE&quot;,
                &quot;name&quot;: &quot;自定义表格&quot;,
                &quot;desc&quot;: &quot;&quot;,
                &quot;choice&quot;: [],
                &quot;validate_type&quot;: &quot;REQUIRE&quot;,
                &quot;regex&quot;: &quot;EMPTY&quot;,
                &quot;meta&quot;: {
                    &quot;columns&quot;: [
                        {
                            &quot;choice&quot;: [],
                            &quot;display&quot;: &quot;input&quot;,
                            &quot;key&quot;: &quot;TEST&quot;,
                            &quot;name&quot;: &quot;test&quot;
                        },
                        {
                            &quot;choice&quot;: [
                                {
                                    &quot;name&quot;: &quot;a&quot;,
                                    &quot;key&quot;: &quot;A&quot;
                                },
                                {
                                    &quot;name&quot;: &quot;b&quot;,
                                    &quot;key&quot;: &quot;B&quot;
                                }
                            ],
                            &quot;display&quot;: &quot;select&quot;,
                            &quot;key&quot;: &quot;TEST2&quot;,
                            &quot;name&quot;: &quot;test2&quot;
                        }
                    ]
                }
            }
        ]
    },
    &quot;result&quot;: true
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>返回结果，true 为成功，false 为失败</td>
</tr>
<tr>
<td>code</td>
<td>int</td>
<td>返回码，0 表示成功，其他值表示失败</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>错误信息</td>
</tr>
<tr>
<td>data</td>
<td>object</td>
<td>返回数据</td>
</tr>
</tbody>
</table>
<h3 id="data">data</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>service_id</td>
<td>int</td>
<td>服务 id</td>
</tr>
<tr>
<td>workflow_id</td>
<td>int</td>
<td>服务流程 id</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>服务名称</td>
</tr>
<tr>
<td>service_type</td>
<td>string</td>
<td>服务类型</td>
</tr>
<tr>
<td>desc</td>
<td>string</td>
<td>服务描述</td>
</tr>
<tr>
<td>fields</td>
<td>array</td>
<td>提单字段</td>
</tr>
</tbody>
</table>
<h3 id="fields">fields</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>int</td>
<td>字段 id</td>
</tr>
<tr>
<td>key</td>
<td>string</td>
<td>字段唯一标识</td>
</tr>
<tr>
<td>type</td>
<td>string</td>
<td>字段类型</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>字段名称</td>
</tr>
<tr>
<td>desc</td>
<td>string</td>
<td>字段描述</td>
</tr>
<tr>
<td>choice</td>
<td>array</td>
<td>选项</td>
</tr>
<tr>
<td>validate_type</td>
<td>string</td>
<td>校验规则</td>
</tr>
<tr>
<td>regex</td>
<td>string</td>
<td>正则校验规则</td>
</tr>
<tr>
<td>meta</td>
<td>object</td>
<td>自定义表格格式</td>
</tr>
</tbody>
</table>
<h3 id="type">type（字段类型）</h3>
<table>
<thead>
<tr>
<th>类型 Key</th>
<th>类型</th>
</tr>
</thead>
<tbody>
<tr>
<td>STRING</td>
<td>单行文本</td>
</tr>
<tr>
<td>STRING</td>
<td>单行文本</td>
</tr>
<tr>
<td>TEXT</td>
<td>多行文本</td>
</tr>
<tr>
<td>INT</td>
<td>数字</td>
</tr>
<tr>
<td>DATE</td>
<td>日期</td>
</tr>
<tr>
<td>DATETIME</td>
<td>时间</td>
</tr>
<tr>
<td>DATETIMERANGE</td>
<td>时间间隔</td>
</tr>
<tr>
<td>TABLE</td>
<td>表格</td>
</tr>
<tr>
<td>SELECT</td>
<td>单选下拉框</td>
</tr>
<tr>
<td>MULTISELECT</td>
<td>多选下拉框</td>
</tr>
<tr>
<td>CHECKBOX</td>
<td>复选框</td>
</tr>
<tr>
<td>RADIO</td>
<td>单选框</td>
</tr>
<tr>
<td>MEMBERS</td>
<td>多选人员选择</td>
</tr>
<tr>
<td>RICHTEXT</td>
<td>富文本</td>
</tr>
<tr>
<td>FILE</td>
<td>附件上传</td>
</tr>
<tr>
<td>CUSTOMTABLE</td>
<td>自定义表格</td>
</tr>
<tr>
<td>TREESELECT</td>
<td>树形选择</td>
</tr>
<tr>
<td>CASCADE</td>
<td>级联</td>
</tr>
</tbody>
</table>
<h3 id="meta">meta</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>columns</td>
<td>array</td>
<td>列</td>
</tr>
</tbody>
</table>
<h3 id="columns">columns</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>choice</td>
<td>array</td>
<td>选项</td>
</tr>
<tr>
<td>display</td>
<td>string</td>
<td>展现形式</td>
</tr>
<tr>
<td>key</td>
<td>string</td>
<td>唯一标识</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>名字</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/itsm/get_service_roles/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>获取服务角色</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>service_id</td>
<td>string</td>
<td>是</td>
<td>服务 id</td>
</tr>
<tr>
<td>ticket_creator</td>
<td>string</td>
<td>否</td>
<td>提单人，实例化 leader 和提单人本身时使用</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-json">{  
    &quot;bk_app_secret&quot;: &quot;xxxx&quot;, 
    &quot;bk_app_code&quot;: &quot;xxxx&quot;, 
    &quot;bk_token&quot;: &quot;xxxx&quot;,
    &quot;service_id&quot;: 1,
    &quot;ticket_creator&quot;: &quot;xx&quot;
}  </code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;message&quot;: &quot;success&quot;,
    &quot;code&quot;: 0,
    &quot;data&quot;: [{
            &quot;id&quot;: 92580,
            &quot;name&quot;: &quot;节点1&quot;,
            &quot;processors_type&quot;: &quot;GENERAL&quot;,
            &quot;processors&quot;: &quot;xxxx&quot;,
            &quot;sign_type&quot;: &quot;or&quot;
        },
        {
            &quot;id&quot;: 92581,
            &quot;name&quot;: &quot;节点2&quot;,
            &quot;processors_type&quot;: &quot;IAM&quot;,
            &quot;processors&quot;: &quot;分级管理员&quot;,
            &quot;sign_type&quot;: &quot;or&quot;
        },
        {
            &quot;id&quot;: 92582,
            &quot;name&quot;: &quot;节点3&quot;,
            &quot;processors_type&quot;: &quot;PERSON&quot;,
            &quot;processors&quot;: &quot;xxxx&quot;,
            &quot;sign_type&quot;: &quot;and&quot;
        }
    ],
    &quot;result&quot;: true
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>返回结果，true 为成功，false 为失败</td>
</tr>
<tr>
<td>code</td>
<td>int</td>
<td>返回码，0 表示成功，其他值表示失败</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>错误信息</td>
</tr>
<tr>
<td>data</td>
<td>list</td>
<td>返回数据</td>
</tr>
</tbody>
</table>
<h3 id="data">data</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>int</td>
<td>节点 id</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>节点 id</td>
</tr>
<tr>
<td>processors_type</td>
<td>string</td>
<td>处理人类型</td>
</tr>
<tr>
<td>processors</td>
<td>string</td>
<td>处理人，多个用","分割</td>
</tr>
<tr>
<td>sign_type</td>
<td>string</td>
<td>会签类型，“or”为或签，任意一人通过即为通过，“and”为多签，全部审批人通过才算通过</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/itsm/get_services/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>服务列表查询，支持根据指定的目录查询服务列表</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>catalog_id</td>
<td>int</td>
<td>否</td>
<td>服务目录 id</td>
</tr>
<tr>
<td>service_type</td>
<td>string</td>
<td>否</td>
<td>服务类型</td>
</tr>
<tr>
<td>display_type</td>
<td>string</td>
<td>否</td>
<td>可见范围</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;bk_app_secret&quot;: &quot;xxxx&quot;,
    &quot;bk_app_code&quot;: &quot;xxxx&quot;,
    &quot;bk_token&quot;: &quot;xxxx&quot;,
    &quot;catalog_id&quot;: 12,
    &quot;service_type&quot;: &quot;request&quot;,
    &quot;display_type&quot;: &quot;IAM&quot;
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;message&quot;: &quot;success&quot;,
    &quot;code&quot;: 0,
    &quot;data&quot;: [
        {
            &quot;id&quot;: 3,
            &quot;name&quot;: &quot;test1&quot;,
            &quot;desc&quot;: &quot;1&quot;,
            &quot;service_type&quot;: &quot;request&quot;
        },
        {
            &quot;id&quot;: 4,
            &quot;name&quot;: &quot;test2&quot;,
            &quot;desc&quot;: &quot;2&quot;,
            &quot;service_type&quot;: &quot;request&quot;
        }
    ],
    &quot;result&quot;: true
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>返回结果，true 为成功，false 为失败</td>
</tr>
<tr>
<td>code</td>
<td>int</td>
<td>返回码，0 表示成功，其他值表示失败</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>错误信息</td>
</tr>
<tr>
<td>data</td>
<td>array</td>
<td>返回数据</td>
</tr>
</tbody>
</table>
<h3 id="data">data</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>int</td>
<td>服务 id</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>服务名称</td>
</tr>
<tr>
<td>desc</td>
<td>string</td>
<td>服务描述</td>
</tr>
<tr>
<td>service_type</td>
<td>string</td>
<td>服务类型</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/itsm/get_ticket_info/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>单据详情查询，支持根据单号查询单据的详情（携带基本信息和提单信息）</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>sn</td>
<td>string</td>
<td>是</td>
<td>单号</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-json">{  
    &quot;bk_app_secret&quot;: &quot;xxxx&quot;, 
    &quot;bk_app_code&quot;: &quot;xxxx&quot;, 
    &quot;bk_token&quot;: &quot;xxxx&quot;, 
    &quot;sn&quot;: &quot;NO2019090XXXXXXXX&quot;
}  </code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;message&quot;: &quot;success&quot;,
    &quot;code&quot;: 0,
    &quot;data&quot;: {
        &quot;id&quot;: 176,
        &quot;catalog_id&quot;: 30,
        &quot;service_id&quot;: 18,
        &quot;flow_id&quot;: 61,
        &quot;sn&quot;: &quot;NO2019090414050083&quot;,
        &quot;title&quot;: &quot;xxxxx&quot;,
        &quot;service_type&quot;: &quot;change&quot;,
        &quot;create_at&quot;: &quot;2019-09-04 14:05:00&quot;,
        &quot;current_status&quot;: &quot;RUNNING&quot;,
        &quot;current_steps&quot;: [
                {
                    &quot;action_type&quot;: &quot;TRANSITION&quot;,
                    &quot;name&quot;: &quot;审核意见&quot;,
                    &quot;processors&quot;: &quot;admin&quot;,
                    &quot;processors_type&quot;: &quot;PERSON&quot;,
                    &quot;state_id&quot;: 8,
                    &quot;status&quot;: &quot;RUNNING&quot;
                }        
        ],
        &quot;comment_id&quot;: &quot;&quot;,
        &quot;is_commented&quot;: false,
        &quot;updated_by&quot;: &quot;xxxx&quot;,
        &quot;update_at&quot;: &quot;2019-09-04 14:05:01&quot;,
        &quot;end_at&quot;: null,
        &quot;creator&quot;: &quot;xxx(xxx)&quot;,
        &quot;is_biz_need&quot;: false,
        &quot;bk_biz_id&quot;: 2,
        &quot;fields&quot;: [{
                &quot;id&quot;: 1024,
                &quot;key&quot;: &quot;title&quot;,
                &quot;type&quot;: &quot;STRING&quot;,
                &quot;name&quot;: &quot;标题&quot;,
                &quot;value&quot;: &quot;xx&quot;,
                &quot;display_value&quot;: &quot;xx&quot;,
                &quot;desc&quot;: &quot;请输入标题&quot;,
            },{
                &quot;id&quot;: 1025,
                &quot;key&quot;: &quot;bk_biz_id&quot;,
                &quot;type&quot;: &quot;SELECT&quot;,
                &quot;name&quot;: &quot;标题&quot;,
                &quot;value&quot;: &quot;2&quot;,
                &quot;display_value&quot;: &quot;蓝鲸&quot;,
                &quot;desc&quot;: &quot;请输入标题&quot;,
            }
        ]
    },
    &quot;result&quot;: true
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>返回结果，true 为成功，false 为失败</td>
</tr>
<tr>
<td>code</td>
<td>int</td>
<td>返回码，0 表示成功，其他值表示失败</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>错误信息</td>
</tr>
<tr>
<td>data</td>
<td>object</td>
<td>返回数据</td>
</tr>
</tbody>
</table>
<h3 id="data">data</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>int</td>
<td>单据 id</td>
</tr>
<tr>
<td>catalog_id</td>
<td>int</td>
<td>服务目录 id</td>
</tr>
<tr>
<td>service_id</td>
<td>int</td>
<td>服务 id</td>
</tr>
<tr>
<td>flow_id</td>
<td>int</td>
<td>流程版本 id</td>
</tr>
<tr>
<td>sn</td>
<td>string</td>
<td>单号</td>
</tr>
<tr>
<td>title</td>
<td>string</td>
<td>单据标题</td>
</tr>
<tr>
<td>current_status</td>
<td>string</td>
<td>单据当前状态，RUNNING（处理中）/FINISHED（已结束）/TERMINATED（被终止）</td>
</tr>
<tr>
<td>current_steps</td>
<td>array</td>
<td>单据当前步骤</td>
</tr>
<tr>
<td>comment_id</td>
<td>string</td>
<td>单据评价 id</td>
</tr>
<tr>
<td>is_commented</td>
<td>bool</td>
<td>单据是否已评价</td>
</tr>
<tr>
<td>updated_by</td>
<td>string</td>
<td>最近更新者</td>
</tr>
<tr>
<td>update_at</td>
<td>string</td>
<td>最近更新时间</td>
</tr>
<tr>
<td>end_at</td>
<td>string</td>
<td>结束时间</td>
</tr>
<tr>
<td>creator</td>
<td>string</td>
<td>提单人</td>
</tr>
<tr>
<td>create_at</td>
<td>string</td>
<td>创建时间</td>
</tr>
<tr>
<td>is_biz_need</td>
<td>bool</td>
<td>是否与业务关联</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>业务 id</td>
</tr>
<tr>
<td>fields</td>
<td>array</td>
<td>提单节点字段</td>
</tr>
</tbody>
</table>
<h3 id="current_steps">current_steps（当前步骤）</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>string</td>
<td>步骤名称</td>
</tr>
<tr>
<td>action_type</td>
<td>string</td>
<td>操作类型：TRANSITION（审批）/DISTRIBUTE（分派）/CLAIM（认领）/AUTOMATIC（自动处理）</td>
</tr>
<tr>
<td>processors</td>
<td>string</td>
<td>处理人列表</td>
</tr>
<tr>
<td>processors_type</td>
<td>string</td>
<td>处理人类型：CMDB（cmdb 角色）/GENERAL（通用角色）/PERSON（个人）/STARTER（提单人）/OPEN（不限）</td>
</tr>
<tr>
<td>state_id</td>
<td>int</td>
<td>节点 ID</td>
</tr>
<tr>
<td>status</td>
<td>string</td>
<td>节点状态</td>
</tr>
</tbody>
</table>
<h3 id="status">status（节点状态）</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>WAIT</td>
<td>待处理</td>
<td></td>
</tr>
<tr>
<td>RUNNING</td>
<td>处理中</td>
<td></td>
</tr>
<tr>
<td>RECEIVING</td>
<td>待认领</td>
<td></td>
</tr>
<tr>
<td>DISTRIBUTING</td>
<td>待分派</td>
<td></td>
</tr>
<tr>
<td>TERMINATED</td>
<td>被终止</td>
<td></td>
</tr>
<tr>
<td>FINISHED</td>
<td>已结束</td>
<td></td>
</tr>
<tr>
<td>FAILED</td>
<td>执行失败</td>
<td></td>
</tr>
<tr>
<td>SUSPEND</td>
<td>被挂起</td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="fields">fields</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>int</td>
<td>字段 id</td>
</tr>
<tr>
<td>key</td>
<td>string</td>
<td>字段唯一标识</td>
</tr>
<tr>
<td>type</td>
<td>string</td>
<td>字段类型</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>字段名称</td>
</tr>
<tr>
<td>desc</td>
<td>string</td>
<td>字段描述</td>
</tr>
<tr>
<td>value</td>
<td>string</td>
<td>字段值</td>
</tr>
<tr>
<td>display_value</td>
<td>string</td>
<td>字段展示值</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/itsm/get_ticket_logs/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>单据日志查询，支持根据单号查询单据的处日志</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>sn</td>
<td>string</td>
<td>是</td>
<td>单号</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-json">{  
    &quot;bk_app_secret&quot;: &quot;xxxx&quot;, 
    &quot;bk_app_code&quot;: &quot;xxxx&quot;, 
    &quot;bk_token&quot;: &quot;xxxx&quot;, 
    &quot;sn&quot;: &quot;NO2019090XXXXXXXX&quot;
}  </code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;message&quot;: &quot;success&quot;,
    &quot;code&quot;: 0,
    &quot;data&quot;: {
        &quot;sn&quot;: &quot;NO2019090414050083&quot;,
        &quot;title&quot;: &quot;xxxxx&quot;,
        &quot;create_at&quot;: &quot;2019-09-04 14:05:00&quot;,
        &quot;creator&quot;: &quot;xxx(xxx)&quot;,
        &quot;logs&quot;: [{
                        &quot;operator&quot;: &quot;xxxx&quot;,
                        &quot;message&quot;: &quot;流程开始&quot;,
                        &quot;source&quot;: &quot;WEB&quot;,
                        &quot;operate_at&quot;: &quot;2019-08-09 00:41:02&quot;
                    }, {
                        &quot;operator&quot;: &quot;xxxx&quot;,
                        &quot;message&quot;: &quot;xxxx(xxxx) 处理节点【提单】(提交)&quot;,
                        &quot;source&quot;: &quot;WEB&quot;,
                        &quot;operate_at&quot;: &quot;2019-08-09 00:43:43&quot;
                    }, {
                        &quot;operator&quot;: &quot;xxxx&quot;,
                        &quot;message&quot;: &quot;xxxx(xxxx) 处理节点【审批】(通过)&quot;,
                        &quot;source&quot;: &quot;WEB&quot;,
                        &quot;operate_at&quot;: &quot;2019-08-10 16:39:14&quot;
                    }, {
                        &quot;operator&quot;: &quot;xxxx&quot;,
                        &quot;message&quot;: &quot;xxxx(xxxx) 处理节点【总监审批】(通过)&quot;,
                        &quot;source&quot;: &quot;WEB&quot;,
                        &quot;operate_at&quot;: &quot;2019-08-10 20:35:45&quot;
                    }, {
                        &quot;operator&quot;: &quot;xxxx&quot;,
                        &quot;message&quot;: &quot;xxxx(xxxx) 处理节点【账号创建】(通过)&quot;,
                        &quot;source&quot;: &quot;API&quot;,
                        &quot;operate_at&quot;: &quot;2019-08-15 10:20:09&quot;
                    }, {
                        &quot;operator&quot;: &quot;xxxx&quot;,
                        &quot;message&quot;: &quot;单据流程结束&quot;,
                        &quot;source&quot;: &quot;SYS&quot;,
                        &quot;operate_at&quot;: &quot;2019-08-15 10:20:09&quot;
                    }
        ]
    },
    &quot;result&quot;: true
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>返回结果，true 为成功，false 为失败</td>
</tr>
<tr>
<td>code</td>
<td>int</td>
<td>返回码，0 表示成功，其他值表示失败</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>错误信息</td>
</tr>
<tr>
<td>data</td>
<td>object</td>
<td>返回数据</td>
</tr>
</tbody>
</table>
<h3 id="data">data</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>sn</td>
<td>string</td>
<td>单据 sn</td>
</tr>
<tr>
<td>title</td>
<td>string</td>
<td>单据标题</td>
</tr>
<tr>
<td>create_at</td>
<td>string</td>
<td>创建时间</td>
</tr>
<tr>
<td>creator</td>
<td>string</td>
<td>提单人</td>
</tr>
<tr>
<td>logs</td>
<td>array</td>
<td>日志信息列表</td>
</tr>
</tbody>
</table>
<h3 id="logs">logs</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>operator</td>
<td>string</td>
<td>处理人</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>处理信息</td>
</tr>
<tr>
<td>operate_at</td>
<td>string</td>
<td>处理时间</td>
</tr>
<tr>
<td>source</td>
<td>string</td>
<td>处理途径，包含：WEB（页面操作）/MOBILE（手机端操作）/API（接口操作）/SYS（系统操作）</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/itsm/get_ticket_status/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>单据状态查询，支持根据单号查询单据的状态（携带基本信息）</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>sn</td>
<td>string</td>
<td>是</td>
<td>单号</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-json">{  
    &quot;bk_app_secret&quot;: &quot;xxxx&quot;, 
    &quot;bk_app_code&quot;: &quot;xxxx&quot;, 
    &quot;bk_token&quot;: &quot;xxxx&quot;, 
    &quot;sn&quot;: &quot;NO2019090XXXXXXXX&quot;
}  </code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;message&quot;: &quot;success&quot;,
    &quot;code&quot;: 0,
    &quot;data&quot;: {
        &quot;ticket_url&quot;: &quot;https://blueking.com/#/commonInfo?id=6&amp;activeNname=all&amp;router=request&quot;,
        &quot;operations&quot;: [
            {
                &quot;can_operate&quot;: true,
                &quot;name&quot;: &quot;撤单&quot;,
                &quot;key&quot;: &quot;WITHDRAW&quot;
            },
            {
                &quot;can_operate&quot;: true,
                &quot;name&quot;: &quot;恢复&quot;,
                &quot;key&quot;: &quot;UNSUSPEND&quot;
            }
        ],
        &quot;current_status&quot;: &quot;SUSPENDED&quot;,
        &quot;current_steps&quot;: [
            {
                &quot;name&quot;: &quot;法务审批&quot;,
                &quot;state_id&quot;: 4,
                &quot;status&quot;: &quot;RUNNING&quot;,
                &quot;action_type&quot;: &quot;TRANSITION&quot;,
                &quot;processors_type&quot;: &quot;PERSON&quot;,
                &quot;processors&quot;: &quot;zhangsan&quot;,
                &quot;operations&quot;: [
                    {
                        &quot;can_operate&quot;: true,
                        &quot;name&quot;: &quot;提交&quot;,
                        &quot;key&quot;: &quot;TRANSITION&quot;
                    },
                    {
                        &quot;can_operate&quot;: true,
                        &quot;name&quot;: &quot;转单&quot;,
                        &quot;key&quot;: &quot;DELIVER&quot;
                    },
                    {
                        &quot;can_operate&quot;: true,
                        &quot;name&quot;: &quot;终止&quot;,
                        &quot;key&quot;: &quot;TERMINATE&quot;
                    }
                ],
                &quot;fields&quot;: [
                    {
                        &quot;workflow_id&quot;: 1,
                        &quot;meta&quot;: {},
                        &quot;id&quot;: 8,
                        &quot;regex&quot;: &quot;EMPTY&quot;,
                        &quot;api_instance_id&quot;: 0,
                        &quot;type&quot;: &quot;RADIO&quot;,
                        &quot;source_uri&quot;: &quot;&quot;,
                        &quot;validate_type&quot;: &quot;REQUIRE&quot;,
                        &quot;source_type&quot;: &quot;CUSTOM&quot;,
                        &quot;key&quot;: &quot;SHENPIJIEGUO&quot;,
                        &quot;choice&quot;: [
                            {
                                &quot;name&quot;: &quot;同意&quot;,
                                &quot;key&quot;: &quot;TONGYI&quot;
                            },
                            {
                                &quot;name&quot;: &quot;拒绝&quot;,
                                &quot;key&quot;: &quot;JUJUE&quot;
                            }
                        ],
                        &quot;desc&quot;: &quot;&quot;,
                        &quot;name&quot;: &quot;审批结果&quot;,
                        &quot;is_readonly&quot;: false,
                        &quot;custom_regex&quot;: &quot;&quot;,
                        &quot;state_id&quot;: 4
                    },
                    {
                        &quot;workflow_id&quot;: 1,
                        &quot;meta&quot;: {},
                        &quot;id&quot;: 9,
                        &quot;regex&quot;: &quot;EMPTY&quot;,
                        &quot;api_instance_id&quot;: 0,
                        &quot;type&quot;: &quot;TEXT&quot;,
                        &quot;source_uri&quot;: &quot;&quot;,
                        &quot;validate_type&quot;: &quot;REQUIRE&quot;,
                        &quot;source_type&quot;: &quot;CUSTOM&quot;,
                        &quot;key&quot;: &quot;SHENPIBEIZHU&quot;,
                        &quot;choice&quot;: [],
                        &quot;desc&quot;: &quot;&quot;,
                        &quot;name&quot;: &quot;审批备注&quot;,
                        &quot;is_readonly&quot;: false,
                        &quot;custom_regex&quot;: &quot;&quot;,
                        &quot;state_id&quot;: 4
                    }
                ]
            }
        ],
        &quot;is_commented&quot;: false
    },
    &quot;result&quot;: true
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>返回结果，true 为成功，false 为失败</td>
</tr>
<tr>
<td>code</td>
<td>int</td>
<td>返回码，0 表示成功，其他值表示失败</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>错误信息</td>
</tr>
<tr>
<td>data</td>
<td>object</td>
<td>返回数据</td>
</tr>
</tbody>
</table>
<h3 id="data">data</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>current_status</td>
<td>string</td>
<td>单据当前状态，RUNNING（处理中）/FINISHED（已结束）/TERMINATED（被终止）/ SUSPENDED（被挂起）</td>
</tr>
<tr>
<td>current_steps</td>
<td>array</td>
<td>单据当前步骤列表</td>
</tr>
<tr>
<td>operations</td>
<td>array</td>
<td>单据当前支持的操作列表</td>
</tr>
<tr>
<td>is_commented</td>
<td>bool</td>
<td>单据是否已评价</td>
</tr>
<tr>
<td>ticket_url</td>
<td>string</td>
<td>单据详情链接</td>
</tr>
</tbody>
</table>
<h3 id="operations">operations（单据支持的操作）</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>key</td>
<td>string</td>
<td>操作标识，包括：SUSPEND（挂起）/UNSUSPEND（恢复）/WITHDRAW（撤销）/TERMINATE（终止节点和单据）</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>操作名称</td>
</tr>
<tr>
<td>can_operate</td>
<td>string</td>
<td>可否操作（扩展字段，始终为 true）</td>
</tr>
</tbody>
</table>
<h3 id="current_steps">current_steps（当前步骤）</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>string</td>
<td>步骤名称</td>
</tr>
<tr>
<td>action_type</td>
<td>string</td>
<td>操作类型：TRANSITION（审批）/DISTRIBUTE（分派）/CLAIM（认领）/AUTOMATIC（自动处理）</td>
</tr>
<tr>
<td>processors</td>
<td>string</td>
<td>处理人列表</td>
</tr>
<tr>
<td>processors_type</td>
<td>string</td>
<td>处理人类型：CMDB（cmdb 角色）/GENERAL（通用角色）/PERSON（个人）/STARTER（提单人）/OPEN（不限）</td>
</tr>
<tr>
<td>state_id</td>
<td>int</td>
<td>节点 ID</td>
</tr>
<tr>
<td>status</td>
<td>string</td>
<td>节点状态</td>
</tr>
<tr>
<td>operations</td>
<td>array</td>
<td>单据当前步骤支持的操作列表</td>
</tr>
<tr>
<td>fields</td>
<td>array</td>
<td>单据当前步骤的表单字段列表</td>
</tr>
</tbody>
</table>
<h3 id="operations_1">operations（节点支持的操作）</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>key</td>
<td>string</td>
<td>操作标识，包括： TRANSITION（审批）/CLAIM（认领）/DISTRIBUTE（派单）/DELIVER（转单）/TERMINATE（终止节点和单据）</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>操作名称</td>
</tr>
<tr>
<td>can_operate</td>
<td>string</td>
<td>可否操作（扩展字段，始终为 true）</td>
</tr>
</tbody>
</table>
<h3 id="fields">fields（节点字段）</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>int</td>
<td>字段 id</td>
</tr>
<tr>
<td>key</td>
<td>string</td>
<td>字段唯一标识</td>
</tr>
<tr>
<td>type</td>
<td>string</td>
<td>字段类型</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>字段名称</td>
</tr>
<tr>
<td>desc</td>
<td>string</td>
<td>字段描述</td>
</tr>
<tr>
<td>choice</td>
<td>array</td>
<td>选项</td>
</tr>
<tr>
<td>validate_type</td>
<td>string</td>
<td>校验规则</td>
</tr>
<tr>
<td>regex</td>
<td>string</td>
<td>正则校验规则</td>
</tr>
<tr>
<td>meta</td>
<td>object</td>
<td>自定义表格格式</td>
</tr>
</tbody>
</table>
<h3 id="type">type（字段类型）</h3>
<table>
<thead>
<tr>
<th>类型 Key</th>
<th>类型</th>
</tr>
</thead>
<tbody>
<tr>
<td>STRING</td>
<td>单行文本</td>
</tr>
<tr>
<td>STRING</td>
<td>单行文本</td>
</tr>
<tr>
<td>TEXT</td>
<td>多行文本</td>
</tr>
<tr>
<td>INT</td>
<td>数字</td>
</tr>
<tr>
<td>DATE</td>
<td>日期</td>
</tr>
<tr>
<td>DATETIME</td>
<td>时间</td>
</tr>
<tr>
<td>DATETIMERANGE</td>
<td>时间间隔</td>
</tr>
<tr>
<td>TABLE</td>
<td>表格</td>
</tr>
<tr>
<td>SELECT</td>
<td>单选下拉框</td>
</tr>
<tr>
<td>MULTISELECT</td>
<td>多选下拉框</td>
</tr>
<tr>
<td>CHECKBOX</td>
<td>复选框</td>
</tr>
<tr>
<td>RADIO</td>
<td>单选框</td>
</tr>
<tr>
<td>MEMBERS</td>
<td>多选人员选择</td>
</tr>
<tr>
<td>RICHTEXT</td>
<td>富文本</td>
</tr>
<tr>
<td>FILE</td>
<td>附件上传</td>
</tr>
<tr>
<td>CUSTOMTABLE</td>
<td>自定义表格</td>
</tr>
<tr>
<td>TREESELECT</td>
<td>树形选择</td>
</tr>
<tr>
<td>CASCADE</td>
<td>级联</td>
</tr>
</tbody>
</table>
<h3 id="meta">meta</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>columns</td>
<td>array</td>
<td>列</td>
</tr>
</tbody>
</table>
<h3 id="columns">columns</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>choice</td>
<td>array</td>
<td>选项</td>
</tr>
<tr>
<td>display</td>
<td>string</td>
<td>展现形式</td>
</tr>
<tr>
<td>key</td>
<td>string</td>
<td>唯一标识</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>名字</td>
</tr>
</tbody>
</table>
<h3 id="status">status（节点状态）</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>WAIT</td>
<td>待处理</td>
<td></td>
</tr>
<tr>
<td>RUNNING</td>
<td>处理中</td>
<td></td>
</tr>
<tr>
<td>RECEIVING</td>
<td>待认领</td>
<td></td>
</tr>
<tr>
<td>DISTRIBUTING</td>
<td>待分派</td>
<td></td>
</tr>
<tr>
<td>TERMINATED</td>
<td>被终止</td>
<td></td>
</tr>
<tr>
<td>FINISHED</td>
<td>已结束</td>
<td></td>
</tr>
<tr>
<td>FAILED</td>
<td>执行失败</td>
<td></td>
</tr>
<tr>
<td>SUSPEND</td>
<td>被挂起</td>
<td></td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/itsm/get_tickets/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>获取单据</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>sns</td>
<td>array</td>
<td>否</td>
<td>根据单号列表过滤</td>
</tr>
<tr>
<td>creator</td>
<td>string</td>
<td>否</td>
<td>根据单据创建人过滤</td>
</tr>
<tr>
<td>create_at__lte</td>
<td>string</td>
<td>否</td>
<td>创建时间大于或等于，格式："YYYY-MM-DD hh:mm:ss"</td>
</tr>
<tr>
<td>create_at__gte</td>
<td>string</td>
<td>否</td>
<td>创建时间小于或等于，格式："YYYY-MM-DD hh:mm:ss"</td>
</tr>
<tr>
<td>page</td>
<td>int</td>
<td>否</td>
<td>请求页码，默认为 1</td>
</tr>
<tr>
<td>page_size</td>
<td>int</td>
<td>否</td>
<td>每页数据量，默认为 10，最大 10000</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;bk_app_secret&quot;: &quot;xxxx&quot;,
    &quot;bk_app_code&quot;: &quot;xxxx&quot;,
    &quot;bk_token&quot;: &quot;xxxx&quot;,
    &quot;sns&quot;: [&quot;NO2019091610001755&quot;],
    &quot;create_at__lte&quot;: &quot;2019-09-16 10:00:00&quot;
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;message&quot;: &quot;success&quot;,
    &quot;code&quot;: 0,
    &quot;data&quot;: {
        &quot;page&quot;: 1,
        &quot;total_page&quot;: 1,
        &quot;count&quot;: 1,
        &quot;next&quot;: null,
        &quot;previous&quot;: null,
        &quot;items&quot;: [
            {
                &quot;id&quot;: 1,
                &quot;sn&quot;: &quot;NO2019091610001755&quot;,
                &quot;title&quot;: &quot;a&quot;,
                &quot;catalog_id&quot;: 3,
                &quot;service_id&quot;: 1,
                &quot;service_type&quot;: &quot;request&quot;,
                &quot;flow_id&quot;: 1,
                &quot;current_status&quot;: &quot;RUNNING&quot;,
                &quot;comment_id&quot;: &quot;&quot;,
                &quot;is_commented&quot;: false,
                &quot;updated_by&quot;: &quot;admin&quot;,
                &quot;update_at&quot;: &quot;2019-09-16 10:01:07&quot;,
                &quot;end_at&quot;: null,
                &quot;creator&quot;: &quot;admin&quot;,
                &quot;create_at&quot;: &quot;2019-09-16 10:00:17&quot;,
                &quot;bk_biz_id&quot;: -1,
                &quot;ticket_url&quot;: &quot;xxxx&quot;
            }
        ]
    },
    &quot;result&quot;: true
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>返回结果，true 为成功，false 为失败</td>
</tr>
<tr>
<td>code</td>
<td>int</td>
<td>返回码，0 表示成功，其他值表示失败</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>错误信息</td>
</tr>
<tr>
<td>data</td>
<td>object</td>
<td>返回数据</td>
</tr>
</tbody>
</table>
<h3 id="data">data</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>count</td>
<td>int</td>
<td>返回数量</td>
</tr>
<tr>
<td>next</td>
<td>string</td>
<td>下一页链接</td>
</tr>
<tr>
<td>previous</td>
<td>string</td>
<td>前一页链接</td>
</tr>
<tr>
<td>items</td>
<td>array</td>
<td>单据数据列表</td>
</tr>
<tr>
<td>page</td>
<td>int</td>
<td>页码</td>
</tr>
<tr>
<td>total_page</td>
<td>int</td>
<td>总页数</td>
</tr>
</tbody>
</table>
<h3 id="items">items</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>int</td>
<td>单据 id</td>
</tr>
<tr>
<td>catalog_id</td>
<td>int</td>
<td>服务目录 id</td>
</tr>
<tr>
<td>service_id</td>
<td>int</td>
<td>服务 id</td>
</tr>
<tr>
<td>flow_id</td>
<td>int</td>
<td>流程版本 id</td>
</tr>
<tr>
<td>sn</td>
<td>string</td>
<td>单号</td>
</tr>
<tr>
<td>title</td>
<td>string</td>
<td>单据标题</td>
</tr>
<tr>
<td>current_status</td>
<td>string</td>
<td>单据当前状态</td>
</tr>
<tr>
<td>current_steps</td>
<td>array</td>
<td>单据当前步骤</td>
</tr>
<tr>
<td>comment_id</td>
<td>string</td>
<td>单据评价 id</td>
</tr>
<tr>
<td>is_commented</td>
<td>bool</td>
<td>单据是否已评价</td>
</tr>
<tr>
<td>updated_by</td>
<td>string</td>
<td>最近更新者</td>
</tr>
<tr>
<td>update_at</td>
<td>string</td>
<td>最近更新时间</td>
</tr>
<tr>
<td>end_at</td>
<td>string</td>
<td>结束时间</td>
</tr>
<tr>
<td>creator</td>
<td>string</td>
<td>提单人</td>
</tr>
<tr>
<td>create_at</td>
<td>string</td>
<td>创建时间</td>
</tr>
<tr>
<td>is_biz_need</td>
<td>bool</td>
<td>是否与业务关联</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>业务 id</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/itsm/operate_node/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>单据节点操作接口</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>sn</td>
<td>string</td>
<td>是</td>
<td>单号</td>
</tr>
<tr>
<td>operator</td>
<td>string</td>
<td>是</td>
<td>单据节点处理人、单据节点认领人，必须在处理人范围内</td>
</tr>
<tr>
<td>state_id</td>
<td>int</td>
<td>是</td>
<td>节点 ID，必须是当前可处理的节点</td>
</tr>
<tr>
<td>action_type</td>
<td>string</td>
<td>是</td>
<td>操作类型： TRANSITION（审批）/CLAIM（认领）/DISTRIBUTE（派单）/DELIVER（转单） ）/TERMINATE（终止节点和单据）</td>
</tr>
<tr>
<td>fields</td>
<td>array</td>
<td>否</td>
<td>审批表单字段列表（审批操作必填）</td>
</tr>
<tr>
<td>processors_type</td>
<td>string</td>
<td>否</td>
<td>被指定的处理人类型（分派和转单操作必填）： GENERAL（通用角色）/PERSON（个人）</td>
</tr>
<tr>
<td>processors</td>
<td>string</td>
<td>否</td>
<td>被指定的处理人（分派和转单操作必填）： processors_type 为 GENERAL 时，为角色 ID，否则为蓝鲸用户的 username</td>
</tr>
<tr>
<td>action_message</td>
<td>string</td>
<td>否</td>
<td>操作备注信息（转单和终止操作必填）</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例一：审批</h3>
<pre class="codehilite"><code class="language-json">{  
    &quot;bk_app_secret&quot;: &quot;xxxx&quot;, 
    &quot;bk_app_code&quot;: &quot;xxxx&quot;, 
    &quot;bk_token&quot;: &quot;xxxx&quot;,
    &quot;sn&quot;: &quot;NO2019110816441094&quot;,
    &quot;operator&quot;: &quot;zhangsan&quot;,
    &quot;action_type&quot;: &quot;TRANSITION&quot;,
    &quot;state_id&quot;: 4,
    &quot;fields&quot;: [{
        &quot;key&quot;: &quot;SHENPIJIEGUO&quot;,
        &quot;value&quot;: &quot;TONGYI&quot;
    },{
        &quot;key&quot;: &quot;SHENPIBEIZHU&quot;,
        &quot;value&quot;: &quot;hello&quot;
    }]  
}  </code></pre>


<h3 id="_8">请求参数示例二：转单</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;sn&quot;: &quot;NO2019110710341888&quot;,
    &quot;operator&quot;: &quot;zhangsan&quot;,
    &quot;action_type&quot;: &quot;DELIVER&quot;,
    &quot;action_message&quot;: &quot;test&quot;,
    &quot;processors&quot;: &quot;zhangsan&quot;,
    &quot;processors_type&quot;: &quot;PERSON&quot;,
    &quot;state_id&quot;: 4
} </code></pre>


<h3 id="_9">请求参数示例三：认领</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;sn&quot;: &quot;NO2019110816441094&quot;,
    &quot;operator&quot;: &quot;zhangsan&quot;,
    &quot;action_type&quot;: &quot;CLAIM&quot;,
    &quot;state_id&quot;: 4
}</code></pre>


<h3 id="_10">请求参数示例四：终止</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;sn&quot;: &quot;NO2019110816441094&quot;,
    &quot;operator&quot;: &quot;zhangsan&quot;,
    &quot;action_type&quot;: &quot;TERMINATE&quot;,
    &quot;action_message&quot;: &quot;test&quot;,
    &quot;state_id&quot;: 4
}</code></pre>


<h3 id="_11">返回结果示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;message&quot;: &quot;success&quot;,
    &quot;code&quot;: 0,
    &quot;data&quot;: [],
    &quot;result&quot;: true
}</code></pre>


<h3 id="_12">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>返回结果，true 为成功，false 为失败</td>
</tr>
<tr>
<td>code</td>
<td>int</td>
<td>返回码，0 表示成功，其他值表示失败</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>错误信息</td>
</tr>
<tr>
<td>data</td>
<td>object</td>
<td>返回数据</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/itsm/operate_ticket/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>单据操作接口</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>sn</td>
<td>string</td>
<td>是</td>
<td>单号</td>
</tr>
<tr>
<td>operator</td>
<td>string</td>
<td>是</td>
<td>单据处理人，必须在处理人范围内</td>
</tr>
<tr>
<td>action_type</td>
<td>string</td>
<td>是</td>
<td>操作类型：SUSPEND（挂起）/UNSUSPEND（恢复）/WITHDRAW（撤销）/TERMINATE（终止）</td>
</tr>
<tr>
<td>action_message</td>
<td>string</td>
<td>否</td>
<td>操作备注信息（挂起和终止操作必填）</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例一：挂起</h3>
<pre class="codehilite"><code class="language-json">{  
    &quot;bk_app_secret&quot;: &quot;xxxx&quot;, 
    &quot;bk_app_code&quot;: &quot;xxxx&quot;, 
    &quot;bk_token&quot;: &quot;xxxx&quot;, 
    &quot;sn&quot;: &quot;NO2019100818365320&quot;,
    &quot;operator&quot;: &quot;zhangsan&quot;,
    &quot;action_type&quot;: &quot;SUSPEND&quot;,
    &quot;action_message&quot;: &quot;test&quot;
}</code></pre>


<h3 id="_8">请求参数示例二：恢复</h3>
<pre class="codehilite"><code class="language-json">{  
    &quot;sn&quot;: &quot;NO2019100818365320&quot;,
    &quot;operator&quot;: &quot;zhangsan&quot;,
    &quot;action_type&quot;: &quot;UNSUSPEND&quot;,
    &quot;action_message&quot;: &quot;test&quot;
}</code></pre>


<h3 id="_9">请求参数示例三：撤单</h3>
<pre class="codehilite"><code class="language-json">{  
    &quot;sn&quot;: &quot;NO2019100818365320&quot;,
    &quot;operator&quot;: &quot;zhangsan&quot;,
   &quot;action_type&quot;: &quot;WITHDRAW&quot;,
   &quot;action_message&quot;: &quot;test&quot;
}</code></pre>


<h3 id="_10">请求参数示例四：终止</h3>
<pre class="codehilite"><code class="language-json">{  
    &quot;sn&quot;: &quot;NO2019100818365320&quot;,
    &quot;operator&quot;: &quot;zhangsan&quot;,
   &quot;action_type&quot;: &quot;TERMINATE&quot;,
   &quot;action_message&quot;: &quot;test&quot;
}</code></pre>


<h3 id="_11">返回结果示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;message&quot;: &quot;success&quot;,
    &quot;code&quot;: 0,
    &quot;data&quot;: [],
    &quot;result&quot;: true
}</code></pre>


<h3 id="_12">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>返回结果，true 为成功，false 为失败</td>
</tr>
<tr>
<td>code</td>
<td>int</td>
<td>返回码，0 表示成功，其他值表示失败</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>错误信息</td>
</tr>
<tr>
<td>data</td>
<td>object</td>
<td>返回数据</td>
</tr>
</tbody>
</table><h2 id="api">蓝鲸日志平台 API 简介</h2>
<table>
<thead>
<tr>
<th>资源名称</th>
<th>资源描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="./esquery_search.md">esquery_search</a></td>
<td>日志查询接口</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/log_search/esquery_search/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>日志查询接口</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>indices</td>
<td>string</td>
<td>是</td>
<td>索引列表</td>
</tr>
<tr>
<td>scenario_id</td>
<td>string</td>
<td>否</td>
<td>ES 接入场景(非必填） 默认为 log，蓝鲸计算平台：bkdata 原生 ES：es 日志采集：log</td>
</tr>
<tr>
<td>storage_cluster_id</td>
<td>int</td>
<td>否</td>
<td>当 scenario_id 为 es 或 log 时候需要传入</td>
</tr>
<tr>
<td>time_field</td>
<td>string</td>
<td>否</td>
<td>时间字段（非必填，bkdata 内部为 dtEventTimeStamp，外部如果传入时间范围需要指定时间字段）</td>
</tr>
<tr>
<td>start_time</td>
<td>string</td>
<td>否</td>
<td>开始时间</td>
</tr>
<tr>
<td>end_time</td>
<td>string</td>
<td>否</td>
<td>结束时间</td>
</tr>
<tr>
<td>time_range</td>
<td>string</td>
<td>否</td>
<td>时间标识符符["15m", "30m", "1h", "4h", "12h", "1d", "customized"]（非必填，默认 15m）</td>
</tr>
<tr>
<td>query_string</td>
<td>string</td>
<td>否</td>
<td>搜索语句 query_string(非必填，默认为*)</td>
</tr>
<tr>
<td>filter</td>
<td>list</td>
<td>否</td>
<td>搜索过滤条件（非必填，默认为没有过滤，默认的操作符是 is） 操作符支持 is、is one of、is not、is not one of</td>
</tr>
<tr>
<td>start</td>
<td>int</td>
<td>否</td>
<td>起始位置（非必填，类似数组切片，默认为 0）</td>
</tr>
<tr>
<td>size</td>
<td>int</td>
<td>否</td>
<td>条数（非必填，控制返回条目，默认为 500）</td>
</tr>
<tr>
<td>aggs</td>
<td>dict</td>
<td>否</td>
<td>ES 的聚合参数</td>
</tr>
<tr>
<td>highlight</td>
<td>dict</td>
<td>否</td>
<td>高亮参数</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;indices&quot;: &quot;index_a,index_b,&quot;,
    &quot;scenario_id&quot;: &quot;bkdata&quot;,
    &quot;start_time&quot;: &quot;2019-06-11 00:00:00&quot;,
    &quot;end_time&quot;: &quot;2019-06-12 11:11:11&quot;,
    &quot;time_range&quot;: &quot;customized&quot;,
    &quot;keyword&quot;: &quot;error&quot;,
    &quot;filter&quot;: [
        {
            &quot;field&quot;: &quot;ip&quot;,
            &quot;operator&quot;: &quot;is&quot;,
            &quot;value&quot;: &quot;127.0.0.1&quot;
        }
    ],
    &quot;sort_list&quot;: [
        [&quot;field_a&quot;, &quot;desc&quot;],
        [&quot;field_b&quot;, &quot;asc&quot;]
    ],
    &quot;start&quot;: 0,
    &quot;size&quot;: 15,
    &quot;aggs&quot;: {
        &quot;docs_per_minute&quot;: {
            &quot;date_histogram&quot;: {
                &quot;field&quot;: &quot;dtEventTimeStamp&quot;,
                &quot;interval&quot;: &quot;1m&quot;,
                &quot;time_zone&quot;: &quot;+08: 00&quot;
            }
        },
        &quot;top_ip&quot;: {
            &quot;terms&quot;: {
                &quot;field&quot;: &quot;ip&quot;,
                &quot;size&quot;: 5
            }
        }
    },
    &quot;highlight&quot;: {
        &quot;pre_tags&quot;: [
            &quot;&lt;mark&gt;&quot;
        ],
        &quot;post_tags&quot;: [
            &quot;&lt;/mark&gt;&quot;
        ],
        &quot;fields&quot;: {
            &quot;*&quot;: {
            }
        },
        &quot;require_field_match&quot;: false
    }
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;result&quot;: true,
    &quot;message&quot;: &quot;查询成功&quot;,
    &quot;data&quot;: {
        &quot;hits&quot;: {
            &quot;hits&quot;: [
                {
                    &quot;_score&quot;: 2,
                    &quot;_type&quot;: &quot;xx&quot;,
                    &quot;_id&quot;: &quot;xxx&quot;,
                    &quot;_source&quot;: {
                        &quot;dtEventTimeStamp&quot;: 1565453112000,
                        &quot;report_time&quot;: &quot;2019-08-11 00:05:12&quot;,
                        &quot;log&quot;: &quot;xxxxxx&quot;,
                        &quot;ip&quot;: &quot;127.0.0.1&quot;,
                        &quot;gseindex&quot;: 5857918,
                        &quot;_iteration_idx&quot;: 3,
                        &quot;path&quot;: &quot;xxxxx&quot;
                    },
                    &quot;_index&quot;: &quot;xxxxxxxx&quot;
                },
                {
                    &quot;_score&quot;: 2,
                    &quot;_type&quot;: &quot;xxxx&quot;,
                    &quot;_id&quot;: &quot;xxxxx&quot;,
                    &quot;_source&quot;: {
                        &quot;dtEventTimeStamp&quot;: 1565453113000,
                        &quot;report_time&quot;: &quot;2019-08-11 00:05:13&quot;,
                        &quot;log&quot;: &quot;xxxxxxx&quot;,
                        &quot;ip&quot;: &quot;127.0.0.1&quot;,
                        &quot;gseindex&quot;: 5857921,
                        &quot;_iteration_idx&quot;: 2,
                        &quot;path&quot;: &quot;xxxxxxxxx&quot;
                    },
                    &quot;_index&quot;: &quot;xxxxxxx&quot;
                }
            ],
            &quot;total&quot;: 8429903,
            &quot;max_score&quot;: 2
        },
        &quot;_shards&quot;: {
            &quot;successful&quot;: 9,
            &quot;failed&quot;: 0,
            &quot;total&quot;: 9
        },
        &quot;took&quot;: 136,
        &quot;timed_out&quot;: false
    },
    &quot;code&quot;: 0
}</code></pre><h2 id="api">蓝鲸监控 API 简介</h2>
<table>
<thead>
<tr>
<th>资源名称</th>
<th>资源描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="./add_shield.md">add_shield</a></td>
<td>新增告警屏蔽</td>
</tr>
<tr>
<td><a href="./delete_alarm_strategy.md">delete_alarm_strategy</a></td>
<td>删除告警策略</td>
</tr>
<tr>
<td><a href="./delete_notice_group.md">delete_notice_group</a></td>
<td>删除通知组</td>
</tr>
<tr>
<td><a href="./disable_shield.md">disable_shield</a></td>
<td>解除告警屏蔽</td>
</tr>
<tr>
<td><a href="./edit_shield.md">edit_shield</a></td>
<td>编辑告警屏蔽</td>
</tr>
<tr>
<td><a href="./export_uptime_check_task.md">export_uptime_check_task</a></td>
<td>导出拨测任务配置</td>
</tr>
<tr>
<td><a href="./get_collect_config_list.md">get_collect_config_list</a></td>
<td>采集配置列表</td>
</tr>
<tr>
<td><a href="./get_collect_status.md">get_collect_status</a></td>
<td>查询采集配置节点状态</td>
</tr>
<tr>
<td><a href="./get_es_data.md">get_es_data</a></td>
<td>获取监控链路时序数据</td>
</tr>
<tr>
<td><a href="./get_event_log.md">get_event_log</a></td>
<td>查询事件流转记录</td>
</tr>
<tr>
<td><a href="./get_shield.md">get_shield</a></td>
<td>获取告警屏蔽</td>
</tr>
<tr>
<td><a href="./get_ts_data.md">get_ts_data</a></td>
<td>获取 ES 数据</td>
</tr>
<tr>
<td><a href="./get_uptime_check_node_list.md">get_uptime_check_node_list</a></td>
<td>拨测节点列表</td>
</tr>
<tr>
<td><a href="./get_uptime_check_task_list.md">get_uptime_check_task_list</a></td>
<td>拨测任务列表</td>
</tr>
<tr>
<td><a href="./import_uptime_check_node.md">import_uptime_check_node</a></td>
<td>导入拨测节点配置</td>
</tr>
<tr>
<td><a href="./import_uptime_check_task.md">import_uptime_check_task</a></td>
<td>导入拨测任务配置</td>
</tr>
<tr>
<td><a href="./list_shield.md">list_shield</a></td>
<td>获取告警屏蔽列表</td>
</tr>
<tr>
<td><a href="./metadata_create_cluster_info.md">metadata_create_cluster_info</a></td>
<td>创建存储集群信息</td>
</tr>
<tr>
<td><a href="./metadata_create_data_id.md">metadata_create_data_id</a></td>
<td>创建监控数据源</td>
</tr>
<tr>
<td><a href="./metadata_create_event_group.md">metadata_create_event_group</a></td>
<td>创建事件分组</td>
</tr>
<tr>
<td><a href="./metadata_create_result_table.md">metadata_create_result_table</a></td>
<td>创建监控结果表</td>
</tr>
<tr>
<td><a href="./metadata_create_result_table_metric_split.md">metadata_create_result_table_metric_split</a></td>
<td>创建结果表的维度拆分配置</td>
</tr>
<tr>
<td><a href="./metadata_create_time_series_group.md">metadata_create_time_series_group</a></td>
<td>创建自定义时序分组</td>
</tr>
<tr>
<td><a href="./metadata_delete_event_group.md">metadata_delete_event_group</a></td>
<td>删除事件分组</td>
</tr>
<tr>
<td><a href="./metadata_delete_time_series_group.md">metadata_delete_time_series_group</a></td>
<td>删除自定义时序分组</td>
</tr>
<tr>
<td><a href="./metadata_get_cluster_info.md">metadata_get_cluster_info</a></td>
<td>查询指定存储集群信息</td>
</tr>
<tr>
<td><a href="./metadata_get_data_id.md">metadata_get_data_id</a></td>
<td>获取监控数据源具体信息</td>
</tr>
<tr>
<td><a href="./metadata_get_event_group.md">metadata_get_event_group</a></td>
<td>查询事件分组具体内容</td>
</tr>
<tr>
<td><a href="./metadata_get_result_table.md">metadata_get_result_table</a></td>
<td>获取监控结果表具体信息</td>
</tr>
<tr>
<td><a href="./metadata_get_result_table_storage.md">metadata_get_result_table_storage</a></td>
<td>查询指定结果表的指定存储信息</td>
</tr>
<tr>
<td><a href="./metadata_get_time_series_group.md">metadata_get_time_series_group</a></td>
<td>获取自定义时序分组具体内容</td>
</tr>
<tr>
<td><a href="./metadata_get_time_series_metrics.md">metadata_get_time_series_metrics</a></td>
<td>获取自定义时序结果表的 metrics 信息</td>
</tr>
<tr>
<td><a href="./metadata_list_label.md">metadata_list_label</a></td>
<td>查询当前已有的标签信息</td>
</tr>
<tr>
<td><a href="./metadata_list_result_table.md">metadata_list_result_table</a></td>
<td>查询监控结果表</td>
</tr>
<tr>
<td><a href="./metadata_modify_cluster_info.md">metadata_modify_cluster_info</a></td>
<td>修改存储集群信息</td>
</tr>
<tr>
<td><a href="./metadata_modify_data_id.md">metadata_modify_data_id</a></td>
<td>修改指定数据源的配置信息</td>
</tr>
<tr>
<td><a href="./metadata_modify_event_group.md">metadata_modify_event_group</a></td>
<td>修改事件分组</td>
</tr>
<tr>
<td><a href="./metadata_modify_result_table.md">metadata_modify_result_table</a></td>
<td>修改监控结果表</td>
</tr>
<tr>
<td><a href="./metadata_modify_time_series_group.md">metadata_modify_time_series_group</a></td>
<td>修改自定义时序分组</td>
</tr>
<tr>
<td><a href="./metadata_query_event_group.md">metadata_query_event_group</a></td>
<td>创建事件分组</td>
</tr>
<tr>
<td><a href="./metadata_query_tag_values.md">metadata_query_tag_values</a></td>
<td>获取自定义时序分组具体内容</td>
</tr>
<tr>
<td><a href="./metadata_query_time_series_group.md">metadata_query_time_series_group</a></td>
<td>查询事件分组</td>
</tr>
<tr>
<td><a href="./metadata_upgrade_result_table.md">metadata_upgrade_result_table</a></td>
<td>将指定的监控单业务结果表升级为全业务结果表</td>
</tr>
<tr>
<td><a href="./query_collect_config.md">query_collect_config</a></td>
<td>查询采集配置</td>
</tr>
<tr>
<td><a href="./save_alarm_strategy.md">save_alarm_strategy</a></td>
<td>保存告警策略</td>
</tr>
<tr>
<td><a href="./save_collect_config.md">save_collect_config</a></td>
<td>创建/保存采集配置</td>
</tr>
<tr>
<td><a href="./save_notice_group.md">save_notice_group</a></td>
<td>保存通知组</td>
</tr>
<tr>
<td><a href="./search_alarm_strategy.md">search_alarm_strategy</a></td>
<td>查询告警策略</td>
</tr>
<tr>
<td><a href="./search_event.md">search_event</a></td>
<td>查询事件</td>
</tr>
<tr>
<td><a href="./search_notice_group.md">search_notice_group</a></td>
<td>查询通知组</td>
</tr>
<tr>
<td><a href="./switch_alarm_strategy.md">switch_alarm_strategy</a></td>
<td>启停告警策略</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/monitor_v3/add_shield/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>创建屏蔽配置</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 ID</td>
</tr>
<tr>
<td>category</td>
<td>string</td>
<td>是</td>
<td>屏蔽类型</td>
</tr>
<tr>
<td>description</td>
<td>string</td>
<td>是</td>
<td>说明</td>
</tr>
<tr>
<td>begin_time</td>
<td>string</td>
<td>是</td>
<td>开始时间</td>
</tr>
<tr>
<td>end_time</td>
<td>string</td>
<td>是</td>
<td>结束时间</td>
</tr>
<tr>
<td>cycle_config</td>
<td>dict</td>
<td>是</td>
<td>屏蔽配置</td>
</tr>
<tr>
<td>shield_notice</td>
<td>bool</td>
<td>是</td>
<td>是否发送屏蔽通知</td>
</tr>
<tr>
<td>notice_config</td>
<td>dict</td>
<td>否</td>
<td>通知配置</td>
</tr>
<tr>
<td>dimension_config</td>
<td>dict</td>
<td>是</td>
<td>屏蔽维度</td>
</tr>
</tbody>
</table>
<h4 id="cycleconfig">屏蔽配置(CycleConfig)</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>begin_time</td>
<td>string</td>
<td>否</td>
<td>开始时间(每天)</td>
</tr>
<tr>
<td>end_time</td>
<td>string</td>
<td>否</td>
<td>结束时间(每天)</td>
</tr>
<tr>
<td>type</td>
<td>int</td>
<td>是</td>
<td>屏蔽周期类型</td>
</tr>
<tr>
<td>day_list</td>
<td>list</td>
<td>否</td>
<td>周期为月时，需要屏蔽的天</td>
</tr>
<tr>
<td>week_list</td>
<td>list</td>
<td>否</td>
<td>周期为星期是，需要屏蔽的天</td>
</tr>
</tbody>
</table>
<h4 id="noticeconfig">通知配置(NoticeConfig)</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>notice_time</td>
<td>int</td>
<td>是</td>
<td>屏蔽开始/结束前 N 分钟通知</td>
</tr>
<tr>
<td>notice_way</td>
<td>list</td>
<td>是</td>
<td>通知类型</td>
</tr>
<tr>
<td>notice_receiver</td>
<td>list</td>
<td>是</td>
<td>通知人</td>
</tr>
</tbody>
</table>
<h4 id="_7">示例数据</h4>
<p>基于范围的屏蔽</p>
<pre class="codehilite"><code class="language-json">{
  &quot;category&quot;:&quot;scope&quot;,
  &quot;begin_time&quot;:&quot;2019-11-21 00:00:00&quot;,
  &quot;end_time&quot;:&quot;2019-11-23 23:59:59&quot;,
  &quot;cycle_config&quot;:{
    &quot;begin_time&quot;:&quot;&quot;,
    &quot;end_time&quot;:&quot;&quot;,
    &quot;day_list&quot;:[],
    &quot;week_list&quot;:[],
    &quot;type&quot;:1
  },
  &quot;shield_notice&quot;:true,
  &quot;notice_config&quot;:{
    &quot;notice_time&quot;:5,
    &quot;notice_way&quot;:[&quot;weixin&quot;],
    &quot;notice_receiver&quot;:[
      {
        &quot;id&quot;:&quot;user1&quot;,
        &quot;type&quot;:&quot;user&quot;
      }
    ]
  },
  &quot;description&quot;:&quot;test&quot;,
  &quot;dimension_config&quot;:{
    &quot;scope_type&quot;:&quot;instance&quot;,
    &quot;target&quot;:[8]
  },
  &quot;bk_biz_id&quot;:2
}</code></pre>


<p>基于策略的屏蔽</p>
<pre class="codehilite"><code class="language-json">{
  &quot;category&quot;:&quot;scope&quot;,
  &quot;begin_time&quot;:&quot;2019-11-21 00:00:00&quot;,
  &quot;end_time&quot;:&quot;2019-11-23 23:59:59&quot;,
  &quot;cycle_config&quot;:{
    &quot;begin_time&quot;:&quot;&quot;,
    &quot;end_time&quot;:&quot;&quot;,
    &quot;day_list&quot;:[],
    &quot;week_list&quot;:[],
    &quot;type&quot;:1
  },
  &quot;shield_notice&quot;:true,
  &quot;notice_config&quot;:{
    &quot;notice_time&quot;:5,
    &quot;notice_way&quot;:[&quot;weixin&quot;],
    &quot;notice_receiver&quot;:[
      {
        &quot;id&quot;:&quot;user1&quot;,
        &quot;type&quot;:&quot;user&quot;
      }
    ]
  },
  &quot;description&quot;:&quot;test&quot;,
  &quot;dimension_config&quot;:{
    &quot;id&quot;: 1,
    &quot;level&quot;:[1]
  },
  &quot;bk_biz_id&quot;:2
}</code></pre>


<h3 id="_8">响应参数</h3>
<h4 id="_9">示例数据</h4>
<pre class="codehilite"><code class="language-json">{
  &quot;message&quot;: &quot;OK&quot;,
  &quot;code&quot;: &quot;0&quot;,
  &quot;data&quot;: {
    &quot;id&quot;: 1
  },
  &quot;result&quot;: true
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/monitor_v3/delete_alarm_strategy/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>删除告警策略</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 ID</td>
</tr>
<tr>
<td align="left">id</td>
<td>int</td>
<td>是</td>
<td>告警策略 ID</td>
</tr>
</tbody>
</table>
<h4 id="_7">示例数据</h4>
<pre class="codehilite"><code class="language-json">{
  &quot;bk_biz_id&quot;: 2,
  &quot;id&quot;: 1
}</code></pre>


<h3 id="_8">响应参数</h3>
<pre class="codehilite"><code class="language-json">{
  &quot;message&quot;: &quot;OK&quot;,
  &quot;code&quot;: &quot;0&quot;,
  &quot;data&quot;: null,
  &quot;result&quot;: true
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/monitor_v3/delete_notice_group/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>删除告警组</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>ids</td>
<td>list</td>
<td>否</td>
<td>通知组 ID</td>
</tr>
</tbody>
</table>
<h4 id="_7">示例数据</h4>
<pre class="codehilite"><code class="language-json">{
  &quot;ids&quot;: [1]
}</code></pre>


<h3 id="_8">响应参数</h3>
<h4 id="_9">示例数据</h4>
<pre class="codehilite"><code class="language-json">{
  &quot;message&quot;: &quot;OK&quot;,
  &quot;code&quot;: &quot;0&quot;,
  &quot;data&quot;: null,
  &quot;result&quot;: true
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/monitor_v3/disable_shield/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>删除屏蔽配置</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_7">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>int</td>
<td>是</td>
<td>屏蔽 ID</td>
</tr>
</tbody>
</table>
<pre class="codehilite"><code class="language-json">{
  &quot;id&quot;: 1
}</code></pre>


<h3 id="_8">响应参数</h3>
<h4 id="_9">示例数据</h4>
<pre class="codehilite"><code class="language-json">{
  &quot;result&quot;: true,
  &quot;message&quot;: &quot;&quot;,
  &quot;data&quot;: &quot;&quot;
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/monitor_v3/edit_shield/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>编辑屏蔽配置</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 ID</td>
</tr>
<tr>
<td>category</td>
<td>string</td>
<td>是</td>
<td>屏蔽类型</td>
</tr>
<tr>
<td>description</td>
<td>string</td>
<td>是</td>
<td>说明</td>
</tr>
<tr>
<td>begin_time</td>
<td>string</td>
<td>是</td>
<td>开始时间</td>
</tr>
<tr>
<td>end_time</td>
<td>string</td>
<td>是</td>
<td>结束时间</td>
</tr>
<tr>
<td>cycle_config</td>
<td>dict</td>
<td>是</td>
<td>屏蔽配置</td>
</tr>
<tr>
<td>shield_notice</td>
<td>bool</td>
<td>是</td>
<td>是否发送屏蔽通知</td>
</tr>
<tr>
<td>notice_config</td>
<td>dict</td>
<td>否</td>
<td>通知配置</td>
</tr>
<tr>
<td>id</td>
<td>int</td>
<td>是</td>
<td>屏蔽 ID</td>
</tr>
<tr>
<td>level</td>
<td>int</td>
<td>否</td>
<td>屏蔽策略的等级</td>
</tr>
</tbody>
</table>
<h4 id="cycleconfig">屏蔽配置(CycleConfig)</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>begin_time</td>
<td>string</td>
<td>否</td>
<td>开始时间(每天)</td>
</tr>
<tr>
<td>end_time</td>
<td>string</td>
<td>否</td>
<td>结束时间(每天)</td>
</tr>
<tr>
<td>type</td>
<td>int</td>
<td>是</td>
<td>屏蔽周期类型</td>
</tr>
<tr>
<td>day_list</td>
<td>list</td>
<td>否</td>
<td>周期为月时，需要屏蔽的天</td>
</tr>
<tr>
<td>week_list</td>
<td>list</td>
<td>否</td>
<td>周期为星期是，需要屏蔽的天</td>
</tr>
</tbody>
</table>
<h4 id="noticeconfig">通知配置(NoticeConfig)</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>notice_time</td>
<td>int</td>
<td>是</td>
<td>屏蔽开始/结束前 N 分钟通知</td>
</tr>
<tr>
<td>notice_way</td>
<td>list</td>
<td>是</td>
<td>通知类型</td>
</tr>
<tr>
<td>notice_receiver</td>
<td>list</td>
<td>是</td>
<td>通知人</td>
</tr>
</tbody>
</table>
<h4 id="_7">示例数据</h4>
<pre class="codehilite"><code class="language-json">{
  &quot;category&quot;:&quot;scope&quot;,
  &quot;begin_time&quot;:&quot;2019-11-21 00:00:00&quot;,
  &quot;end_time&quot;:&quot;2019-11-23 23:59:59&quot;,
  &quot;cycle_config&quot;:{
    &quot;begin_time&quot;:&quot;&quot;,
    &quot;end_time&quot;:&quot;&quot;,
    &quot;day_list&quot;:[],
    &quot;week_list&quot;:[],
    &quot;type&quot;:1
  },
  &quot;shield_notice&quot;:true,
  &quot;notice_config&quot;:{
    &quot;notice_time&quot;:5,
    &quot;notice_way&quot;:[&quot;weixin&quot;],
    &quot;notice_receiver&quot;:[
      {
        &quot;id&quot;:&quot;user1&quot;,
        &quot;type&quot;:&quot;user&quot;
      }
    ]
  },
  &quot;description&quot;:&quot;test&quot;,
  &quot;bk_biz_id&quot;:2
}</code></pre>


<h3 id="_8">响应参数</h3>
<h4 id="_9">示例数据</h4>
<pre class="codehilite"><code class="language-json">{
  &quot;message&quot;: &quot;OK&quot;,
  &quot;code&quot;: &quot;0&quot;,
  &quot;data&quot;: {
    &quot;id&quot;: 1
  },
  &quot;result&quot;: true
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/monitor_v3/export_uptime_check_task/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>拨测任务配置导出</p>
<h4 id="_4">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h3 id="_5">请求参数</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 id</td>
</tr>
<tr>
<td>protocol</td>
<td>str</td>
<td>否</td>
<td>协议类型(TCP、UDP、HTTP)</td>
</tr>
<tr>
<td>task_ids</td>
<td>str</td>
<td>否</td>
<td>任务 ID，多个任务以逗号分隔</td>
</tr>
<tr>
<td>node_conf_needed</td>
<td>int</td>
<td>否</td>
<td>是否导出任务相关的节点配置信息，0 或 1,默认为 1</td>
</tr>
</tbody>
</table>
<h3 id="_6">请求参数示例</h3>
<pre class="codehilite"><code class="language-bash">{
     biz_id: 2,
     task_ids: &quot;60&quot;,
     protocol: &quot;TCP&quot;,
}</code></pre>


<h3 id="_7">返回参数示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;message&quot;: &quot;OK&quot;,
    &quot;code&quot;: 200,
    &quot;data&quot;: [
        {
            &quot;target_conf&quot;: {
                &quot;bk_biz_id&quot;: 0,
                &quot;node_id_list&quot;: [],
                &quot;node_list&quot;: [
                    {
                        &quot;node_conf&quot;: {
                            &quot;carrieroperator&quot;: &quot;内网&quot;,
                            &quot;location&quot;: {
                                &quot;country&quot;: &quot;中国&quot;,
                                &quot;city&quot;: &quot;广东&quot;
                            },
                            &quot;name&quot;: &quot;中国广东内网&quot;,
                            &quot;is_common&quot;: false
                        },
                        &quot;target_conf&quot;: {
                            &quot;bk_biz_id&quot;: 0,
                            &quot;ip&quot;: &quot;&quot;,
                            &quot;bk_cloud_id&quot;: 0
                        }
                    },
                    {
                        &quot;node_conf&quot;: {
                            &quot;carrieroperator&quot;: &quot;内网&quot;,
                            &quot;location&quot;: {
                                &quot;country&quot;: &quot;中国&quot;,
                                &quot;city&quot;: &quot;广东&quot;
                            },
                            &quot;name&quot;: &quot;中国广东内网&quot;,
                            &quot;is_common&quot;: false
                        },
                        &quot;target_conf&quot;: {
                            &quot;bk_biz_id&quot;: 0,
                            &quot;ip&quot;: &quot;&quot;,
                            &quot;bk_cloud_id&quot;: 0
                        }
                    }
                ]
            },
            &quot;collector_conf&quot;: {
                &quot;config&quot;: {
                    &quot;ip_list&quot;: [
                        &quot;10.0.2.13&quot;
                    ],
                    &quot;period&quot;: 1,
                    &quot;response_format&quot;: &quot;in&quot;,
                    &quot;port&quot;: 3306,
                    &quot;timeout&quot;: 2900,
                    &quot;response&quot;: null
                },
                &quot;protocol&quot;: &quot;TCP&quot;,
                &quot;name&quot;: &quot;test_tcp1&quot;,
                &quot;groups&quot;: &quot;未分类&quot;,
                &quot;location&quot;: {
                    &quot;bk_state_name&quot;: &quot;中国&quot;,
                    &quot;bk_province_name&quot;: &quot;北京&quot;
                }
            },
            &quot;monitor_conf&quot;: [
                {
                    &quot;alarm_level_config&quot;: {
                        &quot;2&quot;: {
                            &quot;notify_way&quot;: [
                                &quot;mail&quot;
                            ],
                            &quot;role_list&quot;: [
                                &quot;Tester&quot;
                            ],
                            &quot;monitor_level&quot;: 2,
                            &quot;alarm_end_time&quot;: &quot;23:59&quot;,
                            &quot;responsible&quot;: [],
                            &quot;detect_algorithm&quot;: [
                                {
                                    &quot;config&quot;: {
                                        &quot;threshold&quot;: 10,
                                        &quot;message&quot;: &quot;&quot;,
                                        &quot;method&quot;: &quot;gte&quot;
                                    },
                                    &quot;algorithm_id&quot;: 1000
                                }
                            ],
                            &quot;phone_receiver&quot;: [],
                            &quot;alarm_start_time&quot;: &quot;00:00&quot;,
                            &quot;is_recovery&quot;: false
                        }
                    },
                    &quot;monitor_target&quot;: &quot;available&quot;,
                    &quot;unit&quot;: &quot;%&quot;,
                    &quot;display_name&quot;: &quot;\&quot;test_tcp1\&quot;节点平均值可用率&quot;,
                    &quot;node_count&quot;: 0,
                    &quot;is_enabled&quot;: true,
                    &quot;nodata_alarm&quot;: 0,
                    &quot;rules&quot;: {
                        &quot;count&quot;: 1,
                        &quot;alarm_window&quot;: 1440,
                        &quot;check_window&quot;: 5
                    },
                    &quot;is_classify_notice&quot;: false,
                    &quot;where_sql&quot;: &quot;&quot;,
                    &quot;condition&quot;: [
                        []
                    ],
                    &quot;bk_biz_id&quot;: 2,
                    &quot;scenario&quot;: &quot;uptimecheck&quot;,
                    &quot;monitor_id&quot;: 0,
                    &quot;alarm_strategy_id&quot;: 0,
                    &quot;is_recovery&quot;: false
                }
            ]
        }
    ],
    &quot;result&quot;: true
}</code></pre>


<h3 id="_8">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>返回结果，true 为成功，false 为失败</td>
</tr>
<tr>
<td>code</td>
<td>int</td>
<td>返回码，200 表示成功，其他值表示失败</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>错误信息</td>
</tr>
<tr>
<td>data</td>
<td>list</td>
<td>结果</td>
</tr>
</tbody>
</table>
<h4 id="1data">1、data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>业务 ID</td>
</tr>
<tr>
<td>conf_list</td>
<td>list</td>
<td>配置列表</td>
</tr>
</tbody>
</table>
<h3 id="11-conf_list">1.1 配置列表--conf_list</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>collector_conf</td>
<td>dict</td>
<td>拨测任务基础配置</td>
</tr>
<tr>
<td>target_conf</td>
<td>dict</td>
<td>拨测任务下发配置</td>
</tr>
<tr>
<td>monitor_conf</td>
<td>dict</td>
<td>拨测任务对应的监控策略</td>
</tr>
</tbody>
</table>
<h4 id="111-dataconf_listcollector_conf">1.1.1 拨测任务基础配置--data.conf_list.collector_conf</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>location</td>
<td>dict</td>
<td>拨测目标所在地址</td>
</tr>
<tr>
<td>groups</td>
<td>str</td>
<td>拨测任务所属分组</td>
</tr>
<tr>
<td>name</td>
<td>str</td>
<td>拨测任务名称</td>
</tr>
<tr>
<td>protocol</td>
<td>str</td>
<td>拨测任务协议类型</td>
</tr>
<tr>
<td>config</td>
<td>dict</td>
<td>拨测任务详细配置</td>
</tr>
</tbody>
</table>
<h4 id="1111-tcp-dataconf_listcollector_confconfigtcpudp">1.1.1.1 拨测任务基础配置详细配置(TCP)--data.conf_list.collector_conf.config(TCP、UDP)</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>ip_list</td>
<td>list</td>
<td>目标 IP 地址</td>
</tr>
<tr>
<td>port</td>
<td>int</td>
<td>端口地址</td>
</tr>
<tr>
<td>period</td>
<td>int</td>
<td>采集周期，单位 min</td>
</tr>
<tr>
<td>response_format</td>
<td>str</td>
<td>响应信息匹配方式(包含：in，不包含：nin，正则：reg)</td>
</tr>
<tr>
<td>response</td>
<td>str</td>
<td>期望响应内容</td>
</tr>
<tr>
<td>response_code</td>
<td>str</td>
<td>期望响应码</td>
</tr>
</tbody>
</table>
<h3 id="http-config">http 任务返回的 config 示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;config&quot;: {
        &quot;insecure_skip_verify&quot;: true,
        &quot;urls&quot;: &quot;http://baidu.com&quot;,
        &quot;response_code&quot;: &quot;&quot;,
        &quot;request&quot;: null,
        &quot;period&quot;: 1,
        &quot;response_format&quot;: &quot;in&quot;,
        &quot;method&quot;: &quot;GET&quot;,
        &quot;headers&quot;: [],
        &quot;timeout&quot;: 3000,
        &quot;response&quot;: null
    }
}</code></pre>


<h4 id="1112-http-dataconf_listcollector_confconfighttp">1.1.1.2 拨测任务基础配置详细配置(HTTP)--data.conf_list.collector_conf.config(HTTP)</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>urls</td>
<td>str</td>
<td>url</td>
</tr>
<tr>
<td>method</td>
<td>str</td>
<td>请求方式</td>
</tr>
<tr>
<td>headers</td>
<td>list</td>
<td>请求头</td>
</tr>
<tr>
<td>insecure_skip_verify</td>
<td>bool</td>
<td>是否开启 ssh 验证</td>
</tr>
<tr>
<td>period</td>
<td>int</td>
<td>采集周期，单位 min</td>
</tr>
<tr>
<td>response_format</td>
<td>str</td>
<td>响应信息匹配方式(包含：in，不包含：nin，正则：reg)</td>
</tr>
<tr>
<td>response</td>
<td>str</td>
<td>期望响应内容</td>
</tr>
<tr>
<td>response_code</td>
<td>str</td>
<td>期望响应码</td>
</tr>
</tbody>
</table>
<h4 id="1113-dataconf_listcollector_conflocation">1.1.1.3 拨测目标所在地址--data.conf_list.collector_conf.location</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_state_name</td>
<td>str</td>
<td>国家</td>
</tr>
<tr>
<td>bk_province_name</td>
<td>str</td>
<td>省份</td>
</tr>
</tbody>
</table>
<h4 id="112-dataconf_listtarget_conf">1.1.2 拨测任务下发配置--data.conf_list.target_conf</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>业务 ID</td>
</tr>
<tr>
<td>node_list</td>
<td>list</td>
<td>任务关联的节点信息</td>
</tr>
</tbody>
</table>
<h4 id="1121-dataconf_listtarget_confnode_list">1.1.2.1 任务关联的节点信息--data.conf_list.target_conf.node_list</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>node_conf</td>
<td>dict</td>
<td>节点配置信息</td>
</tr>
<tr>
<td>target_conf</td>
<td>dict</td>
<td>节点下发信息</td>
</tr>
</tbody>
</table>
<h4 id="11211-dataconf_listtarget_confnode_listtarget_conf">1.1.2.1.1 节点下发信息--data.conf_list.target_conf.node_list.target_conf</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>节点所属业务</td>
</tr>
<tr>
<td>ip</td>
<td>str</td>
<td>节点 IP</td>
</tr>
<tr>
<td>bk_cloud_id</td>
<td>int</td>
<td>节点云区域 ID</td>
</tr>
</tbody>
</table>
<h4 id="11212-dataconf_listtarget_confnode_listnode_conf">1.1.2.1.2 节点配置信息--data.conf_list.target_conf.node_list.node_conf</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>carrieroperator</td>
<td>str</td>
<td>运营商信息</td>
</tr>
<tr>
<td>name</td>
<td>str</td>
<td>节点名称</td>
</tr>
<tr>
<td>is_common</td>
<td>bool</td>
<td>是否为通用节点</td>
</tr>
<tr>
<td>location</td>
<td>dict</td>
<td>节点所在区域</td>
</tr>
</tbody>
</table>
<h4 id="112121-dataconf_listtarget_confnode_listnode_conflocation">1.1.2.1.2.1 节点所在区域--data.conf_list.target_conf.node_list.node_conf.location</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>country</td>
<td>str</td>
<td>国家</td>
</tr>
<tr>
<td>city</td>
<td>str</td>
<td>省份</td>
</tr>
</tbody>
</table>
<h4 id="113-dataconf_listmonitor_conf">1.1.3 节点所在区域--data.conf_list.monitor_conf</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>alarm_level_config</td>
<td>dict</td>
<td>监控触发条件配置</td>
</tr>
<tr>
<td>monitor_target</td>
<td>str</td>
<td>监控目标字段</td>
</tr>
<tr>
<td>unit</td>
<td>str</td>
<td>单位</td>
</tr>
<tr>
<td>display_name</td>
<td>str</td>
<td>监控名称</td>
</tr>
<tr>
<td>node_count</td>
<td>int</td>
<td>节点数</td>
</tr>
<tr>
<td>is_enabled</td>
<td>bool</td>
<td>是否启用</td>
</tr>
<tr>
<td>nodata_alarm</td>
<td>int</td>
<td>无数据告警</td>
</tr>
<tr>
<td>rules</td>
<td>dict</td>
<td>告警收敛配置</td>
</tr>
<tr>
<td>is_classify_notice</td>
<td>bool</td>
<td>是否分级告警</td>
</tr>
<tr>
<td>where_sql</td>
<td>str</td>
<td>监控源查询条件</td>
</tr>
<tr>
<td>condition</td>
<td>list</td>
<td>监控范围</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>业务 ID</td>
</tr>
<tr>
<td>scenario</td>
<td>str</td>
<td>监控场景</td>
</tr>
<tr>
<td>monitor_id</td>
<td>int</td>
<td>监控源 ID</td>
</tr>
<tr>
<td>alarm_strategy_id</td>
<td>int</td>
<td>监控策略 ID</td>
</tr>
<tr>
<td>is_recovery</td>
<td>bool</td>
<td>自动恢复</td>
</tr>
</tbody>
</table>
<h4 id="1131-dataconf_listmonitor_confrules">1.1.3.1 告警收敛配置--data.conf_list.monitor_conf.rules</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>alarm_window</td>
<td>int</td>
<td>告警窗口</td>
</tr>
<tr>
<td>check_window</td>
<td>int</td>
<td>检测窗口</td>
</tr>
<tr>
<td>count</td>
<td>int</td>
<td>数量</td>
</tr>
</tbody>
</table>
<h2 id="1132-dataconf_listmonitor_confalarm_level_config">1.1.3.2 监控触发条件配置--data.conf_list.monitor_conf.alarm_level_config</h2>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>dict</td>
<td>告警级别对应的告警触发配置,表示为致命告警</td>
</tr>
<tr>
<td>2</td>
<td>dict</td>
<td>告警级别对应的告警触发配置，表现为预警告警</td>
</tr>
<tr>
<td>3</td>
<td>dict</td>
<td>告警级别对应的告警触发配置，表现为提醒告警</td>
</tr>
</tbody>
</table>
<h2 id="11321-dataconf_listmonitor_confalarm_level_config1">1.1.3.2.1 告警级别对应的告警触发配置--data.conf_list.monitor_conf.alarm_level_config.1</h2>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>alarm_start_time</td>
<td>str</td>
<td>当日开始告警时间</td>
</tr>
<tr>
<td>alarm_end_time</td>
<td>str</td>
<td>当日结束告警时间</td>
</tr>
<tr>
<td>detect_algorithm</td>
<td>list</td>
<td>检测算法配置</td>
</tr>
<tr>
<td>is_recovery</td>
<td>str</td>
<td>自动恢复</td>
</tr>
<tr>
<td>monitor_level</td>
<td>int</td>
<td>告警级别，1 致命、2 预警、3 提醒</td>
</tr>
<tr>
<td>notify_way</td>
<td>list</td>
<td>通知方式，mail 邮件、wechat 微信、sms 短信、phone 电话</td>
</tr>
<tr>
<td>phone_receiver</td>
<td>list</td>
<td>电话通知对象，账号名</td>
</tr>
<tr>
<td>responsible</td>
<td>list</td>
<td>其他通知人列表</td>
</tr>
<tr>
<td>role_list</td>
<td>list</td>
<td>通知人分组，在业务管理中配置</td>
</tr>
</tbody>
</table>
<h2 id="113211-dataconf_listmonitor_confalarm_level_config1detect_algorithm">1.1.3.2.1.1 检测算法配置--data.conf_list.monitor_conf.alarm_level_config.1.detect_algorithm</h2>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>config</td>
<td>dict</td>
<td>检测算法详细配置</td>
</tr>
<tr>
<td>algorithm_id</td>
<td>int</td>
<td>检测算法 ID，静态阈值 1000、同比策略(简易) 1001、环比策略(简易)1002</td>
</tr>
</tbody>
</table>
<h2 id="1132111-dataconf_listmonitor_confalarm_level_config1detect_algorithmconfig">1.1.3.2.1.1.1 检测算法详细配置(静态阈值)--data.conf_list.monitor_conf.alarm_level_config.1.detect_algorithm.config</h2>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>threshold</td>
<td>int</td>
<td>比较值</td>
</tr>
<tr>
<td>method</td>
<td>str</td>
<td>比较方式</td>
</tr>
<tr>
<td>message</td>
<td>str</td>
<td>说明</td>
</tr>
</tbody>
</table>
<h2 id="1132112-dataconf_listmonitor_confalarm_level_config1detect_algorithmconfig">1.1.3.2.1.1.2 检测算法详细配置(同比、环比)--data.conf_list.monitor_conf.alarm_level_config.1.detect_algorithm.config</h2>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>ceil</td>
<td>int</td>
<td>大于设定值告警</td>
</tr>
<tr>
<td>floor</td>
<td>str</td>
<td>低于设定值告警</td>
</tr>
<tr>
<td>message</td>
<td>str</td>
<td>说明</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/monitor_v3/get_collect_config_list/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/monitor_v3/get_collect_status/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/monitor_v3/get_es_data/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/monitor_v3/get_event_log/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>查询时间流水</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>int</td>
<td>事件 ID</td>
</tr>
</tbody>
</table>
<h4 id="_7">示例数据</h4>
<pre class="codehilite"><code class="language-json">{
  &quot;id&quot;: 1
}</code></pre>


<h3 id="_8">响应参数</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>status</td>
<td>string</td>
<td>状态</td>
</tr>
<tr>
<td>event_id</td>
<td>string</td>
<td>事件 ID</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>记录消息</td>
</tr>
<tr>
<td>operate</td>
<td>int</td>
<td>记录类型</td>
</tr>
<tr>
<td>extend_info</td>
<td>dict</td>
<td>其他数据</td>
</tr>
<tr>
<td>create_time</td>
<td>string</td>
<td>创建时间</td>
</tr>
</tbody>
</table>
<h4 id="operate-">operate - 记录类型</h4>
<ul>
<li>ACK - 告警确认</li>
<li>ANOMALY_NOTICE - 告警通知</li>
<li>RECOVERY_NOTICE - 恢复通知</li>
<li>CREATE - 触发告警</li>
<li>CONVERGE - 告警收敛</li>
<li>RECOVER - 告警恢复</li>
<li>CLOSE - 告警关闭</li>
</ul>
<h4 id="status-">status - 状态</h4>
<ul>
<li>RUNNING - 运行中</li>
<li>SUCCESS - 成功</li>
<li>PARTIAL_SUCCESS - 部分成功</li>
<li>FAILED - 失败</li>
<li>SHIELDED - 被屏蔽</li>
</ul>
<h4 id="extend_info">extend_info</h4>
<p>不同类型的记录的数据各不相同</p>
<h5 id="anomaly_notice-">ANOMALY_NOTICE - 告警通知</h5>
<ul>
<li>action - 通知配置(参考"查询事件"接口文档中的 action_list 说明)</li>
</ul>
<pre class="codehilite"><code class="language-json">{
  &quot;action&quot;: {}
}</code></pre>


<h5 id="converge-">CONVERGE - 告警收敛</h5>
<ul>
<li>process_time - 收敛数据点的处理时间段</li>
<li>anomaly_count - 收敛异常点数量</li>
<li>data_time - 收敛数据点的数据时间段</li>
<li>anomaly_record - 异常点记录(参考"查询事件"接口文档中的 origin_alarm 说明)</li>
</ul>
<pre class="codehilite"><code class="language-json">{
  &quot;process_time&quot;: {
    &quot;max&quot;: 1583914154,
    &quot;min&quot;: 1583911227
  },
  &quot;anomaly_record&quot;: {},
  &quot;data_time&quot;: {
    &quot;max&quot;: 1583914020,
    &quot;min&quot;: 1583911080
  },
  &quot;anomaly_count&quot;: 50
}</code></pre>


<h4 id="_9">示例数据</h4>
<pre class="codehilite"><code class="language-json">[
  {
    &quot;status&quot;: &quot;SUCCESS&quot;,
    &quot;event_id&quot;: &quot;d751713988987e9331980363e24189ce.1574439660.88.118.1&quot;,
    &quot;message&quot;: &quot;&quot;,
    &quot;operate&quot;: &quot;CREATE&quot;,
    &quot;extend_info&quot;: &quot;&quot;,
    &quot;create_time&quot;: &quot;2020-01-01 00:00:00&quot;
  },
  {
    &quot;status&quot;: &quot;FAILED&quot;,
    &quot;event_id&quot;: &quot;d751713988987e9331980363e24189ce.1574439660.88.118.1&quot;,
    &quot;message&quot;: &quot;通知人为空&quot;,
    &quot;operate&quot;: &quot;ANOMALY_NOTICE&quot;,
    &quot;extend_info&quot;: {
      &quot;action&quot;: {}
    },
    &quot;create_time&quot;: &quot;2020-01-01 00:00:00&quot;
  }
]</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/monitor_v3/get_shield/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>查询屏蔽详情</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>int</td>
<td>屏蔽 ID</td>
</tr>
</tbody>
</table>
<h4 id="_7">示例数据</h4>
<pre class="codehilite"><code class="language-json">{
  &quot;id&quot;: 1,
  &quot;bk_biz_id&quot;: 2
}</code></pre>


<h3 id="_8">响应参数</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>业务 ID</td>
</tr>
<tr>
<td>category</td>
<td>string</td>
<td>屏蔽类型</td>
</tr>
<tr>
<td>description</td>
<td>string</td>
<td>说明</td>
</tr>
<tr>
<td>begin_time</td>
<td>string</td>
<td>开始时间</td>
</tr>
<tr>
<td>end_time</td>
<td>string</td>
<td>结束时间</td>
</tr>
<tr>
<td>cycle_config</td>
<td>dict</td>
<td>屏蔽配置</td>
</tr>
<tr>
<td>shield_notice</td>
<td>bool</td>
<td>是否发送屏蔽通知</td>
</tr>
<tr>
<td>notice_config</td>
<td>dict</td>
<td>通知配置</td>
</tr>
<tr>
<td>dimension_config</td>
<td>dict</td>
<td>屏蔽维度</td>
</tr>
<tr>
<td>id</td>
<td>int</td>
<td>屏蔽 ID</td>
</tr>
<tr>
<td>scope_type</td>
<td>string</td>
<td>范围类型</td>
</tr>
<tr>
<td>status</td>
<td>int</td>
<td>当前状态，屏蔽中(1)，过期(2)，解除(3)</td>
</tr>
</tbody>
</table>
<h4 id="cycleconfig">屏蔽配置(CycleConfig)</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>begin_time</td>
<td>string</td>
<td>开始时间(每天)</td>
</tr>
<tr>
<td>end_time</td>
<td>string</td>
<td>结束时间(每天)</td>
</tr>
<tr>
<td>type</td>
<td>int</td>
<td>屏蔽周期类型</td>
</tr>
<tr>
<td>day_list</td>
<td>list</td>
<td>周期为月时，需要屏蔽的天</td>
</tr>
<tr>
<td>week_list</td>
<td>list</td>
<td>周期为星期是，需要屏蔽的天</td>
</tr>
</tbody>
</table>
<h4 id="noticeconfig">通知配置(NoticeConfig)</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>notice_time</td>
<td>int</td>
<td>屏蔽开始/结束前 N 分钟通知</td>
</tr>
<tr>
<td>notice_way</td>
<td>list</td>
<td>通知类型</td>
</tr>
<tr>
<td>notice_receiver</td>
<td>list</td>
<td>通知人</td>
</tr>
</tbody>
</table>
<h4 id="_9">示例数据</h4>
<p>基于范围的屏蔽</p>
<pre class="codehilite"><code class="language-json">{
  &quot;id&quot;: 1,
  &quot;scope_type&quot;: &quot;instance&quot;,
  &quot;status&quot;: 1,
  &quot;category&quot;:&quot;scope&quot;,
  &quot;begin_time&quot;:&quot;2019-11-21 00:00:00&quot;,
  &quot;end_time&quot;:&quot;2019-11-23 23:59:59&quot;,
  &quot;cycle_config&quot;:{
    &quot;begin_time&quot;:&quot;&quot;,
    &quot;end_time&quot;:&quot;&quot;,
    &quot;day_list&quot;:[],
    &quot;week_list&quot;:[],
    &quot;type&quot;:1
  },
  &quot;shield_notice&quot;:true,
  &quot;notice_config&quot;:{
    &quot;notice_time&quot;:5,
    &quot;notice_way&quot;:[&quot;weixin&quot;],
    &quot;notice_receiver&quot;:[
      {
        &quot;id&quot;:&quot;user1&quot;,
        &quot;type&quot;:&quot;user&quot;
      }
    ]
  },
  &quot;description&quot;:&quot;test&quot;,
  &quot;dimension_config&quot;:{
    &quot;scope_type&quot;:&quot;instance&quot;,
    &quot;target&quot;:[8]
  },
  &quot;bk_biz_id&quot;:2
}</code></pre>


<p>基于策略的屏蔽</p>
<pre class="codehilite"><code class="language-json">{
  &quot;id&quot;: 1,
  &quot;scope_type&quot;: &quot;&quot;,
  &quot;status&quot;: 1,
  &quot;category&quot;:&quot;scope&quot;,
  &quot;begin_time&quot;:&quot;2019-11-21 00:00:00&quot;,
  &quot;end_time&quot;:&quot;2019-11-23 23:59:59&quot;,
  &quot;cycle_config&quot;:{
    &quot;begin_time&quot;:&quot;&quot;,
    &quot;end_time&quot;:&quot;&quot;,
    &quot;day_list&quot;:[],
    &quot;week_list&quot;:[],
    &quot;type&quot;:1
  },
  &quot;shield_notice&quot;:true,
  &quot;notice_config&quot;:{
    &quot;notice_time&quot;:5,
    &quot;notice_way&quot;:[&quot;weixin&quot;],
    &quot;notice_receiver&quot;:[
      {
        &quot;id&quot;:&quot;user1&quot;,
        &quot;type&quot;:&quot;user&quot;
      }
    ]
  },
  &quot;description&quot;:&quot;test&quot;,
  &quot;dimension_config&quot;:{
    &quot;id&quot;: 1,
    &quot;level&quot;:[1]
  },
  &quot;bk_biz_id&quot;:2
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/monitor_v3/get_ts_data/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>图表数据查询<br />
根据给定的 sql 表达式查询指定的存储引擎  </p>
<h4 id="_4">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_5">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>sql</td>
<td>string</td>
<td>是</td>
<td>SQL 查询语句</td>
</tr>
<tr>
<td>prefer_storage</td>
<td>string</td>
<td>否</td>
<td>查询引擎(默认 influxdb)</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>白名单的 app_code 必填</td>
</tr>
</tbody>
</table>
<h4 id="_6">请求示例</h4>
<pre class="codehilite"><code class="language-json">{
    &quot;bk_username&quot;:&quot;admin&quot;,
    &quot;sql&quot;:&quot;select max(in_use) as _in_use from 3_system_disk where time &gt;= \&quot;1m\&quot; group by ip, bk_cloud_id, bk_supplier_id, device_name, minute1 order by time desc limit 1&quot;
}</code></pre>


<blockquote>
<p>sql 中的结果表名为 biz_id + db_name + table_name<br />
Biz_id：业务 id<br />
Db_name: 数据库名<br />
Table_name: 数据表名<br />
例：2_system_cpu_detail：业务 2 下的 system 库的 cpu_detail 表<br />
查询一个小时内的单核 cpu 的使用率的 sql 语句：<br />
Select Mean(usage) as usage from 2_system_detail where time &gt; '1h' group by ip,device_name,minute1 limit 10  </p>
<p>上面请求实例中结果表 3_system_disk 表示：业务 3 下的 system 库中的 disk 表  </p>
<p>注意：上述的库和表并非和时序存储中的实际物理库、表对应。而是指'源数据管理模块'的库表</p>
</blockquote>
<h3 id="_7">返回结果</h3>
<h4 id="_8">字段说明</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>list</td>
<td>list</td>
<td>查询结果</td>
</tr>
<tr>
<td>totalRecords</td>
<td>int</td>
<td>总记录数</td>
</tr>
<tr>
<td>timetaken</td>
<td>float</td>
<td>查询耗时</td>
</tr>
<tr>
<td>device</td>
<td>string</td>
<td>查询引擎</td>
</tr>
</tbody>
</table>
<h4 id="_9">结果示例</h4>
<pre class="codehilite"><code class="language-json">{
    &quot;message&quot;:&quot;OK&quot;,
    &quot;code&quot;:&quot;0&quot;,
    &quot;data&quot;:{
        &quot;list&quot;:[
            {
                &quot;ip&quot;:&quot;x.x.x.x&quot;,
                &quot;time&quot;:1543487700000,
                &quot;bk_supplier_id&quot;:&quot;0&quot;,
                &quot;device_name&quot;:&quot;C:&quot;,
                &quot;_in_use&quot;:27.0269684761,
                &quot;bk_cloud_id&quot;:&quot;0&quot;,
                &quot;minute1&quot;:1543487700000
            },
            {
                &quot;ip&quot;:&quot;x.x.x.x&quot;,
                &quot;time&quot;:1543487700000,
                &quot;bk_supplier_id&quot;:&quot;0&quot;,
                &quot;device_name&quot;:&quot;\/&quot;,
                &quot;_in_use&quot;:8.3368418991,
                &quot;bk_cloud_id&quot;:&quot;0&quot;,
                &quot;minute1&quot;:1543487700000
            }
        ],
        &quot;timetaken&quot;:0.0059459209,
        &quot;totalRecords&quot;:2,
        &quot;device&quot;:&quot;influxdb&quot;
    },
    &quot;result&quot;:true,
    &quot;request_id&quot;:&quot;408233306947415bb1772a86b9536867&quot;
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/monitor_v3/get_uptime_check_node_list/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/monitor_v3/get_uptime_check_task_list/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/monitor_v3/import_uptime_check_node/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>导入拨测节点</p>
<h4 id="_4">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h2 id="_5">请求参数示例</h2>
<pre class="codehilite"><code class="language-bash">{&quot;conf_list&quot;:[{
    &quot;node_conf&quot;: {
        &quot;carrieroperator&quot;: &quot;内网&quot;,
        &quot;location&quot;: {
            &quot;country&quot;: &quot;中国&quot;,
            &quot;city&quot;: &quot;广东&quot;
        },
        &quot;name&quot;: &quot;中国广东内网&quot;,
        &quot;is_common&quot;: false
    },
    &quot;target_conf&quot;: {
        &quot;bk_biz_id&quot;: 2,
        &quot;bk_cloud_id&quot;: 0,
        &quot;ip&quot;: &quot;x.x.x.x&quot;
    }
},{
    &quot;node_conf&quot;: {
        &quot;carrieroperator&quot;: &quot;内网&quot;,
        &quot;location&quot;: {
            &quot;country&quot;: &quot;中国&quot;,
            &quot;city&quot;: &quot;广东&quot;
        },
        &quot;name&quot;: &quot;中国广东内网&quot;,
        &quot;is_common&quot;: false
    },
    &quot;target_conf&quot;: {
        &quot;bk_biz_id&quot;: 2,
        &quot;bk_cloud_id&quot;: 0,
        &quot;ip&quot;: &quot;x.x.x.x&quot;
    }
}]}</code></pre>


<h1 id="_6">请求参数</h1>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>conf_list</td>
<td>list</td>
<td>是</td>
<td>节点列表</td>
</tr>
</tbody>
</table>
<h1 id="1-conf_list">1 任务列表--conf_list</h1>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>target_conf</td>
<td>dict</td>
<td>是</td>
<td>节点下发配置</td>
</tr>
<tr>
<td>node_conf</td>
<td>dict</td>
<td>是</td>
<td>节点基本配置</td>
</tr>
</tbody>
</table>
<h1 id="11-target_conf">1.1 节点下发配置--target_conf</h1>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>ip</td>
<td>str</td>
<td>是</td>
<td>IP</td>
</tr>
<tr>
<td>bk_cloud_id</td>
<td>int</td>
<td>是</td>
<td>云区域 ID</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 id</td>
</tr>
</tbody>
</table>
<h2 id="12-node_conf">1.2 节点基本配置--node_conf</h2>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>is_common</td>
<td>bool</td>
<td>否</td>
<td>是否为通用节点，默认 false</td>
</tr>
<tr>
<td>name</td>
<td>str</td>
<td>是</td>
<td>节点名称</td>
</tr>
<tr>
<td>location</td>
<td>dict</td>
<td>是</td>
<td>节点所在地区</td>
</tr>
<tr>
<td>carrieroperator</td>
<td>str</td>
<td>是</td>
<td>运营商，最大长度 50(内网、联通、移动、其他)</td>
</tr>
</tbody>
</table>
<h2 id="121-node_conflocation">1.2.1 节点所在地区--node_conf.location</h2>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>country</td>
<td>str</td>
<td>是</td>
<td>国家</td>
</tr>
<tr>
<td>city</td>
<td>str</td>
<td>是</td>
<td>城市</td>
</tr>
</tbody>
</table>
<h2 id="_7">返回结果示例</h2>
<pre class="codehilite"><code class="language-bash">{
    &quot;message&quot;: &quot;OK&quot;,
    &quot;code&quot;: &quot;0&quot;,
    &quot;data&quot;: {
        &quot;failed&quot;: {
            &quot;total&quot;: 1,
            &quot;detail&quot;: [
                    &quot;target_conf&quot;: {
                        &quot;bk_biz_id&quot;: 2,
                        &quot;ip&quot;: &quot;x.x.x.x&quot;,
                        &quot;bk_cloud_id&quot;: 0
                    },
                    &quot;error_mes&quot;: &quot;业务下不存在该主机&quot;
                }]
        },
        &quot;success&quot;: {
            &quot;total&quot;: 2,
            &quot;detail&quot;: [
                {
                    &quot;target_conf&quot;: {
                        &quot;bk_biz_id&quot;: 2,
                        &quot;ip&quot;: &quot;x.x.x.x&quot;,
                        &quot;bk_cloud_id&quot;: 0
                    },
                    &quot;node_id&quot;: 30
                },
                {
                    &quot;target_conf&quot;: {
                        &quot;bk_biz_id&quot;: 2,
                        &quot;ip&quot;: &quot;x.x.x.x&quot;,
                        &quot;bk_cloud_id&quot;: 0
                    },
                    &quot;node_id&quot;: 31
                }
            ]
        }
    },
    &quot;result&quot;: true
}</code></pre>


<h2 id="_8">返回结果参数说明</h2>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>返回结果，true 为成功，false 为失败</td>
</tr>
<tr>
<td>code</td>
<td>int</td>
<td>返回码，200 表示成功，其他值表示失败</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>错误信息</td>
</tr>
<tr>
<td>data</td>
<td>list</td>
<td>结果</td>
</tr>
</tbody>
</table>
<h2 id="2-data">2 data</h2>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>failed</td>
<td>dict</td>
<td>导入失败相关信息</td>
</tr>
<tr>
<td>success</td>
<td>dict</td>
<td>导入成功相关信息</td>
</tr>
</tbody>
</table>
<h2 id="21-datafailed">2.1 导入失败相关信息--data.failed</h2>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>total</td>
<td>int</td>
<td>导入失败数量</td>
</tr>
<tr>
<td>detail</td>
<td>list</td>
<td>导入失败详情</td>
</tr>
</tbody>
</table>
<h2 id="211-datafaileddetail">2.1.1 导入失败详情--data.failed.detail</h2>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>target_conf</td>
<td>dict</td>
<td>节点下发配置</td>
</tr>
<tr>
<td>error_mes</td>
<td>str</td>
<td>导入失败原因</td>
</tr>
</tbody>
</table>
<h2 id="22-datasuccess">2.2 导入成功相关信息--data.success</h2>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>total</td>
<td>int</td>
<td>导入成功数量</td>
</tr>
<tr>
<td>detail</td>
<td>list</td>
<td>导入成功详情</td>
</tr>
</tbody>
</table>
<h2 id="221-datasuccessdatail">2.2.1 导入成功相关信息--data.success.datail</h2>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>target_conf</td>
<td>dict</td>
<td>节点下发配置</td>
</tr>
<tr>
<td>node_id</td>
<td>int</td>
<td>导入成功的节点 id</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/monitor_v3/import_uptime_check_task/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>导入拨测任务</p>
<h4 id="_4">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h3 id="_5">请求参数示例</h3>
<pre class="codehilite"><code class="language-bash">{   &quot;bk_biz_id&quot;: 2,
    &quot;conf_list&quot;: [
        {
            &quot;target_conf&quot;: {
                &quot;bk_biz_id&quot;: 0,
                &quot;node_id_list&quot;: [],
                &quot;node_list&quot;: [
                    {
                        &quot;node_conf&quot;: {
                            &quot;carrieroperator&quot;: &quot;内网&quot;,
                            &quot;location&quot;: {
                                &quot;country&quot;: &quot;中国&quot;,
                                &quot;city&quot;: &quot;广东&quot;
                            },
                            &quot;name&quot;: &quot;中国广东内网&quot;,
                            &quot;is_common&quot;: false
                        },
                        &quot;target_conf&quot;: {
                            &quot;bk_biz_id&quot;: 0,
                            &quot;ip&quot;: &quot;&quot;,
                            &quot;bk_cloud_id&quot;: 0
                        }
                    },
                    {
                        &quot;node_conf&quot;: {
                            &quot;carrieroperator&quot;: &quot;内网&quot;,
                            &quot;location&quot;: {
                                &quot;country&quot;: &quot;中国&quot;,
                                &quot;city&quot;: &quot;广东&quot;
                            },
                            &quot;name&quot;: &quot;中国广东内网&quot;,
                            &quot;is_common&quot;: false
                        },
                        &quot;target_conf&quot;: {
                            &quot;bk_biz_id&quot;: 0,
                            &quot;ip&quot;: &quot;&quot;,
                            &quot;bk_cloud_id&quot;: 0
                        }
                    }
                ]
            },
            &quot;collector_conf&quot;: {
                &quot;config&quot;: {
                    &quot;ip_list&quot;: [
                        &quot;10.0.2.13&quot;
                    ],
                    &quot;period&quot;: 1,
                    &quot;response_format&quot;: &quot;in&quot;,
                    &quot;port&quot;: 3306,
                    &quot;timeout&quot;: 2900,
                    &quot;response&quot;: null
                },
                &quot;protocol&quot;: &quot;TCP&quot;,
                &quot;name&quot;: &quot;test_tcp1&quot;,
                &quot;groups&quot;: &quot;未分类&quot;,
                &quot;location&quot;: {
                    &quot;bk_state_name&quot;: &quot;中国&quot;,
                    &quot;bk_province_name&quot;: &quot;北京&quot;
                }
            },
            &quot;monitor_conf&quot;: [
                {
                    &quot;alarm_level_config&quot;: {
                        &quot;2&quot;: {
                            &quot;notify_way&quot;: [
                                &quot;mail&quot;
                            ],
                            &quot;role_list&quot;: [
                                &quot;Tester&quot;
                            ],
                            &quot;monitor_level&quot;: 2,
                            &quot;alarm_end_time&quot;: &quot;23:59&quot;,
                            &quot;responsible&quot;: [],
                            &quot;detect_algorithm&quot;: [
                                {
                                    &quot;config&quot;: {
                                        &quot;threshold&quot;: 10,
                                        &quot;message&quot;: &quot;&quot;,
                                        &quot;method&quot;: &quot;gte&quot;
                                    },
                                    &quot;algorithm_id&quot;: 1000
                                },
                                {
                                    &quot;config&quot;: {
                                        &quot;message&quot;: &quot;&quot;,
                                        &quot;ceil&quot;: 10,
                                        &quot;floor&quot;: 10
                                    },
                                    &quot;algorithm_id&quot;: 1001
                                }
                            ],
                            &quot;phone_receiver&quot;: [],
                            &quot;alarm_start_time&quot;: &quot;00:00&quot;,
                            &quot;is_recovery&quot;: false
                        }
                    },
                    &quot;monitor_target&quot;: &quot;available&quot;,
                    &quot;unit&quot;: &quot;%&quot;,
                    &quot;display_name&quot;: &quot;\&quot;test_tcp1\&quot;节点平均值可用率&quot;,
                    &quot;node_count&quot;: 0,
                    &quot;is_enabled&quot;: true,
                    &quot;nodata_alarm&quot;: 0,
                    &quot;rules&quot;: {
                        &quot;count&quot;: 1,
                        &quot;alarm_window&quot;: 1440,
                        &quot;check_window&quot;: 5
                    },
                    &quot;is_classify_notice&quot;: false,
                    &quot;where_sql&quot;: &quot;&quot;,
                    &quot;condition&quot;: [
                        []
                    ],
                    &quot;bk_biz_id&quot;: 2,
                    &quot;scenario&quot;: &quot;uptimecheck&quot;,
                    &quot;monitor_id&quot;: 0,
                    &quot;alarm_strategy_id&quot;: 0,
                    &quot;is_recovery&quot;: false
                }
            ]
        }
    ]
        }</code></pre>


<h3 id="_6">请求参数说明</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 ID</td>
</tr>
<tr>
<td>conf_list</td>
<td>list</td>
<td>是</td>
<td>拨测任务配置列表</td>
</tr>
</tbody>
</table>
<h3 id="1-conf_list">1 拨测任务配置列表--conf_list</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>target_conf</td>
<td>dict</td>
<td>是</td>
<td>拨测任务下发配置</td>
</tr>
<tr>
<td>collector_conf</td>
<td>dict</td>
<td>是</td>
<td>拨测任务基本配置</td>
</tr>
<tr>
<td>monitor_conf</td>
<td>list</td>
<td>是</td>
<td>监控策略配置</td>
</tr>
</tbody>
</table>
<h3 id="11-conf_listtarget_conf">1.1 拨测任务下发配置--conf_list.target_conf</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 ID</td>
</tr>
<tr>
<td>node_list</td>
<td>list</td>
<td>否</td>
<td>默认[],需导入节点配置</td>
</tr>
<tr>
<td>node_id_list</td>
<td>list</td>
<td>否</td>
<td>默认[],下发节点 ID 列表，node_list 与 node_id_list 不能同时为空</td>
</tr>
</tbody>
</table>
<h3 id="111-conf_listtarget_confnode_list">1.1.1 需导入节点配置--conf_list.target_conf.node_list</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>target_conf</td>
<td>dict</td>
<td>是</td>
<td>节点下发配置</td>
</tr>
<tr>
<td>node_conf</td>
<td>dict</td>
<td>是</td>
<td>节点基本配置</td>
</tr>
</tbody>
</table>
<h1 id="1111-conf_listtarget_confnode_listtarget_conf">1.1.1.1 节点下发配置--conf_list.target_conf.node_list.target_conf</h1>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>ip</td>
<td>str</td>
<td>是</td>
<td>IP</td>
</tr>
<tr>
<td>bk_cloud_id</td>
<td>int</td>
<td>是</td>
<td>云区域 ID</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 id</td>
</tr>
</tbody>
</table>
<h2 id="1112-conf_listtarget_confnode_listnode_conf">1.1.1.2 节点基本配置--conf_list.target_conf.node_list.node_conf</h2>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>is_common</td>
<td>bool</td>
<td>否</td>
<td>是否为通用节点，默认 false</td>
</tr>
<tr>
<td>name</td>
<td>str</td>
<td>是</td>
<td>节点名称</td>
</tr>
<tr>
<td>location</td>
<td>dict</td>
<td>是</td>
<td>节点所在地区</td>
</tr>
<tr>
<td>carrieroperator</td>
<td>str</td>
<td>是</td>
<td>运营商，最大长度 50(内网、联通、移动、其他)</td>
</tr>
</tbody>
</table>
<h2 id="11121-conf_listtarget_confnode_listnode_conflocation">1.1.1.2.1 节点所在地区--conf_list.target_conf.node_list.node_conf.location</h2>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>country</td>
<td>str</td>
<td>是</td>
<td>国家</td>
</tr>
<tr>
<td>city</td>
<td>str</td>
<td>是</td>
<td>城市</td>
</tr>
</tbody>
</table>
<h3 id="12-conf_listcollector_conf">1.2 拨测任务基本配置--conf_list.collector_conf</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>location</td>
<td>dict</td>
<td>是</td>
<td>拨测目标所在地址</td>
</tr>
<tr>
<td>groups</td>
<td>str</td>
<td>是</td>
<td>拨测任务所属分组</td>
</tr>
<tr>
<td>name</td>
<td>str</td>
<td>是</td>
<td>拨测任务名称</td>
</tr>
<tr>
<td>protocol</td>
<td>str</td>
<td>是</td>
<td>拨测任务协议类型</td>
</tr>
<tr>
<td>config</td>
<td>dict</td>
<td>是</td>
<td>拨测任务详细配置</td>
</tr>
</tbody>
</table>
<h3 id="tcp-config">TCP 任务 config 示例</h3>
<pre class="codehilite"><code class="language-bash">&quot;config&quot;: {
            &quot;ip_list&quot;: [&quot;10.0.2.13&quot;],
            &quot;port&quot;: 3306,
            &quot;period&quot;: 1,
            &quot;response_format&quot;: &quot;in&quot;,
            &quot;timeout&quot;: 2900,
            &quot;response&quot;: null
        }</code></pre>


<h3 id="121-tcpudp-conf_listcollector_confconfig">1.2.1 拨测任务详细配置(TCP、UDP)--conf_list.collector_conf.config</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>ip_list</td>
<td>list</td>
<td>是</td>
<td>目标 IP 地址</td>
</tr>
<tr>
<td>port</td>
<td>int</td>
<td>是</td>
<td>端口地址</td>
</tr>
<tr>
<td>period</td>
<td>int</td>
<td>否</td>
<td>采集周期，单位 min，默认 1</td>
</tr>
<tr>
<td>response_format</td>
<td>str</td>
<td>否</td>
<td>响应信息匹配方式(包含：in，不包含：nin，正则：reg)，默认 in</td>
</tr>
<tr>
<td>timeout</td>
<td>int</td>
<td>否</td>
<td>期望响应时间，单位 ms，默认 3000</td>
</tr>
<tr>
<td>response</td>
<td>str</td>
<td>否</td>
<td>期望响应内容</td>
</tr>
<tr>
<td>response_code</td>
<td>str</td>
<td>否</td>
<td>期望响应码</td>
</tr>
</tbody>
</table>
<h3 id="http-config">HTTP 任务 config 示例</h3>
<pre class="codehilite"><code class="language-bash">&quot;config&quot;: {
        &quot;insecure_skip_verify&quot;: true,
        &quot;urls&quot;: &quot;http://baidu.com&quot;,
        &quot;response_code&quot;: &quot;&quot;,
        &quot;request&quot;: null,
        &quot;period&quot;: 1,
        &quot;response_format&quot;: &quot;in&quot;,
        &quot;method&quot;: &quot;GET&quot;,
        &quot;headers&quot;: [],
        &quot;timeout&quot;: 3000,
        &quot;response&quot;: null
    }</code></pre>


<h3 id="122-http-conf_listcollector_confconfig">1.2.2 拨测任务详细配置(HTTP)--conf_list.collector_conf.config</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>urls</td>
<td>str</td>
<td>是</td>
</tr>
<tr>
<td>method</td>
<td>str</td>
<td>是</td>
</tr>
<tr>
<td>headers</td>
<td>list</td>
<td>否</td>
</tr>
<tr>
<td>insecure_skip_verify</td>
<td>bool</td>
<td>否</td>
</tr>
<tr>
<td>period</td>
<td>int</td>
<td>否</td>
</tr>
<tr>
<td>response_format</td>
<td>str</td>
<td>否</td>
</tr>
<tr>
<td>timeout</td>
<td>int</td>
<td>否</td>
</tr>
<tr>
<td>response</td>
<td>str</td>
<td>否</td>
</tr>
<tr>
<td>response_code</td>
<td>str</td>
<td>否</td>
</tr>
<tr>
<td>request</td>
<td>str</td>
<td>否</td>
</tr>
</tbody>
</table>
<h3 id="13-conf_listmonitor_conf">1.3 监控策略配置--conf_list.monitor_conf</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>alarm_level_config</td>
<td>dict</td>
<td>是</td>
<td>监控触发条件配置</td>
</tr>
<tr>
<td>alarm_strategy_id</td>
<td>int</td>
<td>是</td>
<td>监控策略 ID，0</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 ID</td>
</tr>
<tr>
<td>condition</td>
<td>list</td>
<td>是</td>
<td>监控范围</td>
</tr>
<tr>
<td>display_name</td>
<td></td>
<td>是</td>
<td>监控名称</td>
</tr>
<tr>
<td>is_classify_notice</td>
<td></td>
<td>是</td>
<td>是否分级告警</td>
</tr>
<tr>
<td>is_enabled</td>
<td></td>
<td>是</td>
<td></td>
</tr>
<tr>
<td>is_recovery</td>
<td>bool</td>
<td>是</td>
<td>恢复告警开关</td>
</tr>
<tr>
<td>monitor_target</td>
<td>str</td>
<td>是</td>
<td>监控目标字段</td>
</tr>
<tr>
<td>nodata_alarm</td>
<td>int</td>
<td>是</td>
<td>无数据告警次数</td>
</tr>
<tr>
<td>node_count</td>
<td>int</td>
<td>是</td>
<td>节点平均值 / 部分节点数</td>
</tr>
<tr>
<td>rules</td>
<td>dict</td>
<td>是</td>
<td>收敛规则</td>
</tr>
<tr>
<td>scenario</td>
<td>str</td>
<td>是</td>
<td>监控场景</td>
</tr>
<tr>
<td>unit</td>
<td>str</td>
<td>是</td>
<td>监控字段单位</td>
</tr>
<tr>
<td>where_sql</td>
<td>str</td>
<td>是</td>
<td>可用于前置条件过滤 部分直接使用数据库作为源的监控支持</td>
</tr>
</tbody>
</table>
<h3 id="131-conf_listmonitor_confrules">1.3.1 收敛规则--conf_list.monitor_conf.rules</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>alarm_window</td>
<td>int</td>
<td>是</td>
<td>告警窗口</td>
</tr>
<tr>
<td>check_window</td>
<td>int</td>
<td>是</td>
<td>检测窗口</td>
</tr>
<tr>
<td>count</td>
<td>int</td>
<td>是</td>
<td>数量</td>
</tr>
</tbody>
</table>
<h3 id="132-conf_listmonitor_confalarm_level_config">1.3.2 监控触发条件配置--conf_list.monitor_conf.alarm_level_config</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>dict</td>
<td>否</td>
<td>告警级别对应的告警触发配置,表现为致命告警</td>
</tr>
<tr>
<td>2</td>
<td>dict</td>
<td>否</td>
<td>告警级别对应的告警触发配置，表现为预警告警</td>
</tr>
<tr>
<td>3</td>
<td>dict</td>
<td>否</td>
<td>告警级别对应的告警触发配置，表现为提醒告警</td>
</tr>
</tbody>
</table>
<h3 id="1321-conf_listmonitor_confalarm_level_config1">1.3.2.1 告警级别对应的告警触发配置--conf_list.monitor_conf.alarm_level_config.1</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>alarm_start_time</td>
<td>str</td>
<td>是</td>
<td>当日开始告警时间</td>
</tr>
<tr>
<td>alarm_end_time</td>
<td>str</td>
<td>是</td>
<td>当日结束告警时间</td>
</tr>
<tr>
<td>detect_algorithm</td>
<td>list</td>
<td>是</td>
<td>检测算法配置</td>
</tr>
<tr>
<td>is_recovery</td>
<td>str</td>
<td>是</td>
<td>城市</td>
</tr>
<tr>
<td>monitor_level</td>
<td>int</td>
<td>是</td>
<td>告警级别，1 致命、2 预警、3 提醒</td>
</tr>
<tr>
<td>notify_way</td>
<td>list</td>
<td>是</td>
<td>通知方式，mail 邮件、wechat 微信、sms 短信、phone 电话</td>
</tr>
<tr>
<td>phone_receiver</td>
<td>list</td>
<td>是</td>
<td>电话通知对象，账号名</td>
</tr>
<tr>
<td>responsible</td>
<td>list</td>
<td>是</td>
<td>其他通知人列表</td>
</tr>
<tr>
<td>role_list</td>
<td>list</td>
<td>是</td>
<td>通知人分组，在业务管理中配置</td>
</tr>
</tbody>
</table>
<h3 id="13211-conf_listmonitor_confalarm_level_config1detect_algorithm">1.3.2.1.1 检测算法配置--conf_list.monitor_conf.alarm_level_config.1.detect_algorithm</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>config</td>
<td>dict</td>
<td>是</td>
<td>检测算法详细配置</td>
</tr>
<tr>
<td>algorithm_id</td>
<td>int</td>
<td>是</td>
<td>检测算法 ID，静态阈值 1000、同比策略(简易) 1001、环比策略(简易)1002</td>
</tr>
</tbody>
</table>
<h3 id="132111-conf_listmonitor_confalarm_level_config1detect_algorithmconfig">1.3.2.1.1.1  检测算法详细配置(静态阈值)--conf_list.monitor_conf.alarm_level_config.1.detect_algorithm.config</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>threshold</td>
<td>int</td>
<td>是</td>
<td>比较值</td>
</tr>
<tr>
<td>method</td>
<td>str</td>
<td>是</td>
<td>比较方式</td>
</tr>
<tr>
<td>message</td>
<td>str</td>
<td>否</td>
<td>说明</td>
</tr>
</tbody>
</table>
<h3 id="132112-conf_listmonitor_confalarm_level_config1detect_algorithmconfig">1.3.2.1.1.2  检测算法详细配置(同比、环比)--conf_list.monitor_conf.alarm_level_config.1.detect_algorithm.config</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>ceil</td>
<td>int</td>
<td>是</td>
<td>大于设定值告警</td>
</tr>
<tr>
<td>floor</td>
<td>str</td>
<td>是</td>
<td>低于设定值告警</td>
</tr>
<tr>
<td>message</td>
<td>str</td>
<td>否</td>
<td>说明</td>
</tr>
</tbody>
</table>
<h3 id="_7">返回结果示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;message&quot;: &quot;OK&quot;,
    &quot;code&quot;: &quot;0&quot;,
    &quot;data&quot;: {
        &quot;failed&quot;: {
            &quot;total&quot;: 0,
            &quot;detail&quot;: [{
                        'task_name': &quot;tcp_test2&quot;,
                        'error_mes': 'xx'
                    }]
        },
        &quot;success&quot;: {
            &quot;total&quot;: 1,
            &quot;detail&quot;: [
                {
                    &quot;task_name&quot;: &quot;test_tcp1&quot;
                }
            ]
        }
    },
    &quot;result&quot;: true
}</code></pre>


<h3 id="_8">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>返回结果，true 为成功，false 为失败</td>
</tr>
<tr>
<td>code</td>
<td>int</td>
<td>返回码，200 表示成功，其他值表示失败</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>错误信息</td>
</tr>
<tr>
<td>data</td>
<td>list</td>
<td>结果</td>
</tr>
</tbody>
</table>
<h3 id="2-data">2 data</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>failed</td>
<td>dict</td>
<td>导入失败相关信息</td>
</tr>
<tr>
<td>success</td>
<td>dict</td>
<td>导入成功相关信息</td>
</tr>
</tbody>
</table>
<h2 id="21-datafailed">2.1 导入失败相关信息--data.failed</h2>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>total</td>
<td>int</td>
<td>导入失败数量</td>
</tr>
<tr>
<td>detail</td>
<td>list</td>
<td>导入失败详情</td>
</tr>
</tbody>
</table>
<h2 id="211-datafaileddetail">2.1.1 导入失败详情--data.failed.detail</h2>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>error_mes</td>
<td>str</td>
<td>导入失败原因</td>
</tr>
<tr>
<td>task_name</td>
<td>str</td>
<td>任务名</td>
</tr>
</tbody>
</table>
<h2 id="22-datasuccess">2.2 导入成功相关信息--data.success</h2>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>total</td>
<td>int</td>
<td>导入成功数量</td>
</tr>
<tr>
<td>detail</td>
<td>list</td>
<td>导入成功详情</td>
</tr>
</tbody>
</table>
<h2 id="221-datasuccessdatail">2.2.1 导入成功相关信息--data.success.datail</h2>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>task_name</td>
<td>str</td>
<td>任务名</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/monitor_v3/list_shield/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>查询屏蔽列表</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>time_range</td>
<td>string</td>
<td>时间范围</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>业务 ID</td>
</tr>
<tr>
<td>is_active</td>
<td>bool</td>
<td>是否生效</td>
</tr>
<tr>
<td>page</td>
<td>int</td>
<td>页数</td>
</tr>
<tr>
<td>page_size</td>
<td>int</td>
<td>每页数量</td>
</tr>
</tbody>
</table>
<pre class="codehilite"><code class="language-json">{
  &quot;bk_biz_id&quot;: 1,
  &quot;is_active&quot;: true,
  &quot;time_range&quot;: &quot;2018-01-01 -- 2019-01-01&quot;,
  &quot;page&quot;: 1,
  &quot;page_size&quot;: 10
}</code></pre>


<h3 id="_7">响应参数</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>业务 ID</td>
</tr>
<tr>
<td>category</td>
<td>string</td>
<td>屏蔽类型</td>
</tr>
<tr>
<td>description</td>
<td>string</td>
<td>说明</td>
</tr>
<tr>
<td>begin_time</td>
<td>string</td>
<td>开始时间</td>
</tr>
<tr>
<td>end_time</td>
<td>string</td>
<td>结束时间</td>
</tr>
<tr>
<td>cycle_config</td>
<td>dict</td>
<td>屏蔽配置</td>
</tr>
<tr>
<td>shield_notice</td>
<td>bool</td>
<td>是否发送屏蔽通知</td>
</tr>
<tr>
<td>notice_config</td>
<td>dict</td>
<td>通知配置</td>
</tr>
<tr>
<td>dimension_config</td>
<td>dict</td>
<td>屏蔽维度</td>
</tr>
<tr>
<td>id</td>
<td>int</td>
<td>屏蔽 ID</td>
</tr>
<tr>
<td>scope_type</td>
<td>string</td>
<td>范围类型</td>
</tr>
<tr>
<td>status</td>
<td>int</td>
<td>当前状态，屏蔽中(1)，过期(2)，解除(3)</td>
</tr>
<tr>
<td>failure_time</td>
<td>string</td>
<td>失效时间</td>
</tr>
<tr>
<td>content</td>
<td>string</td>
<td>屏蔽内容快照</td>
</tr>
</tbody>
</table>
<h4 id="cycleconfig">屏蔽配置(CycleConfig)</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>begin_time</td>
<td>string</td>
<td>开始时间(每天)</td>
</tr>
<tr>
<td>end_time</td>
<td>string</td>
<td>结束时间(每天)</td>
</tr>
<tr>
<td>type</td>
<td>int</td>
<td>屏蔽周期类型</td>
</tr>
<tr>
<td>day_list</td>
<td>list</td>
<td>周期为月时，需要屏蔽的天</td>
</tr>
<tr>
<td>week_list</td>
<td>list</td>
<td>周期为星期是，需要屏蔽的天</td>
</tr>
</tbody>
</table>
<h4 id="noticeconfig">通知配置(NoticeConfig)</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>notice_time</td>
<td>int</td>
<td>屏蔽开始/结束前 N 分钟通知</td>
</tr>
<tr>
<td>notice_way</td>
<td>list</td>
<td>通知类型</td>
</tr>
<tr>
<td>notice_receiver</td>
<td>list</td>
<td>通知人</td>
</tr>
</tbody>
</table>
<h4 id="_8">示例数据</h4>
<pre class="codehilite"><code class="language-json">{
    &quot;result&quot;: true,
  &quot;message&quot;: &quot;&quot;,
  &quot;data&quot;: [
    {
      &quot;id&quot;: 1,
      &quot;scope_type&quot;: &quot;instance&quot;,
      &quot;status&quot;: 1,
      &quot;category&quot;:&quot;scope&quot;,
      &quot;begin_time&quot;:&quot;2019-11-21 00:00:00&quot;,
      &quot;end_time&quot;:&quot;2019-11-23 23:59:59&quot;,
      &quot;failure_time&quot;: &quot;&quot;,
      &quot;content&quot;: &quot;&quot;,
      &quot;cycle_config&quot;:{
        &quot;begin_time&quot;:&quot;&quot;,
        &quot;end_time&quot;:&quot;&quot;,
        &quot;day_list&quot;:[],
        &quot;week_list&quot;:[],
        &quot;type&quot;:1
      },
      &quot;shield_notice&quot;:true,
      &quot;notice_config&quot;:{
        &quot;notice_time&quot;:5,
        &quot;notice_way&quot;:[&quot;weixin&quot;],
        &quot;notice_receiver&quot;:[
          {
            &quot;id&quot;:&quot;user1&quot;,
            &quot;type&quot;:&quot;user&quot;
          }
        ]
      },
      &quot;description&quot;:&quot;test&quot;,
      &quot;dimension_config&quot;:{
        &quot;scope_type&quot;:&quot;instance&quot;,
        &quot;target&quot;:[8]
      },
      &quot;bk_biz_id&quot;:2
    }
  ]
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/monitor_v3/metadata_create_cluster_info/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>创建存储集群配置
根据给定的配置参数，创建一个存储集群配置</p>
<h4 id="_4">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_5">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>cluster_name</td>
<td>string</td>
<td>是</td>
<td>存储集群名</td>
</tr>
<tr>
<td>cluster_type</td>
<td>string</td>
<td>是</td>
<td>存储集群类型, 目前可以支持 influxDB, kafka, redis, elasticsearch</td>
</tr>
<tr>
<td>domain_name</td>
<td>string</td>
<td>是</td>
<td>存储集群域名（可以填入 IP）</td>
</tr>
<tr>
<td>port</td>
<td>int</td>
<td>是</td>
<td>存储集群端口</td>
</tr>
<tr>
<td>operator</td>
<td>string</td>
<td>是</td>
<td>创建者</td>
</tr>
<tr>
<td>description</td>
<td>string</td>
<td>否</td>
<td>存储集群描述信息</td>
</tr>
<tr>
<td>auth_info</td>
<td>object</td>
<td>否</td>
<td>集群身份验证信息</td>
</tr>
<tr>
<td>version</td>
<td>string</td>
<td>否</td>
<td>集群版本信息</td>
</tr>
<tr>
<td>custom_label</td>
<td>string</td>
<td>否</td>
<td>自定义标签</td>
</tr>
<tr>
<td>schema</td>
<td>string</td>
<td>否</td>
<td>强行配置 schema，可用于配置 https 等情形</td>
</tr>
<tr>
<td>is_ssl_verify</td>
<td>bool</td>
<td>否</td>
<td>是否需要跳过 SSL\TLS 认证</td>
</tr>
</tbody>
</table>
<h4 id="_6">请求示例</h4>
<pre class="codehilite"><code class="language-json">{
    &quot;cluster_name&quot;: &quot;first_influxdb&quot;,
    &quot;cluster_type&quot;: &quot;influxDB&quot;,
    &quot;domain_name&quot;: &quot;influxdb.service.consul&quot;,
    &quot;operator&quot;: &quot;admin&quot;,
    &quot;auth_info&quot;: {
      &quot;username&quot;: &quot;username&quot;,
      &quot;password&quot;: &quot;password&quot;
    },
    &quot;port&quot;: 9052,
    &quot;description&quot;: &quot;描述信息&quot;
}</code></pre>


<h3 id="_7">返回结果</h3>
<h4 id="_8">字段说明</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>cluster_id</td>
<td>int</td>
<td>集群 ID</td>
</tr>
</tbody>
</table>
<h4 id="_9">结果示例</h4>
<pre class="codehilite"><code class="language-json">{
    &quot;message&quot;:&quot;OK&quot;,
    &quot;code&quot;:&quot;0&quot;,
    &quot;data&quot;:{
        &quot;cluster_id&quot;: 1001
    },
    &quot;result&quot;:true,
    &quot;request_id&quot;:&quot;408233306947415bb1772a86b9536867&quot;
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/monitor_v3/metadata_create_data_id/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>创建数据源
根据给定的配置参数，创建一个数据源</p>
<h4 id="_4">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_5">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>data_name</td>
<td>string</td>
<td>是</td>
<td>数据源名称</td>
</tr>
<tr>
<td>etl_config</td>
<td>string</td>
<td>是</td>
<td>清洗模板配置，prometheus exportor 对应"prometheus"</td>
</tr>
<tr>
<td>operator</td>
<td>string</td>
<td>是</td>
<td>操作者</td>
</tr>
<tr>
<td>mq_cluster</td>
<td>int</td>
<td>否</td>
<td>数据源使用的消息集群</td>
</tr>
<tr>
<td>data_description</td>
<td>string</td>
<td>否</td>
<td>数据源的具体描述</td>
</tr>
<tr>
<td>is_custom_source</td>
<td>bool</td>
<td>否</td>
<td>是否用户自定义数据源，默认为是</td>
</tr>
<tr>
<td>source_label</td>
<td>string</td>
<td>是</td>
<td>数据来源标签，例如：计算平台(bk_data)，监控采集器(bk_monitor_collector)</td>
</tr>
<tr>
<td>type_label</td>
<td>string</td>
<td>是</td>
<td>数据类型标签，例如：时序数据(time_series)，事件数据(event)，日志数据(log)</td>
</tr>
<tr>
<td>custom_label</td>
<td>string</td>
<td>否</td>
<td>自定义标签配置信息</td>
</tr>
<tr>
<td>option</td>
<td>string</td>
<td>否</td>
<td>数据源配置选项内容，格式为{<code>option_name</code>: <code>option_value</code>}</td>
</tr>
</tbody>
</table>
<p><strong>注意</strong>： 上述的<code>source_tag</code>及<code>data_type</code>都应该通过<code>metadata_get_label</code>接口获取，不应该自行创建 </p>
<h4 id="_6">目前数据源可以选择的选项包括</h4>
<table>
<thead>
<tr>
<th>选项名</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>group_info_alias</td>
<td>string</td>
<td>分组标识字段别名</td>
</tr>
<tr>
<td>encoding</td>
<td>string</td>
<td>上报数据编码</td>
</tr>
<tr>
<td>separator</td>
<td>string</td>
<td>分隔符， 用于分割上报日志的字符内容</td>
</tr>
<tr>
<td>separator_field_list</td>
<td>list</td>
<td>分割后字段分配</td>
</tr>
</tbody>
</table>
<h4 id="_7">请求示例</h4>
<pre class="codehilite"><code class="language-json">{
    &quot;data_name&quot;: &quot;basereport&quot;,
    &quot;etl_config&quot;: &quot;basereport&quot;,
    &quot;operator&quot;: &quot;username&quot;,
    &quot;data_description&quot;: &quot;basereport data source&quot;,
    &quot;type_label&quot;: &quot;time_series&quot;,
    &quot;source_label&quot;: &quot;bk_monitor_collector&quot;
}</code></pre>


<h3 id="_8">返回结果</h3>
<h4 id="_9">字段说明</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_data_id</td>
<td>int</td>
<td>结果表 ID</td>
</tr>
</tbody>
</table>
<h4 id="_10">结果示例</h4>
<pre class="codehilite"><code class="language-json">{
    &quot;message&quot;:&quot;OK&quot;,
    &quot;code&quot;:&quot;0&quot;,
    &quot;data&quot;:{
        &quot;bk_data_id&quot;: 1001
    },
    &quot;result&quot;:true,
    &quot;request_id&quot;:&quot;408233306947415bb1772a86b9536867&quot;
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/monitor_v3/metadata_create_event_group/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>创建一个事件分组 ID
给定一个数据源和业务，创建一个归属的事件分组 ID</p>
<h4 id="_4">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_5">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_data_id</td>
<td>int</td>
<td>是</td>
<td>数据源 ID</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 ID</td>
</tr>
<tr>
<td>event_group_name</td>
<td>string</td>
<td>是</td>
<td>事件分组名</td>
</tr>
<tr>
<td>label</td>
<td>string</td>
<td>是</td>
<td>事件分组标签，用于表示事件监控对象，应该复用【result_table_label】类型下的标签</td>
</tr>
<tr>
<td>operator</td>
<td>string</td>
<td>是</td>
<td>操作者</td>
</tr>
<tr>
<td>event_info_list</td>
<td>array</td>
<td>否</td>
<td>事件列表</td>
</tr>
</tbody>
</table>
<h4 id="event_info_list">event_info_list 具体内容说明</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>event_name</td>
<td>string</td>
<td>事件名</td>
</tr>
<tr>
<td>dimension</td>
<td>array</td>
<td>维度列表</td>
</tr>
</tbody>
</table>
<h4 id="_6">请求示例</h4>
<pre class="codehilite"><code class="language-json">{
    &quot;bk_data_id&quot;: 123,
    &quot;bk_biz_id&quot;: 123,
    &quot;event_group_name&quot;: &quot;事件分组名&quot;,
    &quot;label&quot;: &quot;application&quot;,
    &quot;operator&quot;: &quot;system&quot;,
    &quot;event_info_list&quot;: [{
      &quot;event_name&quot;: &quot;usage for update&quot;,
      &quot;dimension_list&quot;: [&quot;dimension_name&quot;]
    },{
      &quot;event_name&quot;: &quot;usage for create&quot;,
      &quot;dimension_list&quot;: [&quot;dimension_name&quot;]
    }]
}</code></pre>


<h3 id="_7">返回结果</h3>
<h4 id="_8">字段说明</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_group_id</td>
<td>int</td>
<td>新建的事件分组 ID</td>
</tr>
</tbody>
</table>
<h4 id="_9">结果示例</h4>
<pre class="codehilite"><code class="language-json">{
    &quot;message&quot;:&quot;OK&quot;,
    &quot;code&quot;:&quot;0&quot;,
    &quot;data&quot;: {
        &quot;event_group_id&quot;: 1001,
        &quot;bk_data_id&quot;: 123,
        &quot;bk_biz_id&quot;: 123,
        &quot;event_group_name&quot;: &quot;事件分组名&quot;,
        &quot;label&quot;: &quot;application&quot;,
        &quot;is_enable&quot;: true,
        &quot;creator&quot;: &quot;admin&quot;,
        &quot;create_time&quot;: &quot;2019-10-10 10:10:10&quot;,
        &quot;last_modify_user&quot;: &quot;admin&quot;,
        &quot;last_modify_time&quot;: &quot;2020-10-10 10:10:10&quot;,
        &quot;event_info_list&quot;: [{
          &quot;bk_event_id&quot;: 1,
          &quot;event_name&quot;: &quot;usage for update&quot;,
          &quot;dimension_list&quot;: [{
            &quot;dimension_name&quot;: &quot;field_name&quot;
          }]
        },{
          &quot;bk_event_id&quot;: 2,
          &quot;event_name&quot;: &quot;usage for create&quot;,
          &quot;dimension_list&quot;: [{
            &quot;dimension_name&quot;: &quot;field_name&quot;
          }]
        }]
    },
    &quot;result&quot;:true,
    &quot;request_id&quot;:&quot;408233306947415bb1772a86b9536867&quot;
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/monitor_v3/metadata_create_result_table/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>创建结果表
根据给定的配置参数，创建一个结果表</p>
<h4 id="_4">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_5">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>是否必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_data_id</td>
<td>int</td>
<td>是</td>
<td>数据源 ID</td>
</tr>
<tr>
<td>table_id</td>
<td>string</td>
<td>是</td>
<td>结果表 ID，格式应该为 库.表(例如，system.cpu)</td>
</tr>
<tr>
<td>table_name_zh</td>
<td>string</td>
<td>是</td>
<td>结果表中文名</td>
</tr>
<tr>
<td>is_custom_table</td>
<td>boolean</td>
<td>是</td>
<td>是否用户自定义结果表</td>
</tr>
<tr>
<td>schema_type</td>
<td>string</td>
<td>是</td>
<td>结果表字段配置方案, free(无 schema 配置), fixed(固定 schema)</td>
</tr>
<tr>
<td>operator</td>
<td>string</td>
<td>是</td>
<td>操作者</td>
</tr>
<tr>
<td>default_storage</td>
<td>string</td>
<td>是</td>
<td>默认存储类型，目前支持 influxdb</td>
</tr>
<tr>
<td>default_storage_config</td>
<td>object</td>
<td>否</td>
<td>默认的存储信息, 根据每种不同的存储，会有不同的配置内容, 如果不提供则会使用默认值；具体内容请参考下面的具体说明</td>
</tr>
<tr>
<td>field_list</td>
<td>array</td>
<td>否</td>
<td>字段信息，数组元素为 object，例如，字段有 field_name(字段名), field_type(字段类型), tag(字段类型, metirc -- 指标, dimension -- 维度), alias_name(字段别名)</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>否</td>
<td>业务 ID，如果不提供，默认是 0（全业务）结果表;如果非零时，将会校验结果表命名规范</td>
</tr>
<tr>
<td>label</td>
<td>string</td>
<td>是</td>
<td>结果表标签，此处记录的是二级标签，对应一级标签将由二级标签推导得到</td>
</tr>
<tr>
<td>external_storage</td>
<td>object</td>
<td>否</td>
<td _storage_95_type="${storage_type">额外存储配置，格式为</td>
</tr>
<tr>
<td>is_time_field_only</td>
<td>bool</td>
<td>否</td>
<td>默认字段是否仅需要 time，默认为 False</td>
</tr>
<tr>
<td>option</td>
<td>object</td>
<td>否</td>
<td>结果表的额外配置信息，格式为{<code>option_name</code>: <code>option_value</code>}</td>
</tr>
<tr>
<td>time_alias_name</td>
<td>string</td>
<td>否</td>
<td>时间字段上传时需要使用其他字段名</td>
</tr>
</tbody>
</table>
<p><strong>注意</strong>： 上述的<code>label</code>都应该通过<code>metadata_get_label</code>接口获取，不应该自行创建</p>
<h4 id="_6">目前结果表可以选择的选项包括</h4>
<table>
<thead>
<tr>
<th>选项名</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>cmdb_level_config</td>
<td>list</td>
<td>CMDB 层级拆分配置</td>
</tr>
<tr>
<td>group_info_alias</td>
<td>string</td>
<td>分组标识字段别名</td>
</tr>
<tr>
<td>es_unique_field_list</td>
<td>list</td>
<td>ES 生成 doc_id 的字段列表</td>
</tr>
</tbody>
</table>
<h6 id="default95storage_config-storage_config-influxdb">参数: default_storage_config 及 storage_config -- 在 influxdb 下支持的参数</h6>
<p>| 键值 | 类型 | 是否必选 | 默认值 |描述 |
| ---- | --- | --- |
| storage_cluster_id | int | 否 | 使用该存储类型的默认存储集群  | 指定存储集群 |
| database | string | 否 | table_id 的点分第一部分 | 存储的数据库 |
| real_table_name | string | 否 | table_id 的点分第二部分 | 实际存储表名 |
| source_duration_time | string | 否 | 30d | 元数据保存时间, 需要符合 influxdb 格式 |</p>
<h6 id="default95storage_config-storage_config-kafka">参数: default_storage_config 及 storage_config -- 在 kafka 下支持的参数</h6>
<p>| 键值 | 类型 | 是否必选 | 默认值 |描述 |
| ---- | --- | --- |
| storage_cluster_id | int | 否 | 使用该存储类型的默认存储集群  | 指定存储集群 |
| topic | string | 否 | 0bkmonitor_storage_${table_id} | 存储的 topic 配置 |
| partition | int | 否 | 1 | 存储 partition 数量，注意：此处只是记录，如果是超过 1 个 topic 的配置，需要手动通过 kafka 命令行工具进行扩容 |
| retention | int | 否 | 1800000 | kafka 数据保存时长，默认是半小时，单位 ms |</p>
<h6 id="default95storage_config-storage_config-redis">参数: default_storage_config 及 storage_config -- 在 redis 下支持的参数</h6>
<p>| 键值 | 类型 | 是否必选 | 默认值 |描述 |
| ---- | --- | --- |
| storage_cluster_id | int | 否 | 使用该存储类型的默认存储集群  | 指定存储集群 |
| key | string | 否 | table_id 名字 | 存储键值 |
| db | int | 否 | 0 |使用 db 配置 |
| command | string | 否 | PUBLISH | 存储命令 |
| is_sentinel | bool | 否 | False | 是否哨兵模式 |
| master_name | string | 否 | "" | 哨兵模式下 master 名称 |</p>
<p><strong>注意</strong>: 由于 redis 默认使用队列方式，消费后就丢弃，因此未有时长配置</p>
<h6 id="default95storage_config-storage_config-elasticsearch">参数: default_storage_config 及 storage_config -- 在 elasticsearch 下支持的参数</h6>
<p>| 键值 | 类型 | 是否必选 | 默认值 |描述 |
| ---- | --- | --- |
| storage_cluster_id | int | 否 | - |使用该存储类型的默认存储集群
| retention | int | 否 |  30 |  保留 index 时间，单位为天，默认保留 30 天 |
| date_format | string | 否 | %Y%m%d%H | 时间格式，默认具体到小时 |
| slice_size | int | 否 | 500 | 需要切分的大小阈值，单位为 GB，默认为 500GB |
| slice_gap | int | 否 | 120 | index 分片时间间隔，单位分钟，默认 2 小时 |
| index_settings | string | 是 | - | 索引创建配置, json 格式 |
| mapping_settings | string | 否 | - | 索引 mapping 配置，<strong>不包含字段定义</strong>， json 格式 |</p>
<p><strong>注意</strong>: 实际 index 构造方式为<code>${table_id}_${date_format}_${current_index}</code></p>
<h6 id="field_list">参数: field_list 的具体参数说明</h6>
<p>| 键值 | 类型 | 是否必选 | 默认值 |描述 |
| ---- | --- | --- |
| field_name | string | 是 | - | 字段名 |
| field_type | string | 是 | - |  字段类型，可以为 float, string, boolean 和 timestamp |
| description | string | 否 | "" |  字段描述信息 |
| tag | string | 是 | - | 字段标签，可以为 metric, dimemsion, timestamp, group |
| alias_name | string | 否 | None | 入库别名 |
| option | string | 否 | {} | 字段选项配置，键为选项名，值为选项配置 |
| is_config_by_user | bool | 是 | true | 用户是否启用该字段配置 |</p>
<p>目前可以选择的 option 包括：
| 选项名 | 类型 | 描述 |
| -------------- | ------ | ----------- |
| es_type | string | es 配置：映射实际字段类型 |
| es_include_in_all | bool | es 配置：是否包含到_all 字段中 |
| es_format | string | es 配置：时间格式 |
| es_doc_values | bool | es 配置：是否维度 |
| es_index | string | es 配置：是否分词，值可以为 true 或 false |
| time_format | string | 数据源时间格式，供 Transfer 解析上报时间 |
| time_zone | int | 时区配置，供 Transfer 解析上报时间为 UTC，取值范围[-12, +12] |</p>
<h4 id="_7">请求示例</h4>
<pre class="codehilite"><code class="language-json">{
    &quot;bk_data_id&quot;: 1001,
    &quot;table_id&quot;: &quot;system.cpu_detail&quot;,
    &quot;table_name_zh&quot;: &quot;CPU记录&quot;,
    &quot;is_custom_table&quot;: true,
    &quot;schema_type&quot;: &quot;fixed&quot;,
    &quot;operator&quot;: &quot;username&quot;,
    &quot;default_storage&quot;: &quot;influxdb&quot;,
    &quot;default_storage_config&quot;: {
        &quot;storage&quot;: 1,
        &quot;source_duration_time&quot;: &quot;30d&quot;
    }
    &quot;field_list&quot;: [{
        &quot;field_name&quot;: &quot;usage&quot;,
        &quot;field_type&quot;: &quot;double&quot;,
        &quot;description&quot;: &quot;field description&quot;
        &quot;tag&quot;: &quot;metric&quot;,
        &quot;alias_name&quot;: &quot;usage_alias&quot;,
        &quot;option&quot;: [],
        &quot;is_config_by_user&quot;: true
    }],
    &quot;label&quot;: &quot;OS&quot;,
    &quot;external_storage&quot;: {
        &quot;kafka&quot;: {
            &quot;expired_time&quot;: 1800000
        }
    }
}</code></pre>


<h3 id="_8">返回结果</h3>
<h4 id="_9">字段说明</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>table_id</td>
<td>string</td>
<td>结果表 ID</td>
</tr>
<tr>
<td>#### 结果示例</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<pre class="codehilite"><code class="language-json">{
    &quot;message&quot;:&quot;OK&quot;,
    &quot;code&quot;:&quot;0&quot;,
    &quot;data&quot;:{
        &quot;table_id&quot;: &quot;system.cpu_detail&quot;
    },
    &quot;result&quot;:true,
    &quot;request_id&quot;:&quot;408233306947415bb1772a86b9536867&quot;
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/monitor_v3/metadata_create_result_table_metric_split/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>创建一个结果表 CMDB 拆分任务
根据给定的数据源 ID，返回这个结果表的具体信息</p>
<h4 id="_4">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_5">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>table_id</td>
<td>string</td>
<td>是</td>
<td>结果表 ID</td>
</tr>
<tr>
<td>cmdb_level</td>
<td>string</td>
<td>是</td>
<td>CMDB 拆分层级名</td>
</tr>
<tr>
<td>operator</td>
<td>string</td>
<td>是</td>
<td>操作者</td>
</tr>
</tbody>
</table>
<h4 id="_6">请求示例</h4>
<pre class="codehilite"><code class="language-json">{
    &quot;table_id&quot;: &quot;system.cpu_summary&quot;,
    &quot;cmdb_level: &quot;set&quot;,
    &quot;operator&quot;: &quot;admin&quot;
}</code></pre>


<h3 id="_7">返回结果</h3>
<h4 id="_8">字段说明</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_data_id</td>
<td>int</td>
<td>新创建的数据源 ID</td>
</tr>
<tr>
<td>table_id</td>
<td>string</td>
<td>新创建的结果表 ID</td>
</tr>
</tbody>
</table>
<h4 id="_9">结果示例</h4>
<pre class="codehilite"><code class="language-json">{
    &quot;message&quot;:&quot;OK&quot;,
    &quot;code&quot;:&quot;0&quot;,
    &quot;data&quot;:{
        &quot;bk_data_id&quot;: 1001,
        &quot;table_id&quot;: &quot;system.cpu_summary_cmdb_level&quot;
    },
    &quot;result&quot;:true,
    &quot;request_id&quot;:&quot;408233306947415bb1772a86b9536867&quot;
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/monitor_v3/metadata_create_time_series_group/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/monitor_v3/metadata_delete_event_group/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>删除一个事件分组
给定一个事件分组 ID，删除之</p>
<h4 id="_4">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_5">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>event_group_id</td>
<td>int</td>
<td>是</td>
<td>事件分组 ID</td>
</tr>
<tr>
<td>operator</td>
<td>string</td>
<td>是</td>
<td>操作者</td>
</tr>
</tbody>
</table>
<h4 id="_6">请求示例</h4>
<pre class="codehilite"><code class="language-json">{
    &quot;event_group_id&quot;: 123,
    &quot;operator&quot;: &quot;admin&quot;
}</code></pre>


<h3 id="_7">返回结果</h3>
<h4 id="_8">结果示例</h4>
<pre class="codehilite"><code class="language-json">{
    &quot;message&quot;:&quot;OK&quot;,
    &quot;code&quot;:&quot;0&quot;,
    &quot;data&quot;: { },
    &quot;result&quot;:true,
    &quot;request_id&quot;:&quot;408233306947415bb1772a86b9536867&quot;
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/monitor_v3/metadata_delete_time_series_group/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/monitor_v3/metadata_get_cluster_info/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/monitor_v3/metadata_get_data_id/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>查询一个数据源的 ID
根据给定的数据源 ID，返回这个结果表的具体信息</p>
<h4 id="_4">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_5">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_data_id</td>
<td>int</td>
<td>否</td>
<td>数据源 ID</td>
</tr>
<tr>
<td>data_name</td>
<td>string</td>
<td>否</td>
<td>数据源名称</td>
</tr>
</tbody>
</table>
<blockquote>
<p>注意：
1. 上述两个必须提供一个，不可以两者同时为空;
2. 当 bk_data_id 提供时，data_name 无效</p>
</blockquote>
<h4 id="_6">请求示例</h4>
<pre class="codehilite"><code class="language-json">{
    &quot;bk_data_id&quot;: 1001
}</code></pre>


<h3 id="_7">返回结果</h3>
<h4 id="_8">字段说明</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_data_id</td>
<td>int</td>
<td>数据源 ID</td>
</tr>
<tr>
<td>data_name</td>
<td>string</td>
<td>数据源名称</td>
</tr>
<tr>
<td>data_description</td>
<td>string</td>
<td>数据源描述</td>
</tr>
<tr>
<td>mq_cluster_info</td>
<td>object</td>
<td>消息队列集群信息, 样例会有具体描述</td>
</tr>
<tr>
<td>etl_config</td>
<td>string</td>
<td>清洗配置名称</td>
</tr>
<tr>
<td>is_custom_source</td>
<td>boolean</td>
<td>是否用户自定义数据源</td>
</tr>
<tr>
<td>creator</td>
<td>string</td>
<td>创建者</td>
</tr>
<tr>
<td>create_time</td>
<td>string</td>
<td>创建时间, 格式为【2018-10-10 10:00:00】</td>
</tr>
<tr>
<td>last_modify_user</td>
<td>string</td>
<td>最后修改者</td>
</tr>
<tr>
<td>last_modify_time</td>
<td>string</td>
<td>最后修改时间【2018-10-10 10:00:00】</td>
</tr>
<tr>
<td>token</td>
<td>string</td>
<td>dataID 的验证码</td>
</tr>
</tbody>
</table>
<h4 id="_9">结果示例</h4>
<pre class="codehilite"><code class="language-json">{
    &quot;message&quot;:&quot;OK&quot;,
    &quot;code&quot;:&quot;0&quot;,
    &quot;data&quot;:{
        &quot;bk_data_id&quot;: 1001,
        &quot;data_name&quot;: &quot;基础数据&quot;,
        &quot;data_description&quot;: &quot;基础数据数据源&quot;,
        &quot;mq_cluster_info&quot;: {
            &quot;storage_config&quot;: {
               &quot;topic&quot;: &quot;bk_monitor_1001&quot;,
               &quot;partition&quot;: 1,
           },
            &quot;cluster_config&quot;: {
               &quot;domain_name&quot;: &quot;kafka.domain.cluster&quot;,
               &quot;port&quot;: 80,
           },
           &quot;cluster_type&quot;: &quot;kafka&quot;
        },
        &quot;etl_config&quot;: &quot;basereport&quot;,
        &quot;is_custom_source&quot;: false,
        &quot;creator&quot;: &quot;username&quot;,
        &quot;create_time&quot;: &quot;2018-10-10 10:10:10&quot;,
        &quot;last_modify_user&quot;: &quot;username&quot;,
        &quot;last_modify_time&quot;: &quot;2018-10-10 10:10:10&quot;,
        &quot;source_label&quot;: &quot;bk_monitor_collector&quot;,
        &quot;type_label&quot;: &quot;time_series&quot;,
        &quot;token&quot;: &quot;5dc2353d913c45bea43dd8d931745a05&quot;
    },
    &quot;result&quot;:true,
    &quot;request_id&quot;:&quot;408233306947415bb1772a86b9536867&quot;
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/monitor_v3/metadata_get_event_group/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>查询一个事件分组 ID
给定一个数据源和业务， 查询器具体的信息</p>
<h4 id="_4">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_5">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>event_group_id</td>
<td>int</td>
<td>是</td>
<td>事件分组 ID</td>
</tr>
<tr>
<td>with_result_table_info</td>
<td>bool</td>
<td>否</td>
<td>事件分组存储信息</td>
</tr>
</tbody>
</table>
<h4 id="_6">请求示例</h4>
<pre class="codehilite"><code class="language-json">{
    &quot;event_group_id&quot;: 123,
    &quot;with_result_table_info&quot;: true
}</code></pre>


<h3 id="_7">返回结果</h3>
<h4 id="_8">字段说明</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_event_group_id</td>
<td>int</td>
<td>事件分组 ID</td>
</tr>
<tr>
<td>bk_data_id</td>
<td>int</td>
<td>数据源 ID</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>业务 ID</td>
</tr>
<tr>
<td>event_group_name</td>
<td>string</td>
<td>事件分组名</td>
</tr>
<tr>
<td>label</td>
<td>string</td>
<td>事件标签</td>
</tr>
<tr>
<td>is_enable</td>
<td>bool</td>
<td>是否启用</td>
</tr>
<tr>
<td>creator</td>
<td>string</td>
<td>创建者</td>
</tr>
<tr>
<td>create_time</td>
<td>string</td>
<td>创建时间</td>
</tr>
<tr>
<td>last_modify_user</td>
<td>string</td>
<td>最后修改者</td>
</tr>
<tr>
<td>last_modify_time</td>
<td>string</td>
<td>最后修改时间</td>
</tr>
<tr>
<td>event_info_list</td>
<td>array</td>
<td>事件列表</td>
</tr>
<tr>
<td>shipper_list</td>
<td>object</td>
<td>结果表配置信息</td>
</tr>
</tbody>
</table>
<h4 id="event_info_list">event_info_list 具体内容说明</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_event_id</td>
<td>int</td>
<td>事件 ID</td>
</tr>
<tr>
<td>event_name</td>
<td>string</td>
<td>事件名</td>
</tr>
<tr>
<td>dimension</td>
<td>array</td>
<td>维度列表, 元素为维度明</td>
</tr>
</tbody>
</table>
<h4 id="_9">结果示例</h4>
<pre class="codehilite"><code class="language-json">{
    &quot;message&quot;:&quot;OK&quot;,
    &quot;code&quot;:&quot;0&quot;,
    &quot;data&quot;: {
        &quot;event_group_id&quot;: 1001,
        &quot;bk_data_id&quot;: 123,
        &quot;bk_biz_id&quot;: 123,
        &quot;event_group_name&quot;: &quot;事件分组名&quot;,
        &quot;label&quot;: &quot;application&quot;,
        &quot;is_enable&quot;: true,
        &quot;creator&quot;: &quot;admin&quot;,
        &quot;create_time&quot;: &quot;2019-10-10 10:10:10&quot;,
        &quot;last_modify_user&quot;: &quot;admin&quot;,
        &quot;last_modify_time&quot;: &quot;2020-10-10 10:10:10&quot;,
        &quot;event_info_list&quot;: [{
          &quot;bk_event_id&quot;: 1,
          &quot;event_name&quot;: &quot;usage for update&quot;,
          &quot;dimension_list&quot;: [&quot;dimension_name&quot;]
        },{
          &quot;bk_event_id&quot;: 2,
          &quot;event_name&quot;: &quot;usage for create&quot;,
          &quot;dimension_list&quot;: [&quot;dimension_name&quot;]
        }],
        &quot;shipper_list&quot;: [{
            &quot;cluster_info&quot;: {
                &quot;domain_name&quot;: &quot;es.service.consul&quot;,
                &quot;port&quot;: 8000
            },
            &quot;cluster_type&quot;: &quot;es&quot;
        }]
    },
    &quot;result&quot;:true,
    &quot;request_id&quot;:&quot;408233306947415bb1772a86b9536867&quot;
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/monitor_v3/metadata_get_result_table/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>查询一个结果表的信息
根据给定的结果表 ID，返回这个结果表的具体信息</p>
<h4 id="_4">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_5">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>table_id</td>
<td>string</td>
<td>是</td>
<td>结果表 ID</td>
</tr>
</tbody>
</table>
<h4 id="_6">请求示例</h4>
<pre class="codehilite"><code class="language-json">{
    &quot;table_id&quot;: &quot;system.cpu&quot;
}</code></pre>


<h3 id="_7">返回结果</h3>
<h4 id="_8">字段说明</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>table_id</td>
<td>int</td>
<td>结果表 ID</td>
</tr>
<tr>
<td>table_name_zh</td>
<td>string</td>
<td>结果表中文名</td>
</tr>
<tr>
<td>is_custom_table</td>
<td>boolean</td>
<td>是否自定义结果表</td>
</tr>
<tr>
<td>schema_type</td>
<td>string</td>
<td>结果表 schema 配置方案，free(无 schema 配置), dynamic(动态 schema), fixed(固定 schema)</td>
</tr>
<tr>
<td>default_storage</td>
<td>string</td>
<td>默认存储方案</td>
</tr>
<tr>
<td>storage_list</td>
<td>array</td>
<td>所有存储列表，元素为 string</td>
</tr>
<tr>
<td>creator</td>
<td>string</td>
<td>创建者</td>
</tr>
<tr>
<td>create_time</td>
<td>string</td>
<td>创建时间, 格式为【2018-10-10 10:00:00】</td>
</tr>
<tr>
<td>last_modify_user</td>
<td>string</td>
<td>最后修改者</td>
</tr>
<tr>
<td>last_modify_time</td>
<td>string</td>
<td>最后修改时间【2018-10-10 10:00:00】</td>
</tr>
</tbody>
</table>
<h4 id="_9">结果示例</h4>
<pre class="codehilite"><code class="language-json">{
    &quot;message&quot;:&quot;OK&quot;,
    &quot;code&quot;:&quot;0&quot;,
    &quot;data&quot;:{
        &quot;table_id&quot;: &quot;system.cpu&quot;,
        &quot;table_name_zh&quot;: &quot;结果表名&quot;,
        &quot;is_custom_table&quot;: false,
        &quot;scheme_type&quot;: &quot;fixed&quot;,
        &quot;default_storage&quot;: &quot;influxdb&quot;,
        &quot;storage_list&quot;: [&quot;influxdb&quot;],
        &quot;creator&quot;: &quot;username&quot;,
        &quot;create_time&quot;: &quot;2018-10-10 10:10:10&quot;,
        &quot;last_modify_user&quot;: &quot;username&quot;,
        &quot;last_modify_time&quot;: &quot;2018-10-10 10:10:10&quot;,
        &quot;field_list&quot;: [{
            &quot;field_name&quot;: &quot;usage&quot;,
            &quot;field_type&quot;: &quot;float&quot;,
            &quot;tag&quot;: &quot;dimension&quot;,
            &quot;description&quot;: &quot;CPU用量&quot;
            &quot;is_config_by_user&quot;: true
        }],
        &quot;bk_biz_id&quot;: 0,
        &quot;label&quot;: &quot;OS&quot;
    },
    &quot;result&quot;:true,
    &quot;request_id&quot;:&quot;408233306947415bb1772a86b9536867&quot;
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/monitor_v3/metadata_get_result_table_storage/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>查询一个结果表的指定存储信息
根据给定的结果表 ID，返回这个结果表的具体存储集群信息</p>
<h4 id="_4">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_5">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result_table_list</td>
<td>string</td>
<td>是</td>
<td>结果表 ID</td>
</tr>
<tr>
<td>storage_type</td>
<td>string</td>
<td>是</td>
<td>存储类型</td>
</tr>
</tbody>
</table>
<h4 id="_6">请求示例</h4>
<pre class="codehilite"><code class="language-json">{
    &quot;result_table_list&quot;: &quot;system.cpu&quot;,
    &quot;storage_type&quot;: &quot;elasticsearch&quot;
}</code></pre>


<h3 id="_7">返回结果</h3>
<h4 id="_8">字段说明</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>table_id</td>
<td>int</td>
<td>结果表 ID</td>
</tr>
<tr>
<td>storage_info</td>
<td>array</td>
<td>存储集群信息</td>
</tr>
</tbody>
</table>
<h6 id="storage_info">对于 storage_info，各个元素内容说明如下</h6>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>storage_config</td>
<td>object</td>
<td>存储集群特性，各个存储下字段不一致</td>
</tr>
<tr>
<td>cluster_config</td>
<td>object</td>
<td>存储集群信息</td>
</tr>
<tr>
<td>cluster_type</td>
<td>string</td>
<td>存储集群类型</td>
</tr>
<tr>
<td>auth_info</td>
<td>object</td>
<td>身份认证信息</td>
</tr>
</tbody>
</table>
<h4 id="_9">结果示例</h4>
<pre class="codehilite"><code class="language-json">{
    &quot;message&quot;:&quot;OK&quot;,
    &quot;code&quot;:&quot;0&quot;,
    &quot;data&quot;:{
        &quot;system.cpu&quot;: {
            &quot;table_id&quot;: &quot;system.cpu&quot;,
            &quot;storage_info&quot;: [{
                &quot;storage_config&quot;: {
                    &quot;index_datetime_format&quot;: &quot;%Y%m%h&quot;, 
                    &quot;slice_size&quot;: 400,
                    &quot;slice_gap&quot;: 120,
                    &quot;retention&quot;: 30
                },
                &quot;cluster_config&quot;: {
                    &quot;domain_name&quot;: &quot;service.consul&quot;,
                    &quot;port&quot;: 1000,
                    &quot;schema&quot;: &quot;http&quot;,
                    &quot;is_ssl_verify&quot;: false,
                    &quot;cluster_id&quot;: 1,
                    &quot;cluster_name&quot;: &quot;default_es_storage&quot;
                },
                &quot;cluster_type&quot;: &quot;elasticsearch&quot;,
                &quot;auth_info&quot;: {
                    &quot;username&quot;: &quot;admin&quot;,
                    &quot;password&quot;: &quot;password&quot;
                }
            }]
        }

    },
    &quot;result&quot;:true,
    &quot;request_id&quot;:&quot;408233306947415bb1772a86b9536867&quot;
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/monitor_v3/metadata_get_time_series_group/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/monitor_v3/metadata_get_time_series_metrics/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/monitor_v3/metadata_list_label/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>获取数据标签 
根据请求的参数，返回各个请求数据标签，包含了数据源标签及结果表各级标签</p>
<h4 id="_4">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_5">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>label_type</td>
<td>string</td>
<td>否</td>
<td>标签分类，<code>source_label</code>, <code>type_label</code> or <code>result_table_label</code></td>
</tr>
<tr>
<td>level</td>
<td>int</td>
<td>否</td>
<td>标签层级, 层级从 1 开始计算, 该配置只在<code>label_type</code>为<code>result_table</code>时生效</td>
</tr>
<tr>
<td>include_admin_only</td>
<td>bool</td>
<td>否</td>
<td>是否展示管理员可见标签</td>
</tr>
</tbody>
</table>
<h4 id="_6">请求示例</h4>
<pre class="codehilite"><code class="language-json">{
    &quot;level&quot;: 1,
    &quot;label_type&quot;: &quot;source_label&quot;
}</code></pre>


<h3 id="_7">返回结果</h3>
<h4 id="_8">字段说明</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>label_id</td>
<td>string</td>
<td>标签 ID（英文名）</td>
</tr>
<tr>
<td>label_name</td>
<td>string</td>
<td>标签名（中文名）</td>
</tr>
<tr>
<td>label_type</td>
<td>string</td>
<td>标签分类</td>
</tr>
<tr>
<td>level</td>
<td>int</td>
<td>标签层级</td>
</tr>
<tr>
<td>parent_label</td>
<td>string</td>
<td>父级标签 ID</td>
</tr>
<tr>
<td>index</td>
<td>int</td>
<td>标签在同 level 下的排序顺序</td>
</tr>
</tbody>
</table>
<h4 id="_9">结果示例</h4>
<pre class="codehilite"><code class="language-json">{
    &quot;message&quot;:&quot;OK&quot;,
    &quot;code&quot;:&quot;0&quot;,
    &quot;data&quot;: {
        &quot;source_label&quot;: [{
            &quot;label_id&quot;: &quot;bk_monitor_collector&quot;,
            &quot;label_name&quot;: &quot;蓝鲸监控采集器&quot;,
            &quot;label_type&quot;: &quot;source_label&quot;,
            &quot;level&quot;: null,
            &quot;parent_label&quot;: null,
            &quot;index&quot;: 0
        }],
        &quot;type_label&quot;: [{
            &quot;label_id&quot;: &quot;time_series&quot;,
            &quot;label_name&quot;: &quot;时序数据&quot;,
            &quot;label_type&quot;: &quot;type_label&quot;,
            &quot;level&quot;: null,
            &quot;parent_label&quot;: null,
            &quot;index&quot;: 0
        }],
        &quot;result_table_label&quot;: [{
            &quot;label_id&quot;: &quot;OS&quot;,
            &quot;label_name&quot;: &quot;操作系统&quot;,
            &quot;label_type&quot;: &quot;result_table_label&quot;,
            &quot;level&quot;: 2,
            &quot;parent_label&quot;: &quot;host&quot;,
            &quot;index&quot;: 0
        }, {
            &quot;label_id&quot;: &quot;host&quot;,
            &quot;label_name&quot;: &quot;主机&quot;,
            &quot;label_type&quot;: &quot;result_table_label&quot;,
            &quot;level&quot;: 1,
            &quot;parent_label&quot;: null,
            &quot;index&quot;: 1
        }]
    },
    &quot;result&quot;:true,
    &quot;request_id&quot;:&quot;408233306947415bb1772a86b9536867&quot;
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/monitor_v3/metadata_list_result_table/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>获取存储列表
根据给定的过滤参数（暂无），返回符合条件的结果表列表</p>
<h4 id="_4">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_5">接口参数</h4>
<p>无请求参数</p>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>datasource_type</td>
<td>string</td>
<td>false</td>
<td>需要过滤的结果表类型, 如 system</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>false</td>
<td>获取指定业务下的结果表信息</td>
</tr>
<tr>
<td>is_public_include</td>
<td>int</td>
<td>false</td>
<td>是否包含全业务结果表, 0 为不包含, 非 0 为包含全业务结果表</td>
</tr>
<tr>
<td>is_config_by_user</td>
<td>bool</td>
<td>false</td>
<td>是否需要包含非用户配置的结果表内容</td>
</tr>
</tbody>
</table>
<h4 id="_6">请求示例</h4>
<pre class="codehilite"><code class="language-json">{
    &quot;bk_biz_id&quot;: 123,
    &quot;is_public_include&quot;: 1,
    &quot;datasource_type&quot;: &quot;system&quot;
}</code></pre>


<h3 id="_7">返回结果</h3>
<h4 id="_8">字段说明</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result_table_id</td>
<td>int</td>
<td>结果表 ID</td>
</tr>
<tr>
<td>table_name_zh</td>
<td>string</td>
<td>结果表中文名</td>
</tr>
<tr>
<td>is_custom_table</td>
<td>boolean</td>
<td>是否自定义结果表</td>
</tr>
<tr>
<td>schema_type</td>
<td>string</td>
<td>结果表 schema 配置方案，free(无 schema 配置), dynamic(动态 schema), fixed(固定 schema)</td>
</tr>
<tr>
<td>default_storage</td>
<td>string</td>
<td>默认存储方案</td>
</tr>
<tr>
<td>storage_list</td>
<td>array</td>
<td>所有存储列表，元素为 string</td>
</tr>
<tr>
<td>creator</td>
<td>string</td>
<td>创建者</td>
</tr>
<tr>
<td>create_time</td>
<td>string</td>
<td>创建时间, 格式为【2018-10-10 10:00:00】</td>
</tr>
<tr>
<td>last_modify_user</td>
<td>string</td>
<td>最后修改者</td>
</tr>
<tr>
<td>last_modify_time</td>
<td>string</td>
<td>最后修改时间【2018-10-10 10:00:00】</td>
</tr>
</tbody>
</table>
<h4 id="_9">结果示例</h4>
<pre class="codehilite"><code class="language-json">{
    &quot;message&quot;:&quot;OK&quot;,
    &quot;code&quot;:&quot;0&quot;,
    &quot;data&quot;:[{
        &quot;table_id&quot;: &quot;system.cpu&quot;,
        &quot;table_name_zh&quot;: &quot;结果表名&quot;,
        &quot;is_custom_table&quot;: false,
        &quot;scheme_type&quot;: &quot;fixed&quot;,
        &quot;default_storage&quot;: &quot;influxdb&quot;,
        &quot;storage_list&quot;: [&quot;influxdb&quot;],
        &quot;creator&quot;: &quot;username&quot;,
        &quot;create_time&quot;: &quot;2018-10-10 10:10:10&quot;,
        &quot;last_modify_user&quot;: &quot;username&quot;,
        &quot;last_modify_time&quot;: &quot;2018-10-10 10:10:10&quot;,
        &quot;field_list&quot;: [{
            &quot;field_name&quot;: &quot;usage&quot;,
            &quot;field_type&quot;: &quot;float&quot;,
            &quot;tag&quot;: &quot;dimension&quot;,
            &quot;description&quot;: &quot;CPU用量&quot;,
            &quot;is_config_by_user&quot;: true,
            &quot;unit&quot;: &quot;字段单位&quot;

        }],
        &quot;bk_biz_id&quot;: 0,
        &quot;label&quot;: &quot;OS&quot;
    }],
    &quot;result&quot;:true,
    &quot;request_id&quot;:&quot;408233306947415bb1772a86b9536867&quot;
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/monitor_v3/metadata_modify_cluster_info/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>查询存储集群配置
根据给定的配置参数，创建一个存储集群配置</p>
<h4 id="_4">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_5">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>cluster_id</td>
<td>int</td>
<td>是</td>
<td>集群 ID</td>
</tr>
<tr>
<td>cluster_name</td>
<td>string</td>
<td>是</td>
<td>存储集群名</td>
</tr>
<tr>
<td>operator</td>
<td>string</td>
<td>是</td>
<td>修改者</td>
</tr>
<tr>
<td>description</td>
<td>string</td>
<td>否</td>
<td>存储集群描述信息</td>
</tr>
<tr>
<td>auth_info</td>
<td>object</td>
<td>否</td>
<td>集群用户名</td>
</tr>
<tr>
<td>custom_label</td>
<td>string</td>
<td>否</td>
<td>自定义标签</td>
</tr>
<tr>
<td>schema</td>
<td>string</td>
<td>否</td>
<td>强行配置 schema，可用于配置 https 等情形</td>
</tr>
<tr>
<td>is_ssl_verify</td>
<td>bool</td>
<td>否</td>
<td>是否需要跳过 SSL\TLS 认证</td>
</tr>
</tbody>
</table>
<p><strong>注意</strong>: 上述信息是否可以修改，主要决定于该修改参数是否会导致历史数据丢失；例如，修改 domain_name 需要运维介入的操作，不支持在此处修改</p>
<h4 id="auth_info">auth_info 说明</h4>
<pre class="codehilite"><code class="language-json">{
  &quot;username&quot;: &quot;username&quot;,
  &quot;password&quot;: &quot;password&quot;
}</code></pre>


<h4 id="_6">请求示例</h4>
<pre class="codehilite"><code class="language-json">{ 
    &quot;cluster_id&quot;: 1,
    &quot;cluster_name&quot;: &quot;first_influxdb&quot;,
    &quot;operator&quot;: &quot;admin&quot;
}</code></pre>


<p><strong>注意</strong>: 请求可以提供<code>cluster_id</code>或者<code>cluster_name</code>定位需要修改的集群信息；但两者互斥，优先使用<code>cluster_id</code></p>
<h3 id="_7">返回结果</h3>
<h4 id="_8">字段说明</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>cluster_id</td>
<td>int</td>
<td>集群 ID</td>
</tr>
</tbody>
</table>
<h4 id="_9">结果示例</h4>
<pre class="codehilite"><code class="language-json">{
    &quot;message&quot;:&quot;OK&quot;,
    &quot;code&quot;:&quot;0&quot;,
    &quot;data&quot;: [{
        &quot;cluster_config&quot;: {
            &quot;domain_name&quot;: &quot;service.consul&quot;,
            &quot;port&quot;: 9052,
            &quot;schema&quot;: &quot;https&quot;,
            &quot;is_ssl_verify&quot;: true,
            &quot;cluster_id&quot;: 1,
            &quot;cluster_name&quot;: &quot;default_influx&quot;,
            &quot;version&quot;: &quot;&quot;
        },
        &quot;cluster_type&quot;: &quot;influxDB&quot;,
        &quot;auth_info&quot;: {
            &quot;password&quot;: &quot;&quot;,
            &quot;username&quot;: &quot;&quot;
        }
    }],
    &quot;result&quot;:true,
    &quot;request_id&quot;:&quot;408233306947415bb1772a86b9536867&quot;
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/monitor_v3/metadata_modify_data_id/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>修改数据源名称</p>
<h4 id="_4">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_5">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>data_name</td>
<td>string</td>
<td>是</td>
<td>数据源名称</td>
</tr>
<tr>
<td>data_id</td>
<td>int</td>
<td>是</td>
<td>数据源 ID</td>
</tr>
<tr>
<td>operator</td>
<td>string</td>
<td>是</td>
<td>操作者</td>
</tr>
<tr>
<td>source_label</td>
<td>string</td>
<td>是</td>
<td>数据来源标签，例如：计算平台(bk_data)，监控采集器(bk_monitor_collector)</td>
</tr>
<tr>
<td>type_label</td>
<td>string</td>
<td>是</td>
<td>数据类型标签，例如：时序数据(time_series)，事件数据(event)，日志数据(log)</td>
</tr>
</tbody>
</table>
<p><strong>注意</strong>： 上述的<code>source_tag</code>及<code>data_type</code>都应该通过<code>metadata_get_label</code>接口获取，不应该自行创建 </p>
<h4 id="_6">请求示例</h4>
<pre class="codehilite"><code class="language-json">{ 
    &quot;operator&quot;: &quot;adminn&quot;,
    &quot;data_id&quot;: 123,
    &quot;data_name&quot;: &quot;basereport&quot;,
    &quot;source_label&quot;: &quot;bk_monitor_collector&quot;,
    &quot;type_label&quot;: &quot;time_series&quot;
}</code></pre>


<h3 id="_7">返回结果</h3>
<h4 id="_8">字段说明</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_data_id</td>
<td>int</td>
<td>结果表 ID</td>
</tr>
</tbody>
</table>
<h4 id="_9">结果示例</h4>
<pre class="codehilite"><code class="language-json">{
    &quot;message&quot;:&quot;OK&quot;,
    &quot;code&quot;:&quot;0&quot;,
    &quot;data&quot;:{
        &quot;bk_data_id&quot;: 1001,
        &quot;data_name&quot;: &quot;基础数据&quot;,
        &quot;data_description&quot;: &quot;基础数据数据源&quot;,
        &quot;mq_cluster_info&quot;: {
            &quot;storage_config&quot;: {
               &quot;topic&quot;: &quot;bk_monitor_1001&quot;,
               &quot;partition&quot;: 1,
           },
            &quot;cluster_config&quot;: {
               &quot;domain_name&quot;: &quot;kafka.domain.cluster&quot;,
               &quot;port&quot;: 80,
           },
           &quot;cluster_type&quot;: &quot;kafka&quot;
        },
        &quot;etl_config&quot;: &quot;basereport&quot;,
        &quot;is_custom_source&quot;: false,
        &quot;creator&quot;: &quot;username&quot;,
        &quot;create_time&quot;: &quot;2018-10-10 10:10:10&quot;,
        &quot;last_modify_user&quot;: &quot;username&quot;,
        &quot;last_modify_time&quot;: &quot;2018-10-10 10:10:10&quot;,
        &quot;source_label&quot;: &quot;bk_monitor_collector&quot;,
        &quot;type_label&quot;: &quot;time_series&quot;
    },
    &quot;result&quot;:true,
    &quot;request_id&quot;:&quot;408233306947415bb1772a86b9536867&quot;
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/monitor_v3/metadata_modify_event_group/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>修改一个事件分组 ID
给定一个事件分组 ID，修改某些具体的信息</p>
<h4 id="_4">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_5">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>event_group_id</td>
<td>int</td>
<td>是</td>
<td>事件组 ID</td>
</tr>
<tr>
<td>event_group_name</td>
<td>string</td>
<td>是</td>
<td>事件分组名</td>
</tr>
<tr>
<td>label</td>
<td>string</td>
<td>否</td>
<td>事件分组标签，用于表示事件监控对象，应该复用【result_table_label】类型下的标签</td>
</tr>
<tr>
<td>operator</td>
<td>string</td>
<td>否</td>
<td>操作者</td>
</tr>
<tr>
<td>event_info_list</td>
<td>bool</td>
<td>否</td>
<td>事件列表</td>
</tr>
<tr>
<td>is_enable</td>
<td>bool</td>
<td>否</td>
<td>是否停用事件组</td>
</tr>
</tbody>
</table>
<h4 id="_6">请求示例</h4>
<pre class="codehilite"><code class="language-json">{
    &quot;bk_group_id&quot;: 123,
    &quot;label&quot;: &quot;application&quot;,
    &quot;operator&quot;: &quot;system&quot;,
    &quot;description&quot;: &quot;what the group use for.&quot;,
    &quot;is_enable&quot;: true,
    &quot;event_info_list&quot;: [{
      &quot;event_name&quot;: &quot;usage for update&quot;,
      &quot;dimension_list&quot;: [&quot;dimension_name&quot;]
    },{
      &quot;event_name&quot;: &quot;usage for create&quot;,
      &quot;dimension_list&quot;: [&quot;dimension_name&quot;]
    }]
}</code></pre>


<h3 id="_7">返回结果</h3>
<h4 id="_8">字段说明</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_group_id</td>
<td>int</td>
<td>新建的事件分组 ID</td>
</tr>
</tbody>
</table>
<h4 id="_9">结果示例</h4>
<pre class="codehilite"><code class="language-json">{
    &quot;message&quot;:&quot;OK&quot;,
    &quot;code&quot;:&quot;0&quot;,
    &quot;data&quot;: {
        &quot;event_group_id&quot;: 1001,
        &quot;bk_data_id&quot;: 123,
        &quot;bk_biz_id&quot;: 123,
        &quot;label&quot;: &quot;application&quot;,
        &quot;description&quot;: &quot;use for what?&quot;,
        &quot;is_enable&quot;: true,
        &quot;creator&quot;: &quot;admin&quot;,
        &quot;create_time&quot;: &quot;2019-10-10 10:10:10&quot;,
        &quot;last_modify_user&quot;: &quot;admin&quot;,
        &quot;last_modify_time&quot;: &quot;2020-10-10 10:10:10&quot;
    },
    &quot;result&quot;:true,
    &quot;request_id&quot;:&quot;408233306947415bb1772a86b9536867&quot;
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/monitor_v3/metadata_modify_result_table/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>修改一个结果表的配置
根据给定的数据源 ID，返回这个结果表的具体信息</p>
<h4 id="_4">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_5">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>table_id</td>
<td>string</td>
<td>是</td>
<td>结果表 ID</td>
</tr>
<tr>
<td>operator</td>
<td>string</td>
<td>是</td>
<td>操作者</td>
</tr>
<tr>
<td>field_list</td>
<td>array</td>
<td>否</td>
<td>全量的字段列表</td>
</tr>
<tr>
<td>table_name_zh</td>
<td>string</td>
<td>否</td>
<td>结果表中文名</td>
</tr>
<tr>
<td>default_storage</td>
<td>string</td>
<td>否</td>
<td>结果表默认存储类型</td>
</tr>
<tr>
<td>label</td>
<td>string</td>
<td>是</td>
<td>结果表标签，此处记录的是二级标签，对应一级标签将由二级标签推导得到</td>
</tr>
<tr>
<td>is_time_field_only</td>
<td>bool</td>
<td>否</td>
<td>默认字段是否仅需要 time，默认为 False，该字段仅在 field_list 参数为非空时生效</td>
</tr>
<tr>
<td>external_storage</td>
<td>object</td>
<td>否</td>
<td _storage_95_type="${storage_type">额外存储配置，格式为</td>
</tr>
<tr>
<td>is_enable</td>
<td>bool</td>
<td>否</td>
<td>是否启用结果表</td>
</tr>
</tbody>
</table>
<p><strong>注意</strong>： 上述的<code>label</code>都应该通过<code>metadata_get_label</code>接口获取，不应该自行创建</p>
<h6 id="default95storage_config-storage_config-influxdb">参数: default_storage_config 及 storage_config -- 在 influxdb 下支持的参数</h6>
<p>| 键值 | 类型 | 是否必选 | 默认值 |描述 |
| ---- | --- | --- |
| source_duration_time | string | 否 | 30d | 元数据保存时间, 需要符合 influxdb 格式 |</p>
<h6 id="default95storage_config-storage_config-kafka">参数: default_storage_config 及 storage_config -- 在 kafka 下支持的参数</h6>
<p>| 键值 | 类型 | 是否必选 | 默认值 |描述 |
| ---- | --- | --- |
| partition | int | 否 | 1 | 存储 partition 数量，注意：此处只是记录，如果是超过 1 个 topic 的配置，需要手动通过 kafka 命令行工具进行扩容 |
| retention | int | 否 | 1800000 | kafka 数据保存时长，默认是半小时，单位 ms |</p>
<h6 id="default95storage_config-storage_config-redis">参数: default_storage_config 及 storage_config -- 在 redis 下支持的参数</h6>
<p>| 键值 | 类型 | 是否必选 | 默认值 |描述 |
| ---- | --- | --- |
| is_sentinel | bool | 否 | False | 是否哨兵模式 |
| master_name | string | 否 | "" | 哨兵模式下 master 名称 |</p>
<p><strong>注意</strong>: 由于 redis 默认使用队列方式，消费后就丢弃，因此未有时长配置</p>
<h6 id="default95storage_config-storage_config-elasticsearch">参数: default_storage_config 及 storage_config -- 在 elasticsearch 下支持的参数</h6>
<p>| 键值 | 类型 | 是否必选 | 默认值 |描述 |
| ---- | --- | --- |
| retention | int | 否 |  30 |  保留 index 时间，单位为天，默认保留 30 天 |
| slice_size | int | 否 | 500 | 需要切分的大小阈值，单位为 GB，默认为 500GB |
| slice_gap | int | 否 | 120 | index 分片时间间隔，单位分钟，默认 2 小时 |
| index_settings | string | 是 | - | 索引创建配置, json 格式 |
| mapping_settings | string | 否 | - | 索引 mapping 配置，<strong>不包含字段定义</strong>， json 格式 |
| alias_name | string | 否 | None | 入库别名 |
| option | string | 否 | {} | 字段选项配置，键为选项名，值为选项配置 |</p>
<p><strong>注意</strong>: 上述信息是否可以修改，主要决定于该修改参数是否会导致历史数据丢失</p>
<p>| 键值 | 类型 | 是否必选 | 默认值 |描述 |
| ---- | --- | --- |
| filed_name | string | 是 |  - |  字段名 |
| field_type | string | 是 |  - |  字段类型 |
| description | string | 否 |  "" |  字段描述 |
| tag | string | 是 |  - |  字段类型，可以为 metric 或 dimension |
| alias_name | string | 否 |  "" |  字段别名，入库时可以改为此别名写入 |
| option | array | 否 |  [] | 字段配置选项 |
| is_config_by_user | bool | 否 |  true | 是否启用 |</p>
<h4 id="_6">请求示例</h4>
<pre class="codehilite"><code class="language-json">{
    &quot;table_id&quot;: &quot;system.cpu&quot;,
    &quot;operator&quot;: &quot;username&quot;,
    &quot;field_list&quot;: [{
        &quot;filed_name&quot;: &quot;usage&quot;,
        &quot;field_type&quot;: &quot;double&quot;,
        &quot;description&quot;: &quot;field description&quot;,
        &quot;tag&quot;: &quot;metric&quot;,
        &quot;alias_name&quot;: &quot;usage_alias&quot;,
        &quot;option&quot;: [],
        &quot;is_config_by_user&quot;: true
    }],
    &quot;label&quot;: &quot;OS&quot;,
    &quot;table_name_zh&quot;: &quot;CPU性能数据&quot;,
    &quot;default_storage&quot;: &quot;influxdb&quot;
}</code></pre>


<h3 id="_7">返回结果</h3>
<h4 id="_8">字段说明</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>table_id</td>
<td>int</td>
<td>结果表 ID</td>
</tr>
<tr>
<td>table_name_zh</td>
<td>string</td>
<td>结果表中文名</td>
</tr>
<tr>
<td>is_custom_table</td>
<td>boolean</td>
<td>是否自定义结果表</td>
</tr>
<tr>
<td>schema_type</td>
<td>string</td>
<td>结果表 schema 配置方案，free(无 schema 配置), dynamic(动态 schema), fixed(固定 schema)</td>
</tr>
<tr>
<td>default_storage</td>
<td>string</td>
<td>默认存储方案</td>
</tr>
<tr>
<td>storage_list</td>
<td>array</td>
<td>所有存储列表，元素为 string</td>
</tr>
<tr>
<td>creator</td>
<td>string</td>
<td>创建者</td>
</tr>
<tr>
<td>create_time</td>
<td>string</td>
<td>创建时间, 格式为【2018-10-10 10:00:00】</td>
</tr>
<tr>
<td>last_modify_user</td>
<td>string</td>
<td>最后修改者</td>
</tr>
<tr>
<td>last_modify_time</td>
<td>string</td>
<td>最后修改时间【2018-10-10 10:00:00】</td>
</tr>
<tr>
<td>label</td>
<td>string</td>
<td>结果表标签</td>
</tr>
<tr>
<td>#### 结果示例</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<pre class="codehilite"><code class="language-json">{
    &quot;message&quot;:&quot;OK&quot;,
    &quot;code&quot;:&quot;0&quot;,
    &quot;data&quot;:{
        &quot;table_id&quot;: &quot;system.cpu&quot;,
        &quot;table_name_zh&quot;: &quot;结果表名&quot;,
        &quot;is_custom_table&quot;: false,
        &quot;scheme_type&quot;: &quot;fixed&quot;,
        &quot;default_storage&quot;: &quot;influxdb&quot;,
        &quot;storage_list&quot;: [&quot;influxdb&quot;],
        &quot;creator&quot;: &quot;username&quot;,
        &quot;create_time&quot;: &quot;2018-10-10 10:10:10&quot;,
        &quot;last_modify_user&quot;: &quot;username&quot;,
        &quot;last_modify_time&quot;: &quot;2018-10-10 10:10:10&quot;,
        &quot;field_list&quot;: [{
            &quot;field_name&quot;: &quot;usage&quot;,
            &quot;field_type&quot;: &quot;float&quot;,
            &quot;tag&quot;: &quot;dimension&quot;,
            &quot;description&quot;: &quot;CPU用量&quot;,
            &quot;is_config_by_user&quot;: true
        }],
        &quot;label&quot;: &quot;OS&quot;
    },
    &quot;result&quot;:true,
    &quot;request_id&quot;:&quot;408233306947415bb1772a86b9536867&quot;
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/monitor_v3/metadata_modify_time_series_group/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/monitor_v3/metadata_query_event_group/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>批量查询事件分组信息</p>
<h4 id="_4">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_5">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>label</td>
<td>string</td>
<td>否</td>
<td>事件分组标签（监控对象）</td>
</tr>
<tr>
<td>event_group_name</td>
<td>string</td>
<td>否</td>
<td>事件分组名称</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>否</td>
<td>业务 ID</td>
</tr>
</tbody>
</table>
<h4 id="_6">请求示例</h4>
<pre class="codehilite"><code class="language-json">{
    &quot;label&quot;: &quot;application&quot;,
    &quot;event_group_name&quot;: &quot;事件分组名&quot;,
    &quot;bk_biz_id&quot;: 123
}</code></pre>


<h3 id="_7">返回结果</h3>
<h4 id="_8">字段说明</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_event_group_id</td>
<td>int</td>
<td>事件分组 ID</td>
</tr>
<tr>
<td>bk_data_id</td>
<td>int</td>
<td>数据源 ID</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>业务 ID</td>
</tr>
<tr>
<td>event_group_name</td>
<td>string</td>
<td>事件分组名</td>
</tr>
<tr>
<td>label</td>
<td>string</td>
<td>事件标签</td>
</tr>
<tr>
<td>is_enable</td>
<td>bool</td>
<td>是否启用</td>
</tr>
<tr>
<td>creator</td>
<td>string</td>
<td>创建者</td>
</tr>
<tr>
<td>create_time</td>
<td>string</td>
<td>创建时间</td>
</tr>
<tr>
<td>last_modify_user</td>
<td>string</td>
<td>最后修改者</td>
</tr>
<tr>
<td>last_modify_time</td>
<td>string</td>
<td>最后修改时间</td>
</tr>
<tr>
<td>event_info_list</td>
<td>array</td>
<td>事件列表</td>
</tr>
</tbody>
</table>
<h4 id="event_info_list">event_info_list 具体内容说明</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_event_id</td>
<td>int</td>
<td>事件 ID</td>
</tr>
<tr>
<td>event_name</td>
<td>string</td>
<td>事件名</td>
</tr>
<tr>
<td>dimension</td>
<td>array</td>
<td>维度列表</td>
</tr>
</tbody>
</table>
<h4 id="event_info_listdimension">event_info_list.dimension 具体内容说明</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>dimension_name</td>
<td>string</td>
<td>维度名</td>
</tr>
<tr>
<td>dimension_ch_name</td>
<td>string</td>
<td>维度中文名</td>
</tr>
</tbody>
</table>
<h4 id="_9">结果示例</h4>
<pre class="codehilite"><code class="language-json">{
    &quot;message&quot;:&quot;OK&quot;,
    &quot;code&quot;:&quot;0&quot;,
    &quot;data&quot;: [{
        &quot;event_group_id&quot;: 1001,
        &quot;bk_data_id&quot;: 123,
        &quot;bk_biz_id&quot;: 123,
        &quot;event_group_name&quot;: &quot;事件分组名&quot;,
        &quot;label&quot;: &quot;application&quot;,
        &quot;is_enable&quot;: true,
        &quot;creator&quot;: &quot;admin&quot;,
        &quot;create_time&quot;: &quot;2019-10-10 10:10:10&quot;,
        &quot;last_modify_user&quot;: &quot;admin&quot;,
        &quot;last_modify_time&quot;: &quot;2020-10-10 10:10:10&quot;,
        &quot;event_info_list&quot;: [{
          &quot;bk_event_id&quot;: 1,
          &quot;event_name&quot;: &quot;usage for update&quot;,
          &quot;dimension_list&quot;: [{
            &quot;dimension_name&quot;: &quot;field_name&quot;
          }]
        },{
          &quot;bk_event_id&quot;: 2,
          &quot;event_name&quot;: &quot;usage for create&quot;,
          &quot;dimension_list&quot;: [{
            &quot;dimension_name&quot;: &quot;field_name&quot;
          }]
        }]
    }],
    &quot;result&quot;:true,
    &quot;request_id&quot;:&quot;408233306947415bb1772a86b9536867&quot;
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/monitor_v3/metadata_query_tag_values/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/monitor_v3/metadata_query_time_series_group/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/monitor_v3/metadata_upgrade_result_table/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>修改一个单业务结果表，使之升级为全业务结果表</p>
<h4 id="_4">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_5">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>table_id</td>
<td>string</td>
<td>是</td>
<td>结果表 ID</td>
</tr>
<tr>
<td>operator</td>
<td>string</td>
<td>是</td>
<td>操作者</td>
</tr>
</tbody>
</table>
<h4 id="_6">请求示例</h4>
<pre class="codehilite"><code class="language-json">{
    &quot;table_id_list&quot;: [&quot;2_system.cpu&quot;, &quot;3_system.cpu&quot;],
}</code></pre>


<h3 id="_7">返回结果</h3>
<h4 id="_8">结果示例</h4>
<pre class="codehilite"><code class="language-json">{
    &quot;message&quot;:&quot;OK&quot;,
    &quot;code&quot;:&quot;0&quot;,
    &quot;data&quot;: null,
    &quot;result&quot;:true,
    &quot;request_id&quot;:&quot;408233306947415bb1772a86b9536867&quot;
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/monitor_v3/query_collect_config/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/monitor_v3/save_alarm_strategy/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>保存告警策略</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">action_list</td>
<td>list</td>
<td>是</td>
<td>动作列表(Action)</td>
</tr>
<tr>
<td align="left">target</td>
<td>list</td>
<td>是</td>
<td>监控目标</td>
</tr>
<tr>
<td align="left">bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 ID</td>
</tr>
<tr>
<td align="left">item_list</td>
<td>list</td>
<td>是</td>
<td>监控项(Item)</td>
</tr>
<tr>
<td align="left">name</td>
<td>string</td>
<td>是</td>
<td>策略名称</td>
</tr>
<tr>
<td align="left">scenario</td>
<td>string</td>
<td>是</td>
<td>监控对象</td>
</tr>
</tbody>
</table>
<h4 id="noticeaction">NoticeAction</h4>
<p>action 目前只有通知类型，创建策略时，如果传入通知组的 ID，则使用通知组</p>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>action_type</td>
<td>string</td>
<td>是</td>
<td>动作类型(notice)</td>
</tr>
<tr>
<td>config</td>
<td>dict</td>
<td>是</td>
<td>动作配置</td>
</tr>
<tr>
<td>config.alarm_end_time</td>
<td>string</td>
<td>是</td>
<td>通知时间段</td>
</tr>
<tr>
<td>config.alarm_start_time</td>
<td>string</td>
<td>是</td>
<td>通知时间段</td>
</tr>
<tr>
<td>config.send_recovery_alarm</td>
<td>bool</td>
<td>是</td>
<td>是否发送恢复</td>
</tr>
<tr>
<td>config.alarm_interval</td>
<td>int</td>
<td>是</td>
<td>通知间隔</td>
</tr>
<tr>
<td>notice_template</td>
<td>dict</td>
<td>否</td>
<td>通知配置</td>
</tr>
<tr>
<td>notice_template.anomaly_template</td>
<td>string</td>
<td>否</td>
<td>异常通知模板</td>
</tr>
<tr>
<td>notice_template.recovery_template</td>
<td>string</td>
<td>否</td>
<td>恢复通知模板</td>
</tr>
<tr>
<td>notice_group_list</td>
<td>list</td>
<td>是</td>
<td>通知组列表(NoticeGroup)</td>
</tr>
</tbody>
</table>
<h4 id="noticegroup">NoticeGroup</h4>
<p>可以使用已存在的通知组</p>
<ol>
<li>如果存在 id，则使用 id 对应的通知组，传入的通知组配置会更新该通知组。</li>
<li>如果没有 id，则根据传入的字段新建通知组。</li>
</ol>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>notice_receiver</td>
<td>list</td>
<td>否</td>
<td>接收人</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>否</td>
<td>通知组名称</td>
</tr>
<tr>
<td>notice_way</td>
<td>dict</td>
<td>否</td>
<td>通知方式，告警级别为 key，value 是通知方式组成的 list</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>否</td>
<td>备注</td>
</tr>
<tr>
<td>id</td>
<td>int</td>
<td>否</td>
<td>通知组 ID</td>
</tr>
</tbody>
</table>
<h4 id="item">Item</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>rt_query_config</td>
<td>dict</td>
<td>是</td>
<td>指标查询配置(RtQueryConfig)</td>
</tr>
<tr>
<td>metric_id</td>
<td>string</td>
<td>是</td>
<td>指标</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>是</td>
<td>监控项名称</td>
</tr>
<tr>
<td>data_source_label</td>
<td>string</td>
<td>是</td>
<td>数据源</td>
</tr>
<tr>
<td>algorithm_list</td>
<td>list</td>
<td>是</td>
<td>算法配置列表(Algorithm)</td>
</tr>
<tr>
<td>no_data_config</td>
<td>dict</td>
<td>是</td>
<td>无数据配置</td>
</tr>
<tr>
<td>no_data_config.is_enabled</td>
<td>bool</td>
<td>是</td>
<td>是否开启无数据告警</td>
</tr>
<tr>
<td>no_data_config.continous</td>
<td>int</td>
<td>否</td>
<td>无数据告警检测周期数</td>
</tr>
<tr>
<td>data_type_label</td>
<td>string</td>
<td>是</td>
<td>数据类型</td>
</tr>
</tbody>
</table>
<h4 id="rtqueryconfig">RtQueryConfig</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>metric_field</td>
<td>string</td>
<td>是</td>
<td>指标名</td>
</tr>
<tr>
<td>unit_conversion</td>
<td>int</td>
<td>是</td>
<td>单位转换</td>
</tr>
<tr>
<td>unit</td>
<td>string</td>
<td>是</td>
<td>单位</td>
</tr>
<tr>
<td>extend_fields</td>
<td>string</td>
<td>否</td>
<td>其他字段</td>
</tr>
<tr>
<td>agg_condition</td>
<td>list</td>
<td>是</td>
<td>查询条件</td>
</tr>
<tr>
<td>agg_interval</td>
<td>int</td>
<td>是</td>
<td>聚合周期</td>
</tr>
<tr>
<td>agg_dimension</td>
<td>list</td>
<td>是</td>
<td>查询维度</td>
</tr>
<tr>
<td>agg_method</td>
<td>string</td>
<td>是</td>
<td>聚合方法</td>
</tr>
<tr>
<td>result_table_id</td>
<td>string</td>
<td>是</td>
<td>结果表 ID</td>
</tr>
</tbody>
</table>
<h4 id="algorithm">Algorithm</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>algorithm_config</td>
<td>list</td>
<td>是</td>
<td>算法配置列表</td>
</tr>
<tr>
<td>level</td>
<td>int</td>
<td>是</td>
<td>告警级别</td>
</tr>
<tr>
<td>trigger_config</td>
<td>dict</td>
<td>是</td>
<td>触发条件</td>
</tr>
<tr>
<td>trigger_config.count</td>
<td>int</td>
<td>是</td>
<td>触发阈值</td>
</tr>
<tr>
<td>trigger_config.check_window</td>
<td>int</td>
<td>是</td>
<td>触发检测窗口数</td>
</tr>
<tr>
<td>algorithm_type</td>
<td>string</td>
<td>是</td>
<td>算法类型</td>
</tr>
<tr>
<td>recovery_config</td>
<td>dict</td>
<td>是</td>
<td>恢复配置</td>
</tr>
<tr>
<td>recovery_config.check_window</td>
<td>int</td>
<td>是</td>
<td>恢复周期数</td>
</tr>
<tr>
<td>message_template</td>
<td>string</td>
<td>否</td>
<td></td>
</tr>
</tbody>
</table>
<h4 id="_7">算法配置</h4>
<h5 id="_8">静态阈值</h5>
<p>静态阈值一次可以配置多个，因此是个 list 结构</p>
<pre class="codehilite"><code class="language-json">[
  {
    &quot;method&quot;: &quot;gt&quot;, // gt,gte,lt,lte,eq,neq
    &quot;threshold&quot;: 1
  }
]</code></pre>


<h5 id="_9">简单环比</h5>
<pre class="codehilite"><code class="language-json">{
  &quot;floor&quot;: 1,
  &quot;ceil&quot;: 1
}</code></pre>


<h5 id="_10">简单同比</h5>
<pre class="codehilite"><code class="language-json">{
  &quot;floor&quot;: 1,
  &quot;ceil&quot;: 1
}</code></pre>


<h5 id="_11">高级环比</h5>
<pre class="codehilite"><code class="language-json">{
  &quot;floor&quot;: 1,
  &quot;ceil&quot;: 1,
  &quot;floor_interval&quot;: 1,
  &quot;ceil_interval&quot;: 1
}</code></pre>


<h5 id="_12">高级同比</h5>
<pre class="codehilite"><code class="language-json">{
  &quot;floor&quot;: 1,
  &quot;ceil&quot;: 1,
  &quot;floor_interval&quot;: 1,
  &quot;ceil_interval&quot;: 1
}</code></pre>


<h4 id="_13">示例数据</h4>
<pre class="codehilite"><code class="language-json">{
  &quot;bk_biz_id&quot;:2,
  &quot;item_list&quot;:[
    {
      &quot;rt_query_config&quot;:{
        &quot;metric_field&quot;:&quot;idle&quot;,
        &quot;agg_dimension&quot;:[&quot;ip&quot;, &quot;bk_cloud_id&quot;],
        &quot;unit_conversion&quot;:1.0,
        &quot;extend_fields&quot;:&quot;&quot;,
        &quot;agg_method&quot;:&quot;AVG&quot;,
        &quot;agg_condition&quot;:[],
        &quot;agg_interval&quot;:60,
        &quot;result_table_id&quot;:&quot;system.cpu_detail&quot;,
        &quot;unit&quot;:&quot;%&quot;
      },
      &quot;metric_id&quot;:&quot;bk_monitor.system.cpu_detail.idle&quot;,
      &quot;item_name&quot;:&quot;\u7a7a\u95f2\u7387&quot;,
      &quot;data_source_label&quot;:&quot;bk_monitor&quot;,
      &quot;algorithm_list&quot;:[
        {
          &quot;algorithm_config&quot;:[
            {
              &quot;threshold&quot;:0.1,
              &quot;method&quot;:&quot;gte&quot;
            }
          ],
          &quot;level&quot;:1,
          &quot;trigger_config&quot;:{
            &quot;count&quot;:1,
            &quot;check_window&quot;:5
          },
          &quot;algorithm_type&quot;:&quot;Threshold&quot;,
          &quot;recovery_config&quot;:{
            &quot;check_window&quot;:5
          },
          &quot;message_template&quot;:&quot;&quot;
        }
      ],
      &quot;no_data_config&quot;:{
        &quot;is_enabled&quot;:false,
        &quot;continuous&quot;:5
      },
      &quot;data_type_label&quot;:&quot;time_series&quot;,
      &quot;name&quot;:&quot;\u7a7a\u95f2\u7387&quot;
    }
  ],
  &quot;target&quot;:[
    [
      {
        &quot;field&quot;:&quot;ip&quot;,
        &quot;method&quot;:&quot;eq&quot;,
        &quot;value&quot;:[
          {
            &quot;ip&quot;:&quot;127.0.0.1&quot;,
            &quot;bk_cloud_id&quot;:0,
            &quot;bk_supplier_id&quot;:0
          },
        ]
      }
    ]
  ],
  &quot;scenario&quot;:&quot;os&quot;,
  &quot;action_list&quot;:[
    {
      &quot;notice_template&quot;:{
        &quot;anomaly_template&quot;:&quot;aa&quot;,
        &quot;recovery_template&quot;:&quot;&quot;
      },
      &quot;notice_group_list&quot;:[
        {
          &quot;notice_receiver&quot;:[
            &quot;user#test&quot;
          ],
          &quot;name&quot;:&quot;test&quot;,
          &quot;notice_way&quot;:{
            &quot;1&quot;:[&quot;weixin&quot;],
            &quot;3&quot;:[&quot;weixin&quot;],
            &quot;2&quot;:[&quot;weixin&quot;]
          },
          &quot;message&quot;:&quot;&quot;,
          &quot;notice_group_name&quot;:&quot;test&quot;,
          &quot;id&quot;:1
        }
      ],
      &quot;action_type&quot;:&quot;notice&quot;,
      &quot;config&quot;:{
        &quot;alarm_end_time&quot;:&quot;23:59:59&quot;,
        &quot;send_recovery_alarm&quot;:false,
        &quot;alarm_start_time&quot;:&quot;00:00:00&quot;,
        &quot;alarm_interval&quot;:120
      }
    }
  ],
  &quot;name&quot;:&quot;test&quot;
}</code></pre>


<h3 id="_14">响应参数</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>strategy_id</td>
<td>int</td>
<td>是</td>
<td>策略 ID</td>
</tr>
</tbody>
</table>
<h4 id="_15">示例数据</h4>
<pre class="codehilite"><code class="language-json">{
    &quot;result&quot;: true,
  &quot;data&quot;: {
    &quot;strategy_id&quot;: 1
  },
  &quot;message&quot;: &quot;&quot;
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/monitor_v3/save_collect_config/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/monitor_v3/save_notice_group/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>保存告警组</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 ID</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>是</td>
<td>名称</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>是</td>
<td>说明</td>
</tr>
<tr>
<td>webhook_url</td>
<td>string</td>
<td>否</td>
<td>回调地址</td>
</tr>
<tr>
<td>notice_way</td>
<td>dict</td>
<td>是</td>
<td>各个级别的通知方式</td>
</tr>
<tr>
<td>id</td>
<td>int</td>
<td>否</td>
<td>告警组 ID，如果没有则创建</td>
</tr>
<tr>
<td>notice_receiver</td>
<td>list</td>
<td>是</td>
<td>通知对象列表</td>
</tr>
</tbody>
</table>
<h4 id="notice_receiver-">notice_receiver - 通知对象列表</h4>
<p>通知对象有两种类型 <code>user</code> 或 <code>group</code>。</p>
<ol>
<li>user 对应的通知对象为用户名</li>
<li>group 对应的是通知组</li>
<li>operator - 主负责人</li>
<li>bk_bak_operator - 备份负责人</li>
<li>bk_biz_tester - 测试</li>
<li>bk_biz_productor - 产品</li>
<li>bk_biz_maintainer - 运维</li>
<li>bk_biz_developer - 开发</li>
</ol>
<h4 id="notice_way-">notice_way - 通知方式</h4>
<p>各个告警级别的通知方式</p>
<p>基础的通知方式有：</p>
<ul>
<li>weixin</li>
<li>mail</li>
<li>voice</li>
<li>sms</li>
</ul>
<h4 id="_7">示例数据</h4>
<pre class="codehilite"><code class="language-json">{
  &quot;bk_biz_id&quot;: 2,
  &quot;notice_receiver&quot;: [
    {
      &quot;type&quot;: &quot;user&quot;,
      &quot;id&quot;: &quot;admin&quot;
    }
  ],
  &quot;name&quot;: &quot;layman&quot;,
  &quot;notice_way&quot;: {
    &quot;1&quot;: [&quot;weixin&quot;],
    &quot;2&quot;: [&quot;weixin&quot;],
    &quot;3&quot;: [&quot;weixin&quot;]
  },
  &quot;webhook_url&quot;: &quot;https://www.qq.com&quot;,
  &quot;message&quot;: &quot;测试通知&quot;,
  &quot;id&quot;: 1
}</code></pre>


<h3 id="_8">响应参数</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>int</td>
<td>告警 ID</td>
</tr>
</tbody>
</table>
<h4 id="_9">示例数据</h4>
<pre class="codehilite"><code class="language-json">{
  &quot;message&quot;: &quot;OK&quot;,
  &quot;code&quot;: &quot;0&quot;,
  &quot;data&quot;: {
    &quot;id&quot;: 1
  },
  &quot;result&quot;: true
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/monitor_v3/search_alarm_strategy/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>查询告警策略</p>
<h3 id="_4">接口参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>page</td>
<td>int</td>
<td>否</td>
<td>页码</td>
</tr>
<tr>
<td>page_size</td>
<td>int</td>
<td>否</td>
<td>每页条数</td>
</tr>
<tr>
<td>ids</td>
<td>list</td>
<td>否</td>
<td>策略 ID 列表</td>
</tr>
<tr>
<td>metric_id</td>
<td>string</td>
<td>否</td>
<td>指标 ID</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>是</td>
<td>业务 ID</td>
</tr>
<tr>
<td>fields</td>
<td>list</td>
<td>否</td>
<td>所需字段</td>
</tr>
</tbody>
</table>
<h4 id="_7">示例数据</h4>
<pre class="codehilite"><code class="language-json">{
  &quot;bk_biz_id&quot;: 2,
  &quot;ids&quot;: [1, 2]
}</code></pre>


<h3 id="_8">响应参数</h3>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">action_list</td>
<td>list</td>
<td>动作列表(Action)</td>
</tr>
<tr>
<td align="left">source_type</td>
<td>string</td>
<td>数据来源</td>
</tr>
<tr>
<td align="left">target</td>
<td>list</td>
<td>监控目标</td>
</tr>
<tr>
<td align="left">bk_biz_id</td>
<td>int</td>
<td>业务 ID</td>
</tr>
<tr>
<td align="left">item_list</td>
<td>list</td>
<td>监控项(Item)</td>
</tr>
<tr>
<td align="left">name</td>
<td>string</td>
<td>策略名称</td>
</tr>
<tr>
<td align="left">scenario</td>
<td>string</td>
<td>监控对象</td>
</tr>
<tr>
<td align="left">id</td>
<td>int</td>
<td>策略 ID</td>
</tr>
</tbody>
</table>
<h4 id="noticeaction">NoticeAction</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>action_type</td>
<td>string</td>
<td>动作类型(notice)</td>
</tr>
<tr>
<td>config</td>
<td>dict</td>
<td>动作配置</td>
</tr>
<tr>
<td>config.alarm_end_time</td>
<td>string</td>
<td>通知时间段</td>
</tr>
<tr>
<td>config.alarm_start_time</td>
<td>string</td>
<td>通知时间段</td>
</tr>
<tr>
<td>config.send_recovery_alarm</td>
<td>bool</td>
<td>是否发送恢复</td>
</tr>
<tr>
<td>config.alarm_interval</td>
<td>int</td>
<td>通知间隔</td>
</tr>
<tr>
<td>notice_template</td>
<td>dict</td>
<td>通知配置</td>
</tr>
<tr>
<td>notice_template.anomaly_template</td>
<td>string</td>
<td>异常通知模板</td>
</tr>
<tr>
<td>notice_template.recovery_template</td>
<td>string</td>
<td>恢复通知模板</td>
</tr>
<tr>
<td>notice_group_list</td>
<td>list</td>
<td>通知组列表(NoticeGroup)</td>
</tr>
</tbody>
</table>
<h4 id="noticegroup">NoticeGroup</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>notice_receiver</td>
<td>list</td>
<td>接收人</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>通知组名称</td>
</tr>
<tr>
<td>notice_way</td>
<td>dict</td>
<td>通知方式，告警级别为 key，value 是通知方式组成的 list</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>备注</td>
</tr>
<tr>
<td>id</td>
<td>int</td>
<td>通知组 ID</td>
</tr>
</tbody>
</table>
<h4 id="item">Item</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>rt_query_config</td>
<td>dict</td>
<td>指标查询配置(RtQueryConfig)</td>
</tr>
<tr>
<td>metric_id</td>
<td>string</td>
<td>指标</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>监控项名称</td>
</tr>
<tr>
<td>data_source_label</td>
<td>string</td>
<td>数据源</td>
</tr>
<tr>
<td>algorithm_list</td>
<td>list</td>
<td>算法配置列表(Algorithm)</td>
</tr>
<tr>
<td>no_data_config</td>
<td>dict</td>
<td>无数据配置</td>
</tr>
<tr>
<td>no_data_config.is_enabled</td>
<td>bool</td>
<td>是否开启无数据告警</td>
</tr>
<tr>
<td>no_data_config.continous</td>
<td>int</td>
<td>无数据告警检测周期数</td>
</tr>
<tr>
<td>data_type_label</td>
<td>string</td>
<td>数据类型</td>
</tr>
</tbody>
</table>
<h4 id="rtqueryconfig">RtQueryConfig</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>metric_field</td>
<td>string</td>
<td>指标名</td>
</tr>
<tr>
<td>unit_conversion</td>
<td>int</td>
<td>单位转换</td>
</tr>
<tr>
<td>unit</td>
<td>string</td>
<td>单位</td>
</tr>
<tr>
<td>extend_fields</td>
<td>string</td>
<td>其他字段</td>
</tr>
<tr>
<td>agg_condition</td>
<td>list</td>
<td>查询条件</td>
</tr>
<tr>
<td>agg_interval</td>
<td>int</td>
<td>聚合周期</td>
</tr>
<tr>
<td>agg_dimension</td>
<td>list</td>
<td>查询维度</td>
</tr>
<tr>
<td>agg_method</td>
<td>string</td>
<td>聚合方法</td>
</tr>
<tr>
<td>result_table_id</td>
<td>string</td>
<td>结果表 ID</td>
</tr>
</tbody>
</table>
<h4 id="algorithm">Algorithm</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>algorithm_config</td>
<td>list</td>
<td>算法配置列表</td>
</tr>
<tr>
<td>level</td>
<td>int</td>
<td>告警级别</td>
</tr>
<tr>
<td>trigger_config</td>
<td>dict</td>
<td>触发条件</td>
</tr>
<tr>
<td>trigger_config.count</td>
<td>int</td>
<td>触发阈值</td>
</tr>
<tr>
<td>trigger_config.check_window</td>
<td>int</td>
<td>触发检测窗口数</td>
</tr>
<tr>
<td>algorithm_type</td>
<td>string</td>
<td>算法类型</td>
</tr>
<tr>
<td>recovery_config</td>
<td>dict</td>
<td>恢复配置</td>
</tr>
<tr>
<td>recovery_config.check_window</td>
<td>int</td>
<td>恢复周期数</td>
</tr>
<tr>
<td>message_template</td>
<td>string</td>
<td></td>
</tr>
</tbody>
</table>
<h4 id="_9">示例数据</h4>
<pre class="codehilite"><code class="language-json">{
    &quot;message&quot;: &quot;OK&quot;,
    &quot;code&quot;: &quot;0&quot;,
    &quot;data&quot;: [
        {
            &quot;bk_biz_id&quot;: 2,
            &quot;item_list&quot;: [
                {
                    &quot;update_time&quot;: &quot;2019-11-22 14:50:23+0800&quot;,
                    &quot;data_type_label&quot;: &quot;time_series&quot;,
                    &quot;metric_id&quot;: &quot;bk_monitor.system.cpu_detail.idle&quot;,
                    &quot;item_name&quot;: &quot;空闲率&quot;,
                    &quot;strategy_id&quot;: 1,
                    &quot;data_source_label&quot;: &quot;bk_monitor&quot;,
                    &quot;algorithm_list&quot;: [
                        {
                            &quot;algorithm_config&quot;: [
                                {
                                    &quot;threshold&quot;: 0.1,
                                    &quot;method&quot;: &quot;gte&quot;
                                }
                            ],
                            &quot;update_time&quot;: &quot;2019-11-22 14:50:23+0800&quot;,
                            &quot;trigger_config&quot;: {
                                &quot;count&quot;: 1,
                                &quot;check_window&quot;: 5
                            },
                            &quot;strategy_id&quot;: 1,
                            &quot;level&quot;: 1,
                            &quot;algorithm_type&quot;: &quot;Threshold&quot;,
                            &quot;recovery_config&quot;: {
                                &quot;check_window&quot;: 5
                            },
                            &quot;create_time&quot;: &quot;2019-11-22 14:50:23+0800&quot;,
                            &quot;algorithm_id&quot;: 19,
                            &quot;message_template&quot;: &quot;&quot;,
                            &quot;item_id&quot;: 2,
                            &quot;id&quot;: 19
                        }
                    ],
                    &quot;no_data_config&quot;: {
                        &quot;is_enabled&quot;: false,
                        &quot;continuous&quot;: 5
                    },
                    &quot;create_time&quot;: &quot;2019-10-26 15:54:18+0800&quot;,
                    &quot;rt_query_config_id&quot;: 2,
                    &quot;item_id&quot;: 2,
                    &quot;rt_query_config&quot;: {
                        &quot;update_time&quot;: &quot;2019-11-22 14:50:23+0800&quot;,
                        &quot;metric_field&quot;: &quot;idle&quot;,
                        &quot;agg_dimension&quot;: [
                            &quot;ip&quot;,
                            &quot;bk_cloud_id&quot;
                        ],
                        &quot;unit_conversion&quot;: 1,
                        &quot;result_table_id&quot;: &quot;system.cpu_detail&quot;,
                        &quot;extend_fields&quot;: &quot;&quot;,
                        &quot;create_time&quot;: &quot;2019-10-26 15:54:18+0800&quot;,
                        &quot;rt_query_config_id&quot;: 2,
                        &quot;agg_method&quot;: &quot;AVG&quot;,
                        &quot;agg_condition&quot;: [],
                        &quot;agg_interval&quot;: 60,
                        &quot;id&quot;: 2,
                        &quot;unit&quot;: &quot;%&quot;
                    },
                    &quot;id&quot;: 2,
                    &quot;name&quot;: &quot;空闲率&quot;
                }
            ],
            &quot;update_time&quot;: &quot;2019-11-22 14:50:23+0800&quot;,
            &quot;target&quot;: [
                [
                    {
                        &quot;field&quot;: &quot;bk_target_ip&quot;,
                        &quot;method&quot;: &quot;eq&quot;,
                        &quot;value&quot;: [
                            {
                                &quot;bk_target_ip&quot;: &quot;10.0.1.10&quot;,
                                &quot;bk_target_cloud_id&quot;: 0
                            }
                        ]
                    }
                ]
            ],
            &quot;scenario&quot;: &quot;os&quot;,
            &quot;strategy_id&quot;: 1,
            &quot;action_list&quot;: [
                {
                    &quot;update_time&quot;: &quot;2019-11-22 14:50:24+0800&quot;,
                    &quot;notice_template&quot;: {
                        &quot;recovery_template&quot;: &quot;&quot;,
                        &quot;update_time&quot;: &quot;2019-11-22 14:50:24+0800&quot;,
                        &quot;create_time&quot;: &quot;2019-10-26 15:54:19+0800&quot;,
                        &quot;anomaly_template&quot;: &quot;aa&quot;,
                        &quot;action_id&quot;: 2
                    },
                    &quot;id&quot;: 2,
                    &quot;notice_group_list&quot;: [
                        {
                            &quot;update_time&quot;: &quot;2019-11-18 17:51:54+0800&quot;,
                            &quot;notice_receiver&quot;: [
                                {
                                    &quot;type&quot;: &quot;user&quot;,
                                    &quot;id&quot;: &quot;admin&quot;
                                }
                            ],
                            &quot;name&quot;: &quot;user group&quot;,
                            &quot;notice_way&quot;: {
                                &quot;1&quot;: [
                                    &quot;weixin&quot;
                                ],
                                &quot;2&quot;: [
                                    &quot;weixin&quot;
                                ],
                                &quot;3&quot;: [
                                    &quot;weixin&quot;
                                ]
                            },
                            &quot;create_time&quot;: &quot;2019-11-18 17:51:54+0800&quot;,
                            &quot;notice_group_id&quot;: 5,
                            &quot;message&quot;: &quot;asdf&quot;,
                            &quot;notice_group_name&quot;: &quot;user group&quot;,
                            &quot;id&quot;: 5
                        }
                    ],
                    &quot;create_time&quot;: &quot;2019-10-26 15:54:18+0800&quot;,
                    &quot;action_type&quot;: &quot;notice&quot;,
                    &quot;config&quot;: {
                        &quot;alarm_end_time&quot;: &quot;23:59:59&quot;,
                        &quot;send_recovery_alarm&quot;: false,
                        &quot;alarm_start_time&quot;: &quot;00:00:00&quot;,
                        &quot;alarm_interval&quot;: 120
                    },
                    &quot;strategy_id&quot;: 1,
                    &quot;action_id&quot;: 2
                }
            ],
            &quot;source_type&quot;: &quot;BKMONITOR&quot;,
            &quot;strategy_name&quot;: &quot;test&quot;,
            &quot;create_time&quot;: &quot;2019-10-23 21:34:12+0800&quot;,
            &quot;id&quot;: 1,
            &quot;name&quot;: &quot;test&quot;
        }
    ],
    &quot;result&quot;: true
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/monitor_v3/search_event/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>查询事件</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_ids</td>
<td>list</td>
<td>是</td>
<td>业务 ID 列表</td>
</tr>
<tr>
<td>time_range</td>
<td>string</td>
<td>否</td>
<td>事件结束的时间范围，格式为：2020-02-26 00:00:00 -- 2020-02-28 23:59:59</td>
</tr>
<tr>
<td>days</td>
<td>int</td>
<td>否</td>
<td>查询最近几天内的时间，这个参数存在，time_range 则失效</td>
</tr>
<tr>
<td>conditions</td>
<td>list</td>
<td>否</td>
<td>查询条件</td>
</tr>
</tbody>
</table>
<blockquote>
<p>需要注意的是，当前未恢复的事件不受时间条件的约束，也就是无论选择什么时间范围，当前的未恢复的事件都会被查出来，除非使用 conditions 进行事件状态过滤。</p>
</blockquote>
<h4 id="conditions">conditions</h4>
<p>conditions 用于按事件相关的其他字段过滤事件，由 key,value 组成，意味着过滤出 key 字段在 value 列表中事件。</p>
<p>如下列匹配条件，表示筛选出事件状态为“已恢复”的事件。</p>
<pre class="codehilite"><code class="language-json">[
  {
    &quot;key&quot;:&quot;event_status&quot;,
    &quot;value&quot;:[&quot;RECOVERED&quot;]
  }
]</code></pre>


<p>可用的字段有：</p>
<ol>
<li>
<p>strategy_id - 事件关联的策略 ID</p>
</li>
<li>
<p>id - 事件 ID</p>
</li>
<li>
<p>level - 告警级别</p>
</li>
<li>
<p>1 - 致命</p>
</li>
<li>2 - 预警</li>
<li>
<p>3 - 提醒</p>
</li>
<li>
<p>event_status - 事件状态</p>
</li>
<li>
<p>ABNORMAL - 未恢复</p>
</li>
<li>CLOSED - 已关闭</li>
<li>
<p>RECOVERED - 已恢复</p>
</li>
<li>
<p>data_source - 数据来源及类型</p>
</li>
</ol>
<p>是由 <code>|</code>分隔的字符串，左边为数据来源，右边为数据类型，比如<code>bk_monitor|time_series</code></p>
<p>数据来源有：</p>
<ol>
<li>bk_monitor - 监控采集</li>
<li>bk_data - 计算平台</li>
<li>bk_log_search - 日志检索</li>
<li>custom - 用户自定义</li>
</ol>
<p>数据类型有:</p>
<ol>
<li>time_series - 时序数据</li>
<li>event - 事件</li>
<li>log - 日志关键字</li>
</ol>
<h4 id="_7">示例数据</h4>
<pre class="codehilite"><code class="language-json">{
  &quot;bk_biz_ids&quot;:[2],
  &quot;time_range&quot;:&quot;2020-02-26 00:00:00 -- 2020-02-28 23:59:59&quot;,
  &quot;conditions&quot;:[
    {
      &quot;key&quot;:&quot;event_status&quot;,
      &quot;value&quot;:[
        &quot;RECOVERED&quot;
      ]
    },
    {
      &quot;key&quot;:&quot;data_source&quot;,
      &quot;value&quot;:[
        &quot;bk_monitor|time_series&quot;
      ]
    }
  ]
}</code></pre>


<h3 id="_8">响应参数</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>业务 ID</td>
</tr>
<tr>
<td>is_ack</td>
<td>bool</td>
<td>是否确认</td>
</tr>
<tr>
<td>level</td>
<td>int</td>
<td>告警级别，1(执行) 2(预警) 3(提醒)</td>
</tr>
<tr>
<td>origin_alarm</td>
<td>dict</td>
<td>事件产生时的异常点数据</td>
</tr>
<tr>
<td>origin_config</td>
<td>dict</td>
<td>事件产生时的告警策略配置，数据请参考告警策略相关文档</td>
</tr>
<tr>
<td>strategy_id</td>
<td>int</td>
<td>告警策略 ID</td>
</tr>
<tr>
<td>id</td>
<td>int</td>
<td>事件表自增 ID</td>
</tr>
<tr>
<td>is_shielded</td>
<td>bool</td>
<td>是否在屏蔽中</td>
</tr>
<tr>
<td>event_id</td>
<td>string</td>
<td>异常事件 ID</td>
</tr>
<tr>
<td>status</td>
<td>int</td>
<td>事件状态，ABNORMAL(未恢复) CLOSED(已关闭) RECOVERED(已恢复)</td>
</tr>
<tr>
<td>create_time</td>
<td>string</td>
<td>产生事件的时间，格式为 yyyy-mm-dd hh:mm:ss</td>
</tr>
<tr>
<td>begin_time</td>
<td>string</td>
<td>该事件关联的第一个异常点的创建时间，格式为 yyyy-mm-dd hh:mm:ss</td>
</tr>
<tr>
<td>end_time</td>
<td>string</td>
<td>事件结束时间，格式为 yyyy-mm-dd hh:mm:ss</td>
</tr>
<tr>
<td>target_key</td>
<td>string</td>
<td>事件目标，不存在则为空字符串</td>
</tr>
<tr>
<td>p_event_id</td>
<td>string</td>
<td>父事件 ID，默认为空</td>
</tr>
</tbody>
</table>
<h4 id="target-key">target key</h4>
<p>表示当前事件对应的监控目标，数据格式如下：</p>
<ul>
<li>主机: host|${ip}|${bk_cloud_id}
    eg: host|10.0.0.1|0</li>
<li>服务实例: service|${bk_target_service_instance_id}
    eg: service|13</li>
<li>拓扑节点: topo|${bk_obj_id}|${bk_inst_id}
    eg: topo|biz|2</li>
<li>无: ""</li>
</ul>
<h4 id="origin_alarm">origin_alarm</h4>
<p>表示事件发生时的异常点数据，这里介绍其中的几个常用字段。</p>
<ol>
<li>data.dimensions - 维度数据</li>
</ol>
<p><code>json
   {
     "bk_topo_node":[
       "set|2",
       "biz|2",
       "module|3"
     ],
     "bk_target_cloud_id":0,
     "bk_target_ip":"10.0.1.113"
   }</code></p>
<ol>
<li>
<p>data.value - 异常点的值</p>
</li>
<li>
<p>data.time - 异常点的时间戳</p>
</li>
<li>
<p>anomaly - 异常信息</p>
</li>
</ol>
<p>key 是告警级别</p>
<p><code>json
   {
     "1": {
       "anomaly_message": "count &gt;= 1.0, 当前值10.0",
       "anomaly_time": "2019-11-22 16:31:06",
       "anomaly_id": "d751713988987e9331980363e24189ce.1574439900.88.118.1"
     }
   }</code></p>
<ol>
<li>anomaly_message - 异常描述</li>
<li>anomaly_time - 异常时间</li>
<li>
<p>anomaly_id - 异常点 ID</p>
</li>
<li>
<p>dimension_translation - 维度展示信息</p>
</li>
</ol>
<p>将维度翻译成给用户展示的内容，与 data.dimensions 的信息对应</p>
<p><code>json
   {
     "bk_topo_node":{
       "display_name":"bk_topo_node",
       "display_value":[
         {
           "bk_obj_name":"集群",
           "bk_inst_name":"空闲机池"
         },
         {
           "bk_obj_name":"业务",
           "bk_inst_name":"蓝鲸"
         },
         {
           "bk_obj_name":"模块",
           "bk_inst_name":"空闲机"
         }
       ],
       "value":[
         "set|2",
         "biz|2",
         "module|3"
       ]
     },
     "bk_target_cloud_id":{
       "display_name":"bk_target_cloud_id",
       "display_value":0,
       "value":0
     },
     "bk_target_ip":{
       "display_name":"bk_target_ip",
       "display_value":"10.0.1.62",
       "value":"10.0.1.62"
     }
   }</code></p>
<ol>
<li>display_name - 维度名称</li>
<li>display_value - 维度的值</li>
<li>value - 维度的原始值</li>
</ol>
<h4 id="_9">示例数据</h4>
<pre class="codehilite"><code class="language-json">[
  {
    &quot;status&quot;: &quot;ABNORMAL&quot;,
    &quot;bk_biz_id&quot;: 2,
    &quot;is_ack&quot;: false,
    &quot;level&quot;: 1,
    &quot;origin_alarm&quot;: {
      &quot;data&quot;: {
        &quot;record_id&quot;: &quot;d751713988987e9331980363e24189ce.1574439900&quot;,
        &quot;values&quot;: {
          &quot;count&quot;: 10,
          &quot;dtEventTimeStamp&quot;: 1574439900
        },
        &quot;dimensions&quot;: {},
        &quot;value&quot;: 10,
        &quot;time&quot;: 1574439900
      },
      &quot;trigger&quot;: {
        &quot;level&quot;: &quot;1&quot;,
        &quot;anomaly_ids&quot;: [
          &quot;d751713988987e9331980363e24189ce.1574439660.88.118.1&quot;,
          &quot;d751713988987e9331980363e24189ce.1574439720.88.118.1&quot;,
          &quot;d751713988987e9331980363e24189ce.1574439780.88.118.1&quot;,
          &quot;d751713988987e9331980363e24189ce.1574439840.88.118.1&quot;,
          &quot;d751713988987e9331980363e24189ce.1574439900.88.118.1&quot;,
          &quot;d751713988987e9331980363e24189ce.1574439960.88.118.1&quot;,
          &quot;d751713988987e9331980363e24189ce.1574440020.88.118.1&quot;,
          &quot;d751713988987e9331980363e24189ce.1574440080.88.118.1&quot;,
          &quot;d751713988987e9331980363e24189ce.1574440140.88.118.1&quot;
        ]
      },
      &quot;anomaly&quot;: {
        &quot;1&quot;: {
          &quot;anomaly_message&quot;: &quot;count &gt;= 1.0, 当前值10.0&quot;,
          &quot;anomaly_time&quot;: &quot;2019-11-22 16:31:06&quot;,
          &quot;anomaly_id&quot;: &quot;d751713988987e9331980363e24189ce.1574439900.88.118.1&quot;
        }
      },
      &quot;dimension_translation&quot;: {},
      &quot;strategy_snapshot_key&quot;: &quot;bk_bkmonitor.ee.cache.strategy.snapshot.88.1574411061&quot;
    },
    &quot;target_key&quot;: &quot;&quot;,
    &quot;strategy_id&quot;: 88,
    &quot;id&quot;: 1364253,
    &quot;is_shielded&quot;: false,
    &quot;event_id&quot;: &quot;d751713988987e9331980363e24189ce.1574439660.88.118.1&quot;,
    &quot;create_time&quot;: &quot;2019-11-22 16:31:07&quot;,
    &quot;end_time&quot;: null,
    &quot;begin_time&quot;: &quot;2019-11-22 16:25:00&quot;,
    &quot;origin_config&quot;: {},
    &quot;p_event_id&quot;: &quot;&quot;
  }
]</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/monitor_v3/search_notice_group/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>查询告警组</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_ids</td>
<td>list</td>
<td>否</td>
<td>业务 ID</td>
</tr>
<tr>
<td>ids</td>
<td>list</td>
<td>否</td>
<td>通知组 ID</td>
</tr>
</tbody>
</table>
<h4 id="_7">示例数据</h4>
<pre class="codehilite"><code class="language-json">{
  &quot;bk_biz_ids&quot;: [2],
  &quot;ids&quot;: [1]
}</code></pre>


<h3 id="_8">响应参数</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>业务 ID</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>名称</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>说明</td>
</tr>
<tr>
<td>notice_way</td>
<td>dict</td>
<td>各个级别的通知方式</td>
</tr>
<tr>
<td>id</td>
<td>int</td>
<td>告警 ID</td>
</tr>
<tr>
<td>notice_receiver</td>
<td>list</td>
<td>通知人列表</td>
</tr>
<tr>
<td>webhook_url</td>
<td>string</td>
<td>回调地址</td>
</tr>
</tbody>
</table>
<h4 id="_9">示例数据</h4>
<pre class="codehilite"><code class="language-json">{
  &quot;message&quot;: &quot;OK&quot;,
  &quot;code&quot;: &quot;0&quot;,
  &quot;data&quot;: [
    {
      &quot;bk_biz_id&quot;: 2,
      &quot;update_time&quot;: &quot;2019-11-18 17:51:54+0800&quot;,
      &quot;notice_receiver&quot;: [
        {
          &quot;type&quot;: &quot;user&quot;,
          &quot;id&quot;: &quot;admin&quot;
        }
      ],
      &quot;update_user&quot;: &quot;admin&quot;,
      &quot;name&quot;: &quot;layman&quot;,
      &quot;notice_way&quot;: {
        &quot;1&quot;: [&quot;weixin&quot;],
        &quot;2&quot;: [&quot;weixin&quot;],
        &quot;3&quot;: [&quot;weixin&quot;]
      },
      &quot;create_time&quot;: &quot;2019-11-18 17:51:54+0800&quot;,
      &quot;message&quot;: &quot;&quot;,
      &quot;webhook_url&quot;: &quot;&quot;,
      &quot;id&quot;: 5
    }
  ],
  &quot;result&quot;: true
}</code></pre><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/monitor_v3/switch_alarm_strategy/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>开关告警策略</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">ids</td>
<td>list</td>
<td>是</td>
<td>策略 ID 列表</td>
</tr>
<tr>
<td align="left">is_enabled</td>
<td>string</td>
<td>是</td>
<td>是否开启</td>
</tr>
</tbody>
</table>
<h3 id="_7">响应参数</h3>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">ids</td>
<td>list</td>
<td>存在的策略 ID 列表</td>
</tr>
</tbody>
</table><h2 id="api">标准运维 API 文档简介</h2>
<table>
<thead>
<tr>
<th>资源名称</th>
<th>资源描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="./claim_functionalization_task.md">claim_functionalization_task</a></td>
<td>认领职能化任务</td>
</tr>
<tr>
<td><a href="./create_periodic_task.md">create_periodic_task</a></td>
<td>通过流程模板新建周期任务</td>
</tr>
<tr>
<td><a href="./create_task.md">create_task</a></td>
<td>通过流程模板新建任务</td>
</tr>
<tr>
<td><a href="./fast_create_task.md">fast_create_task</a></td>
<td>快速新建一次性任务</td>
</tr>
<tr>
<td><a href="./get_common_template_info.md">get_common_template_info</a></td>
<td>查询单个公共流程模板详情</td>
</tr>
<tr>
<td><a href="./get_common_template_list.md">get_common_template_list</a></td>
<td>查询公共模板列表</td>
</tr>
<tr>
<td><a href="./get_periodic_task_info.md">get_periodic_task_info</a></td>
<td>查询业务下的某个周期任务详情</td>
</tr>
<tr>
<td><a href="./get_periodic_task_list.md">get_periodic_task_list</a></td>
<td>查询业务下的周期任务列表</td>
</tr>
<tr>
<td><a href="./get_plugin_list.md">get_plugin_list</a></td>
<td>查询某个业务下的插件列表</td>
</tr>
<tr>
<td><a href="./get_task_detail.md">get_tasks_status</a></td>
<td>批量查询任务状态</td>
</tr>
<tr>
<td><a href="./get_task_list.md">get_task_detail</a></td>
<td>查询任务执行详情</td>
</tr>
<tr>
<td><a href="./get_task_node_data.md">get_task_list</a></td>
<td>获取业务下的任务列表</td>
</tr>
<tr>
<td><a href="./get_task_node_detail.md">get_task_node_data</a></td>
<td>获取节点执行数据</td>
</tr>
<tr>
<td><a href="./get_task_status.md">get_task_node_detail</a></td>
<td>查询任务节点执行详情</td>
</tr>
<tr>
<td><a href="./get_tasks_status.md">get_task_status</a></td>
<td>查询任务或任务节点执行状态</td>
</tr>
<tr>
<td><a href="./get_template_info.md">get_template_info</a></td>
<td>查询单个模板详情</td>
</tr>
<tr>
<td><a href="./get_template_list.md">get_template_list</a></td>
<td>查询模板列表</td>
</tr>
<tr>
<td><a href="./get_template_schemes.md">get_template_schemes</a></td>
<td>获取模板执行方案列表</td>
</tr>
<tr>
<td><a href="./get_user_project_detail.md">get_user_project_detail</a></td>
<td>获取项目详情</td>
</tr>
<tr>
<td><a href="./get_user_project_list.md">get_user_project_list</a></td>
<td>获取用户有权限的项目列表</td>
</tr>
<tr>
<td><a href="./import_common_template.md">import_common_template</a></td>
<td>导入公共流程</td>
</tr>
<tr>
<td><a href="./import_project_template.md">import_project_template</a></td>
<td>导入业务流程模板</td>
</tr>
<tr>
<td><a href="./modify_constants_for_periodic_task.md">modify_constants_for_periodic_task</a></td>
<td>修改周期任务的全局参数</td>
</tr>
<tr>
<td><a href="./modify_constants_for_task.md">modify_constants_for_task</a></td>
<td>修改任务的全局参数</td>
</tr>
<tr>
<td><a href="./modify_cron_for_periodic_task.md">modify_cron_for_periodic_task</a></td>
<td>修改周期任务的调度策略</td>
</tr>
<tr>
<td><a href="./node_callback.md">node_callback</a></td>
<td>回调任务节点</td>
</tr>
<tr>
<td><a href="./operate_node.md">operate_node</a></td>
<td>操作任务中的节点</td>
</tr>
<tr>
<td><a href="./operate_task.md">operate_task</a></td>
<td>操作任务</td>
</tr>
<tr>
<td><a href="./preview_task_tree.md">preview_task_tree</a></td>
<td>获取节点选择后新的任务树</td>
</tr>
<tr>
<td><a href="./query_task_count.md">query_task_count</a></td>
<td>查询任务分类统计总数</td>
</tr>
<tr>
<td><a href="./set_periodic_task_enabled.md">set_periodic_task_enabled</a></td>
<td>设置周期任务是否激活</td>
</tr>
<tr>
<td><a href="./start_task.md">start_task</a></td>
<td>开始执行任务</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/sops/claim_functionalization_task/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>职能化任务认领</p>
<h4 id="_4">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_5">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>task_id</td>
<td>string</td>
<td>是</td>
<td>任务 ID，需要任务状态是未开始的</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>string</td>
<td>是</td>
<td>模板所属业务 ID</td>
</tr>
<tr>
<td>constants</td>
<td>dict</td>
<td>是</td>
<td>任务全局参数，详细信息见下面说明</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>否</td>
<td>任务新名称</td>
</tr>
<tr>
<td>scope</td>
<td>string</td>
<td>否</td>
<td>bk_biz_id 检索的作用域。默认为 cmdb_biz，此时检索的是绑定的 CMDB 业务 ID 为 bk_biz_id 的项目；当值为 project 时则检索项目 ID 为 bk_biz_id 的项目</td>
</tr>
</tbody>
</table>
<h4 id="constants-key">constants KEY</h4>
<p>变量 KEY，${key} 格式</p>
<h4 id="constants-value">constants VALUE</h4>
<p>变量值</p>
<h3 id="_6">请求参数示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_biz_id&quot;: &quot;2&quot;,
    &quot;task_id&quot;: &quot;8&quot;,
    &quot;constants&quot;: {
        &quot;${bk_timing}&quot;: &quot;100&quot;
    }
}</code></pre>


<h3 id="_7">返回结果示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;data&quot;: &quot;success&quot;,
    &quot;result&quot;: true, 
    &quot;code&quot;: 0
}</code></pre>


<h3 id="_8">返回结果说明</h3>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>true/false 操作是否成功</td>
</tr>
<tr>
<td>data</td>
<td>string</td>
<td>result=true 时成功数据, "success"</td>
</tr>
<tr>
<td>code</td>
<td>int</td>
<td>结果状态码</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>result=false 时错误信息</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/sops/create_periodic_task/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>创建周期任务</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>template_id</td>
<td>string</td>
<td>是</td>
<td>用于创建任务的模板 ID</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>string</td>
<td>是</td>
<td>任务所属业务 ID</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>是</td>
<td>要创建的周期任务名称</td>
</tr>
<tr>
<td>cron</td>
<td>dict</td>
<td>是</td>
<td>要创建的周期任务调度策略</td>
</tr>
<tr>
<td>constants</td>
<td>dict</td>
<td>否</td>
<td>任务全局参数，详细信息见下面说明</td>
</tr>
<tr>
<td>exclude_task_nodes_id</td>
<td>list</td>
<td>否</td>
<td>跳过执行的节点 ID 列表</td>
</tr>
</tbody>
</table>
<h4 id="constantskey">constants.KEY</h4>
<p>变量 KEY，${key} 格式</p>
<h4 id="constantsvalue">constants.VALUE</h4>
<p>变量值</p>
<h4 id="cron">cron</h4>
<table>
<thead>
<tr>
<th>参数名称</th>
<th>参数类型</th>
<th>必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>minute</td>
<td>string</td>
<td>否</td>
<td>分，默认为 *</td>
</tr>
<tr>
<td>hour</td>
<td>string</td>
<td>否</td>
<td>时，默认为 *</td>
</tr>
<tr>
<td>day_of_week</td>
<td>string</td>
<td>否</td>
<td>一周内的某些天，默认为 *</td>
</tr>
<tr>
<td>day_of_month</td>
<td>string</td>
<td>否</td>
<td>一个月中的某些天，默认为 *</td>
</tr>
<tr>
<td>month_of_year</td>
<td>string</td>
<td>否</td>
<td>一年中的某些月份，默认为 *</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;template_id&quot;: &quot;1&quot;,
    &quot;bk_biz_id&quot;: &quot;2&quot;,
    &quot;name&quot;: &quot;from api 3&quot;,
    &quot;cron&quot; : {&quot;minute&quot;: &quot;*/1&quot;, &quot;hour&quot;: &quot;15&quot;, &quot;day_of_week&quot;:&quot;*&quot;, &quot;day_of_month&quot;:&quot;*&quot;, &quot;month_of_year&quot;:&quot;*&quot;},
    &quot;constants&quot;: {&quot;${bk_timing}&quot;: &quot;100&quot;},
    &quot;exclude_task_nodes_id&quot;: [&quot;nodea5c396a3ef0f9f3cd7d4d7695f78&quot;]
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: {
        &quot;cron&quot;: &quot;*/1 15 * * * (m/h/d/dM/MY)&quot;,
        &quot;total_run_count&quot;: 0,
        &quot;name&quot;: &quot;from api 3&quot;,
        &quot;form&quot;: {
            &quot;${bk_timing}&quot;: {
                &quot;source_tag&quot;: &quot;sleep_timer.bk_timing&quot;,
                &quot;source_info&quot;: {
                    &quot;node76393dcfedcf73dbc726f1c4786d&quot;: [
                        &quot;bk_timing&quot;
                    ]
                },
                &quot;name&quot;: &quot;定时时间&quot;,
                &quot;index&quot;: 0,
                &quot;custom_type&quot;: &quot;&quot;,
                &quot;value&quot;: &quot;100&quot;,
                &quot;show_type&quot;: &quot;show&quot;,
                &quot;source_type&quot;: &quot;component_inputs&quot;,
                &quot;key&quot;: &quot;${bk_timing}&quot;,
                &quot;validation&quot;: &quot;&quot;,
                &quot;desc&quot;: &quot;&quot;
            }
        },
        &quot;creator&quot;: &quot;admin&quot;,
        &quot;pipeline_tree&quot;: {
            &quot;activities&quot;: {
                &quot;node76393dcfedcf73dbc726f1c4786d&quot;: {
                    &quot;outgoing&quot;: &quot;linecf7b7f10c87187a88b72c5f91177&quot;,
                    &quot;incoming&quot;: &quot;linecd597f19606c1455d661f71a582d&quot;,
                    &quot;name&quot;: &quot;定时&quot;,
                    &quot;error_ignorable&quot;: false,
                    &quot;component&quot;: {
                        &quot;code&quot;: &quot;sleep_timer&quot;,
                        &quot;data&quot;: {
                            &quot;bk_timing&quot;: {
                                &quot;hook&quot;: true,
                                &quot;value&quot;: &quot;${bk_timing}&quot;
                            }
                        }
                    },
                    &quot;stage_name&quot;: &quot;步骤1&quot;,
                    &quot;optional&quot;: false,
                    &quot;type&quot;: &quot;ServiceActivity&quot;,
                    &quot;id&quot;: &quot;node76393dcfedcf73dbc726f1c4786d&quot;,
                    &quot;loop&quot;: {}
                }
            },
            &quot;end_event&quot;: {
                &quot;incoming&quot;: &quot;linecf7b7f10c87187a88b72c5f91177&quot;,
                &quot;outgoing&quot;: &quot;&quot;,
                &quot;type&quot;: &quot;EmptyEndEvent&quot;,
                &quot;id&quot;: &quot;node375320830be9c46cd89f4069857d&quot;,
                &quot;name&quot;: &quot;&quot;
            },
            &quot;outputs&quot;: [],
            &quot;flows&quot;: {
                &quot;linecd597f19606c1455d661f71a582d&quot;: {
                    &quot;is_default&quot;: false,
                    &quot;source&quot;: &quot;node4e87796ddd76b0d59337b08f385d&quot;,
                    &quot;id&quot;: &quot;linecd597f19606c1455d661f71a582d&quot;,
                    &quot;target&quot;: &quot;node76393dcfedcf73dbc726f1c4786d&quot;
                },
                &quot;linecf7b7f10c87187a88b72c5f91177&quot;: {
                    &quot;is_default&quot;: false,
                    &quot;source&quot;: &quot;node76393dcfedcf73dbc726f1c4786d&quot;,
                    &quot;id&quot;: &quot;linecf7b7f10c87187a88b72c5f91177&quot;,
                    &quot;target&quot;: &quot;node375320830be9c46cd89f4069857d&quot;
                }
            },
            &quot;gateways&quot;: {},
            &quot;line&quot;: [
                {
                    &quot;source&quot;: {
                        &quot;id&quot;: &quot;node4e87796ddd76b0d59337b08f385d&quot;,
                        &quot;arrow&quot;: &quot;Right&quot;
                    },
                    &quot;id&quot;: &quot;linecd597f19606c1455d661f71a582d&quot;,
                    &quot;target&quot;: {
                        &quot;id&quot;: &quot;node76393dcfedcf73dbc726f1c4786d&quot;,
                        &quot;arrow&quot;: &quot;Left&quot;
                    }
                },
                {
                    &quot;source&quot;: {
                        &quot;id&quot;: &quot;node76393dcfedcf73dbc726f1c4786d&quot;,
                        &quot;arrow&quot;: &quot;Right&quot;
                    },
                    &quot;target&quot;: {
                        &quot;id&quot;: &quot;node375320830be9c46cd89f4069857d&quot;,
                        &quot;arrow&quot;: &quot;Left&quot;
                    },
                    &quot;id&quot;: &quot;linecf7b7f10c87187a88b72c5f91177&quot;
                }
            ],
            &quot;start_event&quot;: {
                &quot;incoming&quot;: &quot;&quot;,
                &quot;outgoing&quot;: &quot;linecd597f19606c1455d661f71a582d&quot;,
                &quot;type&quot;: &quot;EmptyStartEvent&quot;,
                &quot;id&quot;: &quot;node4e87796ddd76b0d59337b08f385d&quot;,
                &quot;name&quot;: &quot;&quot;
            },
            &quot;constants&quot;: {
                &quot;${bk_timing}&quot;: {
                    &quot;source_tag&quot;: &quot;sleep_timer.bk_timing&quot;,
                    &quot;source_info&quot;: {
                        &quot;node76393dcfedcf73dbc726f1c4786d&quot;: [
                            &quot;bk_timing&quot;
                        ]
                    },
                    &quot;name&quot;: &quot;定时时间&quot;,
                    &quot;index&quot;: 0,
                    &quot;custom_type&quot;: &quot;&quot;,
                    &quot;value&quot;: &quot;100&quot;,
                    &quot;show_type&quot;: &quot;show&quot;,
                    &quot;source_type&quot;: &quot;component_inputs&quot;,
                    &quot;key&quot;: &quot;${bk_timing}&quot;,
                    &quot;validation&quot;: &quot;&quot;,
                    &quot;desc&quot;: &quot;&quot;
                }
            },
            &quot;location&quot;: [
                {
                    &quot;y&quot;: 150,
                    &quot;x&quot;: 80,
                    &quot;type&quot;: &quot;startpoint&quot;,
                    &quot;id&quot;: &quot;node4e87796ddd76b0d59337b08f385d&quot;
                },
                {
                    &quot;y&quot;: 149,
                    &quot;x&quot;: 1092,
                    &quot;type&quot;: &quot;endpoint&quot;,
                    &quot;id&quot;: &quot;node375320830be9c46cd89f4069857d&quot;
                },
                {
                    &quot;stage_name&quot;: &quot;步骤1&quot;,
                    &quot;name&quot;: &quot;定时&quot;,
                    &quot;y&quot;: 133,
                    &quot;x&quot;: 300,
                    &quot;type&quot;: &quot;tasknode&quot;,
                    &quot;id&quot;: &quot;node76393dcfedcf73dbc726f1c4786d&quot;
                }
            ]
        },
        &quot;last_run_at&quot;: &quot;&quot;,
        &quot;enabled&quot;: false,
        &quot;id&quot;: 11,
        &quot;template_id&quot;: 2
    },
    &quot;result&quot;: true
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>true/false 操作是否成功</td>
</tr>
<tr>
<td>data</td>
<td>dict</td>
<td>result=true 时成功数据，详细信息请见下面说明</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>result=false 时错误信息</td>
</tr>
</tbody>
</table>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>cron</td>
<td>string</td>
<td>周期调度表达式</td>
</tr>
<tr>
<td>total_run_count</td>
<td>int</td>
<td>周期任务运行次数</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>周期任务名</td>
</tr>
<tr>
<td>creator</td>
<td>string</td>
<td>创建者</td>
</tr>
<tr>
<td>last_run_at</td>
<td>string</td>
<td>上次运行时间</td>
</tr>
<tr>
<td>enabled</td>
<td>bool</td>
<td>是否激活</td>
</tr>
<tr>
<td>id</td>
<td>int</td>
<td>周期任务 ID</td>
</tr>
<tr>
<td>template_id</td>
<td>string</td>
<td>用于创建该任务的模板 ID</td>
</tr>
<tr>
<td>form</td>
<td>dict</td>
<td>该周期任务的参数表单对象</td>
</tr>
<tr>
<td>pipeline_tree</td>
<td>dict</td>
<td>该周期任务的实例树</td>
</tr>
</tbody>
</table>
<h4 id="datapipeline_tree">data.pipeline_tree</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>start_event</td>
<td>dict</td>
<td>开始节点信息</td>
</tr>
<tr>
<td>end_event</td>
<td>dict</td>
<td>结束节点信息</td>
</tr>
<tr>
<td>activities</td>
<td>dict</td>
<td>任务节点（原子和子流程）信息</td>
</tr>
<tr>
<td>gateways</td>
<td>dict</td>
<td>网关节点（并行网关、分支网关和汇聚网关）信息</td>
</tr>
<tr>
<td>flows</td>
<td>dict</td>
<td>顺序流（节点连线）信息</td>
</tr>
<tr>
<td>constants</td>
<td>dict</td>
<td>全局变量信息，详情见下面</td>
</tr>
<tr>
<td>outputs</td>
<td>list</td>
<td>模板输出信息，标记 constants 中的输出字段</td>
</tr>
</tbody>
</table>
<h4 id="dataformkey-datapipeline_treeconstantskey">data.form.KEY, data.pipeline_tree.constants.KEY</h4>
<p>全局变量 KEY，${key} 格式</p>
<h4 id="dataformvalue-datapipeline_treeconstantsvalue">data.form.VALUE, data.pipeline_tree.constants.VALUE</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>key</td>
<td>string</td>
<td>同 KEY</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>变量名字</td>
</tr>
<tr>
<td>index</td>
<td>int</td>
<td>变量在模板中的显示顺序</td>
</tr>
<tr>
<td>desc</td>
<td>string</td>
<td>变量说明</td>
</tr>
<tr>
<td>source_type</td>
<td>string</td>
<td>变量来源, 取值范围 custom: 自定义变量，component_inputs: 从原子输入参数勾选，component_outputs：从原子输出结果中勾选</td>
</tr>
<tr>
<td>custom_type</td>
<td>string</td>
<td>source_type=custom 时有效，自定义变量类型， 取值范围 input: 输入框，textarea: 文本框，datetime: 日期时间，int: 整数</td>
</tr>
<tr>
<td>source_tag</td>
<td>string</td>
<td>source_type=component_inputs/component_outputs 时有效，变量的来源原子</td>
</tr>
<tr>
<td>source_info</td>
<td>dict</td>
<td>source_type=component_inputs/component_outputs 时有效，变量的来源节点信息</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/sops/create_task/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>通过流程模板创建任务</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>string</td>
<td>是</td>
<td>模板所属业务 ID</td>
</tr>
<tr>
<td>template_id</td>
<td>string</td>
<td>是</td>
<td>模板 ID</td>
</tr>
<tr>
<td>template_source</td>
<td>string</td>
<td>否</td>
<td>流程模板来源，business:默认值，业务流程，common：公共流程</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>是</td>
<td>任务名称</td>
</tr>
<tr>
<td>flow_type</td>
<td>string</td>
<td>否</td>
<td>任务流程类型，common: 常规流程，common_func：职能化流程</td>
</tr>
<tr>
<td>constants</td>
<td>dict</td>
<td>否</td>
<td>任务全局参数，详细信息见下面说明</td>
</tr>
<tr>
<td>exclude_task_nodes_id</td>
<td>list</td>
<td>否</td>
<td>跳过执行的节点 ID 列表</td>
</tr>
</tbody>
</table>
<h4 id="constantskey">constants.KEY</h4>
<p>变量 KEY，${key} 格式</p>
<h4 id="constantsvalue">constants.VALUE</h4>
<p>变量值，value 的类型和从模板获取的全局变量中 value 类型保持一致</p>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;name&quot;: &quot;tasktest&quot;,
    &quot;flow_type&quot;: &quot;common&quot;,
    &quot;constants&quot;: {
        &quot;${content}: &quot;echo 1&quot;,
        &quot;${params}&quot;: &quot;&quot;,
        &quot;${script_timeout}&quot;: 20
    }
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;result&quot;: true,
    &quot;data&quot;: {
        &quot;task_id&quot;: 10,
        &quot;task_url&quot;: &quot;http://bk_sops_host/taskflow/execute/3/?instance_id=15364&quot;,
        &quot;pipeline_tree&quot;: {
            &quot;activities&quot;: {
                &quot;node9b5ae13799d63e179f0ce3088b62&quot;: {
                    &quot;outgoing&quot;: &quot;line27bc7b4ccbcf37ddb9d1f6572a04&quot;,
                    &quot;incoming&quot;: &quot;line490caa49d2a03e64829693281032&quot;,
                    &quot;name&quot;: &quot;timing&quot;,
                    &quot;error_ignorable&quot;: false,
                    &quot;component&quot;: {
                        &quot;code&quot;: &quot;sleep_timer&quot;,
                        &quot;data&quot;: {
                            &quot;bk_timing&quot;: {
                                &quot;hook&quot;: false,
                                &quot;value&quot;: &quot;2&quot;
                            }
                        }
                    },
                    &quot;stage_name&quot;: &quot;步骤1&quot;,
                    &quot;can_retry&quot;: true,
                    &quot;isSkipped&quot;: true,
                    &quot;type&quot;: &quot;ServiceActivity&quot;,
                    &quot;optional&quot;: false,
                    &quot;id&quot;: &quot;node9b5ae13799d63e179f0ce3088b62&quot;,
                    &quot;loop&quot;: null
                },
                &quot;node880ded556c6c3c269be3cedc64b6&quot;: {
                    &quot;outgoing&quot;: &quot;line490caa49d2a03e64829693281032&quot;,
                    &quot;incoming&quot;: &quot;lineb83161d6e0593ad68d9ec73a961b&quot;,
                    &quot;name&quot;: &quot;暂停&quot;,
                    &quot;error_ignorable&quot;: false,
                    &quot;component&quot;: {
                        &quot;code&quot;: &quot;pause_node&quot;,
                        &quot;data&quot;: {}
                    },
                    &quot;stage_name&quot;: &quot;步骤1&quot;,
                    &quot;can_retry&quot;: true,
                    &quot;isSkipped&quot;: true,
                    &quot;type&quot;: &quot;ServiceActivity&quot;,
                    &quot;optional&quot;: true,
                    &quot;id&quot;: &quot;node880ded556c6c3c269be3cedc64b6&quot;,
                    &quot;loop&quot;: null
                }
            },
            &quot;end_event&quot;: {
                &quot;type&quot;: &quot;EmptyEndEvent&quot;,
                &quot;outgoing&quot;: &quot;&quot;,
                &quot;incoming&quot;: &quot;line27bc7b4ccbcf37ddb9d1f6572a04&quot;,
                &quot;id&quot;: &quot;node5c48f37aa9f0351e8b43ab6a2295&quot;,
                &quot;name&quot;: &quot;&quot;
            },
            &quot;outputs&quot;: [],
            &quot;flows&quot;: {
                &quot;line490caa49d2a03e64829693281032&quot;: {
                    &quot;is_default&quot;: false,
                    &quot;source&quot;: &quot;node880ded556c6c3c269be3cedc64b6&quot;,
                    &quot;id&quot;: &quot;line490caa49d2a03e64829693281032&quot;,
                    &quot;target&quot;: &quot;node9b5ae13799d63e179f0ce3088b62&quot;
                },
                &quot;lineb83161d6e0593ad68d9ec73a961b&quot;: {
                    &quot;is_default&quot;: false,
                    &quot;source&quot;: &quot;noded383bc1d7387391f889c6bab18b8&quot;,
                    &quot;id&quot;: &quot;lineb83161d6e0593ad68d9ec73a961b&quot;,
                    &quot;target&quot;: &quot;node880ded556c6c3c269be3cedc64b6&quot;
                },
                &quot;line27bc7b4ccbcf37ddb9d1f6572a04&quot;: {
                    &quot;is_default&quot;: false,
                    &quot;source&quot;: &quot;node9b5ae13799d63e179f0ce3088b62&quot;,
                    &quot;id&quot;: &quot;line27bc7b4ccbcf37ddb9d1f6572a04&quot;,
                    &quot;target&quot;: &quot;node5c48f37aa9f0351e8b43ab6a2295&quot;
                }
            },
            &quot;gateways&quot;: {},
            &quot;line&quot;: [
                {
                    &quot;source&quot;: {
                        &quot;id&quot;: &quot;node9b5ae13799d63e179f0ce3088b62&quot;,
                        &quot;arrow&quot;: &quot;Right&quot;
                    },
                    &quot;target&quot;: {
                        &quot;id&quot;: &quot;node5c48f37aa9f0351e8b43ab6a2295&quot;,
                        &quot;arrow&quot;: &quot;Left&quot;
                    },
                    &quot;id&quot;: &quot;line27bc7b4ccbcf37ddb9d1f6572a04&quot;
                },
                {
                    &quot;source&quot;: {
                        &quot;id&quot;: &quot;node880ded556c6c3c269be3cedc64b6&quot;,
                        &quot;arrow&quot;: &quot;Right&quot;
                    },
                    &quot;target&quot;: {
                        &quot;id&quot;: &quot;node9b5ae13799d63e179f0ce3088b62&quot;,
                        &quot;arrow&quot;: &quot;Left&quot;
                    },
                    &quot;id&quot;: &quot;line490caa49d2a03e64829693281032&quot;
                },
                {
                    &quot;source&quot;: {
                        &quot;id&quot;: &quot;noded383bc1d7387391f889c6bab18b8&quot;,
                        &quot;arrow&quot;: &quot;Right&quot;
                    },
                    &quot;id&quot;: &quot;lineb83161d6e0593ad68d9ec73a961b&quot;,
                    &quot;target&quot;: {
                        &quot;id&quot;: &quot;node880ded556c6c3c269be3cedc64b6&quot;,
                        &quot;arrow&quot;: &quot;Left&quot;
                    }
                }
            ],
            &quot;start_event&quot;: {
                &quot;type&quot;: &quot;EmptyStartEvent&quot;,
                &quot;outgoing&quot;: &quot;lineb83161d6e0593ad68d9ec73a961b&quot;,
                &quot;incoming&quot;: &quot;&quot;,
                &quot;id&quot;: &quot;noded383bc1d7387391f889c6bab18b8&quot;,
                &quot;name&quot;: &quot;&quot;
            },
            &quot;id&quot;: &quot;node7ef6970d06ad3bc092594cb5ec5f&quot;,
            &quot;constants&quot;: {},
            &quot;location&quot;: [
                {
                    &quot;stage_name&quot;: &quot;步骤1&quot;,
                    &quot;name&quot;: &quot;暂停&quot;,
                    &quot;y&quot;: 135,
                    &quot;x&quot;: 300,
                    &quot;type&quot;: &quot;tasknode&quot;,
                    &quot;id&quot;: &quot;node880ded556c6c3c269be3cedc64b6&quot;
                },
                {
                    &quot;y&quot;: 150,
                    &quot;x&quot;: 1000,
                    &quot;type&quot;: &quot;endpoint&quot;,
                    &quot;id&quot;: &quot;node5c48f37aa9f0351e8b43ab6a2295&quot;
                },
                {
                    &quot;stage_name&quot;: &quot;步骤1&quot;,
                    &quot;name&quot;: &quot;timing&quot;,
                    &quot;y&quot;: 135,
                    &quot;x&quot;: 595,
                    &quot;type&quot;: &quot;tasknode&quot;,
                    &quot;id&quot;: &quot;node9b5ae13799d63e179f0ce3088b62&quot;
                },
                {
                    &quot;y&quot;: 150,
                    &quot;x&quot;: 80,
                    &quot;type&quot;: &quot;startpoint&quot;,
                    &quot;id&quot;: &quot;noded383bc1d7387391f889c6bab18b8&quot;
                }
            ]
        }
    }
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>true/false 操作是否成功</td>
</tr>
<tr>
<td>data</td>
<td>dict</td>
<td>result=true 时成功数据，详细信息请见下面说明</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>result=false 时错误信息</td>
</tr>
</tbody>
</table>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>task_id</td>
<td>int</td>
<td>任务实例 ID</td>
</tr>
<tr>
<td>task_url</td>
<td>str</td>
<td>任务实例链接</td>
</tr>
<tr>
<td>pipeline_tree</td>
<td>dict</td>
<td>任务实例树</td>
</tr>
</tbody>
</table>
<h4 id="datapipeline_tree">data.pipeline_tree</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>start_event</td>
<td>dict</td>
<td>开始节点信息</td>
</tr>
<tr>
<td>end_event</td>
<td>dict</td>
<td>结束节点信息</td>
</tr>
<tr>
<td>activities</td>
<td>dict</td>
<td>任务节点（原子和子流程）信息</td>
</tr>
<tr>
<td>gateways</td>
<td>dict</td>
<td>网关节点（并行网关、分支网关和汇聚网关）信息</td>
</tr>
<tr>
<td>flows</td>
<td>dict</td>
<td>顺序流（节点连线）信息</td>
</tr>
<tr>
<td>constants</td>
<td>dict</td>
<td>全局变量信息，详情见下面</td>
</tr>
<tr>
<td>outputs</td>
<td>list</td>
<td>模板输出信息，标记 constants 中的输出字段</td>
</tr>
</tbody>
</table>
<h4 id="datapipeline_treeconstantskey">data.pipeline_tree.constants.KEY</h4>
<p>全局变量 KEY，${key} 格式</p>
<h4 id="datapipeline_treeconstantsvalue">data.pipeline_tree.constants.VALUE</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>key</td>
<td>string</td>
<td>同 KEY</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>变量名字</td>
</tr>
<tr>
<td>index</td>
<td>int</td>
<td>变量在模板中的显示顺序</td>
</tr>
<tr>
<td>desc</td>
<td>string</td>
<td>变量说明</td>
</tr>
<tr>
<td>source_type</td>
<td>string</td>
<td>变量来源, 取值范围 custom: 自定义变量，component_inputs: 从原子输入参数勾选，component_outputs：从原子输出结果中勾选</td>
</tr>
<tr>
<td>custom_type</td>
<td>string</td>
<td>source_type=custom 时有效，自定义变量类型， 取值范围 input: 输入框，textarea: 文本框，datetime: 日期时间，int: 整数</td>
</tr>
<tr>
<td>source_tag</td>
<td>string</td>
<td>source_type=component_inputs/component_outputs 时有效，变量的来源原子</td>
</tr>
<tr>
<td>source_info</td>
<td>dict</td>
<td>source_type=component_inputs/component_outputs 时有效，变量的来源节点信息</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/sops/fast_create_task/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>创建一次性任务</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>project_id</td>
<td>int</td>
<td>是</td>
<td>项目 ID</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>是</td>
<td>任务名称</td>
</tr>
<tr>
<td>pipeline_tree</td>
<td>dict</td>
<td>是</td>
<td>任务实例树，详细信息请见下面说明</td>
</tr>
<tr>
<td>flow_type</td>
<td>string</td>
<td>否</td>
<td>任务流程类型，common: 常规流程，common_func：职能化流程，默认值为 common</td>
</tr>
<tr>
<td>description</td>
<td>string</td>
<td>否</td>
<td>任务描述</td>
</tr>
<tr>
<td>category</td>
<td>string</td>
<td>否</td>
<td>任务分类，详细信息请见下面说明</td>
</tr>
</tbody>
</table>
<h4 id="category">category</h4>
<table>
<thead>
<tr>
<th>值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>OpsTools</td>
<td>运维工具</td>
</tr>
<tr>
<td>MonitorAlarm</td>
<td>监控告警</td>
</tr>
<tr>
<td>ConfManage</td>
<td>配置管理</td>
</tr>
<tr>
<td>DevTools</td>
<td>开发工具</td>
</tr>
<tr>
<td>EnterpriseIT</td>
<td>企业 IT</td>
</tr>
<tr>
<td>OfficeApp</td>
<td>办公应用</td>
</tr>
<tr>
<td>Other</td>
<td>其它</td>
</tr>
</tbody>
</table>
<h4 id="pipeline_tree">pipeline_tree</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>start_event</td>
<td>dict</td>
<td>是</td>
<td>开始节点，详细信息请见下面说明</td>
</tr>
<tr>
<td>end_event</td>
<td>dict</td>
<td>是</td>
<td>结束节点，详细信息请见下面说明</td>
</tr>
<tr>
<td>activities</td>
<td>dict</td>
<td>是</td>
<td>任务节点（标准插件和子流程），详细信息请见下面说明</td>
</tr>
<tr>
<td>flows</td>
<td>dict</td>
<td>是</td>
<td>顺序流（节点连线），详细信息请见下面说明</td>
</tr>
<tr>
<td>gateways</td>
<td>dict</td>
<td>否</td>
<td>网关节点（并行网关、分支网关和汇聚网关），详细信息请见下面说明</td>
</tr>
<tr>
<td>constants</td>
<td>dict</td>
<td>否</td>
<td>全局变量，详细信息请见下面说明</td>
</tr>
<tr>
<td>outputs</td>
<td>list</td>
<td>否</td>
<td>输出参数，标记 constants 中的输出字段</td>
</tr>
</tbody>
</table>
<h4 id="pipeline_treestart_event">pipeline_tree.start_event</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>string</td>
<td>是</td>
<td>开始节点 ID，在 pipeline_tree 所有 ID 中全局唯一</td>
</tr>
<tr>
<td>type</td>
<td>string</td>
<td>是</td>
<td>开始节点类型，当前只支持 EmptyStartEvent: 空开始类</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>是</td>
<td>开始节点名称，可为空</td>
</tr>
<tr>
<td>incoming</td>
<td>string</td>
<td>是</td>
<td>入度顺序流 ID，必须为空字符串</td>
</tr>
<tr>
<td>outgoing</td>
<td>string</td>
<td>是</td>
<td>出度顺序流 ID</td>
</tr>
</tbody>
</table>
<h4 id="pipeline_treeend_event">pipeline_tree.end_event</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>string</td>
<td>是</td>
<td>结束节点 ID，在 pipeline_tree 所有 ID 中全局唯一</td>
</tr>
<tr>
<td>type</td>
<td>string</td>
<td>是</td>
<td>结束节点类型，当前只支持 EmptyEndEvent：空结束类</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>是</td>
<td>结束节点名称，可为空</td>
</tr>
<tr>
<td>incoming</td>
<td>string</td>
<td>是</td>
<td>入度顺序流 ID</td>
</tr>
<tr>
<td>outgoing</td>
<td>string</td>
<td>是</td>
<td>出度顺序流 ID，必须为空字符串</td>
</tr>
</tbody>
</table>
<h4 id="pipeline_treeactivities-keypipeline_treeflows-keypipeline_treegateways-key">pipeline_tree.activities KEY、pipeline_tree.flows KEY、pipeline_tree.gateways KEY</h4>
<p>流程元素 ID，string 类型，在 pipeline_tree 所有 ID 中全局唯一，用来标识拓扑关系</p>
<h4 id="pipeline_treeactivities-value">pipeline_tree.activities VALUE</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>string</td>
<td>是</td>
<td>任务节点 ID，同 KEY 一致</td>
</tr>
<tr>
<td>type</td>
<td>string</td>
<td>是</td>
<td>任务节点类型，当前只支持 ServiceActivity：标准插件节点</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>是</td>
<td>任务节点名称</td>
</tr>
<tr>
<td>component</td>
<td>dict</td>
<td>是</td>
<td>插件配置，详细信息请见下面说明</td>
</tr>
<tr>
<td>error_ignorable</td>
<td>bool</td>
<td>是</td>
<td>节点失败是否自动忽略</td>
</tr>
<tr>
<td>retryable</td>
<td>bool</td>
<td>是</td>
<td>节点失败后是否可以重试，error_ignorable 为 true 时该参数无效</td>
</tr>
<tr>
<td>skippable</td>
<td>bool</td>
<td>是</td>
<td>节点失败后是否可以跳过，error_ignorable 为 true 时该参数无效</td>
</tr>
<tr>
<td>incoming</td>
<td>string</td>
<td>是</td>
<td>入度顺序流 ID</td>
</tr>
<tr>
<td>outgoing</td>
<td>string</td>
<td>是</td>
<td>出度顺序流 ID</td>
</tr>
<tr>
<td>stage_name</td>
<td>string</td>
<td>否</td>
<td>步骤分组名称</td>
</tr>
</tbody>
</table>
<h4 id="pipeline_treeactivities-valuecomponent">pipeline_tree.activities VALUE.component</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>code</td>
<td>string</td>
<td>是</td>
<td>标准插件编码</td>
</tr>
<tr>
<td>data</td>
<td>dict</td>
<td>是</td>
<td>标准插件输入参数</td>
</tr>
</tbody>
</table>
<h4 id="pipeline_treeflows-value">pipeline_tree.flows VALUE</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>string</td>
<td>是</td>
<td>顺序流 ID，同 KEY 一致</td>
</tr>
<tr>
<td>is_default</td>
<td>bool</td>
<td>是</td>
<td>是否默认分支</td>
</tr>
<tr>
<td>source</td>
<td>string</td>
<td>是</td>
<td>来源节点 ID</td>
</tr>
<tr>
<td>target</td>
<td>string</td>
<td>是</td>
<td>目的节点 ID</td>
</tr>
</tbody>
</table>
<h4 id="pipeline_treegateways-value">pipeline_tree.gateways VALUE</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>string</td>
<td>是</td>
<td>网关节点 ID，同 KEY 一致</td>
</tr>
<tr>
<td>type</td>
<td>string</td>
<td>是</td>
<td>网关类型，ParallelGateway：并行网关，ExclusiveGateway：分支网关，ConvergeGateway：汇聚网关</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>是</td>
<td>网关节点名称，可为空</td>
</tr>
<tr>
<td>incoming</td>
<td>string/list</td>
<td>是</td>
<td>入度顺序流 ID，type 为 ConvergeGateway 时是 list，否则是 string</td>
</tr>
<tr>
<td>outgoing</td>
<td>string/list</td>
<td>是</td>
<td>出度顺序流 ID，type 为 ConvergeGateway 时是 string，否则是 list</td>
</tr>
<tr>
<td>conditions</td>
<td>dict</td>
<td>否</td>
<td>分支条件，type 为 ExclusiveGateway 必填， 详细信息请见下面说明</td>
</tr>
</tbody>
</table>
<h4 id="pipeline_treegateways-valueconditions-key">pipeline_tree.gateways VALUE.conditions KEY</h4>
<p>网关出度顺序流 ID，和 outgoing 列表中一一对应</p>
<h4 id="pipeline_treegateways-valueconditions-value">pipeline_tree.gateways VALUE.conditions VALUE</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>evaluate</td>
<td>string</td>
<td>是</td>
<td>分支表达式，支持的语法请参考产品白皮书等文档</td>
</tr>
</tbody>
</table>
<h4 id="pipeline_treeconstants-key">pipeline_tree.constants KEY</h4>
<p>全局变量 KEY，"${key}" 格式</p>
<h4 id="pipeline_treeconstants-value">pipeline_tree.constants VALUE</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>key</td>
<td>string</td>
<td>是</td>
<td>同 KEY 一致</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>是</td>
<td>变量名字</td>
</tr>
<tr>
<td>index</td>
<td>int</td>
<td>是</td>
<td>变量在任务中的显示顺序</td>
</tr>
<tr>
<td>desc</td>
<td>string</td>
<td>是</td>
<td>变量说明</td>
</tr>
<tr>
<td>source_type</td>
<td>string</td>
<td>是</td>
<td>变量来源, 取值范围 custom: 自定义变量，component_inputs: 从标准插件输入参数勾选，component_outputs：从标准插件输出结果中勾选</td>
</tr>
<tr>
<td>custom_type</td>
<td>string</td>
<td>是</td>
<td>source_type=custom 时有效，自定义变量类型， 取值范围 input: 输入框，textarea: 文本框，datetime: 日期时间，int: 整数</td>
</tr>
<tr>
<td>source_tag</td>
<td>string</td>
<td>是</td>
<td>source_type=component_inputs 或 component_outputs 时有效，变量的来源插件和 Tag</td>
</tr>
<tr>
<td>source_info</td>
<td>dict</td>
<td>是</td>
<td>source_type=component_inputs 或 component_outputs 时有效，变量的来源节点信息</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;name&quot;: &quot;tasktest&quot;,
    &quot;flow_type&quot;: &quot;common&quot;,
    &quot;pipeline_tree&quot;：{
        &quot;start_event&quot;: {
            &quot;incoming&quot;: &quot;&quot;,
            &quot;outgoing&quot;: &quot;line7ed74aa679d19063b6d7037ce6db&quot;,
            &quot;type&quot;: &quot;EmptyStartEvent&quot;,
            &quot;id&quot;: &quot;node20cbeaa5379d08e8d8ed7bb44fdc&quot;,
            &quot;name&quot;: &quot;&quot;
        },
        &quot;activities&quot;: {
            &quot;node5310ec36c0364d3094d515f8f5ef&quot;: {
                &quot;outgoing&quot;: &quot;linec02d1e77e1076aa9c7c2c57238e4&quot;,
                &quot;incoming&quot;: &quot;line7ed74aa679d19063b6d7037ce6db&quot;,
                &quot;name&quot;: &quot;node1&quot;,
                &quot;error_ignorable&quot;: false,
                &quot;component&quot;: {
                    &quot;code&quot;: &quot;sleep_timer&quot;,
                    &quot;data&quot;: {
                        &quot;bk_timing&quot;: {
                            &quot;hook&quot;: true,
                            &quot;value&quot;: &quot;${bk_timing}&quot;
                        }
                    }
                },
                &quot;stage_name&quot;: &quot;stage1&quot;,
                &quot;retryable&quot;: true,
                &quot;skippable&quot;: true,
                &quot;type&quot;: &quot;ServiceActivity&quot;,
                &quot;id&quot;: &quot;node5310ec36c0364d3094d515f8f5ef&quot;
            },
            &quot;node2bf42efcebe266706c3e21326dc4&quot;: {
                &quot;outgoing&quot;: &quot;linef0deadac69f769440a1b0e32587e&quot;,
                &quot;incoming&quot;: &quot;line7587c8804d34a091dae3d321f081&quot;,
                &quot;name&quot;: &quot;node2&quot;,
                &quot;error_ignorable&quot;: false,
                &quot;component&quot;: {
                    &quot;code&quot;: &quot;sleep_timer&quot;,
                    &quot;data&quot;: {
                        &quot;bk_timing&quot;: {
                            &quot;hook&quot;: true,
                            &quot;value&quot;: &quot;${bk_timing}&quot;
                        }
                    }
                },
                &quot;stage_name&quot;: &quot;stage2&quot;,
                &quot;retryable&quot;: true,
                &quot;skippable&quot;: true,
                &quot;type&quot;: &quot;ServiceActivity&quot;,
                &quot;id&quot;: &quot;node2bf42efcebe266706c3e21326dc4&quot;
            },
            &quot;node3c7dcf31454c1e9bdc9cf1cdeacc&quot;: {
                &quot;outgoing&quot;: &quot;linebf8f91c96a8f4eb3794ca5eb9881&quot;,
                &quot;incoming&quot;: &quot;line429f64cdec5d20f368611e621ef5&quot;,
                &quot;name&quot;: &quot;node3&quot;,
                &quot;error_ignorable&quot;: false,
                &quot;component&quot;: {
                    &quot;code&quot;: &quot;sleep_timer&quot;,
                    &quot;data&quot;: {
                        &quot;bk_timing&quot;: {
                            &quot;hook&quot;: false,
                            &quot;value&quot;: &quot;3&quot;
                        }
                    }
                },
                &quot;stage_name&quot;: &quot;stage3&quot;,
                &quot;retryable&quot;: true,
                &quot;skippable&quot;: true,
                &quot;type&quot;: &quot;ServiceActivity&quot;,
                &quot;id&quot;: &quot;node3c7dcf31454c1e9bdc9cf1cdeacc&quot;
            },
            &quot;nodedb1478a75c13f90cc400f5379949&quot;: {
                &quot;outgoing&quot;: &quot;line24d28a3f9f80e23e4a4fab7c4ffd&quot;,
                &quot;incoming&quot;: &quot;linec43c77f26af408748a9c194dbcfe&quot;,
                &quot;name&quot;: &quot;node4&quot;,
                &quot;error_ignorable&quot;: false,
                &quot;component&quot;: {
                    &quot;code&quot;: &quot;sleep_timer&quot;,
                    &quot;data&quot;: {
                        &quot;bk_timing&quot;: {
                            &quot;hook&quot;: true,
                            &quot;value&quot;: &quot;${bk_timing}&quot;
                        }
                    }
                },
                &quot;stage_name&quot;: &quot;stage3&quot;,
                &quot;retryable&quot;: true,
                &quot;skippable&quot;: true,
                &quot;type&quot;: &quot;ServiceActivity&quot;,
                &quot;id&quot;: &quot;nodedb1478a75c13f90cc400f5379949&quot;
            }
        },
        &quot;end_event&quot;: {
            &quot;incoming&quot;: &quot;line6ea858554964a04d868cead4435a&quot;,
            &quot;outgoing&quot;: &quot;&quot;,
            &quot;type&quot;: &quot;EmptyEndEvent&quot;,
            &quot;id&quot;: &quot;nodebe0db4ad30cc1723c7ede37b4b5f&quot;,
            &quot;name&quot;: &quot;&quot;
        },
        &quot;flows&quot;: {
            &quot;line24d28a3f9f80e23e4a4fab7c4ffd&quot;: {
                &quot;is_default&quot;: false,
                &quot;source&quot;: &quot;nodedb1478a75c13f90cc400f5379949&quot;,
                &quot;id&quot;: &quot;line24d28a3f9f80e23e4a4fab7c4ffd&quot;,
                &quot;target&quot;: &quot;node947e423b22e49aeb77bc77528bc0&quot;
            },
            &quot;linebf8f91c96a8f4eb3794ca5eb9881&quot;: {
                &quot;is_default&quot;: false,
                &quot;source&quot;: &quot;node3c7dcf31454c1e9bdc9cf1cdeacc&quot;,
                &quot;id&quot;: &quot;linebf8f91c96a8f4eb3794ca5eb9881&quot;,
                &quot;target&quot;: &quot;node947e423b22e49aeb77bc77528bc0&quot;
            },
            &quot;line7587c8804d34a091dae3d321f081&quot;: {
                &quot;is_default&quot;: false,
                &quot;source&quot;: &quot;node0863aab8325b84cfa3e5db52dc61&quot;,
                &quot;id&quot;: &quot;line7587c8804d34a091dae3d321f081&quot;,
                &quot;target&quot;: &quot;node2bf42efcebe266706c3e21326dc4&quot;
            },
            &quot;line429f64cdec5d20f368611e621ef5&quot;: {
                &quot;is_default&quot;: false,
                &quot;source&quot;: &quot;node7e97af0f55fb64276e067951dd9d&quot;,
                &quot;id&quot;: &quot;line429f64cdec5d20f368611e621ef5&quot;,
                &quot;target&quot;: &quot;node3c7dcf31454c1e9bdc9cf1cdeacc&quot;
            },
            &quot;line6ea858554964a04d868cead4435a&quot;: {
                &quot;is_default&quot;: false,
                &quot;source&quot;: &quot;node2b6f3285cfb3961c72834bafbe1b&quot;,
                &quot;id&quot;: &quot;line6ea858554964a04d868cead4435a&quot;,
                &quot;target&quot;: &quot;nodebe0db4ad30cc1723c7ede37b4b5f&quot;
            },
            &quot;line9dd9c8dbbad90943f268442ab7e0&quot;: {
                &quot;is_default&quot;: false,
                &quot;source&quot;: &quot;node0863aab8325b84cfa3e5db52dc61&quot;,
                &quot;id&quot;: &quot;line9dd9c8dbbad90943f268442ab7e0&quot;,
                &quot;target&quot;: &quot;node7e97af0f55fb64276e067951dd9d&quot;
            },
            &quot;lineabc279d9be88eb98285132ba5b75&quot;: {
                &quot;is_default&quot;: false,
                &quot;source&quot;: &quot;node947e423b22e49aeb77bc77528bc0&quot;,
                &quot;id&quot;: &quot;lineabc279d9be88eb98285132ba5b75&quot;,
                &quot;target&quot;: &quot;node2b6f3285cfb3961c72834bafbe1b&quot;
            },
            &quot;linef0deadac69f769440a1b0e32587e&quot;: {
                &quot;is_default&quot;: false,
                &quot;source&quot;: &quot;node2bf42efcebe266706c3e21326dc4&quot;,
                &quot;id&quot;: &quot;linef0deadac69f769440a1b0e32587e&quot;,
                &quot;target&quot;: &quot;node2b6f3285cfb3961c72834bafbe1b&quot;
            },
            &quot;linec02d1e77e1076aa9c7c2c57238e4&quot;: {
                &quot;is_default&quot;: false,
                &quot;source&quot;: &quot;node5310ec36c0364d3094d515f8f5ef&quot;,
                &quot;id&quot;: &quot;linec02d1e77e1076aa9c7c2c57238e4&quot;,
                &quot;target&quot;: &quot;node0863aab8325b84cfa3e5db52dc61&quot;
            },
            &quot;line7ed74aa679d19063b6d7037ce6db&quot;: {
                &quot;is_default&quot;: false,
                &quot;source&quot;: &quot;node20cbeaa5379d08e8d8ed7bb44fdc&quot;,
                &quot;id&quot;: &quot;line7ed74aa679d19063b6d7037ce6db&quot;,
                &quot;target&quot;: &quot;node5310ec36c0364d3094d515f8f5ef&quot;
            },
            &quot;linec43c77f26af408748a9c194dbcfe&quot;: {
                &quot;is_default&quot;: false,
                &quot;source&quot;: &quot;node7e97af0f55fb64276e067951dd9d&quot;,
                &quot;id&quot;: &quot;linec43c77f26af408748a9c194dbcfe&quot;,
                &quot;target&quot;: &quot;nodedb1478a75c13f90cc400f5379949&quot;
            }
        },
        &quot;gateways&quot;: {
            &quot;node2b6f3285cfb3961c72834bafbe1b&quot;: {
                &quot;incoming&quot;: [&quot;linef0deadac69f769440a1b0e32587e&quot;, &quot;lineabc279d9be88eb98285132ba5b75&quot;],
                &quot;outgoing&quot;: &quot;line6ea858554964a04d868cead4435a&quot;,
                &quot;type&quot;: &quot;ConvergeGateway&quot;,
                &quot;id&quot;: &quot;node2b6f3285cfb3961c72834bafbe1b&quot;,
                &quot;name&quot;: &quot;&quot;
            },
            &quot;node0863aab8325b84cfa3e5db52dc61&quot;: {
                &quot;outgoing&quot;: [&quot;line7587c8804d34a091dae3d321f081&quot;, &quot;line9dd9c8dbbad90943f268442ab7e0&quot;],
                &quot;incoming&quot;: &quot;linec02d1e77e1076aa9c7c2c57238e4&quot;,
                &quot;name&quot;: &quot;&quot;,
                &quot;type&quot;: &quot;ExclusiveGateway&quot;,
                &quot;conditions&quot;: {
                    &quot;line9dd9c8dbbad90943f268442ab7e0&quot;: {
                        &quot;evaluate&quot;: &quot;${bk_timing} &lt;= 10&quot;
                    },
                    &quot;line7587c8804d34a091dae3d321f081&quot;: {
                        &quot;evaluate&quot;: &quot;${bk_timing} &gt; 10&quot;
                    }
                },
                &quot;id&quot;: &quot;node0863aab8325b84cfa3e5db52dc61&quot;
            },
            &quot;node947e423b22e49aeb77bc77528bc0&quot;: {
                &quot;incoming&quot;: [&quot;linebf8f91c96a8f4eb3794ca5eb9881&quot;, &quot;line24d28a3f9f80e23e4a4fab7c4ffd&quot;],
                &quot;outgoing&quot;: &quot;lineabc279d9be88eb98285132ba5b75&quot;,
                &quot;type&quot;: &quot;ConvergeGateway&quot;,
                &quot;id&quot;: &quot;node947e423b22e49aeb77bc77528bc0&quot;,
                &quot;name&quot;: &quot;&quot;
            },
            &quot;node7e97af0f55fb64276e067951dd9d&quot;: {
                &quot;incoming&quot;: &quot;line9dd9c8dbbad90943f268442ab7e0&quot;,
                &quot;outgoing&quot;: [&quot;line429f64cdec5d20f368611e621ef5&quot;, &quot;linec43c77f26af408748a9c194dbcfe&quot;],
                &quot;type&quot;: &quot;ParallelGateway&quot;,
                &quot;id&quot;: &quot;node7e97af0f55fb64276e067951dd9d&quot;,
                &quot;name&quot;: &quot;&quot;
            }
        },
        &quot;constants&quot;: {
            &quot;${bk_timing}&quot;: {
                &quot;source_tag&quot;: &quot;sleep_timer.bk_timing&quot;,
                &quot;source_info&quot;: {
                    &quot;node5310ec36c0364d3094d515f8f5ef&quot;: [&quot;bk_timing&quot;],
                    &quot;node2bf42efcebe266706c3e21326dc4&quot;: [&quot;bk_timing&quot;],
                    &quot;nodedb1478a75c13f90cc400f5379949&quot;: [&quot;bk_timing&quot;]
                },
                &quot;name&quot;: &quot;timing&quot;,
                &quot;index&quot;: 0,
                &quot;custom_type&quot;: &quot;&quot;,
                &quot;value&quot;: &quot;1&quot;,
                &quot;show_type&quot;: &quot;show&quot;,
                &quot;source_type&quot;: &quot;component_inputs&quot;,
                &quot;key&quot;: &quot;${bk_timing}&quot;,
                &quot;desc&quot;: &quot;&quot;
            }
        },
        &quot;outputs&quot;: [&quot;${bk_timing}&quot;]
    }
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;result&quot;: true,
    &quot;data&quot;: {
        &quot;task_id&quot;: 10,
        &quot;task_url&quot;: &quot;http://bk_sops_host/taskflow/execute/3/?instance_id=10&quot;,
        &quot;pipeline_tree&quot;: {
            &quot;start_event&quot;: {
                &quot;incoming&quot;: &quot;&quot;,
                &quot;outgoing&quot;: &quot;line7ed74aa679d19063b6d7037ce6db&quot;,
                &quot;type&quot;: &quot;EmptyStartEvent&quot;,
                &quot;id&quot;: &quot;node20cbeaa5379d08e8d8ed7bb44fdc&quot;,
                &quot;name&quot;: &quot;&quot;
            },
            &quot;activities&quot;: {
                &quot;node5310ec36c0364d3094d515f8f5ef&quot;: {
                    &quot;outgoing&quot;: &quot;linec02d1e77e1076aa9c7c2c57238e4&quot;,
                    &quot;incoming&quot;: &quot;line7ed74aa679d19063b6d7037ce6db&quot;,
                    &quot;name&quot;: &quot;node1&quot;,
                    &quot;error_ignorable&quot;: false,
                    &quot;component&quot;: {
                        &quot;code&quot;: &quot;sleep_timer&quot;,
                        &quot;data&quot;: {
                            &quot;bk_timing&quot;: {
                                &quot;hook&quot;: true,
                                &quot;value&quot;: &quot;${bk_timing}&quot;
                            }
                        }
                    },
                    &quot;stage_name&quot;: &quot;stage1&quot;,
                    &quot;retryable&quot;: true,
                    &quot;skippable&quot;: true,
                    &quot;type&quot;: &quot;ServiceActivity&quot;,
                    &quot;id&quot;: &quot;node5310ec36c0364d3094d515f8f5ef&quot;
                },
                &quot;node2bf42efcebe266706c3e21326dc4&quot;: {
                    &quot;outgoing&quot;: &quot;linef0deadac69f769440a1b0e32587e&quot;,
                    &quot;incoming&quot;: &quot;line7587c8804d34a091dae3d321f081&quot;,
                    &quot;name&quot;: &quot;node2&quot;,
                    &quot;error_ignorable&quot;: false,
                    &quot;component&quot;: {
                        &quot;code&quot;: &quot;sleep_timer&quot;,
                        &quot;data&quot;: {
                            &quot;bk_timing&quot;: {
                                &quot;hook&quot;: true,
                                &quot;value&quot;: &quot;${bk_timing}&quot;
                            }
                        }
                    },
                    &quot;stage_name&quot;: &quot;stage2&quot;,
                    &quot;retryable&quot;: true,
                    &quot;skippable&quot;: true,
                    &quot;type&quot;: &quot;ServiceActivity&quot;,
                    &quot;id&quot;: &quot;node2bf42efcebe266706c3e21326dc4&quot;
                },
                &quot;node3c7dcf31454c1e9bdc9cf1cdeacc&quot;: {
                    &quot;outgoing&quot;: &quot;linebf8f91c96a8f4eb3794ca5eb9881&quot;,
                    &quot;incoming&quot;: &quot;line429f64cdec5d20f368611e621ef5&quot;,
                    &quot;name&quot;: &quot;node3&quot;,
                    &quot;error_ignorable&quot;: false,
                    &quot;component&quot;: {
                        &quot;code&quot;: &quot;sleep_timer&quot;,
                        &quot;data&quot;: {
                            &quot;bk_timing&quot;: {
                                &quot;hook&quot;: false,
                                &quot;value&quot;: &quot;3&quot;
                            }
                        }
                    },
                    &quot;stage_name&quot;: &quot;stage3&quot;,
                    &quot;retryable&quot;: true,
                    &quot;skippable&quot;: true,
                    &quot;type&quot;: &quot;ServiceActivity&quot;,
                    &quot;id&quot;: &quot;node3c7dcf31454c1e9bdc9cf1cdeacc&quot;
                },
                &quot;nodedb1478a75c13f90cc400f5379949&quot;: {
                    &quot;outgoing&quot;: &quot;line24d28a3f9f80e23e4a4fab7c4ffd&quot;,
                    &quot;incoming&quot;: &quot;linec43c77f26af408748a9c194dbcfe&quot;,
                    &quot;name&quot;: &quot;node4&quot;,
                    &quot;error_ignorable&quot;: false,
                    &quot;component&quot;: {
                        &quot;code&quot;: &quot;sleep_timer&quot;,
                        &quot;data&quot;: {
                            &quot;bk_timing&quot;: {
                                &quot;hook&quot;: true,
                                &quot;value&quot;: &quot;${bk_timing}&quot;
                            }
                        }
                    },
                    &quot;stage_name&quot;: &quot;stage3&quot;,
                    &quot;retryable&quot;: true,
                    &quot;skippable&quot;: true,
                    &quot;type&quot;: &quot;ServiceActivity&quot;,
                    &quot;id&quot;: &quot;nodedb1478a75c13f90cc400f5379949&quot;
                }
            },
            &quot;end_event&quot;: {
                &quot;incoming&quot;: &quot;line6ea858554964a04d868cead4435a&quot;,
                &quot;outgoing&quot;: &quot;&quot;,
                &quot;type&quot;: &quot;EmptyEndEvent&quot;,
                &quot;id&quot;: &quot;nodebe0db4ad30cc1723c7ede37b4b5f&quot;,
                &quot;name&quot;: &quot;&quot;
            },
            &quot;flows&quot;: {
                &quot;line24d28a3f9f80e23e4a4fab7c4ffd&quot;: {
                    &quot;is_default&quot;: false,
                    &quot;source&quot;: &quot;nodedb1478a75c13f90cc400f5379949&quot;,
                    &quot;id&quot;: &quot;line24d28a3f9f80e23e4a4fab7c4ffd&quot;,
                    &quot;target&quot;: &quot;node947e423b22e49aeb77bc77528bc0&quot;
                },
                &quot;linebf8f91c96a8f4eb3794ca5eb9881&quot;: {
                    &quot;is_default&quot;: false,
                    &quot;source&quot;: &quot;node3c7dcf31454c1e9bdc9cf1cdeacc&quot;,
                    &quot;id&quot;: &quot;linebf8f91c96a8f4eb3794ca5eb9881&quot;,
                    &quot;target&quot;: &quot;node947e423b22e49aeb77bc77528bc0&quot;
                },
                &quot;line7587c8804d34a091dae3d321f081&quot;: {
                    &quot;is_default&quot;: false,
                    &quot;source&quot;: &quot;node0863aab8325b84cfa3e5db52dc61&quot;,
                    &quot;id&quot;: &quot;line7587c8804d34a091dae3d321f081&quot;,
                    &quot;target&quot;: &quot;node2bf42efcebe266706c3e21326dc4&quot;
                },
                &quot;line429f64cdec5d20f368611e621ef5&quot;: {
                    &quot;is_default&quot;: false,
                    &quot;source&quot;: &quot;node7e97af0f55fb64276e067951dd9d&quot;,
                    &quot;id&quot;: &quot;line429f64cdec5d20f368611e621ef5&quot;,
                    &quot;target&quot;: &quot;node3c7dcf31454c1e9bdc9cf1cdeacc&quot;
                },
                &quot;line6ea858554964a04d868cead4435a&quot;: {
                    &quot;is_default&quot;: false,
                    &quot;source&quot;: &quot;node2b6f3285cfb3961c72834bafbe1b&quot;,
                    &quot;id&quot;: &quot;line6ea858554964a04d868cead4435a&quot;,
                    &quot;target&quot;: &quot;nodebe0db4ad30cc1723c7ede37b4b5f&quot;
                },
                &quot;line9dd9c8dbbad90943f268442ab7e0&quot;: {
                    &quot;is_default&quot;: false,
                    &quot;source&quot;: &quot;node0863aab8325b84cfa3e5db52dc61&quot;,
                    &quot;id&quot;: &quot;line9dd9c8dbbad90943f268442ab7e0&quot;,
                    &quot;target&quot;: &quot;node7e97af0f55fb64276e067951dd9d&quot;
                },
                &quot;lineabc279d9be88eb98285132ba5b75&quot;: {
                    &quot;is_default&quot;: false,
                    &quot;source&quot;: &quot;node947e423b22e49aeb77bc77528bc0&quot;,
                    &quot;id&quot;: &quot;lineabc279d9be88eb98285132ba5b75&quot;,
                    &quot;target&quot;: &quot;node2b6f3285cfb3961c72834bafbe1b&quot;
                },
                &quot;linef0deadac69f769440a1b0e32587e&quot;: {
                    &quot;is_default&quot;: false,
                    &quot;source&quot;: &quot;node2bf42efcebe266706c3e21326dc4&quot;,
                    &quot;id&quot;: &quot;linef0deadac69f769440a1b0e32587e&quot;,
                    &quot;target&quot;: &quot;node2b6f3285cfb3961c72834bafbe1b&quot;
                },
                &quot;linec02d1e77e1076aa9c7c2c57238e4&quot;: {
                    &quot;is_default&quot;: false,
                    &quot;source&quot;: &quot;node5310ec36c0364d3094d515f8f5ef&quot;,
                    &quot;id&quot;: &quot;linec02d1e77e1076aa9c7c2c57238e4&quot;,
                    &quot;target&quot;: &quot;node0863aab8325b84cfa3e5db52dc61&quot;
                },
                &quot;line7ed74aa679d19063b6d7037ce6db&quot;: {
                    &quot;is_default&quot;: false,
                    &quot;source&quot;: &quot;node20cbeaa5379d08e8d8ed7bb44fdc&quot;,
                    &quot;id&quot;: &quot;line7ed74aa679d19063b6d7037ce6db&quot;,
                    &quot;target&quot;: &quot;node5310ec36c0364d3094d515f8f5ef&quot;
                },
                &quot;linec43c77f26af408748a9c194dbcfe&quot;: {
                    &quot;is_default&quot;: false,
                    &quot;source&quot;: &quot;node7e97af0f55fb64276e067951dd9d&quot;,
                    &quot;id&quot;: &quot;linec43c77f26af408748a9c194dbcfe&quot;,
                    &quot;target&quot;: &quot;nodedb1478a75c13f90cc400f5379949&quot;
                }
            },
            &quot;gateways&quot;: {
                &quot;node2b6f3285cfb3961c72834bafbe1b&quot;: {
                    &quot;incoming&quot;: [&quot;linef0deadac69f769440a1b0e32587e&quot;, &quot;lineabc279d9be88eb98285132ba5b75&quot;],
                    &quot;outgoing&quot;: &quot;line6ea858554964a04d868cead4435a&quot;,
                    &quot;type&quot;: &quot;ConvergeGateway&quot;,
                    &quot;id&quot;: &quot;node2b6f3285cfb3961c72834bafbe1b&quot;,
                    &quot;name&quot;: &quot;&quot;
                },
                &quot;node0863aab8325b84cfa3e5db52dc61&quot;: {
                    &quot;outgoing&quot;: [&quot;line7587c8804d34a091dae3d321f081&quot;, &quot;line9dd9c8dbbad90943f268442ab7e0&quot;],
                    &quot;incoming&quot;: &quot;linec02d1e77e1076aa9c7c2c57238e4&quot;,
                    &quot;name&quot;: &quot;&quot;,
                    &quot;type&quot;: &quot;ExclusiveGateway&quot;,
                    &quot;conditions&quot;: {
                        &quot;line9dd9c8dbbad90943f268442ab7e0&quot;: {
                            &quot;evaluate&quot;: &quot;${bk_timing} &lt;= 10&quot;
                        },
                        &quot;line7587c8804d34a091dae3d321f081&quot;: {
                            &quot;evaluate&quot;: &quot;${bk_timing} &gt; 10&quot;
                        }
                    },
                    &quot;id&quot;: &quot;node0863aab8325b84cfa3e5db52dc61&quot;
                },
                &quot;node947e423b22e49aeb77bc77528bc0&quot;: {
                    &quot;incoming&quot;: [&quot;linebf8f91c96a8f4eb3794ca5eb9881&quot;, &quot;line24d28a3f9f80e23e4a4fab7c4ffd&quot;],
                    &quot;outgoing&quot;: &quot;lineabc279d9be88eb98285132ba5b75&quot;,
                    &quot;type&quot;: &quot;ConvergeGateway&quot;,
                    &quot;id&quot;: &quot;node947e423b22e49aeb77bc77528bc0&quot;,
                    &quot;name&quot;: &quot;&quot;
                },
                &quot;node7e97af0f55fb64276e067951dd9d&quot;: {
                    &quot;incoming&quot;: &quot;line9dd9c8dbbad90943f268442ab7e0&quot;,
                    &quot;outgoing&quot;: [&quot;line429f64cdec5d20f368611e621ef5&quot;, &quot;linec43c77f26af408748a9c194dbcfe&quot;],
                    &quot;type&quot;: &quot;ParallelGateway&quot;,
                    &quot;id&quot;: &quot;node7e97af0f55fb64276e067951dd9d&quot;,
                    &quot;name&quot;: &quot;&quot;
                }
            },
            &quot;constants&quot;: {
                &quot;${bk_timing}&quot;: {
                    &quot;source_tag&quot;: &quot;sleep_timer.bk_timing&quot;,
                    &quot;source_info&quot;: {
                        &quot;node5310ec36c0364d3094d515f8f5ef&quot;: [&quot;bk_timing&quot;],
                        &quot;node2bf42efcebe266706c3e21326dc4&quot;: [&quot;bk_timing&quot;],
                        &quot;nodedb1478a75c13f90cc400f5379949&quot;: [&quot;bk_timing&quot;]
                    },
                    &quot;name&quot;: &quot;timing&quot;,
                    &quot;index&quot;: 0,
                    &quot;custom_type&quot;: &quot;&quot;,
                    &quot;value&quot;: &quot;1&quot;,
                    &quot;show_type&quot;: &quot;show&quot;,
                    &quot;source_type&quot;: &quot;component_inputs&quot;,
                    &quot;key&quot;: &quot;${bk_timing}&quot;,
                    &quot;desc&quot;: &quot;&quot;
                }
            },
            &quot;outputs&quot;: [&quot;${bk_timing}&quot;]
        }
    }
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>true/false 操作是否成功</td>
</tr>
<tr>
<td>data</td>
<td>dict</td>
<td>result=true 时成功数据，详细信息请见下面说明</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>result=false 时错误信息</td>
</tr>
</tbody>
</table>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>task_id</td>
<td>int</td>
<td>任务实例 ID</td>
</tr>
<tr>
<td>task_url</td>
<td>string</td>
<td>任务实例链接</td>
</tr>
<tr>
<td>pipeline_tree</td>
<td>dict</td>
<td>任务实例树</td>
</tr>
</tbody>
</table>
<h4 id="datapipeline_tree">data.pipeline_tree</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>start_event</td>
<td>dict</td>
<td>开始节点信息</td>
</tr>
<tr>
<td>end_event</td>
<td>dict</td>
<td>结束节点信息</td>
</tr>
<tr>
<td>activities</td>
<td>dict</td>
<td>任务节点（原子和子流程）信息</td>
</tr>
<tr>
<td>gateways</td>
<td>dict</td>
<td>网关节点（并行网关、分支网关和汇聚网关）信息</td>
</tr>
<tr>
<td>flows</td>
<td>dict</td>
<td>顺序流（节点连线）信息</td>
</tr>
<tr>
<td>constants</td>
<td>dict</td>
<td>全局变量信息，详情见下面</td>
</tr>
<tr>
<td>outputs</td>
<td>list</td>
<td>模板输出信息，标记 constants 中的输出字段</td>
</tr>
</tbody>
</table>
<h4 id="dataformkey-datapipeline_treeconstantskey">data.form.KEY, data.pipeline_tree.constants.KEY</h4>
<p>全局变量 KEY，${key} 格式</p>
<h4 id="dataformvalue-datapipeline_treeconstantsvalue">data.form.VALUE, data.pipeline_tree.constants.VALUE</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>key</td>
<td>string</td>
<td>同 KEY</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>变量名字</td>
</tr>
<tr>
<td>index</td>
<td>int</td>
<td>变量在模板中的显示顺序</td>
</tr>
<tr>
<td>desc</td>
<td>string</td>
<td>变量说明</td>
</tr>
<tr>
<td>source_type</td>
<td>string</td>
<td>变量来源, 取值范围 custom: 自定义变量，component_inputs: 从原子输入参数勾选，component_outputs：从原子输出结果中勾选</td>
</tr>
<tr>
<td>custom_type</td>
<td>string</td>
<td>source_type=custom 时有效，自定义变量类型， 取值范围 input: 输入框，textarea: 文本框，datetime: 日期时间，int: 整数</td>
</tr>
<tr>
<td>source_tag</td>
<td>string</td>
<td>source_type=component_inputs/component_outputs 时有效，变量的来源原子</td>
</tr>
<tr>
<td>source_info</td>
<td>dict</td>
<td>source_type=component_inputs/component_outputs 时有效，变量的来源节点信息</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/sops/get_common_template_info/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>查询公共流程模板详情</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>template_id</td>
<td>string</td>
<td>是</td>
<td>模板 ID</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;template_id&quot;: &quot;30&quot;,
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;result&quot;: true,
    &quot;data&quot;: {
        &quot;category&quot;: &quot;Other&quot;,
        &quot;edit_time&quot;: &quot;2018-04-27 16:24:24 +0800&quot;,
        &quot;create_time&quot;: &quot;2018-04-16 21:43:15 +0800&quot;,
        &quot;name&quot;: &quot;new20180416213944&quot;,
        &quot;creator&quot;: &quot;admin&quot;,
        &quot;pipeline_tree&quot;: {
            &quot;activities&quot;: {
                &quot;631b6576cc5dfbdcaa4f510ce88a7e67&quot;: {
                    &quot;outgoing&quot;: &quot;44ab36ebf4cf119edaf2d20401da87e4&quot;,
                    &quot;incoming&quot;: &quot;fb2f3a8b533ca5c67e2440b4164f7632&quot;,
                    &quot;name&quot;: &quot;节点_1&quot;,
                    &quot;error_ignorable&quot;: false,
                    &quot;component&quot;: {
                        &quot;code&quot;: &quot;job_fast_execute_script&quot;,
                        &quot;data&quot;: {
                            &quot;account&quot;: {
                                &quot;hook&quot;: false,
                                &quot;value&quot;: &quot;root&quot;
                            },
                            &quot;ip_list&quot;: {
                                &quot;hook&quot;: false,
                                &quot;value&quot;: &quot;127.0.0.1&quot;
                            },
                            &quot;script_timeout&quot;: {
                                &quot;hook&quot;: true,
                                &quot;value&quot;: &quot;${script_timeout}&quot;
                            },
                            &quot;content&quot;: {
                                &quot;hook&quot;: false,
                                &quot;value&quot;: &quot;${content}&quot;
                            },
                            &quot;script_param&quot;: {
                                &quot;hook&quot;: false,
                                &quot;value&quot;: &quot;${params}&quot;
                            },
                            &quot;script_type&quot;: {
                                &quot;hook&quot;: true,
                                &quot;value&quot;: &quot;${script_type}&quot;
                            }
                        }
                    },
                    &quot;optional&quot;: false,
                    &quot;type&quot;: &quot;ServiceActivity&quot;,
                    &quot;id&quot;: &quot;631b6576cc5dfbdcaa4f510ce88a7e67&quot;,
                    &quot;loop&quot;: null
                }
            },
            &quot;end_event&quot;: {
                &quot;type&quot;: &quot;EmptyEndEvent&quot;,
                &quot;outgoing&quot;: &quot;&quot;,
                &quot;incoming&quot;: &quot;44ab36ebf4cf119edaf2d20401da87e4&quot;,
                &quot;id&quot;: &quot;60c81e383d048d8a3c574d3436e1b82c&quot;,
                &quot;name&quot;: &quot;&quot;
            },
            &quot;outputs&quot;: [],
            &quot;flows&quot;: {
                &quot;fb2f3a8b533ca5c67e2440b4164f7632&quot;: {
                    &quot;is_default&quot;: false,
                    &quot;source&quot;: &quot;48afea1016ab70ee37179fa0eb1e1a14&quot;,
                    &quot;id&quot;: &quot;fb2f3a8b533ca5c67e2440b4164f7632&quot;,
                    &quot;target&quot;: &quot;631b6576cc5dfbdcaa4f510ce88a7e67&quot;
                },
                &quot;44ab36ebf4cf119edaf2d20401da87e4&quot;: {
                    &quot;is_default&quot;: false,
                    &quot;source&quot;: &quot;631b6576cc5dfbdcaa4f510ce88a7e67&quot;,
                    &quot;id&quot;: &quot;44ab36ebf4cf119edaf2d20401da87e4&quot;,
                    &quot;target&quot;: &quot;60c81e383d048d8a3c574d3436e1b82c&quot;
                }
            },
            &quot;start_event&quot;: {
                &quot;type&quot;: &quot;EmptyStartEvent&quot;,
                &quot;outgoing&quot;: &quot;fb2f3a8b533ca5c67e2440b4164f7632&quot;,
                &quot;incoming&quot;: &quot;&quot;,
                &quot;id&quot;: &quot;48afea1016ab70ee37179fa0eb1e1a14&quot;,
                &quot;name&quot;: &quot;&quot;
            },
            &quot;constants&quot;: {
                &quot;${script_type}&quot;: {
                    &quot;source_tag&quot;: &quot;job_fast_execute_script.script_type&quot;,
                    &quot;source_info&quot;: {
                        &quot;631b6576cc5dfbdcaa4f510ce88a7e67&quot;: [
                            &quot;script_type&quot;
                        ]
                    },
                    &quot;name&quot;: &quot;脚本类型&quot;,
                    &quot;index&quot;: 0,
                    &quot;custom_type&quot;: &quot;radio&quot;,
                    &quot;value&quot;: &quot;4&quot;,
                    &quot;show_type&quot;: &quot;show&quot;,
                    &quot;source_type&quot;: &quot;component_inputs&quot;,
                    &quot;key&quot;: &quot;${script_type}&quot;,
                    &quot;validation&quot;: &quot;^.*$&quot;,
                    &quot;desc&quot;: &quot;&quot;
                },
                &quot;${content}&quot;: {
                    &quot;source_tag&quot;: &quot;&quot;,
                    &quot;source_info&quot;: {},
                    &quot;name&quot;: &quot;内容&quot;,
                    &quot;index&quot;: 2,
                    &quot;custom_type&quot;: &quot;textarea&quot;,
                    &quot;value&quot;: &quot;&quot;,
                    &quot;show_type&quot;: &quot;show&quot;,
                    &quot;source_type&quot;: &quot;custom&quot;,
                    &quot;key&quot;: &quot;${content}&quot;,
                    &quot;desc&quot;: &quot;&quot;
                },
                &quot;${script_timeout}&quot;: {
                    &quot;source_tag&quot;: &quot;job_fast_execute_script.script_timeout&quot;,
                    &quot;source_info&quot;: {
                        &quot;631b6576cc5dfbdcaa4f510ce88a7e67&quot;: [
                            &quot;script_timeout&quot;
                        ]
                    },
                    &quot;name&quot;: &quot;超时时间&quot;,
                    &quot;index&quot;: 1,
                    &quot;custom_type&quot;: &quot;input&quot;,
                    &quot;value&quot;: &quot;&quot;,
                    &quot;show_type&quot;: &quot;show&quot;,
                    &quot;source_type&quot;: &quot;component_inputs&quot;,
                    &quot;key&quot;: &quot;${script_timeout}&quot;,
                    &quot;validation&quot;: &quot;^.*$&quot;,
                    &quot;desc&quot;: &quot;&quot;
                },
                &quot;${params}&quot;: {
                    &quot;source_tag&quot;: &quot;&quot;,
                    &quot;source_info&quot;: {},
                    &quot;name&quot;: &quot;参数&quot;,
                    &quot;index&quot;: 3,
                    &quot;custom_type&quot;: &quot;input&quot;,
                    &quot;value&quot;: &quot;&quot;,
                    &quot;show_type&quot;: &quot;show&quot;,
                    &quot;source_type&quot;: &quot;custom&quot;,
                    &quot;key&quot;: &quot;${params}&quot;,
                    &quot;desc&quot;: &quot;&quot;
                }
            },
            &quot;gateways&quot;: {}
        },
        &quot;id&quot;: 30,
        &quot;editor&quot;: &quot;admin&quot;
    },
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>true/false 查询成功与否</td>
</tr>
<tr>
<td>data</td>
<td>dict</td>
<td>result=true 时模板详情，详细信息见下面说明</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>result=false 时错误信息</td>
</tr>
</tbody>
</table>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>int</td>
<td>模板 ID</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>模板名称</td>
</tr>
<tr>
<td>category</td>
<td>string</td>
<td>模板分类，分类信息见下面说明</td>
</tr>
<tr>
<td>creator</td>
<td>string</td>
<td>模板创建人</td>
</tr>
<tr>
<td>create_time</td>
<td>string</td>
<td>模板创建时间</td>
</tr>
<tr>
<td>editor</td>
<td>string 或者 null</td>
<td>模板编辑人</td>
</tr>
<tr>
<td>edit_time</td>
<td>string</td>
<td>模板最新编辑时间</td>
</tr>
<tr>
<td>pipeline_tree</td>
<td>dict</td>
<td>模板任务树信息，详细信息见下面说明</td>
</tr>
</tbody>
</table>
<h4 id="datacategory">data.category</h4>
<table>
<thead>
<tr>
<th>返回值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>OpsTools</td>
<td>运维工具</td>
</tr>
<tr>
<td>MonitorAlarm</td>
<td>监控告警</td>
</tr>
<tr>
<td>ConfManage</td>
<td>配置管理</td>
</tr>
<tr>
<td>DevTools</td>
<td>开发工具</td>
</tr>
<tr>
<td>EnterpriseIT</td>
<td>企业 IT</td>
</tr>
<tr>
<td>OfficeApp</td>
<td>办公应用</td>
</tr>
<tr>
<td>Other</td>
<td>其它</td>
</tr>
</tbody>
</table>
<h4 id="datapipeline_tree">data.pipeline_tree</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>start_event</td>
<td>dict</td>
<td>开始节点信息</td>
</tr>
<tr>
<td>end_event</td>
<td>dict</td>
<td>结束节点信息</td>
</tr>
<tr>
<td>activities</td>
<td>dict</td>
<td>任务节点（原子和子流程）信息</td>
</tr>
<tr>
<td>gateways</td>
<td>dict</td>
<td>网关节点（并行网关、分支网关和汇聚网关）信息</td>
</tr>
<tr>
<td>flows</td>
<td>dict</td>
<td>顺序流（节点连线）信息</td>
</tr>
<tr>
<td>constants</td>
<td>dict</td>
<td>全局变量信息，详情见下面</td>
</tr>
<tr>
<td>outputs</td>
<td>list</td>
<td>模板输出信息，标记 constants 中的输出字段</td>
</tr>
</tbody>
</table>
<h4 id="datapipeline_treeconstantskey">data.pipeline_tree.constants.KEY</h4>
<p>全局变量 KEY，${key} 格式</p>
<h4 id="datapipeline_treeconstantsvalue">data.pipeline_tree.constants.VALUE</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>key</td>
<td>string</td>
<td>同 KEY</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>变量名字</td>
</tr>
<tr>
<td>index</td>
<td>int</td>
<td>变量在模板中的显示顺序</td>
</tr>
<tr>
<td>desc</td>
<td>string</td>
<td>变量说明</td>
</tr>
<tr>
<td>source_type</td>
<td>string</td>
<td>变量来源, 取值范围 custom: 自定义变量，component_inputs: 从原子输入参数勾选，component_outputs：从原子输出结果中勾选</td>
</tr>
<tr>
<td>custom_type</td>
<td>string</td>
<td>source_type=custom 时有效，自定义变量类型， 取值范围 input: 输入框，textarea: 文本框，datetime: 日期时间，int: 整数</td>
</tr>
<tr>
<td>source_tag</td>
<td>string</td>
<td>source_type=component_inputs 或 component_outputs 时有效，变量的来源原子</td>
</tr>
<tr>
<td>source_info</td>
<td>dict</td>
<td>source_type=component_inputs 或 component_outputs 时有效，变量的来源节点信息</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/sops/get_common_template_list/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>查询公共模板列表</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<p>无</p>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;data&quot;: [
        {
            &quot;category&quot;: &quot;Other&quot;,
            &quot;name&quot;: &quot;父流程&quot;,
            &quot;creator&quot;: &quot;admin&quot;,
            &quot;edit_time&quot;: &quot;2019-07-15 15:13:22 +0800&quot;,
            &quot;create_time&quot;: &quot;2019-07-15 15:13:22 +0800&quot;,
            &quot;editor&quot;: &quot;admin&quot;,
            &quot;id&quot;: 10014
        },
        {
            &quot;category&quot;: &quot;Other&quot;,
            &quot;name&quot;: &quot;子流程&quot;,
            &quot;creator&quot;: &quot;admin&quot;,
            &quot;edit_time&quot;: &quot;2019-07-15 15:13:22 +0800&quot;,
            &quot;create_time&quot;: &quot;2019-07-15 15:13:22 +0800&quot;,
            &quot;editor&quot;: &quot;admin&quot;,
            &quot;id&quot;: 10013
        },
    ],
    &quot;result&quot;: true
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>true/false 查询成功与否</td>
</tr>
<tr>
<td>data</td>
<td>list</td>
<td>result=true 时模板列表，item 信息见下面说明</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>result=false 时错误信息</td>
</tr>
</tbody>
</table>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>int</td>
<td>模板 ID</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>模板名称</td>
</tr>
<tr>
<td>category</td>
<td>string</td>
<td>模板分类，分类信息见下面说明</td>
</tr>
<tr>
<td>creator</td>
<td>string</td>
<td>模板创建人</td>
</tr>
<tr>
<td>create_time</td>
<td>string</td>
<td>模板创建时间</td>
</tr>
<tr>
<td>editor</td>
<td>string 或者 null</td>
<td>模板编辑人</td>
</tr>
<tr>
<td>edit_time</td>
<td>string</td>
<td>模板最新编辑时间</td>
</tr>
</tbody>
</table>
<h4 id="datacategory">data.category</h4>
<table>
<thead>
<tr>
<th>返回值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>OpsTools</td>
<td>运维工具</td>
</tr>
<tr>
<td>MonitorAlarm</td>
<td>监控告警</td>
</tr>
<tr>
<td>ConfManage</td>
<td>配置管理</td>
</tr>
<tr>
<td>DevTools</td>
<td>开发工具</td>
</tr>
<tr>
<td>EnterpriseIT</td>
<td>企业 IT</td>
</tr>
<tr>
<td>OfficeApp</td>
<td>办公应用</td>
</tr>
<tr>
<td>Other</td>
<td>其它</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/sops/get_periodic_task_info/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>查询某个周期任务的详情</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>task_id</td>
<td>string</td>
<td>是</td>
<td>周期任务 ID</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>string</td>
<td>是</td>
<td>模板所属业务 ID</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_biz_id&quot;: &quot;2&quot;,
    &quot;task_id&quot;: &quot;8&quot;
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: {
        &quot;cron&quot;: &quot;1,2,3-19/2 2 3 4 5 (m/h/d/dM/MY)&quot;,
        &quot;total_run_count&quot;: 0,
        &quot;name&quot;: &quot;定时2&quot;,
        &quot;form&quot;: {
            &quot;${bk_timing}&quot;: {
                &quot;source_tag&quot;: &quot;sleep_timer.bk_timing&quot;,
                &quot;source_info&quot;: {
                    &quot;node76393dcfedcf73dbc726f1c4786d&quot;: [
                        &quot;bk_timing&quot;
                    ]
                },
                &quot;name&quot;: &quot;定时时间&quot;,
                &quot;index&quot;: 0,
                &quot;custom_type&quot;: &quot;&quot;,
                &quot;value&quot;: &quot;2&quot;,
                &quot;show_type&quot;: &quot;show&quot;,
                &quot;source_type&quot;: &quot;component_inputs&quot;,
                &quot;key&quot;: &quot;${bk_timing}&quot;,
                &quot;validation&quot;: &quot;&quot;,
                &quot;desc&quot;: &quot;&quot;
            }
        },
        &quot;creator&quot;: &quot;admin&quot;,
        &quot;pipeline_tree&quot;: {
            &quot;activities&quot;: {
                &quot;nodea5c396a3ef0f9f3cd7d4d7695f78&quot;: {
                    &quot;outgoing&quot;: &quot;linef69b59d165fb8c0061b46588c515&quot;,
                    &quot;incoming&quot;: &quot;linecf7b7f10c87187a88b72c5f91177&quot;,
                    &quot;name&quot;: &quot;暂停&quot;,
                    &quot;error_ignorable&quot;: false,
                    &quot;component&quot;: {
                        &quot;code&quot;: &quot;pause_node&quot;,
                        &quot;data&quot;: {}
                    },
                    &quot;stage_name&quot;: &quot;步骤1&quot;,
                    &quot;optional&quot;: false,
                    &quot;type&quot;: &quot;ServiceActivity&quot;,
                    &quot;id&quot;: &quot;nodea5c396a3ef0f9f3cd7d4d7695f78&quot;,
                    &quot;loop&quot;: {}
                },
                &quot;node76393dcfedcf73dbc726f1c4786d&quot;: {
                    &quot;outgoing&quot;: &quot;linecf7b7f10c87187a88b72c5f91177&quot;,
                    &quot;incoming&quot;: &quot;linecd597f19606c1455d661f71a582d&quot;,
                    &quot;name&quot;: &quot;定时&quot;,
                    &quot;error_ignorable&quot;: false,
                    &quot;component&quot;: {
                        &quot;code&quot;: &quot;sleep_timer&quot;,
                        &quot;data&quot;: {
                            &quot;bk_timing&quot;: {
                                &quot;hook&quot;: true,
                                &quot;value&quot;: &quot;${bk_timing}&quot;
                            }
                        }
                    },
                    &quot;stage_name&quot;: &quot;步骤1&quot;,
                    &quot;optional&quot;: false,
                    &quot;type&quot;: &quot;ServiceActivity&quot;,
                    &quot;id&quot;: &quot;node76393dcfedcf73dbc726f1c4786d&quot;,
                    &quot;loop&quot;: {}
                }
            },
            &quot;end_event&quot;: {
                &quot;incoming&quot;: &quot;linef69b59d165fb8c0061b46588c515&quot;,
                &quot;outgoing&quot;: &quot;&quot;,
                &quot;type&quot;: &quot;EmptyEndEvent&quot;,
                &quot;id&quot;: &quot;node375320830be9c46cd89f4069857d&quot;,
                &quot;name&quot;: &quot;&quot;
            },
            &quot;outputs&quot;: [],
            &quot;flows&quot;: {
                &quot;linef69b59d165fb8c0061b46588c515&quot;: {
                    &quot;is_default&quot;: false,
                    &quot;source&quot;: &quot;nodea5c396a3ef0f9f3cd7d4d7695f78&quot;,
                    &quot;id&quot;: &quot;linef69b59d165fb8c0061b46588c515&quot;,
                    &quot;target&quot;: &quot;node375320830be9c46cd89f4069857d&quot;
                },
                &quot;linecd597f19606c1455d661f71a582d&quot;: {
                    &quot;is_default&quot;: false,
                    &quot;source&quot;: &quot;node4e87796ddd76b0d59337b08f385d&quot;,
                    &quot;id&quot;: &quot;linecd597f19606c1455d661f71a582d&quot;,
                    &quot;target&quot;: &quot;node76393dcfedcf73dbc726f1c4786d&quot;
                },
                &quot;linecf7b7f10c87187a88b72c5f91177&quot;: {
                    &quot;is_default&quot;: false,
                    &quot;source&quot;: &quot;node76393dcfedcf73dbc726f1c4786d&quot;,
                    &quot;id&quot;: &quot;linecf7b7f10c87187a88b72c5f91177&quot;,
                    &quot;target&quot;: &quot;nodea5c396a3ef0f9f3cd7d4d7695f78&quot;
                }
            },
            &quot;gateways&quot;: {},
            &quot;line&quot;: [
                {
                    &quot;source&quot;: {
                        &quot;id&quot;: &quot;nodea5c396a3ef0f9f3cd7d4d7695f78&quot;,
                        &quot;arrow&quot;: &quot;Right&quot;
                    },
                    &quot;target&quot;: {
                        &quot;id&quot;: &quot;node375320830be9c46cd89f4069857d&quot;,
                        &quot;arrow&quot;: &quot;Left&quot;
                    },
                    &quot;id&quot;: &quot;linef69b59d165fb8c0061b46588c515&quot;
                },
                {
                    &quot;source&quot;: {
                        &quot;id&quot;: &quot;node4e87796ddd76b0d59337b08f385d&quot;,
                        &quot;arrow&quot;: &quot;Right&quot;
                    },
                    &quot;id&quot;: &quot;linecd597f19606c1455d661f71a582d&quot;,
                    &quot;target&quot;: {
                        &quot;id&quot;: &quot;node76393dcfedcf73dbc726f1c4786d&quot;,
                        &quot;arrow&quot;: &quot;Left&quot;
                    }
                },
                {
                    &quot;source&quot;: {
                        &quot;id&quot;: &quot;node76393dcfedcf73dbc726f1c4786d&quot;,
                        &quot;arrow&quot;: &quot;Right&quot;
                    },
                    &quot;target&quot;: {
                        &quot;id&quot;: &quot;nodea5c396a3ef0f9f3cd7d4d7695f78&quot;,
                        &quot;arrow&quot;: &quot;Left&quot;
                    },
                    &quot;id&quot;: &quot;linecf7b7f10c87187a88b72c5f91177&quot;
                }
            ],
            &quot;start_event&quot;: {
                &quot;incoming&quot;: &quot;&quot;,
                &quot;outgoing&quot;: &quot;linecd597f19606c1455d661f71a582d&quot;,
                &quot;type&quot;: &quot;EmptyStartEvent&quot;,
                &quot;id&quot;: &quot;node4e87796ddd76b0d59337b08f385d&quot;,
                &quot;name&quot;: &quot;&quot;
            },
            &quot;constants&quot;: {
                &quot;${bk_timing}&quot;: {
                    &quot;source_tag&quot;: &quot;sleep_timer.bk_timing&quot;,
                    &quot;source_info&quot;: {
                        &quot;node76393dcfedcf73dbc726f1c4786d&quot;: [
                            &quot;bk_timing&quot;
                        ]
                    },
                    &quot;name&quot;: &quot;定时时间&quot;,
                    &quot;index&quot;: 0,
                    &quot;custom_type&quot;: &quot;&quot;,
                    &quot;value&quot;: &quot;2&quot;,
                    &quot;show_type&quot;: &quot;show&quot;,
                    &quot;source_type&quot;: &quot;component_inputs&quot;,
                    &quot;key&quot;: &quot;${bk_timing}&quot;,
                    &quot;validation&quot;: &quot;&quot;,
                    &quot;desc&quot;: &quot;&quot;
                }
            },
            &quot;location&quot;: [
                {
                    &quot;stage_name&quot;: &quot;步骤1&quot;,
                    &quot;name&quot;: &quot;暂停&quot;,
                    &quot;y&quot;: 133,
                    &quot;x&quot;: 631,
                    &quot;type&quot;: &quot;tasknode&quot;,
                    &quot;id&quot;: &quot;nodea5c396a3ef0f9f3cd7d4d7695f78&quot;
                },
                {
                    &quot;y&quot;: 150,
                    &quot;x&quot;: 80,
                    &quot;type&quot;: &quot;startpoint&quot;,
                    &quot;id&quot;: &quot;node4e87796ddd76b0d59337b08f385d&quot;
                },
                {
                    &quot;y&quot;: 149,
                    &quot;x&quot;: 1092,
                    &quot;type&quot;: &quot;endpoint&quot;,
                    &quot;id&quot;: &quot;node375320830be9c46cd89f4069857d&quot;
                },
                {
                    &quot;stage_name&quot;: &quot;步骤1&quot;,
                    &quot;name&quot;: &quot;定时&quot;,
                    &quot;y&quot;: 133,
                    &quot;x&quot;: 300,
                    &quot;type&quot;: &quot;tasknode&quot;,
                    &quot;id&quot;: &quot;node76393dcfedcf73dbc726f1c4786d&quot;
                }
            ]
        },
        &quot;last_run_at&quot;: &quot;&quot;,
        &quot;enabled&quot;: true,
        &quot;id&quot;: 5,
        &quot;template_id&quot;: &quot;2&quot;
    },
    &quot;result&quot;: true
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>true/false 操作是否成功</td>
</tr>
<tr>
<td>data</td>
<td>dict</td>
<td>result=true 时成功数据，详细信息请见下面说明</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>result=false 时错误信息</td>
</tr>
</tbody>
</table>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>cron</td>
<td>string</td>
<td>周期调度表达式</td>
</tr>
<tr>
<td>total_run_count</td>
<td>int</td>
<td>周期任务运行次数</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>周期任务名</td>
</tr>
<tr>
<td>creator</td>
<td>string</td>
<td>创建者</td>
</tr>
<tr>
<td>last_run_at</td>
<td>string</td>
<td>上次运行时间</td>
</tr>
<tr>
<td>enabled</td>
<td>bool</td>
<td>是否激活</td>
</tr>
<tr>
<td>id</td>
<td>int</td>
<td>周期任务 ID</td>
</tr>
<tr>
<td>template_id</td>
<td>string</td>
<td>用于创建该任务的模板 ID</td>
</tr>
<tr>
<td>form</td>
<td>dict</td>
<td>该周期任务的参数表单对象</td>
</tr>
<tr>
<td>pipeline_tree</td>
<td>dict</td>
<td>该周期任务的实例树</td>
</tr>
</tbody>
</table>
<h4 id="datapipeline_tree">data.pipeline_tree</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>start_event</td>
<td>dict</td>
<td>开始节点信息</td>
</tr>
<tr>
<td>end_event</td>
<td>dict</td>
<td>结束节点信息</td>
</tr>
<tr>
<td>activities</td>
<td>dict</td>
<td>任务节点（原子和子流程）信息</td>
</tr>
<tr>
<td>gateways</td>
<td>dict</td>
<td>网关节点（并行网关、分支网关和汇聚网关）信息</td>
</tr>
<tr>
<td>flows</td>
<td>dict</td>
<td>顺序流（节点连线）信息</td>
</tr>
<tr>
<td>constants</td>
<td>dict</td>
<td>全局变量信息，详情见下面</td>
</tr>
<tr>
<td>outputs</td>
<td>list</td>
<td>模板输出信息，标记 constants 中的输出字段</td>
</tr>
</tbody>
</table>
<h4 id="dataformkey-datapipeline_treeconstantskey">data.form.KEY, data.pipeline_tree.constants.KEY</h4>
<p>全局变量 KEY，${key} 格式</p>
<h4 id="dataformvalue-datapipeline_treeconstantsvalue">data.form.VALUE, data.pipeline_tree.constants.VALUE</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>key</td>
<td>string</td>
<td>同 KEY</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>变量名字</td>
</tr>
<tr>
<td>index</td>
<td>int</td>
<td>变量在模板中的显示顺序</td>
</tr>
<tr>
<td>desc</td>
<td>string</td>
<td>变量说明</td>
</tr>
<tr>
<td>source_type</td>
<td>string</td>
<td>变量来源, 取值范围 custom: 自定义变量，component_inputs: 从原子输入参数勾选，component_outputs：从原子输出结果中勾选</td>
</tr>
<tr>
<td>custom_type</td>
<td>string</td>
<td>source_type=custom 时有效，自定义变量类型， 取值范围 input: 输入框，textarea: 文本框，datetime: 日期时间，int: 整数</td>
</tr>
<tr>
<td>source_tag</td>
<td>string</td>
<td>source_type=component_inputs/component_outputs 时有效，变量的来源原子</td>
</tr>
<tr>
<td>source_info</td>
<td>dict</td>
<td>source_type=component_inputs/component_outputs 时有效，变量的来源节点信息</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/sops/get_periodic_task_list/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>查询某个业务下所有的周期任务</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>string</td>
<td>是</td>
<td>任务所属业务 ID</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_biz_id&quot;: &quot;2&quot;
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;data&quot;: [
        {
            &quot;cron&quot;: &quot;*/1 15 * * * (m/h/d/dM/MY)&quot;,
            &quot;total_run_count&quot;: 1,
            &quot;name&quot;: &quot;from api 3&quot;,
            &quot;creator&quot;: &quot;admin&quot;,
            &quot;last_run_at&quot;: &quot;2018-11-28 15:57:01 +0900&quot;,
            &quot;enabled&quot;: false,
            &quot;id&quot;: 11,
            &quot;template_id&quot;: &quot;2&quot;
        },
        {
            &quot;cron&quot;: &quot;1,2,3-19/2 2 3 4 5 (m/h/d/dM/MY)&quot;,
            &quot;total_run_count&quot;: 0,
            &quot;name&quot;: &quot;from api 1&quot;,
            &quot;creator&quot;: &quot;admin&quot;,
            &quot;last_run_at&quot;: &quot;&quot;,
            &quot;enabled&quot;: false,
            &quot;id&quot;: 6,
            &quot;template_id&quot;: &quot;2&quot;
        },
        {
            &quot;cron&quot;: &quot;*/5 * * * * (m/h/d/dM/MY)&quot;,
            &quot;total_run_count&quot;: 0,
            &quot;name&quot;: &quot;定时&quot;,
            &quot;creator&quot;: &quot;admin&quot;,
            &quot;last_run_at&quot;: &quot;&quot;,
            &quot;enabled&quot;: false,
            &quot;id&quot;: 4,
            &quot;template_id&quot;: &quot;2&quot;
        }
    ],
    &quot;result&quot;: true
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>true/false 操作是否成功</td>
</tr>
<tr>
<td>data</td>
<td>dict</td>
<td>result=true 时成功数据，详细信息请见下面说明</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>result=false 时错误信息</td>
</tr>
</tbody>
</table>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>cron</td>
<td>string</td>
<td>周期调度表达式</td>
</tr>
<tr>
<td>total_run_count</td>
<td>int</td>
<td>周期任务运行次数</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>周期任务名</td>
</tr>
<tr>
<td>creator</td>
<td>string</td>
<td>创建者</td>
</tr>
<tr>
<td>last_run_at</td>
<td>string</td>
<td>上次运行时间</td>
</tr>
<tr>
<td>enabled</td>
<td>bool</td>
<td>是否激活</td>
</tr>
<tr>
<td>id</td>
<td>int</td>
<td>周期任务 ID</td>
</tr>
<tr>
<td>template_id</td>
<td>string</td>
<td>用于创建该任务的模板 ID</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/sops/get_plugin_list/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>获取某个业务下所有的可用插件</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>参数名称</th>
<th>参数类型</th>
<th>必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>app_code</td>
<td>string</td>
<td>是</td>
<td>蓝鲸应用编码</td>
</tr>
<tr>
<td>app_secret</td>
<td>string</td>
<td>是</td>
<td>蓝鲸应用私密 key</td>
</tr>
<tr>
<td>access_token</td>
<td>string</td>
<td>否</td>
<td>用户登录票据，bk_token 为空时必填</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>用户登录票据，access_token 为空时必填</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>string</td>
<td>是</td>
<td>项目唯一 ID，项目 ID 或 CMDB 业务 ID</td>
</tr>
<tr>
<td>scope</td>
<td>string</td>
<td>否</td>
<td>唯一 ID 的范围，取值为 cmdb_biz 或 project，为 cmdb_biz 时 bk_biz_id 代表业务 ID，反之代表项目 ID，不传时默认为 cmdb_biz</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_biz_id&quot;: &quot;2&quot;
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;result&quot;: true,
    &quot;data&quot;: [
        {
            &quot;inputs&quot;: [],
            &quot;outputs&quot;: [
                {
                    &quot;name&quot;: &quot;执行结果&quot;,
                    &quot;key&quot;: &quot;_result&quot;,
                    &quot;type&quot;: &quot;bool&quot;,
                    &quot;schema&quot;: {
                        &quot;type&quot;: &quot;boolean&quot;,
                        &quot;description&quot;: &quot;是否执行成功&quot;,
                        &quot;enum&quot;: []
                    }
                },
                {
                    &quot;name&quot;: &quot;循环次数&quot;,
                    &quot;key&quot;: &quot;_loop&quot;,
                    &quot;type&quot;: &quot;int&quot;,
                    &quot;schema&quot;: {
                        &quot;type&quot;: &quot;int&quot;,
                        &quot;description&quot;: &quot;循环执行次数&quot;,
                        &quot;enum&quot;: []
                    }
                }
            ],
            &quot;desc&quot;: &quot;&quot;,
            &quot;code&quot;: &quot;job_push_local_files&quot;,
            &quot;name&quot;: &quot;分发本地文件&quot;,
            &quot;group_name&quot;: &quot;作业平台(JOB)&quot;,
            &quot;version&quot;: &quot;1.0.0&quot;
        }
    ]
}</code></pre>


<h3 id="_9">返回结果说明</h3>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>true/false 操作是否成功</td>
</tr>
<tr>
<td>data</td>
<td>dict</td>
<td>result=true 时成功数据，详细信息请见下面说明</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>result=false 时错误信息</td>
</tr>
</tbody>
</table>
<h5 id="dataitem">data[item]</h5>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>inputs</td>
<td>array</td>
<td>插件输入参数列表</td>
</tr>
<tr>
<td>outputs</td>
<td>array</td>
<td>插件输出参数列表</td>
</tr>
<tr>
<td>desc</td>
<td>string</td>
<td>插件描述</td>
</tr>
<tr>
<td>code</td>
<td>string</td>
<td>插件代码</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>插件名</td>
</tr>
<tr>
<td>group_name</td>
<td>string</td>
<td>插件组名</td>
</tr>
<tr>
<td>version</td>
<td>name</td>
<td>插件版本</td>
</tr>
</tbody>
</table>
<h5 id="inputs">inputs</h5>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>required</td>
<td>bool</td>
<td>是否是必填参数</td>
</tr>
<tr>
<td>type</td>
<td>string</td>
<td>参数类型</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>参数名</td>
</tr>
<tr>
<td>key</td>
<td>string</td>
<td>参数唯一键</td>
</tr>
<tr>
<td>schema</td>
<td>dict</td>
<td>参数 schema</td>
</tr>
</tbody>
</table>
<h6 id="inputsschema">inputs.schema</h6>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>type</td>
<td>string</td>
<td>参数类型</td>
</tr>
<tr>
<td>enum</td>
<td>list</td>
<td>参数可选范围</td>
</tr>
<tr>
<td>description</td>
<td>string</td>
<td>参数描述</td>
</tr>
<tr>
<td>properties</td>
<td>dict</td>
<td>对象属性 schema，当 type 为 object 时，会存在该字段，该对象的属性的值为另一个 schema 对象</td>
</tr>
<tr>
<td>items</td>
<td>dict</td>
<td>列表元素 schema，当 type 为 array 时，会存在该字段</td>
</tr>
</tbody>
</table>
<h5 id="outputs">outputs</h5>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>type</td>
<td>string</td>
<td>参数类型</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>参数名</td>
</tr>
<tr>
<td>key</td>
<td>string</td>
<td>参数唯一键</td>
</tr>
<tr>
<td>schema</td>
<td>dict</td>
<td>参数 schema</td>
</tr>
</tbody>
</table>
<h6 id="outputsschema">outputs.schema</h6>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>type</td>
<td>string</td>
<td>参数类型</td>
</tr>
<tr>
<td>enum</td>
<td>list</td>
<td>参数可选范围</td>
</tr>
<tr>
<td>description</td>
<td>string</td>
<td>参数描述</td>
</tr>
<tr>
<td>properties</td>
<td>dict</td>
<td>对象属性 schema，当 type 为 object 时，会存在该字段，该对象的属性的值为另一个 schema 对象</td>
</tr>
<tr>
<td>items</td>
<td>dict</td>
<td>列表元素 schema，当 type 为 array 时，会存在该字段</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/sops/get_task_detail/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>查询任务执行详情</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>string</td>
<td>是</td>
<td>所属业务 ID</td>
</tr>
<tr>
<td>task_id</td>
<td>string</td>
<td>是</td>
<td>任务 ID</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_biz_id&quot;: &quot;2&quot;,
    &quot;task_id&quot;: &quot;10&quot;
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;data&quot;: {
        &quot;creator&quot;: &quot;admin&quot;,
        &quot;outputs&quot;: [
            {
                &quot;value&quot;: &quot;1&quot;,
                &quot;key&quot;: &quot;${job_script_type}&quot;,
                &quot;name&quot;: &quot;脚本类型&quot;
            },
            {
                &quot;value&quot;: &quot;127.0.0.1&quot;,
                &quot;key&quot;: &quot;${IP}&quot;,
                &quot;name&quot;: &quot;IP&quot;
            },
            {
                &quot;value&quot;: &quot;0&quot;,
                &quot;key&quot;: &quot;${EXIT}&quot;,
                &quot;name&quot;: &quot;EXIT&quot;
            }
        ],
        &quot;start_time&quot;: &quot;2019-01-17 04:13:08&quot;,
        &quot;business_id&quot;: 2,
        &quot;create_time&quot;: &quot;2019-01-17 04:13:03&quot;,
        &quot;business_name&quot;: &quot;蓝鲸&quot;,
        &quot;id&quot;: 10,
        &quot;constants&quot;: {
            &quot;${IP}&quot;: {
                &quot;source_tag&quot;: &quot;var_ip_picker.ip_picker&quot;,
                &quot;source_info&quot;: {},
                &quot;name&quot;: &quot;IP&quot;,
                &quot;index&quot;: 2,
                &quot;custom_type&quot;: &quot;ip&quot;,
                &quot;value&quot;: {
                    &quot;var_ip_custom_value&quot;: &quot;127.0.0.1&quot;,
                    &quot;var_ip_method&quot;: &quot;custom&quot;,
                    &quot;var_ip_tree&quot;: []
                },
                &quot;show_type&quot;: &quot;show&quot;,
                &quot;source_type&quot;: &quot;custom&quot;,
                &quot;validator&quot;: [],
                &quot;key&quot;: &quot;${IP}&quot;,
                &quot;desc&quot;: &quot;&quot;,
                &quot;validation&quot;: &quot;&quot;,
                &quot;is_meta&quot;: false
            },
            &quot;${job_script_type}&quot;: {
                &quot;source_tag&quot;: &quot;job_fast_execute_script.job_script_type&quot;,
                &quot;source_info&quot;: {
                    &quot;node554316ea019a341f8c28cc6a7da9&quot;: [
                        &quot;job_script_type&quot;
                    ]
                },
                &quot;name&quot;: &quot;脚本类型&quot;,
                &quot;index&quot;: 0,
                &quot;custom_type&quot;: &quot;&quot;,
                &quot;value&quot;: &quot;1&quot;,
                &quot;show_type&quot;: &quot;show&quot;,
                &quot;source_type&quot;: &quot;component_inputs&quot;,
                &quot;key&quot;: &quot;${job_script_type}&quot;,
                &quot;validation&quot;: &quot;&quot;,
                &quot;desc&quot;: &quot;&quot;
            },
            &quot;${EXIT}&quot;: {
                &quot;source_tag&quot;: &quot;&quot;,
                &quot;source_info&quot;: {},
                &quot;name&quot;: &quot;EXIT&quot;,
                &quot;index&quot;: 1,
                &quot;custom_type&quot;: &quot;input&quot;,
                &quot;value&quot;: &quot;0&quot;,
                &quot;show_type&quot;: &quot;show&quot;,
                &quot;source_type&quot;: &quot;custom&quot;,
                &quot;validator&quot;: [],
                &quot;key&quot;: &quot;${EXIT}&quot;,
                &quot;validation&quot;: &quot;^.+$&quot;,
                &quot;desc&quot;: &quot;&quot;
            }
        },
        &quot;create_method&quot;: &quot;app&quot;,
        &quot;elapsed_time&quot;: 7,
        &quot;ex_data&quot;: &quot;&quot;,
        &quot;instance_name&quot;: &quot;job输出变量测试_20190117121300&quot;,
        &quot;end_time&quot;: &quot;2019-01-17 04:13:15&quot;,
        &quot;executor&quot;: &quot;admin&quot;,
        &quot;template_id&quot;: &quot;266&quot;,
        &quot;task_url&quot;: &quot;http://bk_sops_host/taskflow/execute/3/?instance_id=15364&quot;,
        &quot;pipeline_tree&quot;: {
            &quot;activities&quot;: {
                &quot;node9b5ae13799d63e179f0ce3088b62&quot;: {
                    &quot;outgoing&quot;: &quot;line27bc7b4ccbcf37ddb9d1f6572a04&quot;,
                    &quot;incoming&quot;: &quot;line490caa49d2a03e64829693281032&quot;,
                    &quot;name&quot;: &quot;timing&quot;,
                    &quot;error_ignorable&quot;: false,
                    &quot;component&quot;: {
                        &quot;code&quot;: &quot;sleep_timer&quot;,
                        &quot;data&quot;: {
                            &quot;bk_timing&quot;: {
                                &quot;hook&quot;: false,
                                &quot;value&quot;: &quot;2&quot;
                            }
                        }
                    },
                    &quot;stage_name&quot;: &quot;步骤1&quot;,
                    &quot;can_retry&quot;: true,
                    &quot;isSkipped&quot;: true,
                    &quot;type&quot;: &quot;ServiceActivity&quot;,
                    &quot;optional&quot;: false,
                    &quot;id&quot;: &quot;node9b5ae13799d63e179f0ce3088b62&quot;,
                    &quot;loop&quot;: null
                },
                &quot;node880ded556c6c3c269be3cedc64b6&quot;: {
                    &quot;outgoing&quot;: &quot;line490caa49d2a03e64829693281032&quot;,
                    &quot;incoming&quot;: &quot;lineb83161d6e0593ad68d9ec73a961b&quot;,
                    &quot;name&quot;: &quot;暂停&quot;,
                    &quot;error_ignorable&quot;: false,
                    &quot;component&quot;: {
                        &quot;code&quot;: &quot;pause_node&quot;,
                        &quot;data&quot;: {}
                    },
                    &quot;stage_name&quot;: &quot;步骤1&quot;,
                    &quot;can_retry&quot;: true,
                    &quot;isSkipped&quot;: true,
                    &quot;type&quot;: &quot;ServiceActivity&quot;,
                    &quot;optional&quot;: true,
                    &quot;id&quot;: &quot;node880ded556c6c3c269be3cedc64b6&quot;,
                    &quot;loop&quot;: null
                }
            },
            &quot;end_event&quot;: {
                &quot;type&quot;: &quot;EmptyEndEvent&quot;,
                &quot;outgoing&quot;: &quot;&quot;,
                &quot;incoming&quot;: &quot;line27bc7b4ccbcf37ddb9d1f6572a04&quot;,
                &quot;id&quot;: &quot;node5c48f37aa9f0351e8b43ab6a2295&quot;,
                &quot;name&quot;: &quot;&quot;
            },
            &quot;outputs&quot;: [],
            &quot;flows&quot;: {
                &quot;line490caa49d2a03e64829693281032&quot;: {
                    &quot;is_default&quot;: false,
                    &quot;source&quot;: &quot;node880ded556c6c3c269be3cedc64b6&quot;,
                    &quot;id&quot;: &quot;line490caa49d2a03e64829693281032&quot;,
                    &quot;target&quot;: &quot;node9b5ae13799d63e179f0ce3088b62&quot;
                },
                &quot;lineb83161d6e0593ad68d9ec73a961b&quot;: {
                    &quot;is_default&quot;: false,
                    &quot;source&quot;: &quot;noded383bc1d7387391f889c6bab18b8&quot;,
                    &quot;id&quot;: &quot;lineb83161d6e0593ad68d9ec73a961b&quot;,
                    &quot;target&quot;: &quot;node880ded556c6c3c269be3cedc64b6&quot;
                },
                &quot;line27bc7b4ccbcf37ddb9d1f6572a04&quot;: {
                    &quot;is_default&quot;: false,
                    &quot;source&quot;: &quot;node9b5ae13799d63e179f0ce3088b62&quot;,
                    &quot;id&quot;: &quot;line27bc7b4ccbcf37ddb9d1f6572a04&quot;,
                    &quot;target&quot;: &quot;node5c48f37aa9f0351e8b43ab6a2295&quot;
                }
            },
            &quot;gateways&quot;: {},
            &quot;line&quot;: [
                {
                    &quot;source&quot;: {
                        &quot;id&quot;: &quot;node9b5ae13799d63e179f0ce3088b62&quot;,
                        &quot;arrow&quot;: &quot;Right&quot;
                    },
                    &quot;target&quot;: {
                        &quot;id&quot;: &quot;node5c48f37aa9f0351e8b43ab6a2295&quot;,
                        &quot;arrow&quot;: &quot;Left&quot;
                    },
                    &quot;id&quot;: &quot;line27bc7b4ccbcf37ddb9d1f6572a04&quot;
                },
                {
                    &quot;source&quot;: {
                        &quot;id&quot;: &quot;node880ded556c6c3c269be3cedc64b6&quot;,
                        &quot;arrow&quot;: &quot;Right&quot;
                    },
                    &quot;target&quot;: {
                        &quot;id&quot;: &quot;node9b5ae13799d63e179f0ce3088b62&quot;,
                        &quot;arrow&quot;: &quot;Left&quot;
                    },
                    &quot;id&quot;: &quot;line490caa49d2a03e64829693281032&quot;
                },
                {
                    &quot;source&quot;: {
                        &quot;id&quot;: &quot;noded383bc1d7387391f889c6bab18b8&quot;,
                        &quot;arrow&quot;: &quot;Right&quot;
                    },
                    &quot;id&quot;: &quot;lineb83161d6e0593ad68d9ec73a961b&quot;,
                    &quot;target&quot;: {
                        &quot;id&quot;: &quot;node880ded556c6c3c269be3cedc64b6&quot;,
                        &quot;arrow&quot;: &quot;Left&quot;
                    }
                }
            ],
            &quot;start_event&quot;: {
                &quot;type&quot;: &quot;EmptyStartEvent&quot;,
                &quot;outgoing&quot;: &quot;lineb83161d6e0593ad68d9ec73a961b&quot;,
                &quot;incoming&quot;: &quot;&quot;,
                &quot;id&quot;: &quot;noded383bc1d7387391f889c6bab18b8&quot;,
                &quot;name&quot;: &quot;&quot;
            },
            &quot;id&quot;: &quot;node7ef6970d06ad3bc092594cb5ec5f&quot;,
            &quot;constants&quot;: {},
            &quot;location&quot;: [
                {
                    &quot;stage_name&quot;: &quot;步骤1&quot;,
                    &quot;name&quot;: &quot;暂停&quot;,
                    &quot;y&quot;: 135,
                    &quot;x&quot;: 300,
                    &quot;type&quot;: &quot;tasknode&quot;,
                    &quot;id&quot;: &quot;node880ded556c6c3c269be3cedc64b6&quot;
                },
                {
                    &quot;y&quot;: 150,
                    &quot;x&quot;: 1000,
                    &quot;type&quot;: &quot;endpoint&quot;,
                    &quot;id&quot;: &quot;node5c48f37aa9f0351e8b43ab6a2295&quot;
                },
                {
                    &quot;stage_name&quot;: &quot;步骤1&quot;,
                    &quot;name&quot;: &quot;timing&quot;,
                    &quot;y&quot;: 135,
                    &quot;x&quot;: 595,
                    &quot;type&quot;: &quot;tasknode&quot;,
                    &quot;id&quot;: &quot;node9b5ae13799d63e179f0ce3088b62&quot;
                },
                {
                    &quot;y&quot;: 150,
                    &quot;x&quot;: 80,
                    &quot;type&quot;: &quot;startpoint&quot;,
                    &quot;id&quot;: &quot;noded383bc1d7387391f889c6bab18b8&quot;
                }
            ]
        }
    },
    &quot;result&quot;: true
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>true/false 查询成功与否</td>
</tr>
<tr>
<td>data</td>
<td>dict</td>
<td>result=true 时返回数据，详细信息见下面说明</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>result=false 时错误信息</td>
</tr>
</tbody>
</table>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>int</td>
<td>任务 ID，即 task_id</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>任务名称</td>
</tr>
<tr>
<td>business_id</td>
<td>int</td>
<td>所属业务 ID</td>
</tr>
<tr>
<td>business_name</td>
<td>string</td>
<td>所属业务名称</td>
</tr>
<tr>
<td>template_id</td>
<td>int</td>
<td>创建任务所用的流程模板 ID</td>
</tr>
<tr>
<td>create_time</td>
<td>string</td>
<td>任务创建时间</td>
</tr>
<tr>
<td>create_method</td>
<td>string</td>
<td>任务创建方式</td>
</tr>
<tr>
<td>start_time</td>
<td>string</td>
<td>任务执行时间</td>
</tr>
<tr>
<td>finish_time</td>
<td>string</td>
<td>任务完成时间</td>
</tr>
<tr>
<td>elapsed_time</td>
<td>int</td>
<td>任务执行耗时(秒）</td>
</tr>
<tr>
<td>creator</td>
<td>string</td>
<td>任务创建人</td>
</tr>
<tr>
<td>executor</td>
<td>string</td>
<td>任务执行人</td>
</tr>
<tr>
<td>constants</td>
<td>dict</td>
<td>输入的全局变量，详情见下面说明</td>
</tr>
<tr>
<td>outputs</td>
<td>list</td>
<td>任务输出参数，详情见下面说明</td>
</tr>
<tr>
<td>task_url</td>
<td>str</td>
<td>任务实例链接</td>
</tr>
<tr>
<td>pipeline_tree</td>
<td>dict</td>
<td>任务实例树</td>
</tr>
</tbody>
</table>
<h4 id="dataconstantskey">data.constants.KEY</h4>
<p>全局变量 KEY，${key} 格式</p>
<h4 id="dataconstantsvalue">data.constants.VALUE</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>key</td>
<td>string</td>
<td>同 KEY</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>变量名字</td>
</tr>
<tr>
<td>index</td>
<td>int</td>
<td>变量在模板中的显示顺序</td>
</tr>
<tr>
<td>desc</td>
<td>string</td>
<td>变量说明</td>
</tr>
<tr>
<td>source_type</td>
<td>string</td>
<td>变量来源, 取值范围 custom: 自定义变量，component_inputs: 从标准插件输入参数勾选，component_outputs：从标准插件输出结果中勾选</td>
</tr>
<tr>
<td>custom_type</td>
<td>string</td>
<td>source_type=custom 时有效，自定义变量类型， 取值范围 input: 输入框，textarea: 文本框，datetime: 日期时间，int: 整数</td>
</tr>
<tr>
<td>source_tag</td>
<td>string</td>
<td>source_type=component_inputs/component_outputs 时有效，变量的来源标准插件</td>
</tr>
<tr>
<td>source_info</td>
<td>dict</td>
<td>source_type=component_inputs/component_outputs 时有效，变量的来源节点信息</td>
</tr>
</tbody>
</table>
<h4 id="dataoutputs">data.outputs[]</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>string</td>
<td>输出参数名称</td>
</tr>
<tr>
<td>value</td>
<td>string、int、bool、dict、list</td>
<td>输出参数值</td>
</tr>
<tr>
<td>key</td>
<td>string</td>
<td>输出参数 KEY</td>
</tr>
<tr>
<td>preset</td>
<td>bool</td>
<td>是否是标准插件定义中预设输出变量</td>
</tr>
</tbody>
</table>
<h4 id="datapipeline_tree">data.pipeline_tree</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>start_event</td>
<td>dict</td>
<td>开始节点信息</td>
</tr>
<tr>
<td>end_event</td>
<td>dict</td>
<td>结束节点信息</td>
</tr>
<tr>
<td>activities</td>
<td>dict</td>
<td>任务节点（原子和子流程）信息</td>
</tr>
<tr>
<td>gateways</td>
<td>dict</td>
<td>网关节点（并行网关、分支网关和汇聚网关）信息</td>
</tr>
<tr>
<td>flows</td>
<td>dict</td>
<td>顺序流（节点连线）信息</td>
</tr>
<tr>
<td>constants</td>
<td>dict</td>
<td>全局变量信息，详情见下面</td>
</tr>
<tr>
<td>outputs</td>
<td>list</td>
<td>模板输出信息，标记 constants 中的输出字段</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/sops/get_task_list/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>获取某个业务下的任务列表，支持任务名关键词搜索</p>
<h4 id="_4">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_5">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>string</td>
<td>是</td>
<td>项目唯一 ID，项目 ID 或 CMDB 业务 ID</td>
</tr>
<tr>
<td>scope</td>
<td>string</td>
<td>否</td>
<td>唯一 ID 的范围，取值为 cmdb_biz 或 project，为 cmdb_biz 时 bk_biz_id 代表业务 ID，反之代表项目 ID，不传时默认为 cmdb_biz</td>
</tr>
<tr>
<td>keyword</td>
<td>string</td>
<td>否</td>
<td>根据任务名关键词过滤任务列表，默认不过滤</td>
</tr>
<tr>
<td>is_started</td>
<td>bool</td>
<td>否</td>
<td>根据任务是否已开始过滤任务列表，默认不过滤</td>
</tr>
<tr>
<td>is_finished</td>
<td>bool</td>
<td>否</td>
<td>根据任务是否已结束过滤任务列表，默认不过滤</td>
</tr>
<tr>
<td>limit</td>
<td>int</td>
<td>否</td>
<td>分页，返回任务列表任务数，默认为 15</td>
</tr>
<tr>
<td>offset</td>
<td>int</td>
<td>否</td>
<td>分页，返回任务列表起始任务下标，默认为 0</td>
</tr>
</tbody>
</table>
<h3 id="_6">请求参数示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_biz_id&quot;: &quot;2&quot;,
    &quot;keyword&quot;: &quot;定时&quot;,
    &quot;is_started&quot;: true,
    &quot;limit&quot;: 5,
}</code></pre>


<h3 id="_7">返回结果示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;result&quot;: true,
    &quot;data&quot;: [
        {
            &quot;id&quot;: 1595,
            &quot;name&quot;: &quot;定时任务1_clone_20200907043931&quot;,
            &quot;category&quot;: &quot;其它&quot;,
            &quot;create_method&quot;: &quot;app&quot;,
            &quot;creator&quot;: &quot;admin&quot;,
            &quot;executor&quot;: &quot;admin&quot;,
            &quot;start_time&quot;: &quot;2020-09-15T06:24:00.840Z&quot;,
            &quot;finish_time&quot;: &quot;2020-09-15T07:12:51.128Z&quot;,
            &quot;is_started&quot;: true,
            &quot;is_finished&quot;: true,
            &quot;template_source&quot;: &quot;project&quot;,
            &quot;template_id&quot;: &quot;2&quot;,
            &quot;project_id&quot;: 1,
            &quot;project_name&quot;: &quot;蓝鲸&quot;,
            &quot;bk_biz_id&quot;: 2,
            &quot;bk_biz_name&quot;: &quot;蓝鲸&quot;
        },
        {
            &quot;id&quot;: 166,
            &quot;name&quot;: &quot;定时测试1_20200623072621&quot;,
            &quot;category&quot;: &quot;运维工具&quot;,
            &quot;create_method&quot;: &quot;app&quot;,
            &quot;creator&quot;: &quot;admin&quot;,
            &quot;executor&quot;: &quot;admin&quot;,
            &quot;start_time&quot;: &quot;2020-06-23T07:26:29.522Z&quot;,
            &quot;finish_time&quot;: null,
            &quot;is_started&quot;: true,
            &quot;is_finished&quot;: false,
            &quot;template_source&quot;: &quot;project&quot;,
            &quot;template_id&quot;: &quot;243&quot;,
            &quot;project_id&quot;: 1,
            &quot;project_name&quot;: &quot;蓝鲸&quot;,
            &quot;bk_biz_id&quot;: 2,
            &quot;bk_biz_name&quot;: &quot;蓝鲸&quot;
        },
        {
            &quot;id&quot;: 159,
            &quot;name&quot;: &quot;新定时_20200610033932_20200610200000&quot;,
            &quot;category&quot;: &quot;其它&quot;,
            &quot;create_method&quot;: &quot;periodic&quot;,
            &quot;creator&quot;: &quot;sops&quot;,
            &quot;executor&quot;: &quot;sops&quot;,
            &quot;start_time&quot;: &quot;2020-06-10T12:00:00.474Z&quot;,
            &quot;finish_time&quot;: null,
            &quot;is_started&quot;: true,
            &quot;is_finished&quot;: false,
            &quot;template_source&quot;: &quot;project&quot;,
            &quot;template_id&quot;: &quot;246&quot;,
            &quot;project_id&quot;: 1,
            &quot;project_name&quot;: &quot;蓝鲸&quot;,
            &quot;bk_biz_id&quot;: 2,
            &quot;bk_biz_name&quot;: &quot;蓝鲸&quot;
        },
        {
            &quot;id&quot;: 158,
            &quot;name&quot;: &quot;新定时_20200610033932_20200610195200&quot;,
            &quot;category&quot;: &quot;其它&quot;,
            &quot;create_method&quot;: &quot;periodic&quot;,
            &quot;creator&quot;: &quot;sops&quot;,
            &quot;executor&quot;: &quot;sops&quot;,
            &quot;start_time&quot;: &quot;2020-06-10T11:52:01.245Z&quot;,
            &quot;finish_time&quot;: null,
            &quot;is_started&quot;: true,
            &quot;is_finished&quot;: false,
            &quot;template_source&quot;: &quot;project&quot;,
            &quot;template_id&quot;: &quot;246&quot;,
            &quot;project_id&quot;: 1,
            &quot;project_name&quot;: &quot;蓝鲸&quot;,
            &quot;bk_biz_id&quot;: 2,
            &quot;bk_biz_name&quot;: &quot;蓝鲸&quot;
        },
        {
            &quot;id&quot;: 157,
            &quot;name&quot;: &quot;新定时_20200610033932_20200610193900&quot;,
            &quot;category&quot;: &quot;其它&quot;,
            &quot;create_method&quot;: &quot;periodic&quot;,
            &quot;creator&quot;: &quot;sops&quot;,
            &quot;executor&quot;: &quot;sops&quot;,
            &quot;start_time&quot;: &quot;2020-06-10T11:39:00.194Z&quot;,
            &quot;finish_time&quot;: null,
            &quot;is_started&quot;: true,
            &quot;is_finished&quot;: false,
            &quot;template_source&quot;: &quot;project&quot;,
            &quot;template_id&quot;: &quot;246&quot;,
            &quot;project_id&quot;: 1,
            &quot;project_name&quot;: &quot;蓝鲸&quot;,
            &quot;bk_biz_id&quot;: 2,
            &quot;bk_biz_name&quot;: &quot;蓝鲸&quot;
        }
    ]
}</code></pre>


<h3 id="_8">返回结果说明</h3>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>true/false 操作是否成功</td>
</tr>
<tr>
<td>data</td>
<td>list</td>
<td>result=true 时成功数据，详细信息请见下面说明</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>result=false 时错误信息</td>
</tr>
</tbody>
</table>
<h5 id="dataitem">data[item]</h5>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>int</td>
<td>任务 ID</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>任务名</td>
</tr>
<tr>
<td>category</td>
<td>string</td>
<td>任务类型</td>
</tr>
<tr>
<td>create_method</td>
<td>string</td>
<td>任务创建方式</td>
</tr>
<tr>
<td>creator</td>
<td>string</td>
<td>任务创建者</td>
</tr>
<tr>
<td>executor</td>
<td>string</td>
<td>任务执行者</td>
</tr>
<tr>
<td>start_time</td>
<td>string</td>
<td>任务开始时间</td>
</tr>
<tr>
<td>finish_time</td>
<td>string</td>
<td>任务结束时间</td>
</tr>
<tr>
<td>is_started</td>
<td>bool</td>
<td>任务是否已开始</td>
</tr>
<tr>
<td>is_finished</td>
<td>bool</td>
<td>任务是否已结束</td>
</tr>
<tr>
<td>template_source</td>
<td>string</td>
<td>任务模版来源，如项目模版 project 和公共模版 common</td>
</tr>
<tr>
<td>template_id</td>
<td>string</td>
<td>任务模版 ID</td>
</tr>
<tr>
<td>project_id</td>
<td>int</td>
<td>项目 ID</td>
</tr>
<tr>
<td>project_name</td>
<td>string</td>
<td>项目名称</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>业务 ID</td>
</tr>
<tr>
<td>bk_biz_name</td>
<td>string</td>
<td>业务名称</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/sops/get_task_node_data/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>获取任务节点的数据</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>参数名称</th>
<th>参数类型</th>
<th>必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>app_code</td>
<td>string</td>
<td>是</td>
<td>蓝鲸应用编码</td>
</tr>
<tr>
<td>app_secret</td>
<td>string</td>
<td>是</td>
<td>蓝鲸应用私密 key</td>
</tr>
<tr>
<td>access_token</td>
<td>string</td>
<td>否</td>
<td>用户登录票据，bk_token 为空时必填</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>用户登录票据，access_token 为空时必填</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>string</td>
<td>是</td>
<td>项目唯一 ID，项目 ID 或 CMDB 业务 ID</td>
</tr>
<tr>
<td>task_id</td>
<td>int</td>
<td>是</td>
<td>任务 ID</td>
</tr>
<tr>
<td>scope</td>
<td>string</td>
<td>否</td>
<td>唯一 ID 的范围，取值为 cmdb_biz 或 project，为 cmdb_biz 时 bk_biz_id 代表业务 ID，反之代表项目 ID，不传时默认为 cmdb_biz</td>
</tr>
<tr>
<td>node_id</td>
<td>string</td>
<td>是</td>
<td>节点 ID</td>
</tr>
<tr>
<td>component_code</td>
<td>string</td>
<td>是</td>
<td>原子编码</td>
</tr>
<tr>
<td>subprocess_stack</td>
<td>string</td>
<td>否</td>
<td>子流程堆栈，json 格式的列表</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_biz_id&quot;: &quot;2&quot;,
    &quot;task_id&quot;: 11,
    &quot;node_id&quot;: &quot;ndfbcbdc77e9350ba18222dc4a0a435f&quot;,
    &quot;component_code&quot;: &quot;sleep_timer&quot;
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;result&quot;: true,
    &quot;data&quot;: {
        &quot;inputs&quot;: {
            &quot;bk_timing&quot;: &quot;123&quot;
        },
        &quot;outputs&quot;: [
            {
                &quot;name&quot;: &quot;执行结果&quot;,
                &quot;key&quot;: &quot;_result&quot;,
                &quot;value&quot;: &quot;&quot;,
                &quot;preset&quot;: true
            },
            {
                &quot;name&quot;: &quot;循环次数&quot;,
                &quot;key&quot;: &quot;_loop&quot;,
                &quot;value&quot;: &quot;&quot;,
                &quot;preset&quot;: true
            }
        ],
        &quot;ex_data&quot;: &quot;&quot;
    },
    &quot;message&quot;: &quot;&quot;,
    &quot;code&quot;: 0
}</code></pre>


<h3 id="_9">返回结果说明</h3>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>true/false 成功与否</td>
</tr>
<tr>
<td>data</td>
<td>object</td>
<td>result=true 时返回数据，详情见下面说明</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>result=false 时错误信息</td>
</tr>
</tbody>
</table>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>inputs</td>
<td>object</td>
<td>输入参数，key：value 格式</td>
</tr>
<tr>
<td>outputs</td>
<td>array</td>
<td>输出参数，详情见下面说明</td>
</tr>
<tr>
<td>ex_data</td>
<td>string</td>
<td>节点执行失败详情，json 字符串或者 HTML 字符串、普通字符串</td>
</tr>
</tbody>
</table>
<h5 id="outputs">outputs[]</h5>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>string</td>
<td>输出参数名称</td>
</tr>
<tr>
<td>value</td>
<td>string、int、bool、dict、list</td>
<td>输出参数值</td>
</tr>
<tr>
<td>key</td>
<td>string</td>
<td>输出参数 KEY</td>
</tr>
<tr>
<td>preset</td>
<td>bool</td>
<td>是否是原子定义中预设输出变量</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/sops/get_task_node_detail/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>查询任务节点执行详情</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>string</td>
<td>是</td>
<td>所属业务 ID</td>
</tr>
<tr>
<td>task_id</td>
<td>string</td>
<td>是</td>
<td>任务 ID</td>
</tr>
<tr>
<td>node_id</td>
<td>string</td>
<td>是</td>
<td>节点 ID</td>
</tr>
<tr>
<td>component_code</td>
<td>string</td>
<td>否</td>
<td>标准插件编码，请求标准插件执行详情必填</td>
</tr>
<tr>
<td>subprocess_stack</td>
<td>string</td>
<td>否</td>
<td>子流程堆栈，json 格式的列表</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_biz_id&quot;: &quot;2&quot;,
    &quot;task_id&quot;: &quot;10&quot;,
    &quot;node_id&quot;: &quot;node0df0431f8f553925af01a94854bd&quot;
    &quot;subprocess_stack&quot;: &quot;[\&quot;nodeaaa0ce51d2143aa9b0dbc27cb7df\&quot;]&quot;,
    &quot;component_code&quot;: &quot;job_fast_execute_script&quot;,
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: {
        &quot;inputs&quot;: {
            &quot;job_account&quot;: &quot;root&quot;,
            &quot;job_script_timeout&quot;: &quot;&quot;,
            &quot;job_script_source&quot;: &quot;manual&quot;,
            &quot;job_script_list_public&quot;: &quot;&quot;,
            &quot;job_content&quot;: &quot;echo 0\nexit 0&quot;,
            &quot;job_script_type&quot;: &quot;1&quot;,
            &quot;job_script_param&quot;: &quot;&quot;,
            &quot;job_script_list_general&quot;: &quot;&quot;,
            &quot;job_ip_list&quot;: &quot;127.0.0.1&quot;
        },
        &quot;retry&quot;: 0,
        &quot;name&quot;: &quot;&lt;class &quot;pipeline.core.flow.activity.ServiceActivity&quot;&gt;&quot;,
        &quot;finish_time&quot;: &quot;2019-01-17 22:02:46 +0800&quot;,
        &quot;skip&quot;: false,
        &quot;start_time&quot;: &quot;2019-01-17 22:02:37 +0800&quot;,
        &quot;children&quot;: {},
        &quot;histories&quot;: [],
        &quot;ex_data&quot;: null,
        &quot;elapsed_time&quot;: 9,
        &quot;outputs&quot;: [
            {
                &quot;value&quot;: 407584,
                &quot;name&quot;: &quot;JOB任务ID&quot;,
                &quot;key&quot;: &quot;job_inst_id&quot;
            },
            {
                &quot;value&quot;: &quot;&quot;,
                &quot;name&quot;: &quot;JOB任务链接&quot;,
                &quot;key&quot;: &quot;job_inst_url&quot;
            },
            {
                &quot;value&quot;: true,
                &quot;name&quot;: &quot;执行结果&quot;,
                &quot;key&quot;: &quot;_result&quot;
            }
        ],
        &quot;state&quot;: &quot;FINISHED&quot;,
        &quot;version&quot;: &quot;23ac8c29f62b3337aafcf1f538d277f8&quot;,
        &quot;error_ignorable&quot;: false,
        &quot;id&quot;: &quot;node0df0431f8f553925af01a94854bd&quot;,
        &quot;loop&quot;: 1
    },
    &quot;result&quot;: true
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>true/false 查询成功与否</td>
</tr>
<tr>
<td>data</td>
<td>dict</td>
<td>result=true 时返回数据，详细信息见下面说明</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>result=false 时错误信息</td>
</tr>
</tbody>
</table>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>string</td>
<td>节点 ID</td>
</tr>
<tr>
<td>start_time</td>
<td>string</td>
<td>最后一次执行开始时间</td>
</tr>
<tr>
<td>finish_time</td>
<td>string</td>
<td>最后一次执行结束时间</td>
</tr>
<tr>
<td>elapsed_time</td>
<td>int</td>
<td>最后一次执行耗时，单位秒</td>
</tr>
<tr>
<td>state</td>
<td>string</td>
<td>最后一次执行状态，CREATED：未执行，RUNNING：执行中，FAILED：失败，NODE_SUSPENDED：暂停，FINISHED：成功</td>
</tr>
<tr>
<td>skip</td>
<td>bool</td>
<td>是否手动跳过</td>
</tr>
<tr>
<td>retry</td>
<td>int</td>
<td>重试次数</td>
</tr>
<tr>
<td>inputs</td>
<td>dict</td>
<td>输入参数，key：value 格式</td>
</tr>
<tr>
<td>outputs</td>
<td>list</td>
<td>输出参数，详情见下面说明</td>
</tr>
<tr>
<td>ex_data</td>
<td>string</td>
<td>节点执行失败详情，json 字符串或者 HTML 字符串、普通字符串</td>
</tr>
<tr>
<td>histories</td>
<td>list</td>
<td>重试记录详情，详情见下面说明</td>
</tr>
</tbody>
</table>
<h4 id="outputs">outputs[]</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>string</td>
<td>输出字段</td>
</tr>
<tr>
<td>value</td>
<td>string、int、bool、dict、list</td>
<td>输出参数值</td>
</tr>
<tr>
<td>key</td>
<td>string</td>
<td>输出参数 KEY</td>
</tr>
<tr>
<td>preset</td>
<td>bool</td>
<td>是否是标准插件定义中预设输出变量</td>
</tr>
</tbody>
</table>
<h4 id="histories">histories[]</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>start_time</td>
<td>string</td>
<td>执行开始时间</td>
</tr>
<tr>
<td>finish_time</td>
<td>string</td>
<td>执行结束时间</td>
</tr>
<tr>
<td>elapsed_time</td>
<td>int</td>
<td>执行耗时</td>
</tr>
<tr>
<td>state</td>
<td>string</td>
<td>执行状态，CREATED：未执行，RUNNING：执行中，FAILED：失败，NODE_SUSPENDED：暂停，FINISHED：成功</td>
</tr>
<tr>
<td>skip</td>
<td>bool</td>
<td>是否手动跳过</td>
</tr>
<tr>
<td>retry</td>
<td>int</td>
<td>重试次数</td>
</tr>
<tr>
<td>histories</td>
<td>list</td>
<td>重试记录详情，详情见下面说明</td>
</tr>
<tr>
<td>inputs</td>
<td>dict</td>
<td>输入参数，key：value 格式</td>
</tr>
<tr>
<td>outputs</td>
<td>dict</td>
<td>输出参数，key：value 格式</td>
</tr>
<tr>
<td>ex_data</td>
<td>string</td>
<td>节点执行失败详情，json 字符串或者 HTML 字符串、普通字符串</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/sops/get_task_status/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>查询任务或任务节点执行状态</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>string</td>
<td>是</td>
<td>模板所属业务 ID</td>
</tr>
<tr>
<td>task_id</td>
<td>string</td>
<td>是</td>
<td>任务或节点 ID</td>
</tr>
<tr>
<td>subprocess_id</td>
<td>string</td>
<td>否</td>
<td>任务中的子流程节点 ID</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_biz_id&quot;: &quot;2&quot;,
    &quot;task_id&quot;: &quot;10&quot;
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;result&quot;: true,
    &quot;data&quot;: {
        &quot;retry&quot;: 0,
        &quot;name&quot;: &quot;&lt;class 'pipeline.core.pipeline.Pipeline'&gt;&quot;,
        &quot;finish_time&quot;: &quot;&quot;,
        &quot;skip&quot;: false,
        &quot;start_time&quot;: &quot;2018-04-26 16:08:34 +0800&quot;,
        &quot;children&quot;: {
            &quot;62d4784e20483f1585149ce90ed954c9&quot;: {
                &quot;retry&quot;: 0,
                &quot;name&quot;: &quot;&lt;class 'pipeline.core.flow.event.EmptyStartEvent'&gt;&quot;,
                &quot;finish_time&quot;: &quot;2018-04-26 16:08:34 +0800&quot;,
                &quot;skip&quot;: false,
                &quot;start_time&quot;: &quot;2018-04-26 16:08:34 +0800&quot;,
                &quot;children&quot;: {},
                &quot;state&quot;: &quot;FINISHED&quot;,
                &quot;version&quot;: &quot;7447cc2801b630f497768493c02fb488&quot;,
                &quot;id&quot;: &quot;62d4784e20483f1585149ce90ed954c9&quot;,
                &quot;loop&quot;: 1
            },
            &quot;e8b128dff46637368b9b1bd921abc14e&quot;: {
                &quot;retry&quot;: 0,
                &quot;name&quot;: &quot;&lt;class 'pipeline.core.flow.activity.ServiceActivity'&gt;&quot;,
                &quot;finish_time&quot;: &quot;2018-04-26 16:08:46 +0800&quot;,
                &quot;skip&quot;: false,
                &quot;start_time&quot;: &quot;2018-04-26 16:08:34 +0800&quot;,
                &quot;children&quot;: {},
                &quot;state&quot;: &quot;FAILED&quot;,
                &quot;version&quot;: &quot;914d35fe7d143c2186e6d3532870b37d&quot;,
                &quot;id&quot;: &quot;e8b128dff46637368b9b1bd921abc14e&quot;,
                &quot;loop&quot;: 1
            }
        },
        &quot;state&quot;: &quot;FAILED&quot;,
        &quot;version&quot;: &quot;&quot;,
        &quot;id&quot;: &quot;5a1622f9f43e3429acb604e18dbd100a&quot;,
        &quot;loop&quot;: 1
    }
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>true/false 查询成功与否</td>
</tr>
<tr>
<td>data</td>
<td>dict</td>
<td>result=true 时返回数据，详细信息见下面说明</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>result=false 时错误信息</td>
</tr>
</tbody>
</table>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>state</td>
<td>string</td>
<td>任务或节点状态，详细信息见下面说明</td>
</tr>
<tr>
<td>id</td>
<td>string</td>
<td>任务或节点执行态 ID，不等于 task_id</td>
</tr>
<tr>
<td>skip</td>
<td>bool</td>
<td>是否跳过执行</td>
</tr>
<tr>
<td>retry</td>
<td>int</td>
<td>重试和跳过总次数</td>
</tr>
<tr>
<td>start_time</td>
<td>string</td>
<td>任务或节点执行开始时间</td>
</tr>
<tr>
<td>finish_time</td>
<td>string</td>
<td>任务或节点执行结束时间</td>
</tr>
<tr>
<td>children</td>
<td>dict</td>
<td>任务节点执行详情，详细信息见下面说明</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>节点名称</td>
</tr>
</tbody>
</table>
<h4 id="datastate">data.state</h4>
<table>
<thead>
<tr>
<th>返回值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>CREATED</td>
<td>未执行</td>
</tr>
<tr>
<td>RUNNING</td>
<td>执行中</td>
</tr>
<tr>
<td>FAILED</td>
<td>失败</td>
</tr>
<tr>
<td>SUSPENDED</td>
<td>暂停</td>
</tr>
<tr>
<td>REVOKED</td>
<td>已终止</td>
</tr>
<tr>
<td>FINISHED</td>
<td>已完成</td>
</tr>
</tbody>
</table>
<h4 id="datachildrenkey">data.children.KEY</h4>
<p>任务节点执行态 ID</p>
<h4 id="datachildrenvalue">data.children.VALUE</h4>
<p>同 data 格式</p><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/sops/get_tasks_status/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>批量查询任务执行状态</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>参数名称</th>
<th>参数类型</th>
<th>必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>app_code</td>
<td>string</td>
<td>是</td>
<td>蓝鲸应用编码</td>
</tr>
<tr>
<td>app_secret</td>
<td>string</td>
<td>是</td>
<td>蓝鲸应用私密 key</td>
</tr>
<tr>
<td>access_token</td>
<td>string</td>
<td>否</td>
<td>用户登录票据，bk_token 为空时必填</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>用户登录票据，access_token 为空时必填</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>string</td>
<td>是</td>
<td>模板所属业务 ID</td>
</tr>
<tr>
<td>task_id_list</td>
<td>array</td>
<td>是</td>
<td>任务 ID 列表</td>
</tr>
<tr>
<td>scope</td>
<td>string</td>
<td>否</td>
<td>唯一 ID 的范围，取值为 cmdb_biz 或 project，为 cmdb_biz 时 bk_biz_id 代表业务 ID，反之代表项目 ID，不传时默认为 cmdb_biz</td>
</tr>
<tr>
<td>include_children_status</td>
<td>bool</td>
<td>否</td>
<td>返回的结果中是否需要包含任务中节点的状态</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;result&quot;: true,
    &quot;data&quot;: [
        {
            &quot;id&quot;: 30000105,
            &quot;name&quot;: &quot;task test tree&quot;,
            &quot;status&quot;: {
                &quot;id&quot;: &quot;n580c9bf42a93bfc9a6cfe309bb3b418&quot;,
                &quot;state&quot;: &quot;FINISHED&quot;,
                &quot;name&quot;: &quot;&lt;class 'pipeline.core.pipeline.Pipeline'&gt;&quot;,
                &quot;retry&quot;: 0,
                &quot;loop&quot;: 1,
                &quot;skip&quot;: false,
                &quot;error_ignorable&quot;: false,
                &quot;version&quot;: &quot;&quot;,
                &quot;elapsed_time&quot;: 41,
                &quot;start_time&quot;: &quot;2020-03-18 17:22:05 +0800&quot;,
                &quot;finish_time&quot;: &quot;2020-03-18 17:22:46 +0800&quot;
            },
            &quot;create_time&quot;: &quot;2020-03-18 17:21:24 +0800&quot;,
            &quot;start_time&quot;: &quot;2020-03-18 17:22:04 +0800&quot;,
            &quot;finish_time&quot;: &quot;2020-03-18 17:22:46 +0800&quot;,
            &quot;url&quot;: &quot;url&quot;
        },
        {
            &quot;id&quot;: 30000101,
            &quot;name&quot;: &quot;task test1111&quot;,
            &quot;status&quot;: {
                &quot;id&quot;: &quot;nd68a418afd23d64a6f0e69338130787&quot;,
                &quot;state&quot;: &quot;FAILED&quot;,
                &quot;name&quot;: &quot;&lt;class 'pipeline.core.pipeline.Pipeline'&gt;&quot;,
                &quot;retry&quot;: 0,
                &quot;loop&quot;: 1,
                &quot;skip&quot;: false,
                &quot;error_ignorable&quot;: false,
                &quot;version&quot;: &quot;&quot;,
                &quot;elapsed_time&quot;: 1375959,
                &quot;start_time&quot;: &quot;2020-03-18 17:15:34 +0800&quot;,
                &quot;finish_time&quot;: &quot;&quot;
            },
            &quot;create_time&quot;: &quot;2020-03-18 17:14:44 +0800&quot;,
            &quot;start_time&quot;: &quot;2020-03-18 17:15:33 +0800&quot;,
            &quot;finish_time&quot;: &quot;&quot;,
            &quot;url&quot;: &quot;url&quot;
        },
        {
            &quot;id&quot;: 30000100,
            &quot;name&quot;: &quot;task_name&quot;,
            &quot;status&quot;: {
                &quot;id&quot;: &quot;nd14eca299643b958761e7a3e5e4b7de&quot;,
                &quot;state&quot;: &quot;RUNNING&quot;,
                &quot;name&quot;: &quot;&lt;class 'pipeline.core.pipeline.Pipeline'&gt;&quot;,
                &quot;retry&quot;: 0,
                &quot;loop&quot;: 1,
                &quot;skip&quot;: false,
                &quot;error_ignorable&quot;: false,
                &quot;version&quot;: &quot;&quot;,
                &quot;elapsed_time&quot;: 1381417,
                &quot;start_time&quot;: &quot;2020-03-18 15:44:36 +0800&quot;,
                &quot;finish_time&quot;: &quot;&quot;
            },
            &quot;create_time&quot;: &quot;2020-03-18 15:44:31 +0800&quot;,
            &quot;start_time&quot;: &quot;2020-03-18 15:44:35 +0800&quot;,
            &quot;finish_time&quot;: &quot;&quot;,
            &quot;url&quot;: &quot;url&quot;
        }
    ],
    &quot;code&quot;: 0
}</code></pre>


<h3 id="_8">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>true/false 查询成功与否</td>
</tr>
<tr>
<td>data</td>
<td>dict</td>
<td>result=true 时返回数据，详细信息见下面说明</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>result=false 时错误信息</td>
</tr>
</tbody>
</table>
<h4 id="data">data 说明</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>string</td>
<td>任务 ID</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>任务名</td>
</tr>
<tr>
<td>status</td>
<td>dict</td>
<td>状态详情</td>
</tr>
<tr>
<td>create_time</td>
<td>string</td>
<td>任务创建时间</td>
</tr>
<tr>
<td>start_time</td>
<td>string</td>
<td>任务开始时间</td>
</tr>
<tr>
<td>finish_time</td>
<td>string</td>
<td>任务完成时间</td>
</tr>
<tr>
<td>children</td>
<td>dict</td>
<td>任务节点执行详情，详细信息见下面说明</td>
</tr>
</tbody>
</table>
<h4 id="datastatus">data.status 说明</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>string</td>
<td>节点 ID</td>
</tr>
<tr>
<td>state</td>
<td>string</td>
<td>执行状态，CREATED：未执行，RUNNING：执行中，FAILED：失败，NODE_SUSPENDED：暂停，FINISHED：成功</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>节点名</td>
</tr>
<tr>
<td>retry</td>
<td>int</td>
<td>重试次数</td>
</tr>
<tr>
<td>loop</td>
<td>int</td>
<td>循环次数</td>
</tr>
<tr>
<td>skip</td>
<td>bool</td>
<td>是否跳过</td>
</tr>
<tr>
<td>error_ignorable</td>
<td>bool</td>
<td>是否忽略错误</td>
</tr>
<tr>
<td>version</td>
<td>string</td>
<td>节点版本</td>
</tr>
<tr>
<td>elapsed_time</td>
<td>int</td>
<td>节点耗时(秒)</td>
</tr>
<tr>
<td>start_time</td>
<td>string</td>
<td>节点开始时间</td>
</tr>
<tr>
<td>finish_time</td>
<td>string</td>
<td>节点完成时间</td>
</tr>
</tbody>
</table>
<h4 id="datachildren-key">data.children KEY</h4>
<p>任务节点 执行态 ID</p>
<h4 id="datachildren-value">data.children VALUE</h4>
<p>同 status 格式</p><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/sops/get_template_info/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>查询业务下的单个模板详情</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>string</td>
<td>是</td>
<td>模板所属业务 ID</td>
</tr>
<tr>
<td>template_id</td>
<td>string</td>
<td>是</td>
<td>模板 ID</td>
</tr>
<tr>
<td>template_source</td>
<td>string</td>
<td>否</td>
<td>流程模板来源，business:默认值，业务流程，common：公共流程</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_biz_id&quot;: &quot;1&quot;,
    &quot;template_id&quot;: &quot;30&quot;,
    &quot;template_source&quot;: &quot;business&quot;,
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;result&quot;: true,
    &quot;data&quot;: {
        &quot;category&quot;: &quot;Other&quot;,
        &quot;edit_time&quot;: &quot;2018-04-27 16:24:24 +0800&quot;,
        &quot;create_time&quot;: &quot;2018-04-16 21:43:15 +0800&quot;,
        &quot;name&quot;: &quot;new20180416213944&quot;,
        &quot;bk_biz_id&quot;: &quot;2&quot;,
        &quot;creator&quot;: &quot;admin&quot;,
        &quot;pipeline_tree&quot;: {
            &quot;activities&quot;: {
                &quot;631b6576cc5dfbdcaa4f510ce88a7e67&quot;: {
                    &quot;outgoing&quot;: &quot;44ab36ebf4cf119edaf2d20401da87e4&quot;,
                    &quot;incoming&quot;: &quot;fb2f3a8b533ca5c67e2440b4164f7632&quot;,
                    &quot;name&quot;: &quot;节点_1&quot;,
                    &quot;error_ignorable&quot;: false,
                    &quot;component&quot;: {
                        &quot;code&quot;: &quot;job_fast_execute_script&quot;,
                        &quot;data&quot;: {
                            &quot;account&quot;: {
                                &quot;hook&quot;: false,
                                &quot;value&quot;: &quot;root&quot;
                            },
                            &quot;ip_list&quot;: {
                                &quot;hook&quot;: false,
                                &quot;value&quot;: &quot;127.0.0.1&quot;
                            },
                            &quot;script_timeout&quot;: {
                                &quot;hook&quot;: true,
                                &quot;value&quot;: &quot;${script_timeout}&quot;
                            },
                            &quot;content&quot;: {
                                &quot;hook&quot;: false,
                                &quot;value&quot;: &quot;${content}&quot;
                            },
                            &quot;script_param&quot;: {
                                &quot;hook&quot;: false,
                                &quot;value&quot;: &quot;${params}&quot;
                            },
                            &quot;script_type&quot;: {
                                &quot;hook&quot;: true,
                                &quot;value&quot;: &quot;${script_type}&quot;
                            }
                        }
                    },
                    &quot;optional&quot;: false,
                    &quot;type&quot;: &quot;ServiceActivity&quot;,
                    &quot;id&quot;: &quot;631b6576cc5dfbdcaa4f510ce88a7e67&quot;,
                    &quot;loop&quot;: null
                }
            },
            &quot;end_event&quot;: {
                &quot;type&quot;: &quot;EmptyEndEvent&quot;,
                &quot;outgoing&quot;: &quot;&quot;,
                &quot;incoming&quot;: &quot;44ab36ebf4cf119edaf2d20401da87e4&quot;,
                &quot;id&quot;: &quot;60c81e383d048d8a3c574d3436e1b82c&quot;,
                &quot;name&quot;: &quot;&quot;
            },
            &quot;outputs&quot;: [],
            &quot;flows&quot;: {
                &quot;fb2f3a8b533ca5c67e2440b4164f7632&quot;: {
                    &quot;is_default&quot;: false,
                    &quot;source&quot;: &quot;48afea1016ab70ee37179fa0eb1e1a14&quot;,
                    &quot;id&quot;: &quot;fb2f3a8b533ca5c67e2440b4164f7632&quot;,
                    &quot;target&quot;: &quot;631b6576cc5dfbdcaa4f510ce88a7e67&quot;
                },
                &quot;44ab36ebf4cf119edaf2d20401da87e4&quot;: {
                    &quot;is_default&quot;: false,
                    &quot;source&quot;: &quot;631b6576cc5dfbdcaa4f510ce88a7e67&quot;,
                    &quot;id&quot;: &quot;44ab36ebf4cf119edaf2d20401da87e4&quot;,
                    &quot;target&quot;: &quot;60c81e383d048d8a3c574d3436e1b82c&quot;
                }
            },
            &quot;start_event&quot;: {
                &quot;type&quot;: &quot;EmptyStartEvent&quot;,
                &quot;outgoing&quot;: &quot;fb2f3a8b533ca5c67e2440b4164f7632&quot;,
                &quot;incoming&quot;: &quot;&quot;,
                &quot;id&quot;: &quot;48afea1016ab70ee37179fa0eb1e1a14&quot;,
                &quot;name&quot;: &quot;&quot;
            },
            &quot;constants&quot;: {
                &quot;${script_type}&quot;: {
                    &quot;source_tag&quot;: &quot;job_fast_execute_script.script_type&quot;,
                    &quot;source_info&quot;: {
                        &quot;631b6576cc5dfbdcaa4f510ce88a7e67&quot;: [
                            &quot;script_type&quot;
                        ]
                    },
                    &quot;name&quot;: &quot;脚本类型&quot;,
                    &quot;index&quot;: 0,
                    &quot;custom_type&quot;: &quot;radio&quot;,
                    &quot;value&quot;: &quot;4&quot;,
                    &quot;show_type&quot;: &quot;show&quot;,
                    &quot;source_type&quot;: &quot;component_inputs&quot;,
                    &quot;key&quot;: &quot;${script_type}&quot;,
                    &quot;validation&quot;: &quot;^.*$&quot;,
                    &quot;desc&quot;: &quot;&quot;
                },
                &quot;${content}&quot;: {
                    &quot;source_tag&quot;: &quot;&quot;,
                    &quot;source_info&quot;: {},
                    &quot;name&quot;: &quot;内容&quot;,
                    &quot;index&quot;: 2,
                    &quot;custom_type&quot;: &quot;textarea&quot;,
                    &quot;value&quot;: &quot;&quot;,
                    &quot;show_type&quot;: &quot;show&quot;,
                    &quot;source_type&quot;: &quot;custom&quot;,
                    &quot;key&quot;: &quot;${content}&quot;,
                    &quot;desc&quot;: &quot;&quot;
                },
                &quot;${script_timeout}&quot;: {
                    &quot;source_tag&quot;: &quot;job_fast_execute_script.script_timeout&quot;,
                    &quot;source_info&quot;: {
                        &quot;631b6576cc5dfbdcaa4f510ce88a7e67&quot;: [
                            &quot;script_timeout&quot;
                        ]
                    },
                    &quot;name&quot;: &quot;超时时间&quot;,
                    &quot;index&quot;: 1,
                    &quot;custom_type&quot;: &quot;input&quot;,
                    &quot;value&quot;: &quot;&quot;,
                    &quot;show_type&quot;: &quot;show&quot;,
                    &quot;source_type&quot;: &quot;component_inputs&quot;,
                    &quot;key&quot;: &quot;${script_timeout}&quot;,
                    &quot;validation&quot;: &quot;^.*$&quot;,
                    &quot;desc&quot;: &quot;&quot;
                },
                &quot;${params}&quot;: {
                    &quot;source_tag&quot;: &quot;&quot;,
                    &quot;source_info&quot;: {},
                    &quot;name&quot;: &quot;参数&quot;,
                    &quot;index&quot;: 3,
                    &quot;custom_type&quot;: &quot;input&quot;,
                    &quot;value&quot;: &quot;&quot;,
                    &quot;show_type&quot;: &quot;show&quot;,
                    &quot;source_type&quot;: &quot;custom&quot;,
                    &quot;key&quot;: &quot;${params}&quot;,
                    &quot;desc&quot;: &quot;&quot;
                }
            },
            &quot;gateways&quot;: {}
        },
        &quot;bk_biz_name&quot;: &quot;蓝鲸&quot;,
        &quot;id&quot;: 30,
        &quot;editor&quot;: &quot;admin&quot;
    },
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>true/false 查询成功与否</td>
</tr>
<tr>
<td>data</td>
<td>dict</td>
<td>result=true 时模板详情，详细信息见下面说明</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>result=false 时错误信息</td>
</tr>
</tbody>
</table>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>string</td>
<td>模板所属业务 ID</td>
</tr>
<tr>
<td>bk_biz_name</td>
<td>string</td>
<td>模板所属业务名称</td>
</tr>
<tr>
<td>id</td>
<td>int</td>
<td>模板 ID</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>模板名称</td>
</tr>
<tr>
<td>category</td>
<td>string</td>
<td>模板分类，分类信息见下面说明</td>
</tr>
<tr>
<td>creator</td>
<td>string</td>
<td>模板创建人</td>
</tr>
<tr>
<td>create_time</td>
<td>string</td>
<td>模板创建时间</td>
</tr>
<tr>
<td>editor</td>
<td>string 或者 null</td>
<td>模板编辑人</td>
</tr>
<tr>
<td>edit_time</td>
<td>string</td>
<td>模板最新编辑时间</td>
</tr>
<tr>
<td>pipeline_tree</td>
<td>dict</td>
<td>模板任务树信息，详细信息见下面说明</td>
</tr>
</tbody>
</table>
<h4 id="datacategory">data.category</h4>
<table>
<thead>
<tr>
<th>返回值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>OpsTools</td>
<td>运维工具</td>
</tr>
<tr>
<td>MonitorAlarm</td>
<td>监控告警</td>
</tr>
<tr>
<td>ConfManage</td>
<td>配置管理</td>
</tr>
<tr>
<td>DevTools</td>
<td>开发工具</td>
</tr>
<tr>
<td>EnterpriseIT</td>
<td>企业 IT</td>
</tr>
<tr>
<td>OfficeApp</td>
<td>办公应用</td>
</tr>
<tr>
<td>Other</td>
<td>其它</td>
</tr>
</tbody>
</table>
<h4 id="datapipeline_tree">data.pipeline_tree</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>start_event</td>
<td>dict</td>
<td>开始节点信息</td>
</tr>
<tr>
<td>end_event</td>
<td>dict</td>
<td>结束节点信息</td>
</tr>
<tr>
<td>activities</td>
<td>dict</td>
<td>任务节点（原子和子流程）信息</td>
</tr>
<tr>
<td>gateways</td>
<td>dict</td>
<td>网关节点（并行网关、分支网关和汇聚网关）信息</td>
</tr>
<tr>
<td>flows</td>
<td>dict</td>
<td>顺序流（节点连线）信息</td>
</tr>
<tr>
<td>constants</td>
<td>dict</td>
<td>全局变量信息，详情见下面</td>
</tr>
<tr>
<td>outputs</td>
<td>list</td>
<td>模板输出信息，标记 constants 中的输出字段</td>
</tr>
</tbody>
</table>
<h4 id="datapipeline_treeconstantskey">data.pipeline_tree.constants.KEY</h4>
<p>全局变量 KEY，${key} 格式</p>
<h4 id="datapipeline_treeconstantsvalue">data.pipeline_tree.constants.VALUE</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>key</td>
<td>string</td>
<td>同 KEY</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>变量名字</td>
</tr>
<tr>
<td>index</td>
<td>int</td>
<td>变量在模板中的显示顺序</td>
</tr>
<tr>
<td>desc</td>
<td>string</td>
<td>变量说明</td>
</tr>
<tr>
<td>source_type</td>
<td>string</td>
<td>变量来源, 取值范围 custom: 自定义变量，component_inputs: 从原子输入参数勾选，component_outputs：从原子输出结果中勾选</td>
</tr>
<tr>
<td>custom_type</td>
<td>string</td>
<td>source_type=custom 时有效，自定义变量类型， 取值范围 input: 输入框，textarea: 文本框，datetime: 日期时间，int: 整数</td>
</tr>
<tr>
<td>source_tag</td>
<td>string</td>
<td>source_type=component_inputs 或 component_outputs 时有效，变量的来源原子</td>
</tr>
<tr>
<td>source_info</td>
<td>dict</td>
<td>source_type=component_inputs 或 component_outputs 时有效，变量的来源节点信息</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/sops/get_template_list/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>查询业务下的模板列表</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>string</td>
<td>是</td>
<td>模板所属业务 ID</td>
</tr>
<tr>
<td>template_source</td>
<td>string</td>
<td>否</td>
<td>流程模板来源，business:默认值，业务流程，common：公共流程</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_biz_id&quot;: &quot;2&quot;,
    &quot;template_source&quot;: &quot;business&quot;,
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;result&quot;: true,
    &quot;data&quot;: [
        {
            &quot;category&quot;: &quot;Other&quot;,
            &quot;edit_time&quot;: &quot;2018-04-23 17:30:48 +0800&quot;,
            &quot;create_time&quot;: &quot;2018-04-23 17:26:40 +0800&quot;,
            &quot;name&quot;: &quot;快速执行脚本&quot;,
            &quot;bk_biz_id&quot;: &quot;2&quot;,
            &quot;creator&quot;: &quot;admin&quot;,
            &quot;bk_biz_name&quot;: &quot;蓝鲸&quot;,
            &quot;id&quot;: 32,
            &quot;editor&quot;: &quot;admin&quot;
        },
        {
            &quot;category&quot;: &quot;Other&quot;,
            &quot;edit_time&quot;: &quot;2018-04-19 12:04:42 +0800&quot;,
            &quot;create_time&quot;: &quot;2018-04-19 12:04:42 +0800&quot;,
            &quot;name&quot;: &quot;new201804191218&quot;,
            &quot;bk_biz_id&quot;: &quot;2&quot;,
            &quot;creator&quot;: &quot;admin&quot;,
            &quot;bk_biz_name&quot;: &quot;蓝鲸&quot;,
            &quot;id&quot;: 31,
            &quot;editor&quot;: null
        },
        {
            &quot;category&quot;: &quot;Other&quot;,
            &quot;edit_time&quot;: &quot;2018-04-18 17:09:39 +0800&quot;,
            &quot;create_time&quot;: &quot;2018-04-16 21:43:15 +0800&quot;,
            &quot;name&quot;: &quot;new20180416213944&quot;,
            &quot;bk_biz_id&quot;: &quot;2&quot;,
            &quot;creator&quot;: &quot;admin&quot;,
            &quot;bk_biz_name&quot;: &quot;蓝鲸&quot;,
            &quot;id&quot;: 30,
            &quot;editor&quot;: &quot;admin&quot;
        },
    ]
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>true/false 查询成功与否</td>
</tr>
<tr>
<td>data</td>
<td>list</td>
<td>result=true 时模板列表，item 信息见下面说明</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>result=false 时错误信息</td>
</tr>
</tbody>
</table>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>string</td>
<td>模板所属业务 ID</td>
</tr>
<tr>
<td>bk_biz_name</td>
<td>string</td>
<td>模板所属业务名称</td>
</tr>
<tr>
<td>id</td>
<td>int</td>
<td>模板 ID</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>模板名称</td>
</tr>
<tr>
<td>category</td>
<td>string</td>
<td>模板分类，分类信息见下面说明</td>
</tr>
<tr>
<td>creator</td>
<td>string</td>
<td>模板创建人</td>
</tr>
<tr>
<td>create_time</td>
<td>string</td>
<td>模板创建时间</td>
</tr>
<tr>
<td>editor</td>
<td>string 或者 null</td>
<td>模板编辑人</td>
</tr>
<tr>
<td>edit_time</td>
<td>string</td>
<td>模板最新编辑时间</td>
</tr>
</tbody>
</table>
<h4 id="datacategory">data.category</h4>
<table>
<thead>
<tr>
<th>返回值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>OpsTools</td>
<td>运维工具</td>
</tr>
<tr>
<td>MonitorAlarm</td>
<td>监控告警</td>
</tr>
<tr>
<td>ConfManage</td>
<td>配置管理</td>
</tr>
<tr>
<td>DevTools</td>
<td>开发工具</td>
</tr>
<tr>
<td>EnterpriseIT</td>
<td>企业 IT</td>
</tr>
<tr>
<td>OfficeApp</td>
<td>办公应用</td>
</tr>
<tr>
<td>Other</td>
<td>其它</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/sops/get_template_schemes/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>获取模板的执行方案列表</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>参数名称</th>
<th>参数类型</th>
<th>必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>app_code</td>
<td>string</td>
<td>是</td>
<td>蓝鲸应用编码</td>
</tr>
<tr>
<td>app_secret</td>
<td>string</td>
<td>是</td>
<td>蓝鲸应用私密 key</td>
</tr>
<tr>
<td>access_token</td>
<td>string</td>
<td>否</td>
<td>用户登录票据，bk_token 为空时必填</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>用户登录票据，access_token 为空时必填</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>string</td>
<td>是</td>
<td>项目唯一 ID，项目 ID 或 CMDB 业务 ID</td>
</tr>
<tr>
<td>template_id</td>
<td>int</td>
<td>是</td>
<td>模板 ID</td>
</tr>
<tr>
<td>scope</td>
<td>string</td>
<td>否</td>
<td>唯一 ID 的范围，取值为 cmdb_biz 或 project，为 cmdb_biz 时 bk_biz_id 代表业务 ID，反之代表项目 ID，不传时默认为 cmdb_biz</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_biz_id&quot;: &quot;2&quot;,
    &quot;template_id&quot;: &quot;12&quot;
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;result&quot;: true,
    &quot;data&quot;: [
        {
            &quot;id&quot;: &quot;47-1&quot;,
            &quot;name&quot;: &quot;1&quot;,
            &quot;data&quot;: &quot;[\&quot;node7082deed0725aed8c72ecff079ba\&quot;,\&quot;node88d9050f288765b94a15cbe023ab\&quot;]&quot;
        },
        {
            &quot;id&quot;: &quot;47-2&quot;,
            &quot;name&quot;: &quot;2&quot;,
            &quot;data&quot;: &quot;[\&quot;node7082deed0725aed8c72ecff079ba\&quot;]&quot;
        },
        {
            &quot;id&quot;: &quot;47-3&quot;,
            &quot;name&quot;: &quot;3&quot;,
            &quot;data&quot;: &quot;[\&quot;node88d9050f288765b94a15cbe023ab\&quot;]&quot;
        }
    ],
    &quot;code&quot;: 0
}</code></pre>


<h3 id="_9">返回结果说明</h3>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>true/false 成功与否</td>
</tr>
<tr>
<td>data</td>
<td>dict</td>
<td>result=true 时返回数据，详情见下面说明</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>result=false 时错误信息</td>
</tr>
</tbody>
</table>
<h4 id="data">data 说明</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>string</td>
<td>执行方案 ID</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>执行方案名</td>
</tr>
<tr>
<td>data</td>
<td>string</td>
<td>执行方案中包含的节点 ID 列表</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/sops/get_user_project_detail/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>获取项目的详情</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>参数名称</th>
<th>参数类型</th>
<th>必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>app_code</td>
<td>string</td>
<td>是</td>
<td>蓝鲸应用编码</td>
</tr>
<tr>
<td>app_secret</td>
<td>string</td>
<td>是</td>
<td>蓝鲸应用私密 key</td>
</tr>
<tr>
<td>access_token</td>
<td>string</td>
<td>否</td>
<td>用户登录票据，bk_token 为空时必填</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>用户登录票据，access_token 为空时必填</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>string</td>
<td>是</td>
<td>项目唯一 ID，项目 ID 或 CMDB 业务 ID</td>
</tr>
<tr>
<td>scope</td>
<td>string</td>
<td>否</td>
<td>唯一 ID 的范围，取值为 cmdb_biz 或 project，为 cmdb_biz 时 bk_biz_id 代表业务 ID，反之代表项目 ID，不传时默认为 cmdb_biz</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_biz_id&quot;: &quot;2&quot;
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;result&quot;: true,
    &quot;data&quot;: {
        &quot;project_id&quot;: 13,
        &quot;project_name&quot;: &quot;蓝鲸&quot;,
        &quot;bk_biz_id&quot;: 2,
        &quot;from_cmdb&quot;: true,
        &quot;bk_biz_name&quot;: &quot;蓝鲸&quot;,
        &quot;bk_biz_developer&quot;: &quot;&quot;,
        &quot;bk_biz_maintainer&quot;: &quot;admin,gcloudadmin&quot;,
        &quot;bk_biz_tester&quot;: &quot;&quot;,
        &quot;bk_biz_productor&quot;: &quot;&quot;
    },
    &quot;code&quot;: 0
}</code></pre>


<h3 id="_9">返回结果说明</h3>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>true/false 成功与否</td>
</tr>
<tr>
<td>data</td>
<td>dict</td>
<td>result=true 时返回数据，详情见下面说明</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>result=false 时错误信息</td>
</tr>
</tbody>
</table>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>project_id</td>
<td>int</td>
<td>项目 ID</td>
</tr>
<tr>
<td>project_name</td>
<td>string</td>
<td>项目名</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>绑定的 CMDB 业务 ID</td>
</tr>
<tr>
<td>from_cmdb</td>
<td>bool</td>
<td>该项目是否是从 CMDB 业务同步的</td>
</tr>
<tr>
<td>bk_biz_name</td>
<td>string</td>
<td>项目名</td>
</tr>
<tr>
<td>bk_biz_developer</td>
<td>string</td>
<td>业务开发人员列表</td>
</tr>
<tr>
<td>bk_biz_maintainer</td>
<td>string</td>
<td>业务运维人员列表</td>
</tr>
<tr>
<td>bk_biz_tester</td>
<td>string</td>
<td>业务测试人员列表</td>
</tr>
<tr>
<td>bk_biz_productor</td>
<td>string</td>
<td>业务产品人员列表</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/sops/get_user_project_list/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>查询用户有权限的项目列表</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>参数名称</th>
<th>参数类型</th>
<th>必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>app_code</td>
<td>string</td>
<td>是</td>
<td>蓝鲸应用编码</td>
</tr>
<tr>
<td>app_secret</td>
<td>string</td>
<td>是</td>
<td>蓝鲸应用私密 key</td>
</tr>
<tr>
<td>access_token</td>
<td>string</td>
<td>否</td>
<td>用户登录票据，bk_token 为空时必填</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>用户登录票据，access_token 为空时必填</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;result&quot;: true,
    &quot;data&quot;: [
        {
            &quot;project_id&quot;: 13,
            &quot;bk_biz_id&quot;: 2,
            &quot;name&quot;: &quot;蓝鲸&quot;
        },
        {
            &quot;project_id&quot;: 14,
            &quot;bk_biz_id&quot;: 3,
            &quot;name&quot;: &quot;la&quot;
        }
    ],
    &quot;code&quot;: 0
}</code></pre>


<h3 id="_9">返回结果说明</h3>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>true/false 成功与否</td>
</tr>
<tr>
<td>data</td>
<td>dict</td>
<td>result=true 时返回数据，详情见下面说明</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>result=false 时错误信息</td>
</tr>
</tbody>
</table>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>project_id</td>
<td>int</td>
<td>项目 ID</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>绑定的 CMDB 业务 ID</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>项目名</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/sops/import_common_template/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>导入公共流程</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>参数类型</th>
<th>必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>template_data</td>
<td>string</td>
<td>是</td>
<td>公共流程数据，即从标准运维 - 公共流程 - 导出功能下载的文件的内容</td>
</tr>
<tr>
<td>override</td>
<td>bool</td>
<td>否</td>
<td>是否覆盖 ID 相同的流程</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;template_data&quot;: &quot;xxx&quot;,
    &quot;override&quot;: true,
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;message&quot;: &quot;Successfully imported 2 common flows&quot;,
    &quot;data&quot;: {
        &quot;count&quot;: 2
    },
    &quot;result&quot;: true
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>true/false 成功与否</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>result=false 时错误信息</td>
</tr>
<tr>
<td>data</td>
<td>dict</td>
<td>返回数据</td>
</tr>
</tbody>
</table>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>count</td>
<td>int</td>
<td>导入的流程数</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/sops/import_project_template/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>导入项目流程</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>参数类型</th>
<th>必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>template_data</td>
<td>string</td>
<td>是</td>
<td>项目流程数据，即从标准运维 - 项目流程 - 导出功能下载的文件的内容</td>
</tr>
<tr>
<td>project_id</td>
<td>string</td>
<td>是</td>
<td>项目 ID</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;template_data&quot;: &quot;xxx&quot;,
    &quot;project_id&quot;: &quot;3,
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;message&quot;: &quot;Successfully imported 2 flows&quot;,
    &quot;data&quot;: {
        &quot;count&quot;: 2
    },
    &quot;result&quot;: true
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>true/false 成功与否</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>result=false 时错误信息</td>
</tr>
<tr>
<td>data</td>
<td>dict</td>
<td>返回数据</td>
</tr>
</tbody>
</table>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>count</td>
<td>int</td>
<td>导入的流程数</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/sops/modify_constants_for_periodic_task/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>修改周期任务的全局参数</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>task_id</td>
<td>string</td>
<td>是</td>
<td>周期任务 ID</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>string</td>
<td>是</td>
<td>模板所属业务 ID</td>
</tr>
<tr>
<td>constants</td>
<td>dict</td>
<td>否</td>
<td>任务全局参数，详细信息见下面说明</td>
</tr>
</tbody>
</table>
<h4 id="constantskey">constants.KEY</h4>
<p>变量 KEY，${key} 格式</p>
<h4 id="constantsvalue">constants.VALUE</h4>
<p>变量值</p>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_biz_id&quot;: &quot;2&quot;,
    &quot;task_id&quot;: &quot;8&quot;,
    &quot;constants&quot;: {&quot;${bk_timing}&quot;: &quot;100&quot;},
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;data&quot;: {
        &quot;${bk_timing}&quot;: {
            &quot;source_tag&quot;: &quot;sleep_timer.bk_timing&quot;,
            &quot;source_info&quot;: {
                &quot;node76393dcfedcf73dbc726f1c4786d&quot;: [
                    &quot;bk_timing&quot;
                ]
            },
            &quot;name&quot;: &quot;定时时间&quot;,
            &quot;custom_type&quot;: &quot;&quot;,
            &quot;index&quot;: 0,
            &quot;value&quot;: &quot;15&quot;,
            &quot;show_type&quot;: &quot;show&quot;,
            &quot;source_type&quot;: &quot;component_inputs&quot;,
            &quot;key&quot;: &quot;${bk_timing}&quot;,
            &quot;validation&quot;: &quot;&quot;,
            &quot;desc&quot;: &quot;&quot;
        }
    },
    &quot;result&quot;: true
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>true/false 操作是否成功</td>
</tr>
<tr>
<td>data</td>
<td>dict</td>
<td>result=true 时成功数据，详细信息请见下面说明</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>result=false 时错误信息</td>
</tr>
</tbody>
</table>
<h4 id="datakey">data.KEY</h4>
<p>全局变量 KEY，${key} 格式</p>
<h4 id="datavalue">data.VALUE</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>key</td>
<td>string</td>
<td>同 KEY</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>变量名字</td>
</tr>
<tr>
<td>index</td>
<td>int</td>
<td>变量在模板中的显示顺序</td>
</tr>
<tr>
<td>desc</td>
<td>string</td>
<td>变量说明</td>
</tr>
<tr>
<td>source_type</td>
<td>string</td>
<td>变量来源, 取值范围 custom: 自定义变量，component_inputs: 从原子输入参数勾选，component_outputs：从原子输出结果中勾选</td>
</tr>
<tr>
<td>custom_type</td>
<td>string</td>
<td>source_type=custom 时有效，自定义变量类型， 取值范围 input: 输入框，textarea: 文本框，datetime: 日期时间，int: 整数</td>
</tr>
<tr>
<td>source_tag</td>
<td>string</td>
<td>source_type=component_inputs/component_outputs 时有效，变量的来源原子</td>
</tr>
<tr>
<td>source_info</td>
<td>dict</td>
<td>source_type=component_inputs/component_outputs 时有效，变量的来源节点信息</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/sops/modify_constants_for_task/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>修改任务名称和变量</p>
<h4 id="_4">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_5">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>task_id</td>
<td>string</td>
<td>是</td>
<td>任务 ID，需要任务状态是未开始的</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>string</td>
<td>是</td>
<td>模板所属业务 ID</td>
</tr>
<tr>
<td>constants</td>
<td>dict</td>
<td>是</td>
<td>任务全局参数，详细信息见下面说明</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>否</td>
<td>任务新名称</td>
</tr>
<tr>
<td>scope</td>
<td>string</td>
<td>否</td>
<td>bk_biz_id 检索的作用域。默认为 cmdb_biz，此时检索的是绑定的 CMDB 业务 ID 为 bk_biz_id 的项目；当值为 project 时则检索项目 ID 为 bk_biz_id 的项目</td>
</tr>
</tbody>
</table>
<h4 id="constants-key">constants KEY</h4>
<p>变量 KEY，${key} 格式</p>
<h4 id="constants-value">constants VALUE</h4>
<p>变量值</p>
<h3 id="_6">请求参数示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_biz_id&quot;: &quot;2&quot;,
    &quot;task_id&quot;: &quot;8&quot;,
    &quot;constants&quot;: {
        &quot;${bk_timing}&quot;: &quot;100&quot;
    }
}</code></pre>


<h3 id="_7">返回结果示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;data&quot;: &quot;success&quot;,
    &quot;result&quot;: true
}</code></pre>


<h3 id="_8">返回结果说明</h3>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>true/false 操作是否成功</td>
</tr>
<tr>
<td>data</td>
<td>string</td>
<td>result=true 时成功数据, "success"</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>result=false 时错误信息</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/sops/modify_cron_for_periodic_task/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>修改周期任务的调度策略</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>task_id</td>
<td>string</td>
<td>是</td>
<td>周期任务 ID</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>string</td>
<td>是</td>
<td>模板所属业务 ID</td>
</tr>
<tr>
<td>cron</td>
<td>dict</td>
<td>否</td>
<td>调度策略对象</td>
</tr>
</tbody>
</table>
<h4 id="cron">cron</h4>
<table>
<thead>
<tr>
<th>参数名称</th>
<th>参数类型</th>
<th>必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>minute</td>
<td>string</td>
<td>否</td>
<td>分，默认为 *</td>
</tr>
<tr>
<td>hour</td>
<td>string</td>
<td>否</td>
<td>时，默认为 *</td>
</tr>
<tr>
<td>day_of_week</td>
<td>string</td>
<td>否</td>
<td>一周内的某些天，默认为 *</td>
</tr>
<tr>
<td>day_of_month</td>
<td>string</td>
<td>否</td>
<td>一个月中的某些天，默认为 *</td>
</tr>
<tr>
<td>month_of_year</td>
<td>string</td>
<td>否</td>
<td>一年中的某些月份，默认为 *</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_biz_id&quot;: &quot;2&quot;,
    &quot;task_id&quot;: &quot;8&quot;,
    &quot;cron&quot; : {&quot;minute&quot;: &quot;*/1&quot;, &quot;hour&quot;: &quot;15&quot;, &quot;day_of_week&quot;:&quot;*&quot;, &quot;day_of_month&quot;:&quot;*&quot;, &quot;month_of_year&quot;:&quot;*&quot;},
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;data&quot;: {
        &quot;cron&quot;: &quot;*/1 15 * * * (m/h/d/dM/MY)&quot;
    },
    &quot;result&quot;: true
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>true/false 操作是否成功</td>
</tr>
<tr>
<td>data</td>
<td>dict</td>
<td>result=true 时成功数据，详细信息请见下面说明</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>result=false 时错误信息</td>
</tr>
</tbody>
</table>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>cron</td>
<td>string</td>
<td>调度策略表达式</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/sops/node_callback/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>回调指定的节点</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>参数类型</th>
<th>必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>string</td>
<td>是</td>
<td>所属业务 ID</td>
</tr>
<tr>
<td>task_id</td>
<td>string</td>
<td>是</td>
<td>任务 ID</td>
</tr>
<tr>
<td>node_id</td>
<td>string</td>
<td>是</td>
<td>节点 ID</td>
</tr>
<tr>
<td>callback_data</td>
<td>dict</td>
<td>否</td>
<td>回调数据</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;app_code&quot;: &quot;app_code&quot;,
    &quot;app_secret&quot;: &quot;app_secret&quot;,
    &quot;access_token&quot;: &quot;access_token&quot;,
    &quot;bk_biz_id&quot;: &quot;2&quot;,
    &quot;task_id&quot;: &quot;10&quot;,
    &quot;node_id&quot;: &quot;node0df0431f8f553925af01a94854bd&quot;,
    &quot;callback_data&quot;: {&quot;data&quot;: &quot;data&quot;}
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;message&quot;: &quot;success&quot;,
    &quot;result&quot;: true
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>true/false 成功与否</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>result=false 时错误信息</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/sops/operate_node/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>操作节点</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>参数名称</th>
<th>参数类型</th>
<th>必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>app_code</td>
<td>string</td>
<td>是</td>
<td>蓝鲸应用编码</td>
</tr>
<tr>
<td>app_secret</td>
<td>string</td>
<td>是</td>
<td>蓝鲸应用私密 key</td>
</tr>
<tr>
<td>access_token</td>
<td>string</td>
<td>否</td>
<td>用户登录票据，bk_token 为空时必填</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>用户登录票据，access_token 为空时必填</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>string</td>
<td>是</td>
<td>项目唯一 ID，项目 ID 或 CMDB 业务 ID</td>
</tr>
<tr>
<td>task_id</td>
<td>int</td>
<td>是</td>
<td>任务 ID</td>
</tr>
<tr>
<td>scope</td>
<td>string</td>
<td>否</td>
<td>唯一 ID 的范围，取值为 cmdb_biz 或 project，为 cmdb_biz 时 bk_biz_id 代表业务 ID，反之代表项目 ID，不传时默认为 cmdb_biz</td>
</tr>
<tr>
<td>node_id</td>
<td>string</td>
<td>是</td>
<td>节点 ID</td>
</tr>
<tr>
<td>action</td>
<td>string</td>
<td>是</td>
<td>操作类型，可选值有：callback（节点回调）, skip_exg（跳过执行失败的分支网关）, retry（重试失败节点）, skip（跳过失败的节点）, pause_subproc（暂停正在执行的子流程）, resume_subproc（继续暂停的子流程）</td>
</tr>
<tr>
<td>data</td>
<td>object</td>
<td>否</td>
<td>action 为 callback 时传入的数据</td>
</tr>
<tr>
<td>inputs</td>
<td>object</td>
<td>否</td>
<td>action 为 retry 时重试节点时节点的输入数据</td>
</tr>
<tr>
<td>flow_id</td>
<td>string</td>
<td>否</td>
<td>action 为 skip_exg 时选择执行的分支 id</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_biz_id&quot;: &quot;2&quot;,
    &quot;task_id&quot;: &quot;12&quot;,
    &quot;node_id&quot;: &quot;node_id&quot;,
    &quot;action&quot;: &quot;skip&quot;
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;result&quot;: true,
    &quot;data&quot;: &quot;success&quot;,
    &quot;code&quot;: 0
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>true/false 成功与否</td>
</tr>
<tr>
<td>data</td>
<td>string</td>
<td>result=true 时返回的信息</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>result=false 时错误信息</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/sops/operate_task/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>操作任务，如开始、暂停、继续、终止等</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>string</td>
<td>是</td>
<td>模板所属业务 ID</td>
</tr>
<tr>
<td>task_id</td>
<td>string</td>
<td>是</td>
<td>任务 ID</td>
</tr>
<tr>
<td>action</td>
<td>string</td>
<td>是</td>
<td>操作类型</td>
</tr>
</tbody>
</table>
<h4 id="action">action</h4>
<table>
<thead>
<tr>
<th>值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>start</td>
<td>开始任务，等效于调用 start_task 接口</td>
</tr>
<tr>
<td>pause</td>
<td>暂停任务，任务处于执行状态时调用</td>
</tr>
<tr>
<td>resume</td>
<td>继续任务，任务处于暂停状态时调用</td>
</tr>
<tr>
<td>revoke</td>
<td>终止任务</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;action&quot;: &quot;start&quot;,
    &quot;bk_biz_id&quot;: &quot;2&quot;,
    &quot;task_id&quot;: &quot;10&quot;
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;result&quot;: true,
    &quot;data&quot;: {}
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>true/false 操作是否成功</td>
</tr>
<tr>
<td>data</td>
<td>dict</td>
<td>result=true 时返回数据</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>result=false 时错误信息</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/sops/preview_task_tree/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>获取节点选择后新的任务树</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>参数名称</th>
<th>参数类型</th>
<th>必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>app_code</td>
<td>string</td>
<td>是</td>
<td>蓝鲸应用编码</td>
</tr>
<tr>
<td>app_secret</td>
<td>string</td>
<td>是</td>
<td>蓝鲸应用私密 key</td>
</tr>
<tr>
<td>access_token</td>
<td>string</td>
<td>否</td>
<td>用户登录票据，bk_token 为空时必填</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>用户登录票据，access_token 为空时必填</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>string</td>
<td>是</td>
<td>项目唯一 ID，项目 ID 或 CMDB 业务 ID</td>
</tr>
<tr>
<td>template_id</td>
<td>int</td>
<td>是</td>
<td>模板 ID</td>
</tr>
<tr>
<td>scope</td>
<td>string</td>
<td>否</td>
<td>唯一 ID 的范围，取值为 cmdb_biz 或 project，为 cmdb_biz 时 bk_biz_id 代表业务 ID，反之代表项目 ID，不传时默认为 cmdb_biz</td>
</tr>
<tr>
<td>version</td>
<td>string</td>
<td>否</td>
<td>模板的版本，不填时默认为最新版本</td>
</tr>
<tr>
<td>exclude_task_nodes_id</td>
<td>否</td>
<td>需要移除的可选节点 ID 列表，不填时默认为 []</td>
<td></td>
</tr>
<tr>
<td>### 请求参数示例</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<pre class="codehilite"><code class="language-bash">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_biz_id&quot;: &quot;2&quot;,
    &quot;template_id&quot;: &quot;12&quot;
}</code></pre>


<h3 id="_7">返回结果示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;result&quot;: true,
    &quot;data&quot;: {
        &quot;pipeline_tree&quot;: {
            &quot;activities&quot;: {
                &quot;node7082deed0725aed8c72ecff079ba&quot;: {
                    &quot;component&quot;: {
                        &quot;code&quot;: &quot;pause_node&quot;,
                        &quot;data&quot;: {},
                        &quot;version&quot;: &quot;legacy&quot;
                    },
                    &quot;error_ignorable&quot;: false,
                    &quot;id&quot;: &quot;node7082deed0725aed8c72ecff079ba&quot;,
                    &quot;incoming&quot;: [
                        &quot;lineda60368b01cd8828a72585115f88&quot;
                    ],
                    &quot;loop&quot;: null,
                    &quot;name&quot;: &quot;暂停&quot;,
                    &quot;optional&quot;: true,
                    &quot;outgoing&quot;: &quot;line4598d41ef39573f7d7493f934bd8&quot;,
                    &quot;stage_name&quot;: &quot;步骤1&quot;,
                    &quot;type&quot;: &quot;ServiceActivity&quot;,
                    &quot;retryable&quot;: true,
                    &quot;skippable&quot;: true
                },
                &quot;node88d9050f288765b94a15cbe023ab&quot;: {
                    &quot;component&quot;: {
                        &quot;code&quot;: &quot;pause_node&quot;,
                        &quot;data&quot;: {},
                        &quot;version&quot;: &quot;legacy&quot;
                    },
                    &quot;error_ignorable&quot;: false,
                    &quot;id&quot;: &quot;node88d9050f288765b94a15cbe023ab&quot;,
                    &quot;incoming&quot;: [
                        &quot;line4598d41ef39573f7d7493f934bd8&quot;
                    ],
                    &quot;loop&quot;: null,
                    &quot;name&quot;: &quot;暂停&quot;,
                    &quot;optional&quot;: true,
                    &quot;outgoing&quot;: &quot;line9c757e214b4f2ff64437653b8408&quot;,
                    &quot;stage_name&quot;: &quot;步骤1&quot;,
                    &quot;type&quot;: &quot;ServiceActivity&quot;,
                    &quot;retryable&quot;: true,
                    &quot;skippable&quot;: true
                }
            },
            &quot;constants&quot;: {},
            &quot;end_event&quot;: {
                &quot;id&quot;: &quot;node253645bb6f162119e55b7352d8b2&quot;,
                &quot;incoming&quot;: [
                    &quot;line9c757e214b4f2ff64437653b8408&quot;
                ],
                &quot;name&quot;: &quot;&quot;,
                &quot;outgoing&quot;: &quot;&quot;,
                &quot;type&quot;: &quot;EmptyEndEvent&quot;
            },
            &quot;flows&quot;: {
                &quot;lineda60368b01cd8828a72585115f88&quot;: {
                    &quot;id&quot;: &quot;lineda60368b01cd8828a72585115f88&quot;,
                    &quot;is_default&quot;: false,
                    &quot;source&quot;: &quot;nodeb9a3a2a32bb4cfe8761377b2270f&quot;,
                    &quot;target&quot;: &quot;node7082deed0725aed8c72ecff079ba&quot;
                },
                &quot;line4598d41ef39573f7d7493f934bd8&quot;: {
                    &quot;id&quot;: &quot;line4598d41ef39573f7d7493f934bd8&quot;,
                    &quot;is_default&quot;: false,
                    &quot;source&quot;: &quot;node7082deed0725aed8c72ecff079ba&quot;,
                    &quot;target&quot;: &quot;node88d9050f288765b94a15cbe023ab&quot;
                },
                &quot;line9c757e214b4f2ff64437653b8408&quot;: {
                    &quot;id&quot;: &quot;line9c757e214b4f2ff64437653b8408&quot;,
                    &quot;is_default&quot;: false,
                    &quot;source&quot;: &quot;node88d9050f288765b94a15cbe023ab&quot;,
                    &quot;target&quot;: &quot;node253645bb6f162119e55b7352d8b2&quot;
                }
            },
            &quot;gateways&quot;: {},
            &quot;line&quot;: [
                {
                    &quot;id&quot;: &quot;lineda60368b01cd8828a72585115f88&quot;,
                    &quot;source&quot;: {
                        &quot;arrow&quot;: &quot;Right&quot;,
                        &quot;id&quot;: &quot;nodeb9a3a2a32bb4cfe8761377b2270f&quot;
                    },
                    &quot;target&quot;: {
                        &quot;arrow&quot;: &quot;Left&quot;,
                        &quot;id&quot;: &quot;node7082deed0725aed8c72ecff079ba&quot;
                    }
                },
                {
                    &quot;source&quot;: {
                        &quot;arrow&quot;: &quot;Right&quot;,
                        &quot;id&quot;: &quot;node7082deed0725aed8c72ecff079ba&quot;
                    },
                    &quot;target&quot;: {
                        &quot;id&quot;: &quot;node88d9050f288765b94a15cbe023ab&quot;,
                        &quot;arrow&quot;: &quot;Left&quot;
                    },
                    &quot;id&quot;: &quot;line4598d41ef39573f7d7493f934bd8&quot;
                },
                {
                    &quot;source&quot;: {
                        &quot;arrow&quot;: &quot;Right&quot;,
                        &quot;id&quot;: &quot;node88d9050f288765b94a15cbe023ab&quot;
                    },
                    &quot;target&quot;: {
                        &quot;id&quot;: &quot;node253645bb6f162119e55b7352d8b2&quot;,
                        &quot;arrow&quot;: &quot;Left&quot;
                    },
                    &quot;id&quot;: &quot;line9c757e214b4f2ff64437653b8408&quot;
                }
            ],
            &quot;location&quot;: [
                {
                    &quot;id&quot;: &quot;nodeb9a3a2a32bb4cfe8761377b2270f&quot;,
                    &quot;type&quot;: &quot;startpoint&quot;,
                    &quot;x&quot;: 80,
                    &quot;y&quot;: 150
                },
                {
                    &quot;id&quot;: &quot;node7082deed0725aed8c72ecff079ba&quot;,
                    &quot;type&quot;: &quot;tasknode&quot;,
                    &quot;name&quot;: &quot;暂停&quot;,
                    &quot;stage_name&quot;: &quot;步骤1&quot;,
                    &quot;x&quot;: 300,
                    &quot;y&quot;: 150,
                    &quot;group&quot;: &quot;蓝鲸服务(BK)&quot;,
                    &quot;icon&quot;: &quot;&quot;
                },
                {
                    &quot;id&quot;: &quot;node253645bb6f162119e55b7352d8b2&quot;,
                    &quot;type&quot;: &quot;endpoint&quot;,
                    &quot;x&quot;: 820,
                    &quot;y&quot;: 150
                },
                {
                    &quot;id&quot;: &quot;node88d9050f288765b94a15cbe023ab&quot;,
                    &quot;type&quot;: &quot;tasknode&quot;,
                    &quot;name&quot;: &quot;暂停&quot;,
                    &quot;stage_name&quot;: &quot;步骤1&quot;,
                    &quot;x&quot;: 500,
                    &quot;y&quot;: 150,
                    &quot;group&quot;: &quot;蓝鲸服务(BK)&quot;,
                    &quot;icon&quot;: &quot;&quot;
                }
            ],
            &quot;outputs&quot;: [],
            &quot;start_event&quot;: {
                &quot;id&quot;: &quot;nodeb9a3a2a32bb4cfe8761377b2270f&quot;,
                &quot;incoming&quot;: &quot;&quot;,
                &quot;name&quot;: &quot;&quot;,
                &quot;outgoing&quot;: &quot;lineda60368b01cd8828a72585115f88&quot;,
                &quot;type&quot;: &quot;EmptyStartEvent&quot;
            }
        },
        &quot;constants_not_referred&quot;: {}
    },
    &quot;code&quot;: 0
}</code></pre>


<h3 id="_8">返回结果说明</h3>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>true/false 成功与否</td>
</tr>
<tr>
<td>data</td>
<td>dict</td>
<td>result=true 时返回数据，详情见下面说明</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>result=false 时错误信息</td>
</tr>
</tbody>
</table>
<h4 id="data">data 说明</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>pipeline_tree</td>
<td>dict</td>
<td>模板任务树信息，详细信息见下面说明</td>
</tr>
<tr>
<td>constants_not_referred</td>
<td>dict</td>
<td>流程模板中未引用的全局变量，数据结构同 pepeline[constants]</td>
</tr>
</tbody>
</table>
<h5 id="datapipeline_tree">data[pipeline_tree]</h5>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>start_event</td>
<td>dict</td>
<td>开始节点信息</td>
</tr>
<tr>
<td>end_event</td>
<td>dict</td>
<td>结束节点信息</td>
</tr>
<tr>
<td>activities</td>
<td>dict</td>
<td>任务节点（原子和子流程）信息</td>
</tr>
<tr>
<td>gateways</td>
<td>dict</td>
<td>网关节点（并行网关、分支网关和汇聚网关）信息</td>
</tr>
<tr>
<td>flows</td>
<td>dict</td>
<td>顺序流（节点连线）信息</td>
</tr>
<tr>
<td>constants</td>
<td>dict</td>
<td>全局变量信息，详情见下面</td>
</tr>
<tr>
<td>outputs</td>
<td>list</td>
<td>模板输出信息，标记 constants 中的输出字段</td>
</tr>
</tbody>
</table>
<h6 id="datapipeline_treeconstantskey">data.pipeline_tree.constants.KEY</h6>
<p>全局变量 KEY，${key} 格式</p>
<h6 id="datapipeline_treeconstantsvalue">data.pipeline_tree.constants.VALUE</h6>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>key</td>
<td>string</td>
<td>同 KEY</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>变量名字</td>
</tr>
<tr>
<td>index</td>
<td>int</td>
<td>变量在模板中的显示顺序</td>
</tr>
<tr>
<td>desc</td>
<td>string</td>
<td>变量说明</td>
</tr>
<tr>
<td>source_type</td>
<td>string</td>
<td>变量来源, 取值范围 custom: 自定义变量，component_inputs: 从原子输入参数勾选，component_outputs：从原子输出结果中勾选</td>
</tr>
<tr>
<td>custom_type</td>
<td>string</td>
<td>source_type=custom 时有效，自定义变量类型， 取值范围 input: 输入框，textarea: 文本框，datetime: 日期时间，int: 整数</td>
</tr>
<tr>
<td>source_tag</td>
<td>string</td>
<td>source_type=component_inputs</td>
</tr>
<tr>
<td>source_info</td>
<td>dict</td>
<td>source_type=component_inputs</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/sops/query_task_count/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>查询任务实例分类统计总数</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>string</td>
<td>是</td>
<td>模板所属业务 ID</td>
</tr>
<tr>
<td>group_by</td>
<td>string</td>
<td>是</td>
<td>分类统计维度，status：按任务状态（未执行、执行中、已完成）统计，category：按照任务类型统计，flow_type：按照流程类型统计，create_method：按照创建方式</td>
</tr>
<tr>
<td>conditions</td>
<td>dict</td>
<td>否</td>
<td>任务过滤条件</td>
</tr>
</tbody>
</table>
<h4 id="conditions">conditions</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>template_id</td>
<td>string</td>
<td>创建任务的模板 ID</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>任务名称</td>
</tr>
<tr>
<td>creator</td>
<td>string</td>
<td>创建人</td>
</tr>
<tr>
<td>create_time__gte</td>
<td>string</td>
<td>任务创建时间起始时间</td>
</tr>
<tr>
<td>create_time__lte</td>
<td>string</td>
<td>任务创建时间截止时间</td>
</tr>
<tr>
<td>executor</td>
<td>string</td>
<td>执行人</td>
</tr>
<tr>
<td>start_time__gte</td>
<td>string</td>
<td>任务执行时间起始时间</td>
</tr>
<tr>
<td>start_time__lte</td>
<td>string</td>
<td>任务执行时间截止时间</td>
</tr>
<tr>
<td>is_started</td>
<td>bool</td>
<td>任务是否启动</td>
</tr>
<tr>
<td>is_finished</td>
<td>bool</td>
<td>任务是否完成</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_biz_id&quot;: &quot;2&quot;,
    &quot;conditions&quot;: {
        &quot;create_time__lte&quot;: &quot;2018-07-12 10:00:00&quot;,
        &quot;is_started&quot;: true
    },
    &quot;group_by&quot;: &quot;flow_type&quot;
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;data&quot;: {
        &quot;total&quot;: 180,
        &quot;groups&quot;: [
            {
                &quot;code&quot;: &quot;common&quot;,
                &quot;name&quot;: &quot;默认任务流程&quot;,
                &quot;value&quot;: 166
            },
            {
                &quot;code&quot;: &quot;common_func&quot;,
                &quot;name&quot;: &quot;职能化任务流程&quot;,
                &quot;value&quot;: 14
            }
        ]
    },
    &quot;result&quot;: true
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>true/false 操作是否成功</td>
</tr>
<tr>
<td>data</td>
<td>dict</td>
<td>result=true 时返回分类统计信息，详细信息见下面说明</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>result=false 时错误信息</td>
</tr>
</tbody>
</table>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>total</td>
<td>int</td>
<td>按照过滤条件获取的任务总数</td>
</tr>
<tr>
<td>groups</td>
<td>list</td>
<td>按照过滤条件分类分类统计详情</td>
</tr>
</tbody>
</table>
<h4 id="datagroups">data.groups[]</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>code</td>
<td>string</td>
<td>分类统计类型编码</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>分类统计类型名称</td>
</tr>
<tr>
<td>value</td>
<td>string</td>
<td>当前分类任务数量</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/sops/set_periodic_task_enabled/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>设置某个周期任务是否激活</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>task_id</td>
<td>string</td>
<td>是</td>
<td>周期任务 ID</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>string</td>
<td>是</td>
<td>任务所属业务 ID</td>
</tr>
<tr>
<td>enabled</td>
<td>bool</td>
<td>否</td>
<td>该周期任务是否激活，不传则为 false</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_biz_id&quot;: &quot;2&quot;,
    &quot;task_id&quot;: &quot;8&quot;,
    &quot;enabled&quot;: false
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;data&quot;: {
        &quot;enabled&quot;: false
    },
    &quot;result&quot;: true
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>true/false 操作是否成功</td>
</tr>
<tr>
<td>data</td>
<td>dict</td>
<td>result=true 时成功数据，详细信息请见下面说明</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>result=false 时错误信息</td>
</tr>
</tbody>
</table>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>enabled</td>
<td>bool</td>
<td>当前周期任务是否已经激活</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/sops/start_task/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>开始执行任务</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>string</td>
<td>是</td>
<td>模板所属业务 ID</td>
</tr>
<tr>
<td>task_id</td>
<td>string</td>
<td>是</td>
<td>任务 ID</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_biz_id&quot;: &quot;2&quot;,
    &quot;task_id&quot;: &quot;10&quot;
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;result&quot;: true,
    &quot;data&quot;: {}
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>true/false 操作是否成功</td>
</tr>
<tr>
<td>data</td>
<td>dict</td>
<td>result=true 时返回数据</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>result=false 时错误信息</td>
</tr>
</tbody>
</table><h2 id="api">蓝鲸文档中心 API 简介</h2>
<table>
<thead>
<tr>
<th>资源名称</th>
<th>资源描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="./get_doc_link_by_path.md">get_doc_link_by_path</a></td>
<td>查询文档链接</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/bk_docs_center/get_doc_link_by_path/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>根据 md 文档名查询文档链接</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>version</td>
<td>string</td>
<td>是</td>
<td>查询版本</td>
</tr>
<tr>
<td>md_path</td>
<td>string</td>
<td>是</td>
<td>md 文档所在结构路径（如：流程服务/产品白皮书/FAQ/FAQ.md）</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;version&quot;:&quot;6.0&quot;,
    &quot;md_path&quot;: &quot;流程服务/产品白皮书/FAQ/FAQ.md&quot;
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-json">{
    &quot;result&quot;: true,
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;success&quot;,
    &quot;data&quot;: &quot;document/6.0/2/1&quot;
}</code></pre>
    </body>
    </html>
    