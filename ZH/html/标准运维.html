
    <html lang="zh-cn">
    <head>
    <meta content="text/html; charset=utf-8" http-equiv="content-type" />
    <link href="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/default.css" rel="stylesheet">
    </head>
    <body>
    <h1 id="_1">产品简介</h1>
<p>标准运维是通过可视化的图形界面进行任务流程编排和执行的系统，是腾讯蓝鲸产品体系中一款轻量级的调度编排类 SaaS 产品。</p>
<p>标准运维有三大核心服务：
- 调度编排服务：基于蓝鲸 PaaS 平台服务总线（ESB）对接企业内部各个系统 API 的能力，将企业内部多系统间的工作整合到一个流程模版中，实现一键自动化调度。</p>
<ul>
<li>
<p>自助化服务：标准运维通过与蓝鲸 PaaS 平台深度整合，为用户提供了 “轻应用” 和 “职能化” 功能，让用户可以将业务日常的运维工作交给产品和职能化人员执行，实现业务的发布、变更等工作自助化。</p>
</li>
<li>
<p>标准插件自主开发：标准插件提供一套完整的开发流程规范，通过丰富的表单界面和验证逻辑将企业内部各个系统、各个平台的 API 组装成一个标准插件模板。使其他的系统通过标准插件的开发模板来调动不同系统间的功能。</p>
</li>
</ul>
<p>现在，蓝鲸标准运维已正式对外开源，GitHub 地址： <a href="https://github.com/Tencent/bk-sops">https://github.com/Tencent/bk-sops</a></p><h1 id="_1">术语解释</h1>
<ul>
<li>
<p><strong>组件</strong>：在蓝鲸体系里，我们将每一个对接到 ESB（企业服务总线）中的第三方接口称之为组件。</p>
</li>
<li>
<p><strong>标准插件</strong>：标准运维会根据每个 ESB 组件的业务逻辑进行二次封装，增加丰富的表单界面和验证逻辑，我们将这些称之为标准插件。它可以是一个作业平台的脚本作业，可以是腾讯云某个服务的一次接口调用，也可以是一个定时器等等。</p>
</li>
<li>
<p><strong>节点</strong>：标准运维中的一个流程单元，包括流程控制节点和任务节点。在执行任务时，每一个节点都会有未执行、正在执行、执行成功、执行失败的状态。</p>
</li>
<li>
<p><strong>流程控制节点</strong>：标准运维中的一类节点，本身不包含具体执行逻辑，只是用来控制任务流程的执行过程。如开始节点标识任务流程的开始，网关节点控制并行流程和分支流程的开始、结束。</p>
</li>
<li>
<p><strong>网关节点</strong>：包括并行网关、分支网关和汇聚网关，用来控制并行和分支流程的开始、结束。</p>
</li>
<li>
<p><strong>并行网关</strong>：用来标识并行流程的开始，通过和汇聚网关配对使用，可以控制多个节点并行执行。</p>
</li>
<li>
<p><strong>分支网关</strong>：用来标识分支流程的开始，通过和汇聚网关配对使用，可以根据分支表达式的计算结果，动态的控制多个分支中某一个分支执行。</p>
</li>
<li>
<p><strong>汇聚网关</strong>：用来标识并行流程或者分支流程的结束，请注意，标准运维中并行流程中可以嵌入分支流程，分支流程中也可以再嵌入并行流程，请务必保证汇聚网关和并行网关或分支网关一一对应，而不能出现交叉嵌入或者不配对的情况。</p>
</li>
<li>
<p><strong>任务节点</strong>：任务节点是标准运维的具体执行逻辑单元，包括标准插件节点和子流程节点，每个任务节点包括基础信息、输入参数和输出参数，其中输入参数和输出参数可以用来勾选生成全局变量，输入参数还可以引用全局变量来简化用户输入。</p>
</li>
<li>
<p><strong>标准插件节点</strong>：标准运维中的最小执行单元，需要引用标准运维提供的标准插件，表示通过流程模板创建任务时，会执行一次选择的标准插件。</p>
</li>
<li>
<p><strong>子流程节点</strong>：通过子流程节点，用户可以实现流程模板的复用。一般情况下，用户可以新建多个流程模板，每个流程模板功能比较简单，然后在新建的流程模板中，引用之前创建的简单流程模板作为子流程，组成一个复杂逻辑的新流程模板。</p>
</li>
<li>
<p><strong>顺序流</strong>：顺序流是标准运维中用来连接两个节点的有向线段，标识任务流程的执行方向。</p>
</li>
<li>
<p><strong>流程/流程模板</strong>：在标准运维里，每一个基础运维场景的操作指引就是一个流程，流程是创建任务的模板。</p>
</li>
<li>
<p><strong>任务/任务实例</strong>：在标准运维里，我们可以根据一个流程创建出一个任务，每个任务都是一次真正的业务场景作业，任务可以被暂停、被强制终止。</p>
</li>
<li>
<p><strong>全局变量</strong>：全局变量是一个流程模板的公共参数，通过 KEY 来做唯一性约束。用户可以在任务节点的输入参数和分支网关表达式中引用，标准运维会在执行任务时自动替换全局变量的引用为全局变量的值。</p>
</li>
<li>
<p><strong>轻应用</strong>：为了做更精细的权限控制，我们增加了轻应用，你可以通过一个流程模板创建出一个轻应用，并授权给相关人员去执行，轻应用将自动出现在相关人员的蓝鲸工作台（企业版则出现在蓝鲸桌面）上，由于标准运维的任务界面足够简约，所以即便这个人不懂技术也可以执行任务。</p>
</li>
</ul><h1 id="_1">产品架构图</h1>
<p>标准运维后台使用 Python 作为开发语言，使用 Django 开发框架；前端使用 Vue 开发页面，使用 jQuery 开发原子，通过配置式的开发模式，不断降低用户开发原子前端表单的难度。</p>
<p>标准运维的产品结构如图所示：</p>
<p><img alt="-w2020" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/assets/1.png" /></p>
<ul>
<li>
<p>接入层：包含权限控制、API 接口和数据统计等；</p>
</li>
<li>
<p>任务管理层：主要对应标准运维的任务编排和任务控制功能，任务编排包含基础单元标准插件框架和标准插件展示层，任务控制包括创建任务实例的模板校验和参数校验，以及任务实例执行时给用户提供的操作接口如暂停、继续、撤销任务等；</p>
</li>
<li>
<p>流程引擎层：负责解析上层的任务实例，映射节点标准插件对应的服务，并通过底层的蓝鲸服务总线（ESB）调用其他系统的 API（如配置平台的创建集群，作业平台的快速执行脚本等），流程引擎层还包括了具体的任务执行引擎和流程控制、上下文管理等模块。</p>
</li>
</ul><h2 id="job">JOB 任务流程</h2>
<p>在这个章节中，你能够根据指引编排一个调度 JOB 作业的流程，这个流程会在第一个节点中到 JOB 中执行一段脚本，随后根据这段脚本的执行结果再去决定后续的工作。</p>
<h3 id="_1">新建流程</h3>
<p>进入某个项目的项目流程页面下，点击“新建按钮”</p>
<p><img alt="-w2020" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/assets/job_flow_new_flow.png" /></p>
<h3 id="_2">编排流程</h3>
<p>在这个流程中我们需要使用到一个分支网关，一个并行网关，和四个任务节点，先按照下图所示配置出整体的流程框架：</p>
<p><img alt="-w2020" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/assets/job_flow_flow_framework.png" /></p>
<p>在编排流程的过程中我们可以通过单机节点弹出的快捷面板来快速在该节点后生成其他节点：</p>
<p><img alt="-w2020" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/assets/job_flow_node_panel.png" /></p>
<h3 id="_3">配置第一个节点</h3>
<p>让我们先来配置流程中的第一个节点，双击节点打开配置面板，选择“作业平台(JOB)-快速执行脚本”插件：</p>
<p><img alt="-w2020" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/assets/job_flow_first_node_config.png" /></p>
<p>进行如下配置</p>
<p><img alt="-w2020" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/assets/job_flow_first_node_input.png" /></p>
<p>这里我们重点讲一下这几点：
- 在脚本内容中我们执行了一段 <code>echo "&lt;SOPS_VAR&gt;my_output:${flag}&lt;/SOPS_VAR&gt;"</code> 脚本，这里使用了两个特殊语法：
  - <code>&lt;SOPS_VAR&gt;key:value&lt;/SOPS_VAR&gt;</code>：在标准运维的任意步骤中，通过 JOB 插件（快速执行脚本、执行作业），输出<code>&lt;SOPS_VAR&gt;key:val&lt;/SOPS_VAR&gt;</code>格式的字符串，即将变量 key 赋值 val，并添加到节点输出中
  - <code>${flag}</code>：这里是表示对标准运维流程全局变量中 <code>${flag}</code> 变量的引用，如果全局变量存在的话，标准运维会在执行任务时替换为变量实际的值
- 在脚本的目标 IP 中我们引用了 <code>${ip}</code> 变量，而不是将 IP 写死在配置中</p>
<p>看完输入参数配置，我们再来看看输出参数：</p>
<p><img alt="-w2020" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/assets/job_flow_first_node_output.png" /></p>
<p>这里我们将“JOB 全局变量”这个输出参数勾选到了流程全局变量中，这样我们可以在后面的流程中使用</p>
<h3 id="_4">配置第二个节点</h3>
<p>下面来配置第二个节点，打开节点配置，依旧选择“作业平台(JOB)-快速执行脚本”插件，并进行如下配置</p>
<p><img alt="-w2020" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/assets/job_flow_second_node_config.png" /></p>
<h3 id="_5">配置分支网关</h3>
<p>分支网关能够引用流程上下文中的变量，并根据用户配置的表达式来决定要执行哪个分支，点击第一个分支条件打开配置面板并进行如下配置：</p>
<p><img alt="-w2020" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/assets/job_flow_branch_1.png" /></p>
<p>我们通过表达式 <code>"${log_outputs['my_output']}" == "1"</code> 引用了第一个节点中输出的 my_output 变量的值，并通过表达式进行判断，如果其值为 <code>"1"</code>，流程就会执行这条分支。</p>
<p>下面我们按照同样的步骤配置另一条分支：</p>
<p><img alt="-w2020" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/assets/job_flow_branch_2.png" /></p>
<h3 id="_6">配置全局变量</h3>
<p>最后一步我们要完成全局变量的配置，我们要配置两个全局变量：</p>
<ul>
<li><code>${flag}</code>：第一个节点的脚本内容中引用的变量，控制第一个节点的输出内容</li>
<li><code>${ip}</code>：执行流程中两个节点所配置的脚本的机器 IP</li>
</ul>
<p>打开全局变量面板：</p>
<p><img alt="-w2020" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/assets/job_flow_constants_icon.png" /></p>
<p>参考下图先完成 <code>${flag}</code> 的配置：</p>
<p><img alt="-w2020" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/assets/job_flow_constant_flag.png" /></p>
<p>再参考下图完成 <code>${ip}</code> 的配置：</p>
<p><img alt="-w2020" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/assets/job_flow_constant_ip.png" /></p>
<p>完成配置后你的全局变量中应该有这些变量：</p>
<p><img alt="-w2020" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/assets/job_flow_all_constants.png" /></p>
<p>最后保存流程，并使用该流程新建一个任务</p>
<h3 id="_7">参数填写</h3>
<p>使用流程新建任务时，在参数填写界面按照下图进行填写和配置</p>
<p><img alt="-w2020" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/assets/job_flow_fill_params.png" /></p>
<p>这里我们先将“JOB 输出”设置为<code>1</code>，“脚本执行 IP” 选择当前业务下的任意 IP 即可。</p>
<h3 id="_8">任务执行</h3>
<p>完成参数填写和任务创建后，我们会进入到任务详情页面。点击“查看参数”按钮能够预览每个节点的执行参数：</p>
<p><img alt="-w2020" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/assets/job_flow_view_params.png" /></p>
<p>如果配置正确的话，可以看到引用参数的地方都已经被替换掉了：</p>
<p><img alt="-w2020" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/assets/job_flow_view_params_detail.png" /></p>
<p>点击执行按钮开始任务执行：</p>
<p><img alt="-w2020" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/assets/job_flow_start.png" /></p>
<p>可以看到，任务按照我们的配置执行了 “flag = 1” 分支：</p>
<p><img alt="-w2020" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/assets/job_flow_exec_flag_1.png" /></p>
<p>点击任务节点能够看到节点执行详情：</p>
<p><img alt="-w2020" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/assets/job_flow_node_exec_detail.png" /></p>
<h3 id="flag">修改 flag</h3>
<p>创建一个新的任务，这次我们将 flag 的值填写为 <code>0</code> 并执行任务，可以看到，任务走向了另一条分支：</p>
<p><img alt="-w2020" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/assets/job_flow_exec_flag_0.png" /></p><h1 id="_1">产品功能</h1>
<p>标准运维是一套通过成熟稳定的任务调度引擎，把多系统间的工作整合到一个流程，助力运维实现跨系统调度自动化的 SaaS 应用。标准运维拥有可视化的图形界面，用户可通过它实现任务流程编排和执行，包括发布、变更、开区、扩缩容等执行类操作场景。</p>
<h2 id="_2">标准运维</h2>
<table>
<thead>
<tr>
<th>功能</th>
<th>功能描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>项目流程</td>
<td>项目流程是标准运维的核心功能。业务流程页面展示了当前业务下的流程列表，支持高级搜索、新建流程、新建任务、编辑流程、预览流程、克隆流程、权限管理、查看执行历史、删除等操作。</td>
</tr>
<tr>
<td>任务管理</td>
<td>满足用户追溯之前的任务执行情况和周期任务的配置。</td>
</tr>
<tr>
<td>轻应用</td>
<td>用户可以根据一个已执行完成的任务创建一个轻应用到指定用户的蓝鲸工作台（企业版则出现在蓝鲸桌面）。</td>
</tr>
<tr>
<td>公共流程</td>
<td>公共流程页面展示了所有业务下都能够使用的公共流程列表，包含了高级搜索、新建任务、权限管理、查看执行历史等操作。</td>
</tr>
<tr>
<td>职能化</td>
<td>职能化用户在此可以完成一系列职能化操作。</td>
</tr>
<tr>
<td>审计中心</td>
<td>在此可以审计执行过的所有任务历史。</td>
</tr>
<tr>
<td>项目管理</td>
<td>在这里可以查看和管理有权限的项目。</td>
</tr>
<tr>
<td>管理员入口-搜索</td>
<td>根据项目名，模板 ID 或是任务 ID 对项目，流程模板或是任务进行搜索操作。</td>
</tr>
<tr>
<td>周期任务</td>
<td>在这里可以看到整个系统中所有的周期任务。</td>
</tr>
<tr>
<td>远程插件包源管理</td>
<td>管理系统中配置的远程插件源和本地缓存。</td>
</tr>
<tr>
<td>远程插件同步</td>
<td>将远程插件代码同步到本地缓存中。</td>
</tr>
</tbody>
</table><h1 id="_1">首页</h1>
<p>标准运维在蓝鲸体系上体现为一个工具 SaaS。首页界面如下所示：是一个全局视图，包含 “常用项目”、“我的收藏” 和 “我的动态”。</p>
<ul>
<li>
<p>常用项目：根据使用频率将经常使用的项目罗列展示出来。</p>
</li>
<li>
<p>我的收藏：展示用户对流程模板，公共流程，周期任务和轻应用的收藏列表。</p>
</li>
<li>
<p>我的动态：展示最近执行的十条任务。</p>
</li>
</ul>
<p><img alt="-w2020" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/assets/标准运维首页.png" /></p><h2 id="_1">项目流程</h2>
<p>业务流程是标准运维的核心功能。</p>
<p>业务流程页面展示了当前业务下的流程列表，支持高级搜索、新建流程、新建任务、编辑流程、预览流程、克隆流程、权限管理、查看执行历史、删除等操作。</p>
<p><img alt="-w2020" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/assets/业务流程.png" /></p>
<p><strong>可视化任务流程配置</strong>。新建流程时，用户可以通过图形界面进行任务流程编排。在编排页面，用户可以通过左侧的工具栏来添加节点，流程节点包含流程控制节点和任务节点。</p>
<p><img alt="-w2020" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/assets/可视化流程.png" /></p>
<p>1、流程控制节点包括：
- 开始节点——标识流程的开始
- 结束节点——标识流程的结束
- 并行网关——标识并行执行的开始
- 分支网关——标识分支执行的开始（每个分支都需要设置分支表达式，执行时只有一条表达式为 True 的分支会被执行）
- 汇聚网关——标识并行或分支的结束</p>
<p>2、任务节点包括标准插件节点和子流程节点。
- 标准插件节点是标准运维内置的最小执行单元，一般对应于蓝鲸服务总线（ESB）的一次接口调用或者标准运维内置服务，如：定时
- 子流程节点可以选择用户已经创建的流程模板，在新的流程中引用并作为子流程执行</p>
<p>点击某一个任务节点时，会弹出该节点的参数和配置，不同类型的标准插件参数各不相同，但都可以勾选到全局变量区或者引用全局变量。</p>
<p>每个任务节点可以设置 “失败处理” 和 “是否可选” 属性，勾选了 “是否可选” 的节点在执行任务前的 “节点选择” 阶段可以选择本次任务是否执行该节点；勾选了 “自动忽略” 的节点在执行时不论是否成功都不会中断任务流程，而是继续执行后续的节点。</p><h1 id="_1">新建流程</h1>
<p>具体步骤：</p>
<p><strong>新建流程 - 流程名称 - 流程节点 - 全局变量</strong></p>
<p>1、新建流程</p>
<p>用户可以通过对标准插件节点、子流程节点与网关节点的组合，变量的配置与引用，配置出一个业务流程。</p>
<p>流程名称是用户用来描述流程模板的，默认值是 <code>new时间格式串</code>，用户可以自行修改，注意不能包含空格、括号等特殊字符。</p>
<p>用户可以从左边的工具栏，拖拽合适的节点到画布中，并通过连线，组成合法的流程模板。</p>
<p><strong>注意：</strong> 流程名称不能包含'‘"”$&amp;&lt;&gt;非法字符。</p>
<p>2、工具栏说明</p>
<p>工具栏中流程节点包含流程控制节点和任务节点。流程控制节点包括：</p>
<ul>
<li>开始节点——标识流程的开始</li>
<li>结束节点——标识流程的结束</li>
</ul>
<p>一个合法的流程模板只能有一个开始节点和结束节点，开始节点出度（箭头指向节点的连线数量）只能为 1，入度（箭头背离节点的连线数量）为 0。结束节点入度为 1，出度为 0。</p>
<p>流程控制节点还包括：</p>
<ul>
<li>并行网关——标识并行执行的开始</li>
<li>分支网关——标识分支执行的开始</li>
<li>汇聚网关——标识并行或分支的结束</li>
</ul>
<blockquote>
<p>请注意，每一个并行网关或者分支网关都需要配置一个汇聚网关来标识并行或分支流程的结束。</p>
</blockquote>
<p>并行网关入度为 1，出度不小于 2。并行网关出度上的多个节点在执行时会并发执行，对应的汇聚网关在等待所有并行流程执行完成后才会开始启动后续的流程节点。</p>
<p><img alt="g2" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/assets/g2.png" /></p>
<p>分支网关和并行网关类似，区别在于分支网关出度上的多个节点在执行时会根据分支条件启动分支表达式为 True 的一个分支流程，其他的分支则不会被执行。启动的分支执行完成后就立刻启动对应的汇聚网关，接着执行后续的流程节点。分支表达式的语法请参考 <a href="../附录/grammar.md">附录 1</a> 说明。</p>
<p><img alt="g3" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/assets/g3.png" /></p>
<p>任务节点包括标准插件节点和子流程节点。标准插件节点是标准运维内置的最小执行单元，一般对应于蓝鲸服务总线（ESB）的一次 API 调用或者标准运维内置服务如定时。</p>
<p>双击标准插件节点可以配置标准插件节点的参数。其中标准插件类型可以选择一个标准运维接入的标准插件，输入参数、输出参数和选择的标准插件对应，每个标准插件的参数一般不同，如“作业平台(JOB)-快速执行脚本”是对应作业平台的快速执行脚本 API，需要填写脚本类型、脚本内容、脚本参数、超时时间、目标 IP、目标账户等输入参数，在执行时，标准运维会把用户填写的前端参数转换为 ESB 需要的参数格式并调用 API，然后根据 API 返回结果把 JOB 任务 ID、JOB 任务链接、执行结果（成功或失败）作为输出参数展示在执行详情中，后续的流程节点也可以引用前面节点的输出参数。</p>
<p><img alt="发布6" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/assets/发布6.png" /></p>
<p>子流程节点可以选择用户已经创建的流程模板，在新的流程中引用并作为子流程执行。子流程节点的输入参数是选择的流程模板中显示属性为 “显示” 的全局变量，也就是该子流程模板单独创建任务时需要填写的任务参数。输出变量是选择的流程模板中勾选了输出属性的全局变量。</p>
<p><img alt="g4" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/assets/sops003.png" /></p>
<p>5、全局变量</p>
<p>全局变量是一个流程模板的公共参数，通过 KEY 来做唯一性约束。用户可以在任务节点的输入参数和分支网关表达式中引用，标准运维会在执行任务时自动替换全局变量的引用为全局变量的值。</p>
<p>全局变量的来源有三种：</p>
<p>一是 通过任务节点的输入参数勾选生成，这类全局变量的类型是 “组件”，并且不能更改；默认值和来源标准插件的输入参数的表单类型一致，如标准插件节点的参数是单选框，勾选生成的全局变量也是单选框。</p>
<p><img alt="-w2021" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/assets/sops004.png" /></p>
<p>二是 通过任务节点的输出参数勾选生成，这类全局变量类型也是 “组件”，并且不能更改；无默认值属性，因为这类全局变量的值是由生成该变量的标准插件节点、子流程节点的输出结果自动生成的，用户无法手动设置；此外，这类全局变量的显示属性是 “隐藏”，并且不能更改，表示执行任务时不需要用户手动填写这类参数。</p>
<p><img alt="-w2021" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/assets/sops005.png" /></p>
<p>三是 用户在全局变量区点击 “新增变量” 生成，手动添加的全局变量类型可以选择输入框、文本框、日期时间、整数、IP 选择器等，并且可以随时切换；这类变量可以自定义校验规则，这样在创建任务填写参数时，可以避免填写不合法的参数值。</p>
<p><img alt="-w2021" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/assets/sops006.png" /></p>
<p>全局变量可以通过 <code>${key}</code> 的语法引用，并且全局变量的默认值中也可以引用其他的全局变量，只要保证无循环引用即可。多个任务节点的输入参数引用同一个全局变量，可以实现参数共享，减少创建任务时需要填写的参数；任务节点输入参数通过形如 <code>xxx${key}</code> 方式部分引用全局变量，可以实现简化输入参数的目的；任务节点输入参数或者分支条件表达式通过引用之前的任务节点的输出参数生成的全局变量，可以实现根据任务节点输出控制后面节点输入参数和分支流程走向。</p>
<p><img alt="g5" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/assets/sops007.png" /></p><h1 id="_1">新建任务</h1>
<p>用户可以在 “流程模板” 页点击流程模板的 “新建任务” 按钮创建一个任务。</p>
<p>具体步骤：</p>
<p>选择任务节点 - 填写参数 - 预览 - 查看参数 - 启动任务</p>
<p>1、新建任务时，用户需要选择要执行的任务节点（也可以通过点击执行方案快速选择要执行的任务节点），并点击 “下一步”。注意，只有设置了可选节点属性为 “ON” 的任务节点，才能在节点选择阶段选择不执行，其他的任务节点必须执行。</p>
<p><img alt="新建任务1" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/assets/新建任务1.png" /></p>
<p>节点选择时，可以开启 “预览模式”，查看不同方案下的任务模式。</p>
<p><img alt="新建任务2" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/assets/新建任务2.png" /></p>
<p>2、启动任务之前，用户可以点击 “查看参数” 确认变量替换后生成的每个任务节点的参数，如果不符合预期，可以点击 <code>修改参数</code> 重新填写任务的全局变量参数，确认无误后，点击 “执行” 就可以立即启动当前任务流程实例了。</p>
<p><img alt="新建任务3" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/assets/新建任务3.png" /></p>
<p>3、在任务执行过程中，用户可以暂停任务，继续任务或者终止任务，任务执行到某个标准插件失败后也可以选择 “跳过” 或者修改参数后 “重试”。</p>
<p><img alt="新建任务4" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/assets/新建任务4.png" /></p><h1 id="_1">任务记录</h1>
<p><strong>任务历史可追溯</strong>。用户在任务记录页面，可以追溯之前的任务执行情况。</p>
<p><img alt="任务记录" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/assets/任务记录.png" /></p>
<p>可对执行过的任务进行克隆，删除管理。同时，可展开 “高级搜索” 进行过滤查询。</p><h1 id="_1">周期任务</h1>
<p>周期任务能够满足用户对流程模板定期执行任务的需求。</p>
<p><img alt="-w2020" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/assets/43.png" /></p>
<ul>
<li>新建周期任务</li>
</ul>
<p>用户可以在新建任务时通过参数填写的页面中执行计划选择周期执行任务来创建一个周期任务。填写周期表达式来确认任务触发执行的时间。周期表达式可以通过两种方式设置：选择生成，或者手动输入。</p>
<p><img alt="周期任务1" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/assets/周期任务1.png" /></p>
<ul>
<li>周期表达式</li>
</ul>
<p><img alt="-w2020" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/assets/45.png" /></p>
<ul>
<li>生成周期任务</li>
</ul>
<p>新建成功后，周期任务会按照周期规则自动执行，在页面上能够对周期任务执行暂停、编辑、删除、执行任务操作。</p>
<p><img alt="-w2020" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/assets/46.png" /></p>
<ul>
<li>编辑周期任务</li>
</ul>
<p>用户能够编辑周期任务来修改周期规则以及参数信息。注意：周期任务的状态为 “暂停” 时才可编辑。如果周期任务为 “启动” 中时，需将其暂停后再进行编辑操作。</p>
<ul>
<li>执行历史</li>
</ul>
<p>用户能够查看周期任务完整的执行历史，来查看任务执行情况。并可以对已执行的任务进行克隆、删除。</p><h1 id="_1">轻应用</h1>
<p><strong>零成本创建“轻应用”</strong>。业务运维人员将日常工作标准化后，以标准运维中一个模板的形式提供给业务非技术人员使用，为了降低使用者的操作风险和使用成本，将该模板以独立 SaaS 应用的方式指定给授权者使用，这种不需要开发、零成本快速生成的 SaaS 应用称为 “轻应用”。标准运维通过与蓝鲸集成平台深度结合，可以提高业务的自助化能力，便于业务非技术人员执行日常工作。</p>
<p><img alt="-w2020" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/assets/sops002.png" /></p>
<p>在轻应用页面，用户可以根据一个已执行完成的任务创建一个轻应用到指定用户的蓝鲸工作台（若是企业版，则显示在蓝鲸桌面的 “应用市场”，用户可以自行添加到个人桌面）。</p>
<h2 id="_2">新建轻应用</h2>
<p>用户可以选择一个流程模板创建出一个轻应用，轻应用创建完成后，会直接展示在用户的蓝鲸工作台上（若是企业版，则显示在蓝鲸桌面的 “应用市场”，用户可以自行添加到个人桌面），对使用人员而言，轻应用只需要关注一个流程模板的参数填写和任务操作，由于页面足够的简洁和友好，一个非技术人员也可以通过轻应用执行任务，这也就是标准运维提供的自助化服务之一。</p>
<blockquote>
<p>注意，只有在权限中心申请了对应轻应用的“轻应用查看”和其对应模板的“流程查看”权限后才能访问轻应用，如果需要某个用户可以通过轻应用创建任务和执行任务，请提前在权限中心申请该轻应用的“轻应用查看”和“轻应用创建任务”权限以及轻应用对应模板的“流程查看”权限。</p>
</blockquote>
<p><img alt="-w2020" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/assets/26.png" /></p>
<h2 id="_3">编辑轻应用</h2>
<p>如果需要修改轻应用的名称、简介或者 Logo，请在轻应用列表中，通过鼠标选择需要修改的轻应用，点击编辑图标后，在弹窗中填写修改后的参数。</p>
<blockquote>
<p>注意，不能修改轻应用引用的流程模板，如果需要这样做，请删除旧轻应用后重新创建新的轻应用，并引用新的流程模板。</p>
</blockquote>
<p><img alt="-w2020" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/assets/27.png" /></p>
<h2 id="_4">删除轻应用</h2>
<p>如果需要删除轻应用，请在标准运维轻应用列表中，通过鼠标选择需要修改的轻应用，点击删除图标后，在弹窗中二次确认并删除，删除成功后会同步删除个人工作台（蓝鲸桌面）的轻应用。</p><h2 id="_1">公共流程</h2>
<p>公共流程通常用于管理在所有业务下都能够使用的一些流程。你可以在任意有权限的业务下使用公共流程新建任务。</p>
<p><img alt="-w2020" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/assets/common_flow.png" /></p>
<p>在对应的流程上点击“新建任务”就能够选择特定的项目来创建和执行任务啦：</p>
<p><img alt="-w2020" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/assets/common_flow_create_task.png" /></p>
<h3 id="_2">编辑公共流程</h3>
<p>在对公共流程进行配置和编排的时候，我们可能会遇到一些需要选择业务的节点，如作业平台(JOB)-快速执行脚本，而公共流程大多数情况下是不需要提前配置节点所属的业务的，这个时候我们只需要将“业务”字段勾选为全局变量即可，当我们在某个业务下使用该流程新建任务的时候，标准运维会自动为你填充该字段：</p>
<p><img alt="-w2020" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/assets/common_flow_biz_select.png" /></p><h2 id="_1">职能化</h2>
<p>职能化中心能够让你把任务的执行转交给对应的职能化同事来操作，只要用户拥有“职能化中心查看”的权限，就能够进入职能化中心页面：</p>
<p><img alt="-w2020" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/asssets/../assets/function_task.png" /></p>
<h3 id="_2">如何创建职能化任务</h3>
<p>当我们使用流程创建任务时，在参数填写界面能够选择“流程类型”，将任务类型修改为“职能化任务流程”，在参数填写完成后该任务就会以“待认领”的状态进入到职能化中心中等待认领：</p>
<p><img alt="-w2020" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/asssets/../assets/function_task_create.png" /></p>
<p><img alt="-w2020" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/asssets/../assets/function_task_to_be_claim.png" /></p>
<p>当然，职能化人员也可以在职能化页面主动创建任务（需要拥有“流程查看”和“流程新建任务”权限）：</p>
<p><img alt="-w2020" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/asssets/../assets/function_task_create_task.png" /></p><h2 id="_1">审计中心</h2>
<p>审计中心提供了对系统内所有任务审计的总览视图，只要拥有“审计中心查看”权限就能够进入审计中心：</p>
<p><img alt="-w2020" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/asssets/../assets/audit.png" /></p><h2 id="_1">项目管理</h2>
<p>项目管理界面展示了目前你有查看权限的所有项目，你可以在项目管理页面对项目进行查看，编辑和停用操作：</p>
<p><img alt="-w2020" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/asssets/../assets/project_management.png" /></p><h1 id="_1">管理员入口</h1>
<h2 id="_2">后台管理</h2>
<p>包含远程插件包源管理，和远程插件同步。</p>
<p><img alt="-w2020" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/assets/后台管理.png" /></p>
<p>后台管理可以让用户不修改标准运维源码就可以加载第三方插件，解决了标准插件开发和维护流程复杂的问题，让用户可以不需要解压官方包以及重新打包，只需要在自定义插件开发测试完成后，在标准运维配置自定义插件包源信息，然后重新部署应用，就能自动加载插件。</p>
<p>1.配置主包源信息。在配置页面，填入需要的信息</p>
<p><img alt="-w2020" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/assets/远程1.png" />
<img alt="-w2020" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/assets/远程2.png" />
<img alt="-w2020" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/assets/远程4.png" /></p>
<p>2.重新部署后成功加载插件效果 在 “新建流程” 中编辑默认的标准插件节点，可以看到远程插件包源中的 “自定义原子(CUS)-测试 1” ，并且选择该插件后页面渲染正常。</p>
<p><img alt="-w2020" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/assets/远程5.png" /></p>
<h2 id="_3">运营数据</h2>
<p>包含流程统计、任务统计、标准插件统计、轻应用统计 4 个维度的运营数据分析。</p>
<p><img alt="-w2020" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/assets/运营数据.png" /></p>
<h2 id="_4">公共流程</h2>
<p>公共流程是标准运维方便用户在不同业务中共用同一套流程模板的功能。用户可以新建公共流程，达到多业务共享公共流程模板的目的。</p>
<p><img alt="-w2020" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/assets/49.png" /></p><h2 id="api">标准运维 API 文档简介</h2>
<table>
<thead>
<tr>
<th>资源名称</th>
<th>资源描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="./claim_functionalization_task.md">claim_functionalization_task</a></td>
<td>认领职能化任务</td>
</tr>
<tr>
<td><a href="./create_periodic_task.md">create_periodic_task</a></td>
<td>通过流程模板新建周期任务</td>
</tr>
<tr>
<td><a href="./create_task.md">create_task</a></td>
<td>通过流程模板新建任务</td>
</tr>
<tr>
<td><a href="./fast_create_task.md">fast_create_task</a></td>
<td>快速新建一次性任务</td>
</tr>
<tr>
<td><a href="./get_common_template_info.md">get_common_template_info</a></td>
<td>查询单个公共流程模板详情</td>
</tr>
<tr>
<td><a href="./get_common_template_list.md">get_common_template_list</a></td>
<td>查询公共模板列表</td>
</tr>
<tr>
<td><a href="./get_periodic_task_info.md">get_periodic_task_info</a></td>
<td>查询业务下的某个周期任务详情</td>
</tr>
<tr>
<td><a href="./get_periodic_task_list.md">get_periodic_task_list</a></td>
<td>查询业务下的周期任务列表</td>
</tr>
<tr>
<td><a href="./get_plugin_list.md">get_plugin_list</a></td>
<td>查询某个业务下的插件列表</td>
</tr>
<tr>
<td><a href="./get_task_detail.md">get_tasks_status</a></td>
<td>批量查询任务状态</td>
</tr>
<tr>
<td><a href="./get_task_list.md">get_task_detail</a></td>
<td>查询任务执行详情</td>
</tr>
<tr>
<td><a href="./get_task_node_data.md">get_task_list</a></td>
<td>获取业务下的任务列表</td>
</tr>
<tr>
<td><a href="./get_task_node_detail.md">get_task_node_data</a></td>
<td>获取节点执行数据</td>
</tr>
<tr>
<td><a href="./get_task_status.md">get_task_node_detail</a></td>
<td>查询任务节点执行详情</td>
</tr>
<tr>
<td><a href="./get_tasks_status.md">get_task_status</a></td>
<td>查询任务或任务节点执行状态</td>
</tr>
<tr>
<td><a href="./get_template_info.md">get_template_info</a></td>
<td>查询单个模板详情</td>
</tr>
<tr>
<td><a href="./get_template_list.md">get_template_list</a></td>
<td>查询模板列表</td>
</tr>
<tr>
<td><a href="./get_template_schemes.md">get_template_schemes</a></td>
<td>获取模板执行方案列表</td>
</tr>
<tr>
<td><a href="./get_user_project_detail.md">get_user_project_detail</a></td>
<td>获取项目详情</td>
</tr>
<tr>
<td><a href="./get_user_project_list.md">get_user_project_list</a></td>
<td>获取用户有权限的项目列表</td>
</tr>
<tr>
<td><a href="./import_common_template.md">import_common_template</a></td>
<td>导入公共流程</td>
</tr>
<tr>
<td><a href="./import_project_template.md">import_project_template</a></td>
<td>导入业务流程模板</td>
</tr>
<tr>
<td><a href="./modify_constants_for_periodic_task.md">modify_constants_for_periodic_task</a></td>
<td>修改周期任务的全局参数</td>
</tr>
<tr>
<td><a href="./modify_constants_for_task.md">modify_constants_for_task</a></td>
<td>修改任务的全局参数</td>
</tr>
<tr>
<td><a href="./modify_cron_for_periodic_task.md">modify_cron_for_periodic_task</a></td>
<td>修改周期任务的调度策略</td>
</tr>
<tr>
<td><a href="./node_callback.md">node_callback</a></td>
<td>回调任务节点</td>
</tr>
<tr>
<td><a href="./operate_node.md">operate_node</a></td>
<td>操作任务中的节点</td>
</tr>
<tr>
<td><a href="./operate_task.md">operate_task</a></td>
<td>操作任务</td>
</tr>
<tr>
<td><a href="./preview_task_tree.md">preview_task_tree</a></td>
<td>获取节点选择后新的任务树</td>
</tr>
<tr>
<td><a href="./query_task_count.md">query_task_count</a></td>
<td>查询任务分类统计总数</td>
</tr>
<tr>
<td><a href="./set_periodic_task_enabled.md">set_periodic_task_enabled</a></td>
<td>设置周期任务是否激活</td>
</tr>
<tr>
<td><a href="./start_task.md">start_task</a></td>
<td>开始执行任务</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/sops/claim_functionalization_task/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>职能化任务认领</p>
<h4 id="_4">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_5">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>task_id</td>
<td>string</td>
<td>是</td>
<td>任务 ID，需要任务状态是未开始的</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>string</td>
<td>是</td>
<td>模板所属业务 ID</td>
</tr>
<tr>
<td>constants</td>
<td>dict</td>
<td>是</td>
<td>任务全局参数，详细信息见下面说明</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>否</td>
<td>任务新名称</td>
</tr>
<tr>
<td>scope</td>
<td>string</td>
<td>否</td>
<td>bk_biz_id 检索的作用域。默认为 cmdb_biz，此时检索的是绑定的 CMDB 业务 ID 为 bk_biz_id 的项目；当值为 project 时则检索项目 ID 为 bk_biz_id 的项目</td>
</tr>
</tbody>
</table>
<h4 id="constants-key">constants KEY</h4>
<p>变量 KEY，${key} 格式</p>
<h4 id="constants-value">constants VALUE</h4>
<p>变量值</p>
<h3 id="_6">请求参数示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_biz_id&quot;: &quot;2&quot;,
    &quot;task_id&quot;: &quot;8&quot;,
    &quot;constants&quot;: {
        &quot;${bk_timing}&quot;: &quot;100&quot;
    }
}</code></pre>


<h3 id="_7">返回结果示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;data&quot;: &quot;success&quot;,
    &quot;result&quot;: true, 
    &quot;code&quot;: 0
}</code></pre>


<h3 id="_8">返回结果说明</h3>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>true/false 操作是否成功</td>
</tr>
<tr>
<td>data</td>
<td>string</td>
<td>result=true 时成功数据, "success"</td>
</tr>
<tr>
<td>code</td>
<td>int</td>
<td>结果状态码</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>result=false 时错误信息</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/sops/create_periodic_task/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>创建周期任务</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>template_id</td>
<td>string</td>
<td>是</td>
<td>用于创建任务的模板 ID</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>string</td>
<td>是</td>
<td>任务所属业务 ID</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>是</td>
<td>要创建的周期任务名称</td>
</tr>
<tr>
<td>cron</td>
<td>dict</td>
<td>是</td>
<td>要创建的周期任务调度策略</td>
</tr>
<tr>
<td>constants</td>
<td>dict</td>
<td>否</td>
<td>任务全局参数，详细信息见下面说明</td>
</tr>
<tr>
<td>exclude_task_nodes_id</td>
<td>list</td>
<td>否</td>
<td>跳过执行的节点 ID 列表</td>
</tr>
</tbody>
</table>
<h4 id="constantskey">constants.KEY</h4>
<p>变量 KEY，${key} 格式</p>
<h4 id="constantsvalue">constants.VALUE</h4>
<p>变量值</p>
<h4 id="cron">cron</h4>
<table>
<thead>
<tr>
<th>参数名称</th>
<th>参数类型</th>
<th>必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>minute</td>
<td>string</td>
<td>否</td>
<td>分，默认为 *</td>
</tr>
<tr>
<td>hour</td>
<td>string</td>
<td>否</td>
<td>时，默认为 *</td>
</tr>
<tr>
<td>day_of_week</td>
<td>string</td>
<td>否</td>
<td>一周内的某些天，默认为 *</td>
</tr>
<tr>
<td>day_of_month</td>
<td>string</td>
<td>否</td>
<td>一个月中的某些天，默认为 *</td>
</tr>
<tr>
<td>month_of_year</td>
<td>string</td>
<td>否</td>
<td>一年中的某些月份，默认为 *</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;template_id&quot;: &quot;1&quot;,
    &quot;bk_biz_id&quot;: &quot;2&quot;,
    &quot;name&quot;: &quot;from api 3&quot;,
    &quot;cron&quot; : {&quot;minute&quot;: &quot;*/1&quot;, &quot;hour&quot;: &quot;15&quot;, &quot;day_of_week&quot;:&quot;*&quot;, &quot;day_of_month&quot;:&quot;*&quot;, &quot;month_of_year&quot;:&quot;*&quot;},
    &quot;constants&quot;: {&quot;${bk_timing}&quot;: &quot;100&quot;},
    &quot;exclude_task_nodes_id&quot;: [&quot;nodea5c396a3ef0f9f3cd7d4d7695f78&quot;]
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: {
        &quot;cron&quot;: &quot;*/1 15 * * * (m/h/d/dM/MY)&quot;,
        &quot;total_run_count&quot;: 0,
        &quot;name&quot;: &quot;from api 3&quot;,
        &quot;form&quot;: {
            &quot;${bk_timing}&quot;: {
                &quot;source_tag&quot;: &quot;sleep_timer.bk_timing&quot;,
                &quot;source_info&quot;: {
                    &quot;node76393dcfedcf73dbc726f1c4786d&quot;: [
                        &quot;bk_timing&quot;
                    ]
                },
                &quot;name&quot;: &quot;定时时间&quot;,
                &quot;index&quot;: 0,
                &quot;custom_type&quot;: &quot;&quot;,
                &quot;value&quot;: &quot;100&quot;,
                &quot;show_type&quot;: &quot;show&quot;,
                &quot;source_type&quot;: &quot;component_inputs&quot;,
                &quot;key&quot;: &quot;${bk_timing}&quot;,
                &quot;validation&quot;: &quot;&quot;,
                &quot;desc&quot;: &quot;&quot;
            }
        },
        &quot;creator&quot;: &quot;admin&quot;,
        &quot;pipeline_tree&quot;: {
            &quot;activities&quot;: {
                &quot;node76393dcfedcf73dbc726f1c4786d&quot;: {
                    &quot;outgoing&quot;: &quot;linecf7b7f10c87187a88b72c5f91177&quot;,
                    &quot;incoming&quot;: &quot;linecd597f19606c1455d661f71a582d&quot;,
                    &quot;name&quot;: &quot;定时&quot;,
                    &quot;error_ignorable&quot;: false,
                    &quot;component&quot;: {
                        &quot;code&quot;: &quot;sleep_timer&quot;,
                        &quot;data&quot;: {
                            &quot;bk_timing&quot;: {
                                &quot;hook&quot;: true,
                                &quot;value&quot;: &quot;${bk_timing}&quot;
                            }
                        }
                    },
                    &quot;stage_name&quot;: &quot;步骤1&quot;,
                    &quot;optional&quot;: false,
                    &quot;type&quot;: &quot;ServiceActivity&quot;,
                    &quot;id&quot;: &quot;node76393dcfedcf73dbc726f1c4786d&quot;,
                    &quot;loop&quot;: {}
                }
            },
            &quot;end_event&quot;: {
                &quot;incoming&quot;: &quot;linecf7b7f10c87187a88b72c5f91177&quot;,
                &quot;outgoing&quot;: &quot;&quot;,
                &quot;type&quot;: &quot;EmptyEndEvent&quot;,
                &quot;id&quot;: &quot;node375320830be9c46cd89f4069857d&quot;,
                &quot;name&quot;: &quot;&quot;
            },
            &quot;outputs&quot;: [],
            &quot;flows&quot;: {
                &quot;linecd597f19606c1455d661f71a582d&quot;: {
                    &quot;is_default&quot;: false,
                    &quot;source&quot;: &quot;node4e87796ddd76b0d59337b08f385d&quot;,
                    &quot;id&quot;: &quot;linecd597f19606c1455d661f71a582d&quot;,
                    &quot;target&quot;: &quot;node76393dcfedcf73dbc726f1c4786d&quot;
                },
                &quot;linecf7b7f10c87187a88b72c5f91177&quot;: {
                    &quot;is_default&quot;: false,
                    &quot;source&quot;: &quot;node76393dcfedcf73dbc726f1c4786d&quot;,
                    &quot;id&quot;: &quot;linecf7b7f10c87187a88b72c5f91177&quot;,
                    &quot;target&quot;: &quot;node375320830be9c46cd89f4069857d&quot;
                }
            },
            &quot;gateways&quot;: {},
            &quot;line&quot;: [
                {
                    &quot;source&quot;: {
                        &quot;id&quot;: &quot;node4e87796ddd76b0d59337b08f385d&quot;,
                        &quot;arrow&quot;: &quot;Right&quot;
                    },
                    &quot;id&quot;: &quot;linecd597f19606c1455d661f71a582d&quot;,
                    &quot;target&quot;: {
                        &quot;id&quot;: &quot;node76393dcfedcf73dbc726f1c4786d&quot;,
                        &quot;arrow&quot;: &quot;Left&quot;
                    }
                },
                {
                    &quot;source&quot;: {
                        &quot;id&quot;: &quot;node76393dcfedcf73dbc726f1c4786d&quot;,
                        &quot;arrow&quot;: &quot;Right&quot;
                    },
                    &quot;target&quot;: {
                        &quot;id&quot;: &quot;node375320830be9c46cd89f4069857d&quot;,
                        &quot;arrow&quot;: &quot;Left&quot;
                    },
                    &quot;id&quot;: &quot;linecf7b7f10c87187a88b72c5f91177&quot;
                }
            ],
            &quot;start_event&quot;: {
                &quot;incoming&quot;: &quot;&quot;,
                &quot;outgoing&quot;: &quot;linecd597f19606c1455d661f71a582d&quot;,
                &quot;type&quot;: &quot;EmptyStartEvent&quot;,
                &quot;id&quot;: &quot;node4e87796ddd76b0d59337b08f385d&quot;,
                &quot;name&quot;: &quot;&quot;
            },
            &quot;constants&quot;: {
                &quot;${bk_timing}&quot;: {
                    &quot;source_tag&quot;: &quot;sleep_timer.bk_timing&quot;,
                    &quot;source_info&quot;: {
                        &quot;node76393dcfedcf73dbc726f1c4786d&quot;: [
                            &quot;bk_timing&quot;
                        ]
                    },
                    &quot;name&quot;: &quot;定时时间&quot;,
                    &quot;index&quot;: 0,
                    &quot;custom_type&quot;: &quot;&quot;,
                    &quot;value&quot;: &quot;100&quot;,
                    &quot;show_type&quot;: &quot;show&quot;,
                    &quot;source_type&quot;: &quot;component_inputs&quot;,
                    &quot;key&quot;: &quot;${bk_timing}&quot;,
                    &quot;validation&quot;: &quot;&quot;,
                    &quot;desc&quot;: &quot;&quot;
                }
            },
            &quot;location&quot;: [
                {
                    &quot;y&quot;: 150,
                    &quot;x&quot;: 80,
                    &quot;type&quot;: &quot;startpoint&quot;,
                    &quot;id&quot;: &quot;node4e87796ddd76b0d59337b08f385d&quot;
                },
                {
                    &quot;y&quot;: 149,
                    &quot;x&quot;: 1092,
                    &quot;type&quot;: &quot;endpoint&quot;,
                    &quot;id&quot;: &quot;node375320830be9c46cd89f4069857d&quot;
                },
                {
                    &quot;stage_name&quot;: &quot;步骤1&quot;,
                    &quot;name&quot;: &quot;定时&quot;,
                    &quot;y&quot;: 133,
                    &quot;x&quot;: 300,
                    &quot;type&quot;: &quot;tasknode&quot;,
                    &quot;id&quot;: &quot;node76393dcfedcf73dbc726f1c4786d&quot;
                }
            ]
        },
        &quot;last_run_at&quot;: &quot;&quot;,
        &quot;enabled&quot;: false,
        &quot;id&quot;: 11,
        &quot;template_id&quot;: 2
    },
    &quot;result&quot;: true
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>true/false 操作是否成功</td>
</tr>
<tr>
<td>data</td>
<td>dict</td>
<td>result=true 时成功数据，详细信息请见下面说明</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>result=false 时错误信息</td>
</tr>
</tbody>
</table>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>cron</td>
<td>string</td>
<td>周期调度表达式</td>
</tr>
<tr>
<td>total_run_count</td>
<td>int</td>
<td>周期任务运行次数</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>周期任务名</td>
</tr>
<tr>
<td>creator</td>
<td>string</td>
<td>创建者</td>
</tr>
<tr>
<td>last_run_at</td>
<td>string</td>
<td>上次运行时间</td>
</tr>
<tr>
<td>enabled</td>
<td>bool</td>
<td>是否激活</td>
</tr>
<tr>
<td>id</td>
<td>int</td>
<td>周期任务 ID</td>
</tr>
<tr>
<td>template_id</td>
<td>string</td>
<td>用于创建该任务的模板 ID</td>
</tr>
<tr>
<td>form</td>
<td>dict</td>
<td>该周期任务的参数表单对象</td>
</tr>
<tr>
<td>pipeline_tree</td>
<td>dict</td>
<td>该周期任务的实例树</td>
</tr>
</tbody>
</table>
<h4 id="datapipeline_tree">data.pipeline_tree</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>start_event</td>
<td>dict</td>
<td>开始节点信息</td>
</tr>
<tr>
<td>end_event</td>
<td>dict</td>
<td>结束节点信息</td>
</tr>
<tr>
<td>activities</td>
<td>dict</td>
<td>任务节点（原子和子流程）信息</td>
</tr>
<tr>
<td>gateways</td>
<td>dict</td>
<td>网关节点（并行网关、分支网关和汇聚网关）信息</td>
</tr>
<tr>
<td>flows</td>
<td>dict</td>
<td>顺序流（节点连线）信息</td>
</tr>
<tr>
<td>constants</td>
<td>dict</td>
<td>全局变量信息，详情见下面</td>
</tr>
<tr>
<td>outputs</td>
<td>list</td>
<td>模板输出信息，标记 constants 中的输出字段</td>
</tr>
</tbody>
</table>
<h4 id="dataformkey-datapipeline_treeconstantskey">data.form.KEY, data.pipeline_tree.constants.KEY</h4>
<p>全局变量 KEY，${key} 格式</p>
<h4 id="dataformvalue-datapipeline_treeconstantsvalue">data.form.VALUE, data.pipeline_tree.constants.VALUE</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>key</td>
<td>string</td>
<td>同 KEY</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>变量名字</td>
</tr>
<tr>
<td>index</td>
<td>int</td>
<td>变量在模板中的显示顺序</td>
</tr>
<tr>
<td>desc</td>
<td>string</td>
<td>变量说明</td>
</tr>
<tr>
<td>source_type</td>
<td>string</td>
<td>变量来源, 取值范围 custom: 自定义变量，component_inputs: 从原子输入参数勾选，component_outputs：从原子输出结果中勾选</td>
</tr>
<tr>
<td>custom_type</td>
<td>string</td>
<td>source_type=custom 时有效，自定义变量类型， 取值范围 input: 输入框，textarea: 文本框，datetime: 日期时间，int: 整数</td>
</tr>
<tr>
<td>source_tag</td>
<td>string</td>
<td>source_type=component_inputs/component_outputs 时有效，变量的来源原子</td>
</tr>
<tr>
<td>source_info</td>
<td>dict</td>
<td>source_type=component_inputs/component_outputs 时有效，变量的来源节点信息</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/sops/create_task/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>通过流程模板创建任务</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>string</td>
<td>是</td>
<td>模板所属业务 ID</td>
</tr>
<tr>
<td>template_id</td>
<td>string</td>
<td>是</td>
<td>模板 ID</td>
</tr>
<tr>
<td>template_source</td>
<td>string</td>
<td>否</td>
<td>流程模板来源，business:默认值，业务流程，common：公共流程</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>是</td>
<td>任务名称</td>
</tr>
<tr>
<td>flow_type</td>
<td>string</td>
<td>否</td>
<td>任务流程类型，common: 常规流程，common_func：职能化流程</td>
</tr>
<tr>
<td>constants</td>
<td>dict</td>
<td>否</td>
<td>任务全局参数，详细信息见下面说明</td>
</tr>
<tr>
<td>exclude_task_nodes_id</td>
<td>list</td>
<td>否</td>
<td>跳过执行的节点 ID 列表</td>
</tr>
</tbody>
</table>
<h4 id="constantskey">constants.KEY</h4>
<p>变量 KEY，${key} 格式</p>
<h4 id="constantsvalue">constants.VALUE</h4>
<p>变量值，value 的类型和从模板获取的全局变量中 value 类型保持一致</p>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;name&quot;: &quot;tasktest&quot;,
    &quot;flow_type&quot;: &quot;common&quot;,
    &quot;constants&quot;: {
        &quot;${content}: &quot;echo 1&quot;,
        &quot;${params}&quot;: &quot;&quot;,
        &quot;${script_timeout}&quot;: 20
    }
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;result&quot;: true,
    &quot;data&quot;: {
        &quot;task_id&quot;: 10,
        &quot;task_url&quot;: &quot;http://bk_sops_host/taskflow/execute/3/?instance_id=15364&quot;,
        &quot;pipeline_tree&quot;: {
            &quot;activities&quot;: {
                &quot;node9b5ae13799d63e179f0ce3088b62&quot;: {
                    &quot;outgoing&quot;: &quot;line27bc7b4ccbcf37ddb9d1f6572a04&quot;,
                    &quot;incoming&quot;: &quot;line490caa49d2a03e64829693281032&quot;,
                    &quot;name&quot;: &quot;timing&quot;,
                    &quot;error_ignorable&quot;: false,
                    &quot;component&quot;: {
                        &quot;code&quot;: &quot;sleep_timer&quot;,
                        &quot;data&quot;: {
                            &quot;bk_timing&quot;: {
                                &quot;hook&quot;: false,
                                &quot;value&quot;: &quot;2&quot;
                            }
                        }
                    },
                    &quot;stage_name&quot;: &quot;步骤1&quot;,
                    &quot;can_retry&quot;: true,
                    &quot;isSkipped&quot;: true,
                    &quot;type&quot;: &quot;ServiceActivity&quot;,
                    &quot;optional&quot;: false,
                    &quot;id&quot;: &quot;node9b5ae13799d63e179f0ce3088b62&quot;,
                    &quot;loop&quot;: null
                },
                &quot;node880ded556c6c3c269be3cedc64b6&quot;: {
                    &quot;outgoing&quot;: &quot;line490caa49d2a03e64829693281032&quot;,
                    &quot;incoming&quot;: &quot;lineb83161d6e0593ad68d9ec73a961b&quot;,
                    &quot;name&quot;: &quot;暂停&quot;,
                    &quot;error_ignorable&quot;: false,
                    &quot;component&quot;: {
                        &quot;code&quot;: &quot;pause_node&quot;,
                        &quot;data&quot;: {}
                    },
                    &quot;stage_name&quot;: &quot;步骤1&quot;,
                    &quot;can_retry&quot;: true,
                    &quot;isSkipped&quot;: true,
                    &quot;type&quot;: &quot;ServiceActivity&quot;,
                    &quot;optional&quot;: true,
                    &quot;id&quot;: &quot;node880ded556c6c3c269be3cedc64b6&quot;,
                    &quot;loop&quot;: null
                }
            },
            &quot;end_event&quot;: {
                &quot;type&quot;: &quot;EmptyEndEvent&quot;,
                &quot;outgoing&quot;: &quot;&quot;,
                &quot;incoming&quot;: &quot;line27bc7b4ccbcf37ddb9d1f6572a04&quot;,
                &quot;id&quot;: &quot;node5c48f37aa9f0351e8b43ab6a2295&quot;,
                &quot;name&quot;: &quot;&quot;
            },
            &quot;outputs&quot;: [],
            &quot;flows&quot;: {
                &quot;line490caa49d2a03e64829693281032&quot;: {
                    &quot;is_default&quot;: false,
                    &quot;source&quot;: &quot;node880ded556c6c3c269be3cedc64b6&quot;,
                    &quot;id&quot;: &quot;line490caa49d2a03e64829693281032&quot;,
                    &quot;target&quot;: &quot;node9b5ae13799d63e179f0ce3088b62&quot;
                },
                &quot;lineb83161d6e0593ad68d9ec73a961b&quot;: {
                    &quot;is_default&quot;: false,
                    &quot;source&quot;: &quot;noded383bc1d7387391f889c6bab18b8&quot;,
                    &quot;id&quot;: &quot;lineb83161d6e0593ad68d9ec73a961b&quot;,
                    &quot;target&quot;: &quot;node880ded556c6c3c269be3cedc64b6&quot;
                },
                &quot;line27bc7b4ccbcf37ddb9d1f6572a04&quot;: {
                    &quot;is_default&quot;: false,
                    &quot;source&quot;: &quot;node9b5ae13799d63e179f0ce3088b62&quot;,
                    &quot;id&quot;: &quot;line27bc7b4ccbcf37ddb9d1f6572a04&quot;,
                    &quot;target&quot;: &quot;node5c48f37aa9f0351e8b43ab6a2295&quot;
                }
            },
            &quot;gateways&quot;: {},
            &quot;line&quot;: [
                {
                    &quot;source&quot;: {
                        &quot;id&quot;: &quot;node9b5ae13799d63e179f0ce3088b62&quot;,
                        &quot;arrow&quot;: &quot;Right&quot;
                    },
                    &quot;target&quot;: {
                        &quot;id&quot;: &quot;node5c48f37aa9f0351e8b43ab6a2295&quot;,
                        &quot;arrow&quot;: &quot;Left&quot;
                    },
                    &quot;id&quot;: &quot;line27bc7b4ccbcf37ddb9d1f6572a04&quot;
                },
                {
                    &quot;source&quot;: {
                        &quot;id&quot;: &quot;node880ded556c6c3c269be3cedc64b6&quot;,
                        &quot;arrow&quot;: &quot;Right&quot;
                    },
                    &quot;target&quot;: {
                        &quot;id&quot;: &quot;node9b5ae13799d63e179f0ce3088b62&quot;,
                        &quot;arrow&quot;: &quot;Left&quot;
                    },
                    &quot;id&quot;: &quot;line490caa49d2a03e64829693281032&quot;
                },
                {
                    &quot;source&quot;: {
                        &quot;id&quot;: &quot;noded383bc1d7387391f889c6bab18b8&quot;,
                        &quot;arrow&quot;: &quot;Right&quot;
                    },
                    &quot;id&quot;: &quot;lineb83161d6e0593ad68d9ec73a961b&quot;,
                    &quot;target&quot;: {
                        &quot;id&quot;: &quot;node880ded556c6c3c269be3cedc64b6&quot;,
                        &quot;arrow&quot;: &quot;Left&quot;
                    }
                }
            ],
            &quot;start_event&quot;: {
                &quot;type&quot;: &quot;EmptyStartEvent&quot;,
                &quot;outgoing&quot;: &quot;lineb83161d6e0593ad68d9ec73a961b&quot;,
                &quot;incoming&quot;: &quot;&quot;,
                &quot;id&quot;: &quot;noded383bc1d7387391f889c6bab18b8&quot;,
                &quot;name&quot;: &quot;&quot;
            },
            &quot;id&quot;: &quot;node7ef6970d06ad3bc092594cb5ec5f&quot;,
            &quot;constants&quot;: {},
            &quot;location&quot;: [
                {
                    &quot;stage_name&quot;: &quot;步骤1&quot;,
                    &quot;name&quot;: &quot;暂停&quot;,
                    &quot;y&quot;: 135,
                    &quot;x&quot;: 300,
                    &quot;type&quot;: &quot;tasknode&quot;,
                    &quot;id&quot;: &quot;node880ded556c6c3c269be3cedc64b6&quot;
                },
                {
                    &quot;y&quot;: 150,
                    &quot;x&quot;: 1000,
                    &quot;type&quot;: &quot;endpoint&quot;,
                    &quot;id&quot;: &quot;node5c48f37aa9f0351e8b43ab6a2295&quot;
                },
                {
                    &quot;stage_name&quot;: &quot;步骤1&quot;,
                    &quot;name&quot;: &quot;timing&quot;,
                    &quot;y&quot;: 135,
                    &quot;x&quot;: 595,
                    &quot;type&quot;: &quot;tasknode&quot;,
                    &quot;id&quot;: &quot;node9b5ae13799d63e179f0ce3088b62&quot;
                },
                {
                    &quot;y&quot;: 150,
                    &quot;x&quot;: 80,
                    &quot;type&quot;: &quot;startpoint&quot;,
                    &quot;id&quot;: &quot;noded383bc1d7387391f889c6bab18b8&quot;
                }
            ]
        }
    }
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>true/false 操作是否成功</td>
</tr>
<tr>
<td>data</td>
<td>dict</td>
<td>result=true 时成功数据，详细信息请见下面说明</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>result=false 时错误信息</td>
</tr>
</tbody>
</table>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>task_id</td>
<td>int</td>
<td>任务实例 ID</td>
</tr>
<tr>
<td>task_url</td>
<td>str</td>
<td>任务实例链接</td>
</tr>
<tr>
<td>pipeline_tree</td>
<td>dict</td>
<td>任务实例树</td>
</tr>
</tbody>
</table>
<h4 id="datapipeline_tree">data.pipeline_tree</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>start_event</td>
<td>dict</td>
<td>开始节点信息</td>
</tr>
<tr>
<td>end_event</td>
<td>dict</td>
<td>结束节点信息</td>
</tr>
<tr>
<td>activities</td>
<td>dict</td>
<td>任务节点（原子和子流程）信息</td>
</tr>
<tr>
<td>gateways</td>
<td>dict</td>
<td>网关节点（并行网关、分支网关和汇聚网关）信息</td>
</tr>
<tr>
<td>flows</td>
<td>dict</td>
<td>顺序流（节点连线）信息</td>
</tr>
<tr>
<td>constants</td>
<td>dict</td>
<td>全局变量信息，详情见下面</td>
</tr>
<tr>
<td>outputs</td>
<td>list</td>
<td>模板输出信息，标记 constants 中的输出字段</td>
</tr>
</tbody>
</table>
<h4 id="datapipeline_treeconstantskey">data.pipeline_tree.constants.KEY</h4>
<p>全局变量 KEY，${key} 格式</p>
<h4 id="datapipeline_treeconstantsvalue">data.pipeline_tree.constants.VALUE</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>key</td>
<td>string</td>
<td>同 KEY</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>变量名字</td>
</tr>
<tr>
<td>index</td>
<td>int</td>
<td>变量在模板中的显示顺序</td>
</tr>
<tr>
<td>desc</td>
<td>string</td>
<td>变量说明</td>
</tr>
<tr>
<td>source_type</td>
<td>string</td>
<td>变量来源, 取值范围 custom: 自定义变量，component_inputs: 从原子输入参数勾选，component_outputs：从原子输出结果中勾选</td>
</tr>
<tr>
<td>custom_type</td>
<td>string</td>
<td>source_type=custom 时有效，自定义变量类型， 取值范围 input: 输入框，textarea: 文本框，datetime: 日期时间，int: 整数</td>
</tr>
<tr>
<td>source_tag</td>
<td>string</td>
<td>source_type=component_inputs/component_outputs 时有效，变量的来源原子</td>
</tr>
<tr>
<td>source_info</td>
<td>dict</td>
<td>source_type=component_inputs/component_outputs 时有效，变量的来源节点信息</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/sops/fast_create_task/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>创建一次性任务</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>project_id</td>
<td>int</td>
<td>是</td>
<td>项目 ID</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>是</td>
<td>任务名称</td>
</tr>
<tr>
<td>pipeline_tree</td>
<td>dict</td>
<td>是</td>
<td>任务实例树，详细信息请见下面说明</td>
</tr>
<tr>
<td>flow_type</td>
<td>string</td>
<td>否</td>
<td>任务流程类型，common: 常规流程，common_func：职能化流程，默认值为 common</td>
</tr>
<tr>
<td>description</td>
<td>string</td>
<td>否</td>
<td>任务描述</td>
</tr>
<tr>
<td>category</td>
<td>string</td>
<td>否</td>
<td>任务分类，详细信息请见下面说明</td>
</tr>
</tbody>
</table>
<h4 id="category">category</h4>
<table>
<thead>
<tr>
<th>值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>OpsTools</td>
<td>运维工具</td>
</tr>
<tr>
<td>MonitorAlarm</td>
<td>监控告警</td>
</tr>
<tr>
<td>ConfManage</td>
<td>配置管理</td>
</tr>
<tr>
<td>DevTools</td>
<td>开发工具</td>
</tr>
<tr>
<td>EnterpriseIT</td>
<td>企业 IT</td>
</tr>
<tr>
<td>OfficeApp</td>
<td>办公应用</td>
</tr>
<tr>
<td>Other</td>
<td>其它</td>
</tr>
</tbody>
</table>
<h4 id="pipeline_tree">pipeline_tree</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>start_event</td>
<td>dict</td>
<td>是</td>
<td>开始节点，详细信息请见下面说明</td>
</tr>
<tr>
<td>end_event</td>
<td>dict</td>
<td>是</td>
<td>结束节点，详细信息请见下面说明</td>
</tr>
<tr>
<td>activities</td>
<td>dict</td>
<td>是</td>
<td>任务节点（标准插件和子流程），详细信息请见下面说明</td>
</tr>
<tr>
<td>flows</td>
<td>dict</td>
<td>是</td>
<td>顺序流（节点连线），详细信息请见下面说明</td>
</tr>
<tr>
<td>gateways</td>
<td>dict</td>
<td>否</td>
<td>网关节点（并行网关、分支网关和汇聚网关），详细信息请见下面说明</td>
</tr>
<tr>
<td>constants</td>
<td>dict</td>
<td>否</td>
<td>全局变量，详细信息请见下面说明</td>
</tr>
<tr>
<td>outputs</td>
<td>list</td>
<td>否</td>
<td>输出参数，标记 constants 中的输出字段</td>
</tr>
</tbody>
</table>
<h4 id="pipeline_treestart_event">pipeline_tree.start_event</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>string</td>
<td>是</td>
<td>开始节点 ID，在 pipeline_tree 所有 ID 中全局唯一</td>
</tr>
<tr>
<td>type</td>
<td>string</td>
<td>是</td>
<td>开始节点类型，当前只支持 EmptyStartEvent: 空开始类</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>是</td>
<td>开始节点名称，可为空</td>
</tr>
<tr>
<td>incoming</td>
<td>string</td>
<td>是</td>
<td>入度顺序流 ID，必须为空字符串</td>
</tr>
<tr>
<td>outgoing</td>
<td>string</td>
<td>是</td>
<td>出度顺序流 ID</td>
</tr>
</tbody>
</table>
<h4 id="pipeline_treeend_event">pipeline_tree.end_event</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>string</td>
<td>是</td>
<td>结束节点 ID，在 pipeline_tree 所有 ID 中全局唯一</td>
</tr>
<tr>
<td>type</td>
<td>string</td>
<td>是</td>
<td>结束节点类型，当前只支持 EmptyEndEvent：空结束类</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>是</td>
<td>结束节点名称，可为空</td>
</tr>
<tr>
<td>incoming</td>
<td>string</td>
<td>是</td>
<td>入度顺序流 ID</td>
</tr>
<tr>
<td>outgoing</td>
<td>string</td>
<td>是</td>
<td>出度顺序流 ID，必须为空字符串</td>
</tr>
</tbody>
</table>
<h4 id="pipeline_treeactivities-keypipeline_treeflows-keypipeline_treegateways-key">pipeline_tree.activities KEY、pipeline_tree.flows KEY、pipeline_tree.gateways KEY</h4>
<p>流程元素 ID，string 类型，在 pipeline_tree 所有 ID 中全局唯一，用来标识拓扑关系</p>
<h4 id="pipeline_treeactivities-value">pipeline_tree.activities VALUE</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>string</td>
<td>是</td>
<td>任务节点 ID，同 KEY 一致</td>
</tr>
<tr>
<td>type</td>
<td>string</td>
<td>是</td>
<td>任务节点类型，当前只支持 ServiceActivity：标准插件节点</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>是</td>
<td>任务节点名称</td>
</tr>
<tr>
<td>component</td>
<td>dict</td>
<td>是</td>
<td>插件配置，详细信息请见下面说明</td>
</tr>
<tr>
<td>error_ignorable</td>
<td>bool</td>
<td>是</td>
<td>节点失败是否自动忽略</td>
</tr>
<tr>
<td>retryable</td>
<td>bool</td>
<td>是</td>
<td>节点失败后是否可以重试，error_ignorable 为 true 时该参数无效</td>
</tr>
<tr>
<td>skippable</td>
<td>bool</td>
<td>是</td>
<td>节点失败后是否可以跳过，error_ignorable 为 true 时该参数无效</td>
</tr>
<tr>
<td>incoming</td>
<td>string</td>
<td>是</td>
<td>入度顺序流 ID</td>
</tr>
<tr>
<td>outgoing</td>
<td>string</td>
<td>是</td>
<td>出度顺序流 ID</td>
</tr>
<tr>
<td>stage_name</td>
<td>string</td>
<td>否</td>
<td>步骤分组名称</td>
</tr>
</tbody>
</table>
<h4 id="pipeline_treeactivities-valuecomponent">pipeline_tree.activities VALUE.component</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>code</td>
<td>string</td>
<td>是</td>
<td>标准插件编码</td>
</tr>
<tr>
<td>data</td>
<td>dict</td>
<td>是</td>
<td>标准插件输入参数</td>
</tr>
</tbody>
</table>
<h4 id="pipeline_treeflows-value">pipeline_tree.flows VALUE</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>string</td>
<td>是</td>
<td>顺序流 ID，同 KEY 一致</td>
</tr>
<tr>
<td>is_default</td>
<td>bool</td>
<td>是</td>
<td>是否默认分支</td>
</tr>
<tr>
<td>source</td>
<td>string</td>
<td>是</td>
<td>来源节点 ID</td>
</tr>
<tr>
<td>target</td>
<td>string</td>
<td>是</td>
<td>目的节点 ID</td>
</tr>
</tbody>
</table>
<h4 id="pipeline_treegateways-value">pipeline_tree.gateways VALUE</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>string</td>
<td>是</td>
<td>网关节点 ID，同 KEY 一致</td>
</tr>
<tr>
<td>type</td>
<td>string</td>
<td>是</td>
<td>网关类型，ParallelGateway：并行网关，ExclusiveGateway：分支网关，ConvergeGateway：汇聚网关</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>是</td>
<td>网关节点名称，可为空</td>
</tr>
<tr>
<td>incoming</td>
<td>string/list</td>
<td>是</td>
<td>入度顺序流 ID，type 为 ConvergeGateway 时是 list，否则是 string</td>
</tr>
<tr>
<td>outgoing</td>
<td>string/list</td>
<td>是</td>
<td>出度顺序流 ID，type 为 ConvergeGateway 时是 string，否则是 list</td>
</tr>
<tr>
<td>conditions</td>
<td>dict</td>
<td>否</td>
<td>分支条件，type 为 ExclusiveGateway 必填， 详细信息请见下面说明</td>
</tr>
</tbody>
</table>
<h4 id="pipeline_treegateways-valueconditions-key">pipeline_tree.gateways VALUE.conditions KEY</h4>
<p>网关出度顺序流 ID，和 outgoing 列表中一一对应</p>
<h4 id="pipeline_treegateways-valueconditions-value">pipeline_tree.gateways VALUE.conditions VALUE</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>evaluate</td>
<td>string</td>
<td>是</td>
<td>分支表达式，支持的语法请参考产品白皮书等文档</td>
</tr>
</tbody>
</table>
<h4 id="pipeline_treeconstants-key">pipeline_tree.constants KEY</h4>
<p>全局变量 KEY，"${key}" 格式</p>
<h4 id="pipeline_treeconstants-value">pipeline_tree.constants VALUE</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>key</td>
<td>string</td>
<td>是</td>
<td>同 KEY 一致</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>是</td>
<td>变量名字</td>
</tr>
<tr>
<td>index</td>
<td>int</td>
<td>是</td>
<td>变量在任务中的显示顺序</td>
</tr>
<tr>
<td>desc</td>
<td>string</td>
<td>是</td>
<td>变量说明</td>
</tr>
<tr>
<td>source_type</td>
<td>string</td>
<td>是</td>
<td>变量来源, 取值范围 custom: 自定义变量，component_inputs: 从标准插件输入参数勾选，component_outputs：从标准插件输出结果中勾选</td>
</tr>
<tr>
<td>custom_type</td>
<td>string</td>
<td>是</td>
<td>source_type=custom 时有效，自定义变量类型， 取值范围 input: 输入框，textarea: 文本框，datetime: 日期时间，int: 整数</td>
</tr>
<tr>
<td>source_tag</td>
<td>string</td>
<td>是</td>
<td>source_type=component_inputs 或 component_outputs 时有效，变量的来源插件和 Tag</td>
</tr>
<tr>
<td>source_info</td>
<td>dict</td>
<td>是</td>
<td>source_type=component_inputs 或 component_outputs 时有效，变量的来源节点信息</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;name&quot;: &quot;tasktest&quot;,
    &quot;flow_type&quot;: &quot;common&quot;,
    &quot;pipeline_tree&quot;：{
        &quot;start_event&quot;: {
            &quot;incoming&quot;: &quot;&quot;,
            &quot;outgoing&quot;: &quot;line7ed74aa679d19063b6d7037ce6db&quot;,
            &quot;type&quot;: &quot;EmptyStartEvent&quot;,
            &quot;id&quot;: &quot;node20cbeaa5379d08e8d8ed7bb44fdc&quot;,
            &quot;name&quot;: &quot;&quot;
        },
        &quot;activities&quot;: {
            &quot;node5310ec36c0364d3094d515f8f5ef&quot;: {
                &quot;outgoing&quot;: &quot;linec02d1e77e1076aa9c7c2c57238e4&quot;,
                &quot;incoming&quot;: &quot;line7ed74aa679d19063b6d7037ce6db&quot;,
                &quot;name&quot;: &quot;node1&quot;,
                &quot;error_ignorable&quot;: false,
                &quot;component&quot;: {
                    &quot;code&quot;: &quot;sleep_timer&quot;,
                    &quot;data&quot;: {
                        &quot;bk_timing&quot;: {
                            &quot;hook&quot;: true,
                            &quot;value&quot;: &quot;${bk_timing}&quot;
                        }
                    }
                },
                &quot;stage_name&quot;: &quot;stage1&quot;,
                &quot;retryable&quot;: true,
                &quot;skippable&quot;: true,
                &quot;type&quot;: &quot;ServiceActivity&quot;,
                &quot;id&quot;: &quot;node5310ec36c0364d3094d515f8f5ef&quot;
            },
            &quot;node2bf42efcebe266706c3e21326dc4&quot;: {
                &quot;outgoing&quot;: &quot;linef0deadac69f769440a1b0e32587e&quot;,
                &quot;incoming&quot;: &quot;line7587c8804d34a091dae3d321f081&quot;,
                &quot;name&quot;: &quot;node2&quot;,
                &quot;error_ignorable&quot;: false,
                &quot;component&quot;: {
                    &quot;code&quot;: &quot;sleep_timer&quot;,
                    &quot;data&quot;: {
                        &quot;bk_timing&quot;: {
                            &quot;hook&quot;: true,
                            &quot;value&quot;: &quot;${bk_timing}&quot;
                        }
                    }
                },
                &quot;stage_name&quot;: &quot;stage2&quot;,
                &quot;retryable&quot;: true,
                &quot;skippable&quot;: true,
                &quot;type&quot;: &quot;ServiceActivity&quot;,
                &quot;id&quot;: &quot;node2bf42efcebe266706c3e21326dc4&quot;
            },
            &quot;node3c7dcf31454c1e9bdc9cf1cdeacc&quot;: {
                &quot;outgoing&quot;: &quot;linebf8f91c96a8f4eb3794ca5eb9881&quot;,
                &quot;incoming&quot;: &quot;line429f64cdec5d20f368611e621ef5&quot;,
                &quot;name&quot;: &quot;node3&quot;,
                &quot;error_ignorable&quot;: false,
                &quot;component&quot;: {
                    &quot;code&quot;: &quot;sleep_timer&quot;,
                    &quot;data&quot;: {
                        &quot;bk_timing&quot;: {
                            &quot;hook&quot;: false,
                            &quot;value&quot;: &quot;3&quot;
                        }
                    }
                },
                &quot;stage_name&quot;: &quot;stage3&quot;,
                &quot;retryable&quot;: true,
                &quot;skippable&quot;: true,
                &quot;type&quot;: &quot;ServiceActivity&quot;,
                &quot;id&quot;: &quot;node3c7dcf31454c1e9bdc9cf1cdeacc&quot;
            },
            &quot;nodedb1478a75c13f90cc400f5379949&quot;: {
                &quot;outgoing&quot;: &quot;line24d28a3f9f80e23e4a4fab7c4ffd&quot;,
                &quot;incoming&quot;: &quot;linec43c77f26af408748a9c194dbcfe&quot;,
                &quot;name&quot;: &quot;node4&quot;,
                &quot;error_ignorable&quot;: false,
                &quot;component&quot;: {
                    &quot;code&quot;: &quot;sleep_timer&quot;,
                    &quot;data&quot;: {
                        &quot;bk_timing&quot;: {
                            &quot;hook&quot;: true,
                            &quot;value&quot;: &quot;${bk_timing}&quot;
                        }
                    }
                },
                &quot;stage_name&quot;: &quot;stage3&quot;,
                &quot;retryable&quot;: true,
                &quot;skippable&quot;: true,
                &quot;type&quot;: &quot;ServiceActivity&quot;,
                &quot;id&quot;: &quot;nodedb1478a75c13f90cc400f5379949&quot;
            }
        },
        &quot;end_event&quot;: {
            &quot;incoming&quot;: &quot;line6ea858554964a04d868cead4435a&quot;,
            &quot;outgoing&quot;: &quot;&quot;,
            &quot;type&quot;: &quot;EmptyEndEvent&quot;,
            &quot;id&quot;: &quot;nodebe0db4ad30cc1723c7ede37b4b5f&quot;,
            &quot;name&quot;: &quot;&quot;
        },
        &quot;flows&quot;: {
            &quot;line24d28a3f9f80e23e4a4fab7c4ffd&quot;: {
                &quot;is_default&quot;: false,
                &quot;source&quot;: &quot;nodedb1478a75c13f90cc400f5379949&quot;,
                &quot;id&quot;: &quot;line24d28a3f9f80e23e4a4fab7c4ffd&quot;,
                &quot;target&quot;: &quot;node947e423b22e49aeb77bc77528bc0&quot;
            },
            &quot;linebf8f91c96a8f4eb3794ca5eb9881&quot;: {
                &quot;is_default&quot;: false,
                &quot;source&quot;: &quot;node3c7dcf31454c1e9bdc9cf1cdeacc&quot;,
                &quot;id&quot;: &quot;linebf8f91c96a8f4eb3794ca5eb9881&quot;,
                &quot;target&quot;: &quot;node947e423b22e49aeb77bc77528bc0&quot;
            },
            &quot;line7587c8804d34a091dae3d321f081&quot;: {
                &quot;is_default&quot;: false,
                &quot;source&quot;: &quot;node0863aab8325b84cfa3e5db52dc61&quot;,
                &quot;id&quot;: &quot;line7587c8804d34a091dae3d321f081&quot;,
                &quot;target&quot;: &quot;node2bf42efcebe266706c3e21326dc4&quot;
            },
            &quot;line429f64cdec5d20f368611e621ef5&quot;: {
                &quot;is_default&quot;: false,
                &quot;source&quot;: &quot;node7e97af0f55fb64276e067951dd9d&quot;,
                &quot;id&quot;: &quot;line429f64cdec5d20f368611e621ef5&quot;,
                &quot;target&quot;: &quot;node3c7dcf31454c1e9bdc9cf1cdeacc&quot;
            },
            &quot;line6ea858554964a04d868cead4435a&quot;: {
                &quot;is_default&quot;: false,
                &quot;source&quot;: &quot;node2b6f3285cfb3961c72834bafbe1b&quot;,
                &quot;id&quot;: &quot;line6ea858554964a04d868cead4435a&quot;,
                &quot;target&quot;: &quot;nodebe0db4ad30cc1723c7ede37b4b5f&quot;
            },
            &quot;line9dd9c8dbbad90943f268442ab7e0&quot;: {
                &quot;is_default&quot;: false,
                &quot;source&quot;: &quot;node0863aab8325b84cfa3e5db52dc61&quot;,
                &quot;id&quot;: &quot;line9dd9c8dbbad90943f268442ab7e0&quot;,
                &quot;target&quot;: &quot;node7e97af0f55fb64276e067951dd9d&quot;
            },
            &quot;lineabc279d9be88eb98285132ba5b75&quot;: {
                &quot;is_default&quot;: false,
                &quot;source&quot;: &quot;node947e423b22e49aeb77bc77528bc0&quot;,
                &quot;id&quot;: &quot;lineabc279d9be88eb98285132ba5b75&quot;,
                &quot;target&quot;: &quot;node2b6f3285cfb3961c72834bafbe1b&quot;
            },
            &quot;linef0deadac69f769440a1b0e32587e&quot;: {
                &quot;is_default&quot;: false,
                &quot;source&quot;: &quot;node2bf42efcebe266706c3e21326dc4&quot;,
                &quot;id&quot;: &quot;linef0deadac69f769440a1b0e32587e&quot;,
                &quot;target&quot;: &quot;node2b6f3285cfb3961c72834bafbe1b&quot;
            },
            &quot;linec02d1e77e1076aa9c7c2c57238e4&quot;: {
                &quot;is_default&quot;: false,
                &quot;source&quot;: &quot;node5310ec36c0364d3094d515f8f5ef&quot;,
                &quot;id&quot;: &quot;linec02d1e77e1076aa9c7c2c57238e4&quot;,
                &quot;target&quot;: &quot;node0863aab8325b84cfa3e5db52dc61&quot;
            },
            &quot;line7ed74aa679d19063b6d7037ce6db&quot;: {
                &quot;is_default&quot;: false,
                &quot;source&quot;: &quot;node20cbeaa5379d08e8d8ed7bb44fdc&quot;,
                &quot;id&quot;: &quot;line7ed74aa679d19063b6d7037ce6db&quot;,
                &quot;target&quot;: &quot;node5310ec36c0364d3094d515f8f5ef&quot;
            },
            &quot;linec43c77f26af408748a9c194dbcfe&quot;: {
                &quot;is_default&quot;: false,
                &quot;source&quot;: &quot;node7e97af0f55fb64276e067951dd9d&quot;,
                &quot;id&quot;: &quot;linec43c77f26af408748a9c194dbcfe&quot;,
                &quot;target&quot;: &quot;nodedb1478a75c13f90cc400f5379949&quot;
            }
        },
        &quot;gateways&quot;: {
            &quot;node2b6f3285cfb3961c72834bafbe1b&quot;: {
                &quot;incoming&quot;: [&quot;linef0deadac69f769440a1b0e32587e&quot;, &quot;lineabc279d9be88eb98285132ba5b75&quot;],
                &quot;outgoing&quot;: &quot;line6ea858554964a04d868cead4435a&quot;,
                &quot;type&quot;: &quot;ConvergeGateway&quot;,
                &quot;id&quot;: &quot;node2b6f3285cfb3961c72834bafbe1b&quot;,
                &quot;name&quot;: &quot;&quot;
            },
            &quot;node0863aab8325b84cfa3e5db52dc61&quot;: {
                &quot;outgoing&quot;: [&quot;line7587c8804d34a091dae3d321f081&quot;, &quot;line9dd9c8dbbad90943f268442ab7e0&quot;],
                &quot;incoming&quot;: &quot;linec02d1e77e1076aa9c7c2c57238e4&quot;,
                &quot;name&quot;: &quot;&quot;,
                &quot;type&quot;: &quot;ExclusiveGateway&quot;,
                &quot;conditions&quot;: {
                    &quot;line9dd9c8dbbad90943f268442ab7e0&quot;: {
                        &quot;evaluate&quot;: &quot;${bk_timing} &lt;= 10&quot;
                    },
                    &quot;line7587c8804d34a091dae3d321f081&quot;: {
                        &quot;evaluate&quot;: &quot;${bk_timing} &gt; 10&quot;
                    }
                },
                &quot;id&quot;: &quot;node0863aab8325b84cfa3e5db52dc61&quot;
            },
            &quot;node947e423b22e49aeb77bc77528bc0&quot;: {
                &quot;incoming&quot;: [&quot;linebf8f91c96a8f4eb3794ca5eb9881&quot;, &quot;line24d28a3f9f80e23e4a4fab7c4ffd&quot;],
                &quot;outgoing&quot;: &quot;lineabc279d9be88eb98285132ba5b75&quot;,
                &quot;type&quot;: &quot;ConvergeGateway&quot;,
                &quot;id&quot;: &quot;node947e423b22e49aeb77bc77528bc0&quot;,
                &quot;name&quot;: &quot;&quot;
            },
            &quot;node7e97af0f55fb64276e067951dd9d&quot;: {
                &quot;incoming&quot;: &quot;line9dd9c8dbbad90943f268442ab7e0&quot;,
                &quot;outgoing&quot;: [&quot;line429f64cdec5d20f368611e621ef5&quot;, &quot;linec43c77f26af408748a9c194dbcfe&quot;],
                &quot;type&quot;: &quot;ParallelGateway&quot;,
                &quot;id&quot;: &quot;node7e97af0f55fb64276e067951dd9d&quot;,
                &quot;name&quot;: &quot;&quot;
            }
        },
        &quot;constants&quot;: {
            &quot;${bk_timing}&quot;: {
                &quot;source_tag&quot;: &quot;sleep_timer.bk_timing&quot;,
                &quot;source_info&quot;: {
                    &quot;node5310ec36c0364d3094d515f8f5ef&quot;: [&quot;bk_timing&quot;],
                    &quot;node2bf42efcebe266706c3e21326dc4&quot;: [&quot;bk_timing&quot;],
                    &quot;nodedb1478a75c13f90cc400f5379949&quot;: [&quot;bk_timing&quot;]
                },
                &quot;name&quot;: &quot;timing&quot;,
                &quot;index&quot;: 0,
                &quot;custom_type&quot;: &quot;&quot;,
                &quot;value&quot;: &quot;1&quot;,
                &quot;show_type&quot;: &quot;show&quot;,
                &quot;source_type&quot;: &quot;component_inputs&quot;,
                &quot;key&quot;: &quot;${bk_timing}&quot;,
                &quot;desc&quot;: &quot;&quot;
            }
        },
        &quot;outputs&quot;: [&quot;${bk_timing}&quot;]
    }
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;result&quot;: true,
    &quot;data&quot;: {
        &quot;task_id&quot;: 10,
        &quot;task_url&quot;: &quot;http://bk_sops_host/taskflow/execute/3/?instance_id=10&quot;,
        &quot;pipeline_tree&quot;: {
            &quot;start_event&quot;: {
                &quot;incoming&quot;: &quot;&quot;,
                &quot;outgoing&quot;: &quot;line7ed74aa679d19063b6d7037ce6db&quot;,
                &quot;type&quot;: &quot;EmptyStartEvent&quot;,
                &quot;id&quot;: &quot;node20cbeaa5379d08e8d8ed7bb44fdc&quot;,
                &quot;name&quot;: &quot;&quot;
            },
            &quot;activities&quot;: {
                &quot;node5310ec36c0364d3094d515f8f5ef&quot;: {
                    &quot;outgoing&quot;: &quot;linec02d1e77e1076aa9c7c2c57238e4&quot;,
                    &quot;incoming&quot;: &quot;line7ed74aa679d19063b6d7037ce6db&quot;,
                    &quot;name&quot;: &quot;node1&quot;,
                    &quot;error_ignorable&quot;: false,
                    &quot;component&quot;: {
                        &quot;code&quot;: &quot;sleep_timer&quot;,
                        &quot;data&quot;: {
                            &quot;bk_timing&quot;: {
                                &quot;hook&quot;: true,
                                &quot;value&quot;: &quot;${bk_timing}&quot;
                            }
                        }
                    },
                    &quot;stage_name&quot;: &quot;stage1&quot;,
                    &quot;retryable&quot;: true,
                    &quot;skippable&quot;: true,
                    &quot;type&quot;: &quot;ServiceActivity&quot;,
                    &quot;id&quot;: &quot;node5310ec36c0364d3094d515f8f5ef&quot;
                },
                &quot;node2bf42efcebe266706c3e21326dc4&quot;: {
                    &quot;outgoing&quot;: &quot;linef0deadac69f769440a1b0e32587e&quot;,
                    &quot;incoming&quot;: &quot;line7587c8804d34a091dae3d321f081&quot;,
                    &quot;name&quot;: &quot;node2&quot;,
                    &quot;error_ignorable&quot;: false,
                    &quot;component&quot;: {
                        &quot;code&quot;: &quot;sleep_timer&quot;,
                        &quot;data&quot;: {
                            &quot;bk_timing&quot;: {
                                &quot;hook&quot;: true,
                                &quot;value&quot;: &quot;${bk_timing}&quot;
                            }
                        }
                    },
                    &quot;stage_name&quot;: &quot;stage2&quot;,
                    &quot;retryable&quot;: true,
                    &quot;skippable&quot;: true,
                    &quot;type&quot;: &quot;ServiceActivity&quot;,
                    &quot;id&quot;: &quot;node2bf42efcebe266706c3e21326dc4&quot;
                },
                &quot;node3c7dcf31454c1e9bdc9cf1cdeacc&quot;: {
                    &quot;outgoing&quot;: &quot;linebf8f91c96a8f4eb3794ca5eb9881&quot;,
                    &quot;incoming&quot;: &quot;line429f64cdec5d20f368611e621ef5&quot;,
                    &quot;name&quot;: &quot;node3&quot;,
                    &quot;error_ignorable&quot;: false,
                    &quot;component&quot;: {
                        &quot;code&quot;: &quot;sleep_timer&quot;,
                        &quot;data&quot;: {
                            &quot;bk_timing&quot;: {
                                &quot;hook&quot;: false,
                                &quot;value&quot;: &quot;3&quot;
                            }
                        }
                    },
                    &quot;stage_name&quot;: &quot;stage3&quot;,
                    &quot;retryable&quot;: true,
                    &quot;skippable&quot;: true,
                    &quot;type&quot;: &quot;ServiceActivity&quot;,
                    &quot;id&quot;: &quot;node3c7dcf31454c1e9bdc9cf1cdeacc&quot;
                },
                &quot;nodedb1478a75c13f90cc400f5379949&quot;: {
                    &quot;outgoing&quot;: &quot;line24d28a3f9f80e23e4a4fab7c4ffd&quot;,
                    &quot;incoming&quot;: &quot;linec43c77f26af408748a9c194dbcfe&quot;,
                    &quot;name&quot;: &quot;node4&quot;,
                    &quot;error_ignorable&quot;: false,
                    &quot;component&quot;: {
                        &quot;code&quot;: &quot;sleep_timer&quot;,
                        &quot;data&quot;: {
                            &quot;bk_timing&quot;: {
                                &quot;hook&quot;: true,
                                &quot;value&quot;: &quot;${bk_timing}&quot;
                            }
                        }
                    },
                    &quot;stage_name&quot;: &quot;stage3&quot;,
                    &quot;retryable&quot;: true,
                    &quot;skippable&quot;: true,
                    &quot;type&quot;: &quot;ServiceActivity&quot;,
                    &quot;id&quot;: &quot;nodedb1478a75c13f90cc400f5379949&quot;
                }
            },
            &quot;end_event&quot;: {
                &quot;incoming&quot;: &quot;line6ea858554964a04d868cead4435a&quot;,
                &quot;outgoing&quot;: &quot;&quot;,
                &quot;type&quot;: &quot;EmptyEndEvent&quot;,
                &quot;id&quot;: &quot;nodebe0db4ad30cc1723c7ede37b4b5f&quot;,
                &quot;name&quot;: &quot;&quot;
            },
            &quot;flows&quot;: {
                &quot;line24d28a3f9f80e23e4a4fab7c4ffd&quot;: {
                    &quot;is_default&quot;: false,
                    &quot;source&quot;: &quot;nodedb1478a75c13f90cc400f5379949&quot;,
                    &quot;id&quot;: &quot;line24d28a3f9f80e23e4a4fab7c4ffd&quot;,
                    &quot;target&quot;: &quot;node947e423b22e49aeb77bc77528bc0&quot;
                },
                &quot;linebf8f91c96a8f4eb3794ca5eb9881&quot;: {
                    &quot;is_default&quot;: false,
                    &quot;source&quot;: &quot;node3c7dcf31454c1e9bdc9cf1cdeacc&quot;,
                    &quot;id&quot;: &quot;linebf8f91c96a8f4eb3794ca5eb9881&quot;,
                    &quot;target&quot;: &quot;node947e423b22e49aeb77bc77528bc0&quot;
                },
                &quot;line7587c8804d34a091dae3d321f081&quot;: {
                    &quot;is_default&quot;: false,
                    &quot;source&quot;: &quot;node0863aab8325b84cfa3e5db52dc61&quot;,
                    &quot;id&quot;: &quot;line7587c8804d34a091dae3d321f081&quot;,
                    &quot;target&quot;: &quot;node2bf42efcebe266706c3e21326dc4&quot;
                },
                &quot;line429f64cdec5d20f368611e621ef5&quot;: {
                    &quot;is_default&quot;: false,
                    &quot;source&quot;: &quot;node7e97af0f55fb64276e067951dd9d&quot;,
                    &quot;id&quot;: &quot;line429f64cdec5d20f368611e621ef5&quot;,
                    &quot;target&quot;: &quot;node3c7dcf31454c1e9bdc9cf1cdeacc&quot;
                },
                &quot;line6ea858554964a04d868cead4435a&quot;: {
                    &quot;is_default&quot;: false,
                    &quot;source&quot;: &quot;node2b6f3285cfb3961c72834bafbe1b&quot;,
                    &quot;id&quot;: &quot;line6ea858554964a04d868cead4435a&quot;,
                    &quot;target&quot;: &quot;nodebe0db4ad30cc1723c7ede37b4b5f&quot;
                },
                &quot;line9dd9c8dbbad90943f268442ab7e0&quot;: {
                    &quot;is_default&quot;: false,
                    &quot;source&quot;: &quot;node0863aab8325b84cfa3e5db52dc61&quot;,
                    &quot;id&quot;: &quot;line9dd9c8dbbad90943f268442ab7e0&quot;,
                    &quot;target&quot;: &quot;node7e97af0f55fb64276e067951dd9d&quot;
                },
                &quot;lineabc279d9be88eb98285132ba5b75&quot;: {
                    &quot;is_default&quot;: false,
                    &quot;source&quot;: &quot;node947e423b22e49aeb77bc77528bc0&quot;,
                    &quot;id&quot;: &quot;lineabc279d9be88eb98285132ba5b75&quot;,
                    &quot;target&quot;: &quot;node2b6f3285cfb3961c72834bafbe1b&quot;
                },
                &quot;linef0deadac69f769440a1b0e32587e&quot;: {
                    &quot;is_default&quot;: false,
                    &quot;source&quot;: &quot;node2bf42efcebe266706c3e21326dc4&quot;,
                    &quot;id&quot;: &quot;linef0deadac69f769440a1b0e32587e&quot;,
                    &quot;target&quot;: &quot;node2b6f3285cfb3961c72834bafbe1b&quot;
                },
                &quot;linec02d1e77e1076aa9c7c2c57238e4&quot;: {
                    &quot;is_default&quot;: false,
                    &quot;source&quot;: &quot;node5310ec36c0364d3094d515f8f5ef&quot;,
                    &quot;id&quot;: &quot;linec02d1e77e1076aa9c7c2c57238e4&quot;,
                    &quot;target&quot;: &quot;node0863aab8325b84cfa3e5db52dc61&quot;
                },
                &quot;line7ed74aa679d19063b6d7037ce6db&quot;: {
                    &quot;is_default&quot;: false,
                    &quot;source&quot;: &quot;node20cbeaa5379d08e8d8ed7bb44fdc&quot;,
                    &quot;id&quot;: &quot;line7ed74aa679d19063b6d7037ce6db&quot;,
                    &quot;target&quot;: &quot;node5310ec36c0364d3094d515f8f5ef&quot;
                },
                &quot;linec43c77f26af408748a9c194dbcfe&quot;: {
                    &quot;is_default&quot;: false,
                    &quot;source&quot;: &quot;node7e97af0f55fb64276e067951dd9d&quot;,
                    &quot;id&quot;: &quot;linec43c77f26af408748a9c194dbcfe&quot;,
                    &quot;target&quot;: &quot;nodedb1478a75c13f90cc400f5379949&quot;
                }
            },
            &quot;gateways&quot;: {
                &quot;node2b6f3285cfb3961c72834bafbe1b&quot;: {
                    &quot;incoming&quot;: [&quot;linef0deadac69f769440a1b0e32587e&quot;, &quot;lineabc279d9be88eb98285132ba5b75&quot;],
                    &quot;outgoing&quot;: &quot;line6ea858554964a04d868cead4435a&quot;,
                    &quot;type&quot;: &quot;ConvergeGateway&quot;,
                    &quot;id&quot;: &quot;node2b6f3285cfb3961c72834bafbe1b&quot;,
                    &quot;name&quot;: &quot;&quot;
                },
                &quot;node0863aab8325b84cfa3e5db52dc61&quot;: {
                    &quot;outgoing&quot;: [&quot;line7587c8804d34a091dae3d321f081&quot;, &quot;line9dd9c8dbbad90943f268442ab7e0&quot;],
                    &quot;incoming&quot;: &quot;linec02d1e77e1076aa9c7c2c57238e4&quot;,
                    &quot;name&quot;: &quot;&quot;,
                    &quot;type&quot;: &quot;ExclusiveGateway&quot;,
                    &quot;conditions&quot;: {
                        &quot;line9dd9c8dbbad90943f268442ab7e0&quot;: {
                            &quot;evaluate&quot;: &quot;${bk_timing} &lt;= 10&quot;
                        },
                        &quot;line7587c8804d34a091dae3d321f081&quot;: {
                            &quot;evaluate&quot;: &quot;${bk_timing} &gt; 10&quot;
                        }
                    },
                    &quot;id&quot;: &quot;node0863aab8325b84cfa3e5db52dc61&quot;
                },
                &quot;node947e423b22e49aeb77bc77528bc0&quot;: {
                    &quot;incoming&quot;: [&quot;linebf8f91c96a8f4eb3794ca5eb9881&quot;, &quot;line24d28a3f9f80e23e4a4fab7c4ffd&quot;],
                    &quot;outgoing&quot;: &quot;lineabc279d9be88eb98285132ba5b75&quot;,
                    &quot;type&quot;: &quot;ConvergeGateway&quot;,
                    &quot;id&quot;: &quot;node947e423b22e49aeb77bc77528bc0&quot;,
                    &quot;name&quot;: &quot;&quot;
                },
                &quot;node7e97af0f55fb64276e067951dd9d&quot;: {
                    &quot;incoming&quot;: &quot;line9dd9c8dbbad90943f268442ab7e0&quot;,
                    &quot;outgoing&quot;: [&quot;line429f64cdec5d20f368611e621ef5&quot;, &quot;linec43c77f26af408748a9c194dbcfe&quot;],
                    &quot;type&quot;: &quot;ParallelGateway&quot;,
                    &quot;id&quot;: &quot;node7e97af0f55fb64276e067951dd9d&quot;,
                    &quot;name&quot;: &quot;&quot;
                }
            },
            &quot;constants&quot;: {
                &quot;${bk_timing}&quot;: {
                    &quot;source_tag&quot;: &quot;sleep_timer.bk_timing&quot;,
                    &quot;source_info&quot;: {
                        &quot;node5310ec36c0364d3094d515f8f5ef&quot;: [&quot;bk_timing&quot;],
                        &quot;node2bf42efcebe266706c3e21326dc4&quot;: [&quot;bk_timing&quot;],
                        &quot;nodedb1478a75c13f90cc400f5379949&quot;: [&quot;bk_timing&quot;]
                    },
                    &quot;name&quot;: &quot;timing&quot;,
                    &quot;index&quot;: 0,
                    &quot;custom_type&quot;: &quot;&quot;,
                    &quot;value&quot;: &quot;1&quot;,
                    &quot;show_type&quot;: &quot;show&quot;,
                    &quot;source_type&quot;: &quot;component_inputs&quot;,
                    &quot;key&quot;: &quot;${bk_timing}&quot;,
                    &quot;desc&quot;: &quot;&quot;
                }
            },
            &quot;outputs&quot;: [&quot;${bk_timing}&quot;]
        }
    }
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>true/false 操作是否成功</td>
</tr>
<tr>
<td>data</td>
<td>dict</td>
<td>result=true 时成功数据，详细信息请见下面说明</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>result=false 时错误信息</td>
</tr>
</tbody>
</table>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>task_id</td>
<td>int</td>
<td>任务实例 ID</td>
</tr>
<tr>
<td>task_url</td>
<td>string</td>
<td>任务实例链接</td>
</tr>
<tr>
<td>pipeline_tree</td>
<td>dict</td>
<td>任务实例树</td>
</tr>
</tbody>
</table>
<h4 id="datapipeline_tree">data.pipeline_tree</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>start_event</td>
<td>dict</td>
<td>开始节点信息</td>
</tr>
<tr>
<td>end_event</td>
<td>dict</td>
<td>结束节点信息</td>
</tr>
<tr>
<td>activities</td>
<td>dict</td>
<td>任务节点（原子和子流程）信息</td>
</tr>
<tr>
<td>gateways</td>
<td>dict</td>
<td>网关节点（并行网关、分支网关和汇聚网关）信息</td>
</tr>
<tr>
<td>flows</td>
<td>dict</td>
<td>顺序流（节点连线）信息</td>
</tr>
<tr>
<td>constants</td>
<td>dict</td>
<td>全局变量信息，详情见下面</td>
</tr>
<tr>
<td>outputs</td>
<td>list</td>
<td>模板输出信息，标记 constants 中的输出字段</td>
</tr>
</tbody>
</table>
<h4 id="dataformkey-datapipeline_treeconstantskey">data.form.KEY, data.pipeline_tree.constants.KEY</h4>
<p>全局变量 KEY，${key} 格式</p>
<h4 id="dataformvalue-datapipeline_treeconstantsvalue">data.form.VALUE, data.pipeline_tree.constants.VALUE</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>key</td>
<td>string</td>
<td>同 KEY</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>变量名字</td>
</tr>
<tr>
<td>index</td>
<td>int</td>
<td>变量在模板中的显示顺序</td>
</tr>
<tr>
<td>desc</td>
<td>string</td>
<td>变量说明</td>
</tr>
<tr>
<td>source_type</td>
<td>string</td>
<td>变量来源, 取值范围 custom: 自定义变量，component_inputs: 从原子输入参数勾选，component_outputs：从原子输出结果中勾选</td>
</tr>
<tr>
<td>custom_type</td>
<td>string</td>
<td>source_type=custom 时有效，自定义变量类型， 取值范围 input: 输入框，textarea: 文本框，datetime: 日期时间，int: 整数</td>
</tr>
<tr>
<td>source_tag</td>
<td>string</td>
<td>source_type=component_inputs/component_outputs 时有效，变量的来源原子</td>
</tr>
<tr>
<td>source_info</td>
<td>dict</td>
<td>source_type=component_inputs/component_outputs 时有效，变量的来源节点信息</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/sops/get_common_template_info/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>查询公共流程模板详情</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>template_id</td>
<td>string</td>
<td>是</td>
<td>模板 ID</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;template_id&quot;: &quot;30&quot;,
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;result&quot;: true,
    &quot;data&quot;: {
        &quot;category&quot;: &quot;Other&quot;,
        &quot;edit_time&quot;: &quot;2018-04-27 16:24:24 +0800&quot;,
        &quot;create_time&quot;: &quot;2018-04-16 21:43:15 +0800&quot;,
        &quot;name&quot;: &quot;new20180416213944&quot;,
        &quot;creator&quot;: &quot;admin&quot;,
        &quot;pipeline_tree&quot;: {
            &quot;activities&quot;: {
                &quot;631b6576cc5dfbdcaa4f510ce88a7e67&quot;: {
                    &quot;outgoing&quot;: &quot;44ab36ebf4cf119edaf2d20401da87e4&quot;,
                    &quot;incoming&quot;: &quot;fb2f3a8b533ca5c67e2440b4164f7632&quot;,
                    &quot;name&quot;: &quot;节点_1&quot;,
                    &quot;error_ignorable&quot;: false,
                    &quot;component&quot;: {
                        &quot;code&quot;: &quot;job_fast_execute_script&quot;,
                        &quot;data&quot;: {
                            &quot;account&quot;: {
                                &quot;hook&quot;: false,
                                &quot;value&quot;: &quot;root&quot;
                            },
                            &quot;ip_list&quot;: {
                                &quot;hook&quot;: false,
                                &quot;value&quot;: &quot;127.0.0.1&quot;
                            },
                            &quot;script_timeout&quot;: {
                                &quot;hook&quot;: true,
                                &quot;value&quot;: &quot;${script_timeout}&quot;
                            },
                            &quot;content&quot;: {
                                &quot;hook&quot;: false,
                                &quot;value&quot;: &quot;${content}&quot;
                            },
                            &quot;script_param&quot;: {
                                &quot;hook&quot;: false,
                                &quot;value&quot;: &quot;${params}&quot;
                            },
                            &quot;script_type&quot;: {
                                &quot;hook&quot;: true,
                                &quot;value&quot;: &quot;${script_type}&quot;
                            }
                        }
                    },
                    &quot;optional&quot;: false,
                    &quot;type&quot;: &quot;ServiceActivity&quot;,
                    &quot;id&quot;: &quot;631b6576cc5dfbdcaa4f510ce88a7e67&quot;,
                    &quot;loop&quot;: null
                }
            },
            &quot;end_event&quot;: {
                &quot;type&quot;: &quot;EmptyEndEvent&quot;,
                &quot;outgoing&quot;: &quot;&quot;,
                &quot;incoming&quot;: &quot;44ab36ebf4cf119edaf2d20401da87e4&quot;,
                &quot;id&quot;: &quot;60c81e383d048d8a3c574d3436e1b82c&quot;,
                &quot;name&quot;: &quot;&quot;
            },
            &quot;outputs&quot;: [],
            &quot;flows&quot;: {
                &quot;fb2f3a8b533ca5c67e2440b4164f7632&quot;: {
                    &quot;is_default&quot;: false,
                    &quot;source&quot;: &quot;48afea1016ab70ee37179fa0eb1e1a14&quot;,
                    &quot;id&quot;: &quot;fb2f3a8b533ca5c67e2440b4164f7632&quot;,
                    &quot;target&quot;: &quot;631b6576cc5dfbdcaa4f510ce88a7e67&quot;
                },
                &quot;44ab36ebf4cf119edaf2d20401da87e4&quot;: {
                    &quot;is_default&quot;: false,
                    &quot;source&quot;: &quot;631b6576cc5dfbdcaa4f510ce88a7e67&quot;,
                    &quot;id&quot;: &quot;44ab36ebf4cf119edaf2d20401da87e4&quot;,
                    &quot;target&quot;: &quot;60c81e383d048d8a3c574d3436e1b82c&quot;
                }
            },
            &quot;start_event&quot;: {
                &quot;type&quot;: &quot;EmptyStartEvent&quot;,
                &quot;outgoing&quot;: &quot;fb2f3a8b533ca5c67e2440b4164f7632&quot;,
                &quot;incoming&quot;: &quot;&quot;,
                &quot;id&quot;: &quot;48afea1016ab70ee37179fa0eb1e1a14&quot;,
                &quot;name&quot;: &quot;&quot;
            },
            &quot;constants&quot;: {
                &quot;${script_type}&quot;: {
                    &quot;source_tag&quot;: &quot;job_fast_execute_script.script_type&quot;,
                    &quot;source_info&quot;: {
                        &quot;631b6576cc5dfbdcaa4f510ce88a7e67&quot;: [
                            &quot;script_type&quot;
                        ]
                    },
                    &quot;name&quot;: &quot;脚本类型&quot;,
                    &quot;index&quot;: 0,
                    &quot;custom_type&quot;: &quot;radio&quot;,
                    &quot;value&quot;: &quot;4&quot;,
                    &quot;show_type&quot;: &quot;show&quot;,
                    &quot;source_type&quot;: &quot;component_inputs&quot;,
                    &quot;key&quot;: &quot;${script_type}&quot;,
                    &quot;validation&quot;: &quot;^.*$&quot;,
                    &quot;desc&quot;: &quot;&quot;
                },
                &quot;${content}&quot;: {
                    &quot;source_tag&quot;: &quot;&quot;,
                    &quot;source_info&quot;: {},
                    &quot;name&quot;: &quot;内容&quot;,
                    &quot;index&quot;: 2,
                    &quot;custom_type&quot;: &quot;textarea&quot;,
                    &quot;value&quot;: &quot;&quot;,
                    &quot;show_type&quot;: &quot;show&quot;,
                    &quot;source_type&quot;: &quot;custom&quot;,
                    &quot;key&quot;: &quot;${content}&quot;,
                    &quot;desc&quot;: &quot;&quot;
                },
                &quot;${script_timeout}&quot;: {
                    &quot;source_tag&quot;: &quot;job_fast_execute_script.script_timeout&quot;,
                    &quot;source_info&quot;: {
                        &quot;631b6576cc5dfbdcaa4f510ce88a7e67&quot;: [
                            &quot;script_timeout&quot;
                        ]
                    },
                    &quot;name&quot;: &quot;超时时间&quot;,
                    &quot;index&quot;: 1,
                    &quot;custom_type&quot;: &quot;input&quot;,
                    &quot;value&quot;: &quot;&quot;,
                    &quot;show_type&quot;: &quot;show&quot;,
                    &quot;source_type&quot;: &quot;component_inputs&quot;,
                    &quot;key&quot;: &quot;${script_timeout}&quot;,
                    &quot;validation&quot;: &quot;^.*$&quot;,
                    &quot;desc&quot;: &quot;&quot;
                },
                &quot;${params}&quot;: {
                    &quot;source_tag&quot;: &quot;&quot;,
                    &quot;source_info&quot;: {},
                    &quot;name&quot;: &quot;参数&quot;,
                    &quot;index&quot;: 3,
                    &quot;custom_type&quot;: &quot;input&quot;,
                    &quot;value&quot;: &quot;&quot;,
                    &quot;show_type&quot;: &quot;show&quot;,
                    &quot;source_type&quot;: &quot;custom&quot;,
                    &quot;key&quot;: &quot;${params}&quot;,
                    &quot;desc&quot;: &quot;&quot;
                }
            },
            &quot;gateways&quot;: {}
        },
        &quot;id&quot;: 30,
        &quot;editor&quot;: &quot;admin&quot;
    },
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>true/false 查询成功与否</td>
</tr>
<tr>
<td>data</td>
<td>dict</td>
<td>result=true 时模板详情，详细信息见下面说明</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>result=false 时错误信息</td>
</tr>
</tbody>
</table>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>int</td>
<td>模板 ID</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>模板名称</td>
</tr>
<tr>
<td>category</td>
<td>string</td>
<td>模板分类，分类信息见下面说明</td>
</tr>
<tr>
<td>creator</td>
<td>string</td>
<td>模板创建人</td>
</tr>
<tr>
<td>create_time</td>
<td>string</td>
<td>模板创建时间</td>
</tr>
<tr>
<td>editor</td>
<td>string 或者 null</td>
<td>模板编辑人</td>
</tr>
<tr>
<td>edit_time</td>
<td>string</td>
<td>模板最新编辑时间</td>
</tr>
<tr>
<td>pipeline_tree</td>
<td>dict</td>
<td>模板任务树信息，详细信息见下面说明</td>
</tr>
</tbody>
</table>
<h4 id="datacategory">data.category</h4>
<table>
<thead>
<tr>
<th>返回值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>OpsTools</td>
<td>运维工具</td>
</tr>
<tr>
<td>MonitorAlarm</td>
<td>监控告警</td>
</tr>
<tr>
<td>ConfManage</td>
<td>配置管理</td>
</tr>
<tr>
<td>DevTools</td>
<td>开发工具</td>
</tr>
<tr>
<td>EnterpriseIT</td>
<td>企业 IT</td>
</tr>
<tr>
<td>OfficeApp</td>
<td>办公应用</td>
</tr>
<tr>
<td>Other</td>
<td>其它</td>
</tr>
</tbody>
</table>
<h4 id="datapipeline_tree">data.pipeline_tree</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>start_event</td>
<td>dict</td>
<td>开始节点信息</td>
</tr>
<tr>
<td>end_event</td>
<td>dict</td>
<td>结束节点信息</td>
</tr>
<tr>
<td>activities</td>
<td>dict</td>
<td>任务节点（原子和子流程）信息</td>
</tr>
<tr>
<td>gateways</td>
<td>dict</td>
<td>网关节点（并行网关、分支网关和汇聚网关）信息</td>
</tr>
<tr>
<td>flows</td>
<td>dict</td>
<td>顺序流（节点连线）信息</td>
</tr>
<tr>
<td>constants</td>
<td>dict</td>
<td>全局变量信息，详情见下面</td>
</tr>
<tr>
<td>outputs</td>
<td>list</td>
<td>模板输出信息，标记 constants 中的输出字段</td>
</tr>
</tbody>
</table>
<h4 id="datapipeline_treeconstantskey">data.pipeline_tree.constants.KEY</h4>
<p>全局变量 KEY，${key} 格式</p>
<h4 id="datapipeline_treeconstantsvalue">data.pipeline_tree.constants.VALUE</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>key</td>
<td>string</td>
<td>同 KEY</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>变量名字</td>
</tr>
<tr>
<td>index</td>
<td>int</td>
<td>变量在模板中的显示顺序</td>
</tr>
<tr>
<td>desc</td>
<td>string</td>
<td>变量说明</td>
</tr>
<tr>
<td>source_type</td>
<td>string</td>
<td>变量来源, 取值范围 custom: 自定义变量，component_inputs: 从原子输入参数勾选，component_outputs：从原子输出结果中勾选</td>
</tr>
<tr>
<td>custom_type</td>
<td>string</td>
<td>source_type=custom 时有效，自定义变量类型， 取值范围 input: 输入框，textarea: 文本框，datetime: 日期时间，int: 整数</td>
</tr>
<tr>
<td>source_tag</td>
<td>string</td>
<td>source_type=component_inputs 或 component_outputs 时有效，变量的来源原子</td>
</tr>
<tr>
<td>source_info</td>
<td>dict</td>
<td>source_type=component_inputs 或 component_outputs 时有效，变量的来源节点信息</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/sops/get_common_template_list/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>查询公共模板列表</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<p>无</p>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;data&quot;: [
        {
            &quot;category&quot;: &quot;Other&quot;,
            &quot;name&quot;: &quot;父流程&quot;,
            &quot;creator&quot;: &quot;admin&quot;,
            &quot;edit_time&quot;: &quot;2019-07-15 15:13:22 +0800&quot;,
            &quot;create_time&quot;: &quot;2019-07-15 15:13:22 +0800&quot;,
            &quot;editor&quot;: &quot;admin&quot;,
            &quot;id&quot;: 10014
        },
        {
            &quot;category&quot;: &quot;Other&quot;,
            &quot;name&quot;: &quot;子流程&quot;,
            &quot;creator&quot;: &quot;admin&quot;,
            &quot;edit_time&quot;: &quot;2019-07-15 15:13:22 +0800&quot;,
            &quot;create_time&quot;: &quot;2019-07-15 15:13:22 +0800&quot;,
            &quot;editor&quot;: &quot;admin&quot;,
            &quot;id&quot;: 10013
        },
    ],
    &quot;result&quot;: true
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>true/false 查询成功与否</td>
</tr>
<tr>
<td>data</td>
<td>list</td>
<td>result=true 时模板列表，item 信息见下面说明</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>result=false 时错误信息</td>
</tr>
</tbody>
</table>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>int</td>
<td>模板 ID</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>模板名称</td>
</tr>
<tr>
<td>category</td>
<td>string</td>
<td>模板分类，分类信息见下面说明</td>
</tr>
<tr>
<td>creator</td>
<td>string</td>
<td>模板创建人</td>
</tr>
<tr>
<td>create_time</td>
<td>string</td>
<td>模板创建时间</td>
</tr>
<tr>
<td>editor</td>
<td>string 或者 null</td>
<td>模板编辑人</td>
</tr>
<tr>
<td>edit_time</td>
<td>string</td>
<td>模板最新编辑时间</td>
</tr>
</tbody>
</table>
<h4 id="datacategory">data.category</h4>
<table>
<thead>
<tr>
<th>返回值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>OpsTools</td>
<td>运维工具</td>
</tr>
<tr>
<td>MonitorAlarm</td>
<td>监控告警</td>
</tr>
<tr>
<td>ConfManage</td>
<td>配置管理</td>
</tr>
<tr>
<td>DevTools</td>
<td>开发工具</td>
</tr>
<tr>
<td>EnterpriseIT</td>
<td>企业 IT</td>
</tr>
<tr>
<td>OfficeApp</td>
<td>办公应用</td>
</tr>
<tr>
<td>Other</td>
<td>其它</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/sops/get_periodic_task_info/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>查询某个周期任务的详情</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>task_id</td>
<td>string</td>
<td>是</td>
<td>周期任务 ID</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>string</td>
<td>是</td>
<td>模板所属业务 ID</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_biz_id&quot;: &quot;2&quot;,
    &quot;task_id&quot;: &quot;8&quot;
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: {
        &quot;cron&quot;: &quot;1,2,3-19/2 2 3 4 5 (m/h/d/dM/MY)&quot;,
        &quot;total_run_count&quot;: 0,
        &quot;name&quot;: &quot;定时2&quot;,
        &quot;form&quot;: {
            &quot;${bk_timing}&quot;: {
                &quot;source_tag&quot;: &quot;sleep_timer.bk_timing&quot;,
                &quot;source_info&quot;: {
                    &quot;node76393dcfedcf73dbc726f1c4786d&quot;: [
                        &quot;bk_timing&quot;
                    ]
                },
                &quot;name&quot;: &quot;定时时间&quot;,
                &quot;index&quot;: 0,
                &quot;custom_type&quot;: &quot;&quot;,
                &quot;value&quot;: &quot;2&quot;,
                &quot;show_type&quot;: &quot;show&quot;,
                &quot;source_type&quot;: &quot;component_inputs&quot;,
                &quot;key&quot;: &quot;${bk_timing}&quot;,
                &quot;validation&quot;: &quot;&quot;,
                &quot;desc&quot;: &quot;&quot;
            }
        },
        &quot;creator&quot;: &quot;admin&quot;,
        &quot;pipeline_tree&quot;: {
            &quot;activities&quot;: {
                &quot;nodea5c396a3ef0f9f3cd7d4d7695f78&quot;: {
                    &quot;outgoing&quot;: &quot;linef69b59d165fb8c0061b46588c515&quot;,
                    &quot;incoming&quot;: &quot;linecf7b7f10c87187a88b72c5f91177&quot;,
                    &quot;name&quot;: &quot;暂停&quot;,
                    &quot;error_ignorable&quot;: false,
                    &quot;component&quot;: {
                        &quot;code&quot;: &quot;pause_node&quot;,
                        &quot;data&quot;: {}
                    },
                    &quot;stage_name&quot;: &quot;步骤1&quot;,
                    &quot;optional&quot;: false,
                    &quot;type&quot;: &quot;ServiceActivity&quot;,
                    &quot;id&quot;: &quot;nodea5c396a3ef0f9f3cd7d4d7695f78&quot;,
                    &quot;loop&quot;: {}
                },
                &quot;node76393dcfedcf73dbc726f1c4786d&quot;: {
                    &quot;outgoing&quot;: &quot;linecf7b7f10c87187a88b72c5f91177&quot;,
                    &quot;incoming&quot;: &quot;linecd597f19606c1455d661f71a582d&quot;,
                    &quot;name&quot;: &quot;定时&quot;,
                    &quot;error_ignorable&quot;: false,
                    &quot;component&quot;: {
                        &quot;code&quot;: &quot;sleep_timer&quot;,
                        &quot;data&quot;: {
                            &quot;bk_timing&quot;: {
                                &quot;hook&quot;: true,
                                &quot;value&quot;: &quot;${bk_timing}&quot;
                            }
                        }
                    },
                    &quot;stage_name&quot;: &quot;步骤1&quot;,
                    &quot;optional&quot;: false,
                    &quot;type&quot;: &quot;ServiceActivity&quot;,
                    &quot;id&quot;: &quot;node76393dcfedcf73dbc726f1c4786d&quot;,
                    &quot;loop&quot;: {}
                }
            },
            &quot;end_event&quot;: {
                &quot;incoming&quot;: &quot;linef69b59d165fb8c0061b46588c515&quot;,
                &quot;outgoing&quot;: &quot;&quot;,
                &quot;type&quot;: &quot;EmptyEndEvent&quot;,
                &quot;id&quot;: &quot;node375320830be9c46cd89f4069857d&quot;,
                &quot;name&quot;: &quot;&quot;
            },
            &quot;outputs&quot;: [],
            &quot;flows&quot;: {
                &quot;linef69b59d165fb8c0061b46588c515&quot;: {
                    &quot;is_default&quot;: false,
                    &quot;source&quot;: &quot;nodea5c396a3ef0f9f3cd7d4d7695f78&quot;,
                    &quot;id&quot;: &quot;linef69b59d165fb8c0061b46588c515&quot;,
                    &quot;target&quot;: &quot;node375320830be9c46cd89f4069857d&quot;
                },
                &quot;linecd597f19606c1455d661f71a582d&quot;: {
                    &quot;is_default&quot;: false,
                    &quot;source&quot;: &quot;node4e87796ddd76b0d59337b08f385d&quot;,
                    &quot;id&quot;: &quot;linecd597f19606c1455d661f71a582d&quot;,
                    &quot;target&quot;: &quot;node76393dcfedcf73dbc726f1c4786d&quot;
                },
                &quot;linecf7b7f10c87187a88b72c5f91177&quot;: {
                    &quot;is_default&quot;: false,
                    &quot;source&quot;: &quot;node76393dcfedcf73dbc726f1c4786d&quot;,
                    &quot;id&quot;: &quot;linecf7b7f10c87187a88b72c5f91177&quot;,
                    &quot;target&quot;: &quot;nodea5c396a3ef0f9f3cd7d4d7695f78&quot;
                }
            },
            &quot;gateways&quot;: {},
            &quot;line&quot;: [
                {
                    &quot;source&quot;: {
                        &quot;id&quot;: &quot;nodea5c396a3ef0f9f3cd7d4d7695f78&quot;,
                        &quot;arrow&quot;: &quot;Right&quot;
                    },
                    &quot;target&quot;: {
                        &quot;id&quot;: &quot;node375320830be9c46cd89f4069857d&quot;,
                        &quot;arrow&quot;: &quot;Left&quot;
                    },
                    &quot;id&quot;: &quot;linef69b59d165fb8c0061b46588c515&quot;
                },
                {
                    &quot;source&quot;: {
                        &quot;id&quot;: &quot;node4e87796ddd76b0d59337b08f385d&quot;,
                        &quot;arrow&quot;: &quot;Right&quot;
                    },
                    &quot;id&quot;: &quot;linecd597f19606c1455d661f71a582d&quot;,
                    &quot;target&quot;: {
                        &quot;id&quot;: &quot;node76393dcfedcf73dbc726f1c4786d&quot;,
                        &quot;arrow&quot;: &quot;Left&quot;
                    }
                },
                {
                    &quot;source&quot;: {
                        &quot;id&quot;: &quot;node76393dcfedcf73dbc726f1c4786d&quot;,
                        &quot;arrow&quot;: &quot;Right&quot;
                    },
                    &quot;target&quot;: {
                        &quot;id&quot;: &quot;nodea5c396a3ef0f9f3cd7d4d7695f78&quot;,
                        &quot;arrow&quot;: &quot;Left&quot;
                    },
                    &quot;id&quot;: &quot;linecf7b7f10c87187a88b72c5f91177&quot;
                }
            ],
            &quot;start_event&quot;: {
                &quot;incoming&quot;: &quot;&quot;,
                &quot;outgoing&quot;: &quot;linecd597f19606c1455d661f71a582d&quot;,
                &quot;type&quot;: &quot;EmptyStartEvent&quot;,
                &quot;id&quot;: &quot;node4e87796ddd76b0d59337b08f385d&quot;,
                &quot;name&quot;: &quot;&quot;
            },
            &quot;constants&quot;: {
                &quot;${bk_timing}&quot;: {
                    &quot;source_tag&quot;: &quot;sleep_timer.bk_timing&quot;,
                    &quot;source_info&quot;: {
                        &quot;node76393dcfedcf73dbc726f1c4786d&quot;: [
                            &quot;bk_timing&quot;
                        ]
                    },
                    &quot;name&quot;: &quot;定时时间&quot;,
                    &quot;index&quot;: 0,
                    &quot;custom_type&quot;: &quot;&quot;,
                    &quot;value&quot;: &quot;2&quot;,
                    &quot;show_type&quot;: &quot;show&quot;,
                    &quot;source_type&quot;: &quot;component_inputs&quot;,
                    &quot;key&quot;: &quot;${bk_timing}&quot;,
                    &quot;validation&quot;: &quot;&quot;,
                    &quot;desc&quot;: &quot;&quot;
                }
            },
            &quot;location&quot;: [
                {
                    &quot;stage_name&quot;: &quot;步骤1&quot;,
                    &quot;name&quot;: &quot;暂停&quot;,
                    &quot;y&quot;: 133,
                    &quot;x&quot;: 631,
                    &quot;type&quot;: &quot;tasknode&quot;,
                    &quot;id&quot;: &quot;nodea5c396a3ef0f9f3cd7d4d7695f78&quot;
                },
                {
                    &quot;y&quot;: 150,
                    &quot;x&quot;: 80,
                    &quot;type&quot;: &quot;startpoint&quot;,
                    &quot;id&quot;: &quot;node4e87796ddd76b0d59337b08f385d&quot;
                },
                {
                    &quot;y&quot;: 149,
                    &quot;x&quot;: 1092,
                    &quot;type&quot;: &quot;endpoint&quot;,
                    &quot;id&quot;: &quot;node375320830be9c46cd89f4069857d&quot;
                },
                {
                    &quot;stage_name&quot;: &quot;步骤1&quot;,
                    &quot;name&quot;: &quot;定时&quot;,
                    &quot;y&quot;: 133,
                    &quot;x&quot;: 300,
                    &quot;type&quot;: &quot;tasknode&quot;,
                    &quot;id&quot;: &quot;node76393dcfedcf73dbc726f1c4786d&quot;
                }
            ]
        },
        &quot;last_run_at&quot;: &quot;&quot;,
        &quot;enabled&quot;: true,
        &quot;id&quot;: 5,
        &quot;template_id&quot;: &quot;2&quot;
    },
    &quot;result&quot;: true
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>true/false 操作是否成功</td>
</tr>
<tr>
<td>data</td>
<td>dict</td>
<td>result=true 时成功数据，详细信息请见下面说明</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>result=false 时错误信息</td>
</tr>
</tbody>
</table>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>cron</td>
<td>string</td>
<td>周期调度表达式</td>
</tr>
<tr>
<td>total_run_count</td>
<td>int</td>
<td>周期任务运行次数</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>周期任务名</td>
</tr>
<tr>
<td>creator</td>
<td>string</td>
<td>创建者</td>
</tr>
<tr>
<td>last_run_at</td>
<td>string</td>
<td>上次运行时间</td>
</tr>
<tr>
<td>enabled</td>
<td>bool</td>
<td>是否激活</td>
</tr>
<tr>
<td>id</td>
<td>int</td>
<td>周期任务 ID</td>
</tr>
<tr>
<td>template_id</td>
<td>string</td>
<td>用于创建该任务的模板 ID</td>
</tr>
<tr>
<td>form</td>
<td>dict</td>
<td>该周期任务的参数表单对象</td>
</tr>
<tr>
<td>pipeline_tree</td>
<td>dict</td>
<td>该周期任务的实例树</td>
</tr>
</tbody>
</table>
<h4 id="datapipeline_tree">data.pipeline_tree</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>start_event</td>
<td>dict</td>
<td>开始节点信息</td>
</tr>
<tr>
<td>end_event</td>
<td>dict</td>
<td>结束节点信息</td>
</tr>
<tr>
<td>activities</td>
<td>dict</td>
<td>任务节点（原子和子流程）信息</td>
</tr>
<tr>
<td>gateways</td>
<td>dict</td>
<td>网关节点（并行网关、分支网关和汇聚网关）信息</td>
</tr>
<tr>
<td>flows</td>
<td>dict</td>
<td>顺序流（节点连线）信息</td>
</tr>
<tr>
<td>constants</td>
<td>dict</td>
<td>全局变量信息，详情见下面</td>
</tr>
<tr>
<td>outputs</td>
<td>list</td>
<td>模板输出信息，标记 constants 中的输出字段</td>
</tr>
</tbody>
</table>
<h4 id="dataformkey-datapipeline_treeconstantskey">data.form.KEY, data.pipeline_tree.constants.KEY</h4>
<p>全局变量 KEY，${key} 格式</p>
<h4 id="dataformvalue-datapipeline_treeconstantsvalue">data.form.VALUE, data.pipeline_tree.constants.VALUE</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>key</td>
<td>string</td>
<td>同 KEY</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>变量名字</td>
</tr>
<tr>
<td>index</td>
<td>int</td>
<td>变量在模板中的显示顺序</td>
</tr>
<tr>
<td>desc</td>
<td>string</td>
<td>变量说明</td>
</tr>
<tr>
<td>source_type</td>
<td>string</td>
<td>变量来源, 取值范围 custom: 自定义变量，component_inputs: 从原子输入参数勾选，component_outputs：从原子输出结果中勾选</td>
</tr>
<tr>
<td>custom_type</td>
<td>string</td>
<td>source_type=custom 时有效，自定义变量类型， 取值范围 input: 输入框，textarea: 文本框，datetime: 日期时间，int: 整数</td>
</tr>
<tr>
<td>source_tag</td>
<td>string</td>
<td>source_type=component_inputs/component_outputs 时有效，变量的来源原子</td>
</tr>
<tr>
<td>source_info</td>
<td>dict</td>
<td>source_type=component_inputs/component_outputs 时有效，变量的来源节点信息</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/sops/get_periodic_task_list/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>查询某个业务下所有的周期任务</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>string</td>
<td>是</td>
<td>任务所属业务 ID</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_biz_id&quot;: &quot;2&quot;
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;data&quot;: [
        {
            &quot;cron&quot;: &quot;*/1 15 * * * (m/h/d/dM/MY)&quot;,
            &quot;total_run_count&quot;: 1,
            &quot;name&quot;: &quot;from api 3&quot;,
            &quot;creator&quot;: &quot;admin&quot;,
            &quot;last_run_at&quot;: &quot;2018-11-28 15:57:01 +0900&quot;,
            &quot;enabled&quot;: false,
            &quot;id&quot;: 11,
            &quot;template_id&quot;: &quot;2&quot;
        },
        {
            &quot;cron&quot;: &quot;1,2,3-19/2 2 3 4 5 (m/h/d/dM/MY)&quot;,
            &quot;total_run_count&quot;: 0,
            &quot;name&quot;: &quot;from api 1&quot;,
            &quot;creator&quot;: &quot;admin&quot;,
            &quot;last_run_at&quot;: &quot;&quot;,
            &quot;enabled&quot;: false,
            &quot;id&quot;: 6,
            &quot;template_id&quot;: &quot;2&quot;
        },
        {
            &quot;cron&quot;: &quot;*/5 * * * * (m/h/d/dM/MY)&quot;,
            &quot;total_run_count&quot;: 0,
            &quot;name&quot;: &quot;定时&quot;,
            &quot;creator&quot;: &quot;admin&quot;,
            &quot;last_run_at&quot;: &quot;&quot;,
            &quot;enabled&quot;: false,
            &quot;id&quot;: 4,
            &quot;template_id&quot;: &quot;2&quot;
        }
    ],
    &quot;result&quot;: true
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>true/false 操作是否成功</td>
</tr>
<tr>
<td>data</td>
<td>dict</td>
<td>result=true 时成功数据，详细信息请见下面说明</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>result=false 时错误信息</td>
</tr>
</tbody>
</table>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>cron</td>
<td>string</td>
<td>周期调度表达式</td>
</tr>
<tr>
<td>total_run_count</td>
<td>int</td>
<td>周期任务运行次数</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>周期任务名</td>
</tr>
<tr>
<td>creator</td>
<td>string</td>
<td>创建者</td>
</tr>
<tr>
<td>last_run_at</td>
<td>string</td>
<td>上次运行时间</td>
</tr>
<tr>
<td>enabled</td>
<td>bool</td>
<td>是否激活</td>
</tr>
<tr>
<td>id</td>
<td>int</td>
<td>周期任务 ID</td>
</tr>
<tr>
<td>template_id</td>
<td>string</td>
<td>用于创建该任务的模板 ID</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/sops/get_plugin_list/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>获取某个业务下所有的可用插件</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>参数名称</th>
<th>参数类型</th>
<th>必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>app_code</td>
<td>string</td>
<td>是</td>
<td>蓝鲸应用编码</td>
</tr>
<tr>
<td>app_secret</td>
<td>string</td>
<td>是</td>
<td>蓝鲸应用私密 key</td>
</tr>
<tr>
<td>access_token</td>
<td>string</td>
<td>否</td>
<td>用户登录票据，bk_token 为空时必填</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>用户登录票据，access_token 为空时必填</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>string</td>
<td>是</td>
<td>项目唯一 ID，项目 ID 或 CMDB 业务 ID</td>
</tr>
<tr>
<td>scope</td>
<td>string</td>
<td>否</td>
<td>唯一 ID 的范围，取值为 cmdb_biz 或 project，为 cmdb_biz 时 bk_biz_id 代表业务 ID，反之代表项目 ID，不传时默认为 cmdb_biz</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_biz_id&quot;: &quot;2&quot;
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;result&quot;: true,
    &quot;data&quot;: [
        {
            &quot;inputs&quot;: [],
            &quot;outputs&quot;: [
                {
                    &quot;name&quot;: &quot;执行结果&quot;,
                    &quot;key&quot;: &quot;_result&quot;,
                    &quot;type&quot;: &quot;bool&quot;,
                    &quot;schema&quot;: {
                        &quot;type&quot;: &quot;boolean&quot;,
                        &quot;description&quot;: &quot;是否执行成功&quot;,
                        &quot;enum&quot;: []
                    }
                },
                {
                    &quot;name&quot;: &quot;循环次数&quot;,
                    &quot;key&quot;: &quot;_loop&quot;,
                    &quot;type&quot;: &quot;int&quot;,
                    &quot;schema&quot;: {
                        &quot;type&quot;: &quot;int&quot;,
                        &quot;description&quot;: &quot;循环执行次数&quot;,
                        &quot;enum&quot;: []
                    }
                }
            ],
            &quot;desc&quot;: &quot;&quot;,
            &quot;code&quot;: &quot;job_push_local_files&quot;,
            &quot;name&quot;: &quot;分发本地文件&quot;,
            &quot;group_name&quot;: &quot;作业平台(JOB)&quot;,
            &quot;version&quot;: &quot;1.0.0&quot;
        }
    ]
}</code></pre>


<h3 id="_9">返回结果说明</h3>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>true/false 操作是否成功</td>
</tr>
<tr>
<td>data</td>
<td>dict</td>
<td>result=true 时成功数据，详细信息请见下面说明</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>result=false 时错误信息</td>
</tr>
</tbody>
</table>
<h5 id="dataitem">data[item]</h5>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>inputs</td>
<td>array</td>
<td>插件输入参数列表</td>
</tr>
<tr>
<td>outputs</td>
<td>array</td>
<td>插件输出参数列表</td>
</tr>
<tr>
<td>desc</td>
<td>string</td>
<td>插件描述</td>
</tr>
<tr>
<td>code</td>
<td>string</td>
<td>插件代码</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>插件名</td>
</tr>
<tr>
<td>group_name</td>
<td>string</td>
<td>插件组名</td>
</tr>
<tr>
<td>version</td>
<td>name</td>
<td>插件版本</td>
</tr>
</tbody>
</table>
<h5 id="inputs">inputs</h5>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>required</td>
<td>bool</td>
<td>是否是必填参数</td>
</tr>
<tr>
<td>type</td>
<td>string</td>
<td>参数类型</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>参数名</td>
</tr>
<tr>
<td>key</td>
<td>string</td>
<td>参数唯一键</td>
</tr>
<tr>
<td>schema</td>
<td>dict</td>
<td>参数 schema</td>
</tr>
</tbody>
</table>
<h6 id="inputsschema">inputs.schema</h6>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>type</td>
<td>string</td>
<td>参数类型</td>
</tr>
<tr>
<td>enum</td>
<td>list</td>
<td>参数可选范围</td>
</tr>
<tr>
<td>description</td>
<td>string</td>
<td>参数描述</td>
</tr>
<tr>
<td>properties</td>
<td>dict</td>
<td>对象属性 schema，当 type 为 object 时，会存在该字段，该对象的属性的值为另一个 schema 对象</td>
</tr>
<tr>
<td>items</td>
<td>dict</td>
<td>列表元素 schema，当 type 为 array 时，会存在该字段</td>
</tr>
</tbody>
</table>
<h5 id="outputs">outputs</h5>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>type</td>
<td>string</td>
<td>参数类型</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>参数名</td>
</tr>
<tr>
<td>key</td>
<td>string</td>
<td>参数唯一键</td>
</tr>
<tr>
<td>schema</td>
<td>dict</td>
<td>参数 schema</td>
</tr>
</tbody>
</table>
<h6 id="outputsschema">outputs.schema</h6>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>type</td>
<td>string</td>
<td>参数类型</td>
</tr>
<tr>
<td>enum</td>
<td>list</td>
<td>参数可选范围</td>
</tr>
<tr>
<td>description</td>
<td>string</td>
<td>参数描述</td>
</tr>
<tr>
<td>properties</td>
<td>dict</td>
<td>对象属性 schema，当 type 为 object 时，会存在该字段，该对象的属性的值为另一个 schema 对象</td>
</tr>
<tr>
<td>items</td>
<td>dict</td>
<td>列表元素 schema，当 type 为 array 时，会存在该字段</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/sops/get_task_detail/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>查询任务执行详情</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>string</td>
<td>是</td>
<td>所属业务 ID</td>
</tr>
<tr>
<td>task_id</td>
<td>string</td>
<td>是</td>
<td>任务 ID</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_biz_id&quot;: &quot;2&quot;,
    &quot;task_id&quot;: &quot;10&quot;
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;data&quot;: {
        &quot;creator&quot;: &quot;admin&quot;,
        &quot;outputs&quot;: [
            {
                &quot;value&quot;: &quot;1&quot;,
                &quot;key&quot;: &quot;${job_script_type}&quot;,
                &quot;name&quot;: &quot;脚本类型&quot;
            },
            {
                &quot;value&quot;: &quot;127.0.0.1&quot;,
                &quot;key&quot;: &quot;${IP}&quot;,
                &quot;name&quot;: &quot;IP&quot;
            },
            {
                &quot;value&quot;: &quot;0&quot;,
                &quot;key&quot;: &quot;${EXIT}&quot;,
                &quot;name&quot;: &quot;EXIT&quot;
            }
        ],
        &quot;start_time&quot;: &quot;2019-01-17 04:13:08&quot;,
        &quot;business_id&quot;: 2,
        &quot;create_time&quot;: &quot;2019-01-17 04:13:03&quot;,
        &quot;business_name&quot;: &quot;蓝鲸&quot;,
        &quot;id&quot;: 10,
        &quot;constants&quot;: {
            &quot;${IP}&quot;: {
                &quot;source_tag&quot;: &quot;var_ip_picker.ip_picker&quot;,
                &quot;source_info&quot;: {},
                &quot;name&quot;: &quot;IP&quot;,
                &quot;index&quot;: 2,
                &quot;custom_type&quot;: &quot;ip&quot;,
                &quot;value&quot;: {
                    &quot;var_ip_custom_value&quot;: &quot;127.0.0.1&quot;,
                    &quot;var_ip_method&quot;: &quot;custom&quot;,
                    &quot;var_ip_tree&quot;: []
                },
                &quot;show_type&quot;: &quot;show&quot;,
                &quot;source_type&quot;: &quot;custom&quot;,
                &quot;validator&quot;: [],
                &quot;key&quot;: &quot;${IP}&quot;,
                &quot;desc&quot;: &quot;&quot;,
                &quot;validation&quot;: &quot;&quot;,
                &quot;is_meta&quot;: false
            },
            &quot;${job_script_type}&quot;: {
                &quot;source_tag&quot;: &quot;job_fast_execute_script.job_script_type&quot;,
                &quot;source_info&quot;: {
                    &quot;node554316ea019a341f8c28cc6a7da9&quot;: [
                        &quot;job_script_type&quot;
                    ]
                },
                &quot;name&quot;: &quot;脚本类型&quot;,
                &quot;index&quot;: 0,
                &quot;custom_type&quot;: &quot;&quot;,
                &quot;value&quot;: &quot;1&quot;,
                &quot;show_type&quot;: &quot;show&quot;,
                &quot;source_type&quot;: &quot;component_inputs&quot;,
                &quot;key&quot;: &quot;${job_script_type}&quot;,
                &quot;validation&quot;: &quot;&quot;,
                &quot;desc&quot;: &quot;&quot;
            },
            &quot;${EXIT}&quot;: {
                &quot;source_tag&quot;: &quot;&quot;,
                &quot;source_info&quot;: {},
                &quot;name&quot;: &quot;EXIT&quot;,
                &quot;index&quot;: 1,
                &quot;custom_type&quot;: &quot;input&quot;,
                &quot;value&quot;: &quot;0&quot;,
                &quot;show_type&quot;: &quot;show&quot;,
                &quot;source_type&quot;: &quot;custom&quot;,
                &quot;validator&quot;: [],
                &quot;key&quot;: &quot;${EXIT}&quot;,
                &quot;validation&quot;: &quot;^.+$&quot;,
                &quot;desc&quot;: &quot;&quot;
            }
        },
        &quot;create_method&quot;: &quot;app&quot;,
        &quot;elapsed_time&quot;: 7,
        &quot;ex_data&quot;: &quot;&quot;,
        &quot;instance_name&quot;: &quot;job输出变量测试_20190117121300&quot;,
        &quot;end_time&quot;: &quot;2019-01-17 04:13:15&quot;,
        &quot;executor&quot;: &quot;admin&quot;,
        &quot;template_id&quot;: &quot;266&quot;,
        &quot;task_url&quot;: &quot;http://bk_sops_host/taskflow/execute/3/?instance_id=15364&quot;,
        &quot;pipeline_tree&quot;: {
            &quot;activities&quot;: {
                &quot;node9b5ae13799d63e179f0ce3088b62&quot;: {
                    &quot;outgoing&quot;: &quot;line27bc7b4ccbcf37ddb9d1f6572a04&quot;,
                    &quot;incoming&quot;: &quot;line490caa49d2a03e64829693281032&quot;,
                    &quot;name&quot;: &quot;timing&quot;,
                    &quot;error_ignorable&quot;: false,
                    &quot;component&quot;: {
                        &quot;code&quot;: &quot;sleep_timer&quot;,
                        &quot;data&quot;: {
                            &quot;bk_timing&quot;: {
                                &quot;hook&quot;: false,
                                &quot;value&quot;: &quot;2&quot;
                            }
                        }
                    },
                    &quot;stage_name&quot;: &quot;步骤1&quot;,
                    &quot;can_retry&quot;: true,
                    &quot;isSkipped&quot;: true,
                    &quot;type&quot;: &quot;ServiceActivity&quot;,
                    &quot;optional&quot;: false,
                    &quot;id&quot;: &quot;node9b5ae13799d63e179f0ce3088b62&quot;,
                    &quot;loop&quot;: null
                },
                &quot;node880ded556c6c3c269be3cedc64b6&quot;: {
                    &quot;outgoing&quot;: &quot;line490caa49d2a03e64829693281032&quot;,
                    &quot;incoming&quot;: &quot;lineb83161d6e0593ad68d9ec73a961b&quot;,
                    &quot;name&quot;: &quot;暂停&quot;,
                    &quot;error_ignorable&quot;: false,
                    &quot;component&quot;: {
                        &quot;code&quot;: &quot;pause_node&quot;,
                        &quot;data&quot;: {}
                    },
                    &quot;stage_name&quot;: &quot;步骤1&quot;,
                    &quot;can_retry&quot;: true,
                    &quot;isSkipped&quot;: true,
                    &quot;type&quot;: &quot;ServiceActivity&quot;,
                    &quot;optional&quot;: true,
                    &quot;id&quot;: &quot;node880ded556c6c3c269be3cedc64b6&quot;,
                    &quot;loop&quot;: null
                }
            },
            &quot;end_event&quot;: {
                &quot;type&quot;: &quot;EmptyEndEvent&quot;,
                &quot;outgoing&quot;: &quot;&quot;,
                &quot;incoming&quot;: &quot;line27bc7b4ccbcf37ddb9d1f6572a04&quot;,
                &quot;id&quot;: &quot;node5c48f37aa9f0351e8b43ab6a2295&quot;,
                &quot;name&quot;: &quot;&quot;
            },
            &quot;outputs&quot;: [],
            &quot;flows&quot;: {
                &quot;line490caa49d2a03e64829693281032&quot;: {
                    &quot;is_default&quot;: false,
                    &quot;source&quot;: &quot;node880ded556c6c3c269be3cedc64b6&quot;,
                    &quot;id&quot;: &quot;line490caa49d2a03e64829693281032&quot;,
                    &quot;target&quot;: &quot;node9b5ae13799d63e179f0ce3088b62&quot;
                },
                &quot;lineb83161d6e0593ad68d9ec73a961b&quot;: {
                    &quot;is_default&quot;: false,
                    &quot;source&quot;: &quot;noded383bc1d7387391f889c6bab18b8&quot;,
                    &quot;id&quot;: &quot;lineb83161d6e0593ad68d9ec73a961b&quot;,
                    &quot;target&quot;: &quot;node880ded556c6c3c269be3cedc64b6&quot;
                },
                &quot;line27bc7b4ccbcf37ddb9d1f6572a04&quot;: {
                    &quot;is_default&quot;: false,
                    &quot;source&quot;: &quot;node9b5ae13799d63e179f0ce3088b62&quot;,
                    &quot;id&quot;: &quot;line27bc7b4ccbcf37ddb9d1f6572a04&quot;,
                    &quot;target&quot;: &quot;node5c48f37aa9f0351e8b43ab6a2295&quot;
                }
            },
            &quot;gateways&quot;: {},
            &quot;line&quot;: [
                {
                    &quot;source&quot;: {
                        &quot;id&quot;: &quot;node9b5ae13799d63e179f0ce3088b62&quot;,
                        &quot;arrow&quot;: &quot;Right&quot;
                    },
                    &quot;target&quot;: {
                        &quot;id&quot;: &quot;node5c48f37aa9f0351e8b43ab6a2295&quot;,
                        &quot;arrow&quot;: &quot;Left&quot;
                    },
                    &quot;id&quot;: &quot;line27bc7b4ccbcf37ddb9d1f6572a04&quot;
                },
                {
                    &quot;source&quot;: {
                        &quot;id&quot;: &quot;node880ded556c6c3c269be3cedc64b6&quot;,
                        &quot;arrow&quot;: &quot;Right&quot;
                    },
                    &quot;target&quot;: {
                        &quot;id&quot;: &quot;node9b5ae13799d63e179f0ce3088b62&quot;,
                        &quot;arrow&quot;: &quot;Left&quot;
                    },
                    &quot;id&quot;: &quot;line490caa49d2a03e64829693281032&quot;
                },
                {
                    &quot;source&quot;: {
                        &quot;id&quot;: &quot;noded383bc1d7387391f889c6bab18b8&quot;,
                        &quot;arrow&quot;: &quot;Right&quot;
                    },
                    &quot;id&quot;: &quot;lineb83161d6e0593ad68d9ec73a961b&quot;,
                    &quot;target&quot;: {
                        &quot;id&quot;: &quot;node880ded556c6c3c269be3cedc64b6&quot;,
                        &quot;arrow&quot;: &quot;Left&quot;
                    }
                }
            ],
            &quot;start_event&quot;: {
                &quot;type&quot;: &quot;EmptyStartEvent&quot;,
                &quot;outgoing&quot;: &quot;lineb83161d6e0593ad68d9ec73a961b&quot;,
                &quot;incoming&quot;: &quot;&quot;,
                &quot;id&quot;: &quot;noded383bc1d7387391f889c6bab18b8&quot;,
                &quot;name&quot;: &quot;&quot;
            },
            &quot;id&quot;: &quot;node7ef6970d06ad3bc092594cb5ec5f&quot;,
            &quot;constants&quot;: {},
            &quot;location&quot;: [
                {
                    &quot;stage_name&quot;: &quot;步骤1&quot;,
                    &quot;name&quot;: &quot;暂停&quot;,
                    &quot;y&quot;: 135,
                    &quot;x&quot;: 300,
                    &quot;type&quot;: &quot;tasknode&quot;,
                    &quot;id&quot;: &quot;node880ded556c6c3c269be3cedc64b6&quot;
                },
                {
                    &quot;y&quot;: 150,
                    &quot;x&quot;: 1000,
                    &quot;type&quot;: &quot;endpoint&quot;,
                    &quot;id&quot;: &quot;node5c48f37aa9f0351e8b43ab6a2295&quot;
                },
                {
                    &quot;stage_name&quot;: &quot;步骤1&quot;,
                    &quot;name&quot;: &quot;timing&quot;,
                    &quot;y&quot;: 135,
                    &quot;x&quot;: 595,
                    &quot;type&quot;: &quot;tasknode&quot;,
                    &quot;id&quot;: &quot;node9b5ae13799d63e179f0ce3088b62&quot;
                },
                {
                    &quot;y&quot;: 150,
                    &quot;x&quot;: 80,
                    &quot;type&quot;: &quot;startpoint&quot;,
                    &quot;id&quot;: &quot;noded383bc1d7387391f889c6bab18b8&quot;
                }
            ]
        }
    },
    &quot;result&quot;: true
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>true/false 查询成功与否</td>
</tr>
<tr>
<td>data</td>
<td>dict</td>
<td>result=true 时返回数据，详细信息见下面说明</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>result=false 时错误信息</td>
</tr>
</tbody>
</table>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>int</td>
<td>任务 ID，即 task_id</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>任务名称</td>
</tr>
<tr>
<td>business_id</td>
<td>int</td>
<td>所属业务 ID</td>
</tr>
<tr>
<td>business_name</td>
<td>string</td>
<td>所属业务名称</td>
</tr>
<tr>
<td>template_id</td>
<td>int</td>
<td>创建任务所用的流程模板 ID</td>
</tr>
<tr>
<td>create_time</td>
<td>string</td>
<td>任务创建时间</td>
</tr>
<tr>
<td>create_method</td>
<td>string</td>
<td>任务创建方式</td>
</tr>
<tr>
<td>start_time</td>
<td>string</td>
<td>任务执行时间</td>
</tr>
<tr>
<td>finish_time</td>
<td>string</td>
<td>任务完成时间</td>
</tr>
<tr>
<td>elapsed_time</td>
<td>int</td>
<td>任务执行耗时(秒）</td>
</tr>
<tr>
<td>creator</td>
<td>string</td>
<td>任务创建人</td>
</tr>
<tr>
<td>executor</td>
<td>string</td>
<td>任务执行人</td>
</tr>
<tr>
<td>constants</td>
<td>dict</td>
<td>输入的全局变量，详情见下面说明</td>
</tr>
<tr>
<td>outputs</td>
<td>list</td>
<td>任务输出参数，详情见下面说明</td>
</tr>
<tr>
<td>task_url</td>
<td>str</td>
<td>任务实例链接</td>
</tr>
<tr>
<td>pipeline_tree</td>
<td>dict</td>
<td>任务实例树</td>
</tr>
</tbody>
</table>
<h4 id="dataconstantskey">data.constants.KEY</h4>
<p>全局变量 KEY，${key} 格式</p>
<h4 id="dataconstantsvalue">data.constants.VALUE</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>key</td>
<td>string</td>
<td>同 KEY</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>变量名字</td>
</tr>
<tr>
<td>index</td>
<td>int</td>
<td>变量在模板中的显示顺序</td>
</tr>
<tr>
<td>desc</td>
<td>string</td>
<td>变量说明</td>
</tr>
<tr>
<td>source_type</td>
<td>string</td>
<td>变量来源, 取值范围 custom: 自定义变量，component_inputs: 从标准插件输入参数勾选，component_outputs：从标准插件输出结果中勾选</td>
</tr>
<tr>
<td>custom_type</td>
<td>string</td>
<td>source_type=custom 时有效，自定义变量类型， 取值范围 input: 输入框，textarea: 文本框，datetime: 日期时间，int: 整数</td>
</tr>
<tr>
<td>source_tag</td>
<td>string</td>
<td>source_type=component_inputs/component_outputs 时有效，变量的来源标准插件</td>
</tr>
<tr>
<td>source_info</td>
<td>dict</td>
<td>source_type=component_inputs/component_outputs 时有效，变量的来源节点信息</td>
</tr>
</tbody>
</table>
<h4 id="dataoutputs">data.outputs[]</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>string</td>
<td>输出参数名称</td>
</tr>
<tr>
<td>value</td>
<td>string、int、bool、dict、list</td>
<td>输出参数值</td>
</tr>
<tr>
<td>key</td>
<td>string</td>
<td>输出参数 KEY</td>
</tr>
<tr>
<td>preset</td>
<td>bool</td>
<td>是否是标准插件定义中预设输出变量</td>
</tr>
</tbody>
</table>
<h4 id="datapipeline_tree">data.pipeline_tree</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>start_event</td>
<td>dict</td>
<td>开始节点信息</td>
</tr>
<tr>
<td>end_event</td>
<td>dict</td>
<td>结束节点信息</td>
</tr>
<tr>
<td>activities</td>
<td>dict</td>
<td>任务节点（原子和子流程）信息</td>
</tr>
<tr>
<td>gateways</td>
<td>dict</td>
<td>网关节点（并行网关、分支网关和汇聚网关）信息</td>
</tr>
<tr>
<td>flows</td>
<td>dict</td>
<td>顺序流（节点连线）信息</td>
</tr>
<tr>
<td>constants</td>
<td>dict</td>
<td>全局变量信息，详情见下面</td>
</tr>
<tr>
<td>outputs</td>
<td>list</td>
<td>模板输出信息，标记 constants 中的输出字段</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/sops/get_task_list/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>获取某个业务下的任务列表，支持任务名关键词搜索</p>
<h4 id="_4">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_5">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>string</td>
<td>是</td>
<td>项目唯一 ID，项目 ID 或 CMDB 业务 ID</td>
</tr>
<tr>
<td>scope</td>
<td>string</td>
<td>否</td>
<td>唯一 ID 的范围，取值为 cmdb_biz 或 project，为 cmdb_biz 时 bk_biz_id 代表业务 ID，反之代表项目 ID，不传时默认为 cmdb_biz</td>
</tr>
<tr>
<td>keyword</td>
<td>string</td>
<td>否</td>
<td>根据任务名关键词过滤任务列表，默认不过滤</td>
</tr>
<tr>
<td>is_started</td>
<td>bool</td>
<td>否</td>
<td>根据任务是否已开始过滤任务列表，默认不过滤</td>
</tr>
<tr>
<td>is_finished</td>
<td>bool</td>
<td>否</td>
<td>根据任务是否已结束过滤任务列表，默认不过滤</td>
</tr>
<tr>
<td>limit</td>
<td>int</td>
<td>否</td>
<td>分页，返回任务列表任务数，默认为 15</td>
</tr>
<tr>
<td>offset</td>
<td>int</td>
<td>否</td>
<td>分页，返回任务列表起始任务下标，默认为 0</td>
</tr>
</tbody>
</table>
<h3 id="_6">请求参数示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_biz_id&quot;: &quot;2&quot;,
    &quot;keyword&quot;: &quot;定时&quot;,
    &quot;is_started&quot;: true,
    &quot;limit&quot;: 5,
}</code></pre>


<h3 id="_7">返回结果示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;result&quot;: true,
    &quot;data&quot;: [
        {
            &quot;id&quot;: 1595,
            &quot;name&quot;: &quot;定时任务1_clone_20200907043931&quot;,
            &quot;category&quot;: &quot;其它&quot;,
            &quot;create_method&quot;: &quot;app&quot;,
            &quot;creator&quot;: &quot;admin&quot;,
            &quot;executor&quot;: &quot;admin&quot;,
            &quot;start_time&quot;: &quot;2020-09-15T06:24:00.840Z&quot;,
            &quot;finish_time&quot;: &quot;2020-09-15T07:12:51.128Z&quot;,
            &quot;is_started&quot;: true,
            &quot;is_finished&quot;: true,
            &quot;template_source&quot;: &quot;project&quot;,
            &quot;template_id&quot;: &quot;2&quot;,
            &quot;project_id&quot;: 1,
            &quot;project_name&quot;: &quot;蓝鲸&quot;,
            &quot;bk_biz_id&quot;: 2,
            &quot;bk_biz_name&quot;: &quot;蓝鲸&quot;
        },
        {
            &quot;id&quot;: 166,
            &quot;name&quot;: &quot;定时测试1_20200623072621&quot;,
            &quot;category&quot;: &quot;运维工具&quot;,
            &quot;create_method&quot;: &quot;app&quot;,
            &quot;creator&quot;: &quot;admin&quot;,
            &quot;executor&quot;: &quot;admin&quot;,
            &quot;start_time&quot;: &quot;2020-06-23T07:26:29.522Z&quot;,
            &quot;finish_time&quot;: null,
            &quot;is_started&quot;: true,
            &quot;is_finished&quot;: false,
            &quot;template_source&quot;: &quot;project&quot;,
            &quot;template_id&quot;: &quot;243&quot;,
            &quot;project_id&quot;: 1,
            &quot;project_name&quot;: &quot;蓝鲸&quot;,
            &quot;bk_biz_id&quot;: 2,
            &quot;bk_biz_name&quot;: &quot;蓝鲸&quot;
        },
        {
            &quot;id&quot;: 159,
            &quot;name&quot;: &quot;新定时_20200610033932_20200610200000&quot;,
            &quot;category&quot;: &quot;其它&quot;,
            &quot;create_method&quot;: &quot;periodic&quot;,
            &quot;creator&quot;: &quot;sops&quot;,
            &quot;executor&quot;: &quot;sops&quot;,
            &quot;start_time&quot;: &quot;2020-06-10T12:00:00.474Z&quot;,
            &quot;finish_time&quot;: null,
            &quot;is_started&quot;: true,
            &quot;is_finished&quot;: false,
            &quot;template_source&quot;: &quot;project&quot;,
            &quot;template_id&quot;: &quot;246&quot;,
            &quot;project_id&quot;: 1,
            &quot;project_name&quot;: &quot;蓝鲸&quot;,
            &quot;bk_biz_id&quot;: 2,
            &quot;bk_biz_name&quot;: &quot;蓝鲸&quot;
        },
        {
            &quot;id&quot;: 158,
            &quot;name&quot;: &quot;新定时_20200610033932_20200610195200&quot;,
            &quot;category&quot;: &quot;其它&quot;,
            &quot;create_method&quot;: &quot;periodic&quot;,
            &quot;creator&quot;: &quot;sops&quot;,
            &quot;executor&quot;: &quot;sops&quot;,
            &quot;start_time&quot;: &quot;2020-06-10T11:52:01.245Z&quot;,
            &quot;finish_time&quot;: null,
            &quot;is_started&quot;: true,
            &quot;is_finished&quot;: false,
            &quot;template_source&quot;: &quot;project&quot;,
            &quot;template_id&quot;: &quot;246&quot;,
            &quot;project_id&quot;: 1,
            &quot;project_name&quot;: &quot;蓝鲸&quot;,
            &quot;bk_biz_id&quot;: 2,
            &quot;bk_biz_name&quot;: &quot;蓝鲸&quot;
        },
        {
            &quot;id&quot;: 157,
            &quot;name&quot;: &quot;新定时_20200610033932_20200610193900&quot;,
            &quot;category&quot;: &quot;其它&quot;,
            &quot;create_method&quot;: &quot;periodic&quot;,
            &quot;creator&quot;: &quot;sops&quot;,
            &quot;executor&quot;: &quot;sops&quot;,
            &quot;start_time&quot;: &quot;2020-06-10T11:39:00.194Z&quot;,
            &quot;finish_time&quot;: null,
            &quot;is_started&quot;: true,
            &quot;is_finished&quot;: false,
            &quot;template_source&quot;: &quot;project&quot;,
            &quot;template_id&quot;: &quot;246&quot;,
            &quot;project_id&quot;: 1,
            &quot;project_name&quot;: &quot;蓝鲸&quot;,
            &quot;bk_biz_id&quot;: 2,
            &quot;bk_biz_name&quot;: &quot;蓝鲸&quot;
        }
    ]
}</code></pre>


<h3 id="_8">返回结果说明</h3>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>true/false 操作是否成功</td>
</tr>
<tr>
<td>data</td>
<td>list</td>
<td>result=true 时成功数据，详细信息请见下面说明</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>result=false 时错误信息</td>
</tr>
</tbody>
</table>
<h5 id="dataitem">data[item]</h5>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>int</td>
<td>任务 ID</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>任务名</td>
</tr>
<tr>
<td>category</td>
<td>string</td>
<td>任务类型</td>
</tr>
<tr>
<td>create_method</td>
<td>string</td>
<td>任务创建方式</td>
</tr>
<tr>
<td>creator</td>
<td>string</td>
<td>任务创建者</td>
</tr>
<tr>
<td>executor</td>
<td>string</td>
<td>任务执行者</td>
</tr>
<tr>
<td>start_time</td>
<td>string</td>
<td>任务开始时间</td>
</tr>
<tr>
<td>finish_time</td>
<td>string</td>
<td>任务结束时间</td>
</tr>
<tr>
<td>is_started</td>
<td>bool</td>
<td>任务是否已开始</td>
</tr>
<tr>
<td>is_finished</td>
<td>bool</td>
<td>任务是否已结束</td>
</tr>
<tr>
<td>template_source</td>
<td>string</td>
<td>任务模版来源，如项目模版 project 和公共模版 common</td>
</tr>
<tr>
<td>template_id</td>
<td>string</td>
<td>任务模版 ID</td>
</tr>
<tr>
<td>project_id</td>
<td>int</td>
<td>项目 ID</td>
</tr>
<tr>
<td>project_name</td>
<td>string</td>
<td>项目名称</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>业务 ID</td>
</tr>
<tr>
<td>bk_biz_name</td>
<td>string</td>
<td>业务名称</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/sops/get_task_node_data/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>获取任务节点的数据</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>参数名称</th>
<th>参数类型</th>
<th>必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>app_code</td>
<td>string</td>
<td>是</td>
<td>蓝鲸应用编码</td>
</tr>
<tr>
<td>app_secret</td>
<td>string</td>
<td>是</td>
<td>蓝鲸应用私密 key</td>
</tr>
<tr>
<td>access_token</td>
<td>string</td>
<td>否</td>
<td>用户登录票据，bk_token 为空时必填</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>用户登录票据，access_token 为空时必填</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>string</td>
<td>是</td>
<td>项目唯一 ID，项目 ID 或 CMDB 业务 ID</td>
</tr>
<tr>
<td>task_id</td>
<td>int</td>
<td>是</td>
<td>任务 ID</td>
</tr>
<tr>
<td>scope</td>
<td>string</td>
<td>否</td>
<td>唯一 ID 的范围，取值为 cmdb_biz 或 project，为 cmdb_biz 时 bk_biz_id 代表业务 ID，反之代表项目 ID，不传时默认为 cmdb_biz</td>
</tr>
<tr>
<td>node_id</td>
<td>string</td>
<td>是</td>
<td>节点 ID</td>
</tr>
<tr>
<td>component_code</td>
<td>string</td>
<td>是</td>
<td>原子编码</td>
</tr>
<tr>
<td>subprocess_stack</td>
<td>string</td>
<td>否</td>
<td>子流程堆栈，json 格式的列表</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_biz_id&quot;: &quot;2&quot;,
    &quot;task_id&quot;: 11,
    &quot;node_id&quot;: &quot;ndfbcbdc77e9350ba18222dc4a0a435f&quot;,
    &quot;component_code&quot;: &quot;sleep_timer&quot;
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;result&quot;: true,
    &quot;data&quot;: {
        &quot;inputs&quot;: {
            &quot;bk_timing&quot;: &quot;123&quot;
        },
        &quot;outputs&quot;: [
            {
                &quot;name&quot;: &quot;执行结果&quot;,
                &quot;key&quot;: &quot;_result&quot;,
                &quot;value&quot;: &quot;&quot;,
                &quot;preset&quot;: true
            },
            {
                &quot;name&quot;: &quot;循环次数&quot;,
                &quot;key&quot;: &quot;_loop&quot;,
                &quot;value&quot;: &quot;&quot;,
                &quot;preset&quot;: true
            }
        ],
        &quot;ex_data&quot;: &quot;&quot;
    },
    &quot;message&quot;: &quot;&quot;,
    &quot;code&quot;: 0
}</code></pre>


<h3 id="_9">返回结果说明</h3>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>true/false 成功与否</td>
</tr>
<tr>
<td>data</td>
<td>object</td>
<td>result=true 时返回数据，详情见下面说明</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>result=false 时错误信息</td>
</tr>
</tbody>
</table>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>inputs</td>
<td>object</td>
<td>输入参数，key：value 格式</td>
</tr>
<tr>
<td>outputs</td>
<td>array</td>
<td>输出参数，详情见下面说明</td>
</tr>
<tr>
<td>ex_data</td>
<td>string</td>
<td>节点执行失败详情，json 字符串或者 HTML 字符串、普通字符串</td>
</tr>
</tbody>
</table>
<h5 id="outputs">outputs[]</h5>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>string</td>
<td>输出参数名称</td>
</tr>
<tr>
<td>value</td>
<td>string、int、bool、dict、list</td>
<td>输出参数值</td>
</tr>
<tr>
<td>key</td>
<td>string</td>
<td>输出参数 KEY</td>
</tr>
<tr>
<td>preset</td>
<td>bool</td>
<td>是否是原子定义中预设输出变量</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/sops/get_task_node_detail/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>查询任务节点执行详情</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>string</td>
<td>是</td>
<td>所属业务 ID</td>
</tr>
<tr>
<td>task_id</td>
<td>string</td>
<td>是</td>
<td>任务 ID</td>
</tr>
<tr>
<td>node_id</td>
<td>string</td>
<td>是</td>
<td>节点 ID</td>
</tr>
<tr>
<td>component_code</td>
<td>string</td>
<td>否</td>
<td>标准插件编码，请求标准插件执行详情必填</td>
</tr>
<tr>
<td>subprocess_stack</td>
<td>string</td>
<td>否</td>
<td>子流程堆栈，json 格式的列表</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_biz_id&quot;: &quot;2&quot;,
    &quot;task_id&quot;: &quot;10&quot;,
    &quot;node_id&quot;: &quot;node0df0431f8f553925af01a94854bd&quot;
    &quot;subprocess_stack&quot;: &quot;[\&quot;nodeaaa0ce51d2143aa9b0dbc27cb7df\&quot;]&quot;,
    &quot;component_code&quot;: &quot;job_fast_execute_script&quot;,
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;message&quot;: &quot;&quot;,
    &quot;data&quot;: {
        &quot;inputs&quot;: {
            &quot;job_account&quot;: &quot;root&quot;,
            &quot;job_script_timeout&quot;: &quot;&quot;,
            &quot;job_script_source&quot;: &quot;manual&quot;,
            &quot;job_script_list_public&quot;: &quot;&quot;,
            &quot;job_content&quot;: &quot;echo 0\nexit 0&quot;,
            &quot;job_script_type&quot;: &quot;1&quot;,
            &quot;job_script_param&quot;: &quot;&quot;,
            &quot;job_script_list_general&quot;: &quot;&quot;,
            &quot;job_ip_list&quot;: &quot;127.0.0.1&quot;
        },
        &quot;retry&quot;: 0,
        &quot;name&quot;: &quot;&lt;class &quot;pipeline.core.flow.activity.ServiceActivity&quot;&gt;&quot;,
        &quot;finish_time&quot;: &quot;2019-01-17 22:02:46 +0800&quot;,
        &quot;skip&quot;: false,
        &quot;start_time&quot;: &quot;2019-01-17 22:02:37 +0800&quot;,
        &quot;children&quot;: {},
        &quot;histories&quot;: [],
        &quot;ex_data&quot;: null,
        &quot;elapsed_time&quot;: 9,
        &quot;outputs&quot;: [
            {
                &quot;value&quot;: 407584,
                &quot;name&quot;: &quot;JOB任务ID&quot;,
                &quot;key&quot;: &quot;job_inst_id&quot;
            },
            {
                &quot;value&quot;: &quot;&quot;,
                &quot;name&quot;: &quot;JOB任务链接&quot;,
                &quot;key&quot;: &quot;job_inst_url&quot;
            },
            {
                &quot;value&quot;: true,
                &quot;name&quot;: &quot;执行结果&quot;,
                &quot;key&quot;: &quot;_result&quot;
            }
        ],
        &quot;state&quot;: &quot;FINISHED&quot;,
        &quot;version&quot;: &quot;23ac8c29f62b3337aafcf1f538d277f8&quot;,
        &quot;error_ignorable&quot;: false,
        &quot;id&quot;: &quot;node0df0431f8f553925af01a94854bd&quot;,
        &quot;loop&quot;: 1
    },
    &quot;result&quot;: true
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>true/false 查询成功与否</td>
</tr>
<tr>
<td>data</td>
<td>dict</td>
<td>result=true 时返回数据，详细信息见下面说明</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>result=false 时错误信息</td>
</tr>
</tbody>
</table>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>string</td>
<td>节点 ID</td>
</tr>
<tr>
<td>start_time</td>
<td>string</td>
<td>最后一次执行开始时间</td>
</tr>
<tr>
<td>finish_time</td>
<td>string</td>
<td>最后一次执行结束时间</td>
</tr>
<tr>
<td>elapsed_time</td>
<td>int</td>
<td>最后一次执行耗时，单位秒</td>
</tr>
<tr>
<td>state</td>
<td>string</td>
<td>最后一次执行状态，CREATED：未执行，RUNNING：执行中，FAILED：失败，NODE_SUSPENDED：暂停，FINISHED：成功</td>
</tr>
<tr>
<td>skip</td>
<td>bool</td>
<td>是否手动跳过</td>
</tr>
<tr>
<td>retry</td>
<td>int</td>
<td>重试次数</td>
</tr>
<tr>
<td>inputs</td>
<td>dict</td>
<td>输入参数，key：value 格式</td>
</tr>
<tr>
<td>outputs</td>
<td>list</td>
<td>输出参数，详情见下面说明</td>
</tr>
<tr>
<td>ex_data</td>
<td>string</td>
<td>节点执行失败详情，json 字符串或者 HTML 字符串、普通字符串</td>
</tr>
<tr>
<td>histories</td>
<td>list</td>
<td>重试记录详情，详情见下面说明</td>
</tr>
</tbody>
</table>
<h4 id="outputs">outputs[]</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>string</td>
<td>输出字段</td>
</tr>
<tr>
<td>value</td>
<td>string、int、bool、dict、list</td>
<td>输出参数值</td>
</tr>
<tr>
<td>key</td>
<td>string</td>
<td>输出参数 KEY</td>
</tr>
<tr>
<td>preset</td>
<td>bool</td>
<td>是否是标准插件定义中预设输出变量</td>
</tr>
</tbody>
</table>
<h4 id="histories">histories[]</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>start_time</td>
<td>string</td>
<td>执行开始时间</td>
</tr>
<tr>
<td>finish_time</td>
<td>string</td>
<td>执行结束时间</td>
</tr>
<tr>
<td>elapsed_time</td>
<td>int</td>
<td>执行耗时</td>
</tr>
<tr>
<td>state</td>
<td>string</td>
<td>执行状态，CREATED：未执行，RUNNING：执行中，FAILED：失败，NODE_SUSPENDED：暂停，FINISHED：成功</td>
</tr>
<tr>
<td>skip</td>
<td>bool</td>
<td>是否手动跳过</td>
</tr>
<tr>
<td>retry</td>
<td>int</td>
<td>重试次数</td>
</tr>
<tr>
<td>histories</td>
<td>list</td>
<td>重试记录详情，详情见下面说明</td>
</tr>
<tr>
<td>inputs</td>
<td>dict</td>
<td>输入参数，key：value 格式</td>
</tr>
<tr>
<td>outputs</td>
<td>dict</td>
<td>输出参数，key：value 格式</td>
</tr>
<tr>
<td>ex_data</td>
<td>string</td>
<td>节点执行失败详情，json 字符串或者 HTML 字符串、普通字符串</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/sops/get_task_status/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>查询任务或任务节点执行状态</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>string</td>
<td>是</td>
<td>模板所属业务 ID</td>
</tr>
<tr>
<td>task_id</td>
<td>string</td>
<td>是</td>
<td>任务或节点 ID</td>
</tr>
<tr>
<td>subprocess_id</td>
<td>string</td>
<td>否</td>
<td>任务中的子流程节点 ID</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_biz_id&quot;: &quot;2&quot;,
    &quot;task_id&quot;: &quot;10&quot;
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;result&quot;: true,
    &quot;data&quot;: {
        &quot;retry&quot;: 0,
        &quot;name&quot;: &quot;&lt;class 'pipeline.core.pipeline.Pipeline'&gt;&quot;,
        &quot;finish_time&quot;: &quot;&quot;,
        &quot;skip&quot;: false,
        &quot;start_time&quot;: &quot;2018-04-26 16:08:34 +0800&quot;,
        &quot;children&quot;: {
            &quot;62d4784e20483f1585149ce90ed954c9&quot;: {
                &quot;retry&quot;: 0,
                &quot;name&quot;: &quot;&lt;class 'pipeline.core.flow.event.EmptyStartEvent'&gt;&quot;,
                &quot;finish_time&quot;: &quot;2018-04-26 16:08:34 +0800&quot;,
                &quot;skip&quot;: false,
                &quot;start_time&quot;: &quot;2018-04-26 16:08:34 +0800&quot;,
                &quot;children&quot;: {},
                &quot;state&quot;: &quot;FINISHED&quot;,
                &quot;version&quot;: &quot;7447cc2801b630f497768493c02fb488&quot;,
                &quot;id&quot;: &quot;62d4784e20483f1585149ce90ed954c9&quot;,
                &quot;loop&quot;: 1
            },
            &quot;e8b128dff46637368b9b1bd921abc14e&quot;: {
                &quot;retry&quot;: 0,
                &quot;name&quot;: &quot;&lt;class 'pipeline.core.flow.activity.ServiceActivity'&gt;&quot;,
                &quot;finish_time&quot;: &quot;2018-04-26 16:08:46 +0800&quot;,
                &quot;skip&quot;: false,
                &quot;start_time&quot;: &quot;2018-04-26 16:08:34 +0800&quot;,
                &quot;children&quot;: {},
                &quot;state&quot;: &quot;FAILED&quot;,
                &quot;version&quot;: &quot;914d35fe7d143c2186e6d3532870b37d&quot;,
                &quot;id&quot;: &quot;e8b128dff46637368b9b1bd921abc14e&quot;,
                &quot;loop&quot;: 1
            }
        },
        &quot;state&quot;: &quot;FAILED&quot;,
        &quot;version&quot;: &quot;&quot;,
        &quot;id&quot;: &quot;5a1622f9f43e3429acb604e18dbd100a&quot;,
        &quot;loop&quot;: 1
    }
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>true/false 查询成功与否</td>
</tr>
<tr>
<td>data</td>
<td>dict</td>
<td>result=true 时返回数据，详细信息见下面说明</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>result=false 时错误信息</td>
</tr>
</tbody>
</table>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>state</td>
<td>string</td>
<td>任务或节点状态，详细信息见下面说明</td>
</tr>
<tr>
<td>id</td>
<td>string</td>
<td>任务或节点执行态 ID，不等于 task_id</td>
</tr>
<tr>
<td>skip</td>
<td>bool</td>
<td>是否跳过执行</td>
</tr>
<tr>
<td>retry</td>
<td>int</td>
<td>重试和跳过总次数</td>
</tr>
<tr>
<td>start_time</td>
<td>string</td>
<td>任务或节点执行开始时间</td>
</tr>
<tr>
<td>finish_time</td>
<td>string</td>
<td>任务或节点执行结束时间</td>
</tr>
<tr>
<td>children</td>
<td>dict</td>
<td>任务节点执行详情，详细信息见下面说明</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>节点名称</td>
</tr>
</tbody>
</table>
<h4 id="datastate">data.state</h4>
<table>
<thead>
<tr>
<th>返回值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>CREATED</td>
<td>未执行</td>
</tr>
<tr>
<td>RUNNING</td>
<td>执行中</td>
</tr>
<tr>
<td>FAILED</td>
<td>失败</td>
</tr>
<tr>
<td>SUSPENDED</td>
<td>暂停</td>
</tr>
<tr>
<td>REVOKED</td>
<td>已终止</td>
</tr>
<tr>
<td>FINISHED</td>
<td>已完成</td>
</tr>
</tbody>
</table>
<h4 id="datachildrenkey">data.children.KEY</h4>
<p>任务节点执行态 ID</p>
<h4 id="datachildrenvalue">data.children.VALUE</h4>
<p>同 data 格式</p><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/sops/get_tasks_status/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>批量查询任务执行状态</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>参数名称</th>
<th>参数类型</th>
<th>必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>app_code</td>
<td>string</td>
<td>是</td>
<td>蓝鲸应用编码</td>
</tr>
<tr>
<td>app_secret</td>
<td>string</td>
<td>是</td>
<td>蓝鲸应用私密 key</td>
</tr>
<tr>
<td>access_token</td>
<td>string</td>
<td>否</td>
<td>用户登录票据，bk_token 为空时必填</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>用户登录票据，access_token 为空时必填</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>string</td>
<td>是</td>
<td>模板所属业务 ID</td>
</tr>
<tr>
<td>task_id_list</td>
<td>array</td>
<td>是</td>
<td>任务 ID 列表</td>
</tr>
<tr>
<td>scope</td>
<td>string</td>
<td>否</td>
<td>唯一 ID 的范围，取值为 cmdb_biz 或 project，为 cmdb_biz 时 bk_biz_id 代表业务 ID，反之代表项目 ID，不传时默认为 cmdb_biz</td>
</tr>
<tr>
<td>include_children_status</td>
<td>bool</td>
<td>否</td>
<td>返回的结果中是否需要包含任务中节点的状态</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;result&quot;: true,
    &quot;data&quot;: [
        {
            &quot;id&quot;: 30000105,
            &quot;name&quot;: &quot;task test tree&quot;,
            &quot;status&quot;: {
                &quot;id&quot;: &quot;n580c9bf42a93bfc9a6cfe309bb3b418&quot;,
                &quot;state&quot;: &quot;FINISHED&quot;,
                &quot;name&quot;: &quot;&lt;class 'pipeline.core.pipeline.Pipeline'&gt;&quot;,
                &quot;retry&quot;: 0,
                &quot;loop&quot;: 1,
                &quot;skip&quot;: false,
                &quot;error_ignorable&quot;: false,
                &quot;version&quot;: &quot;&quot;,
                &quot;elapsed_time&quot;: 41,
                &quot;start_time&quot;: &quot;2020-03-18 17:22:05 +0800&quot;,
                &quot;finish_time&quot;: &quot;2020-03-18 17:22:46 +0800&quot;
            },
            &quot;create_time&quot;: &quot;2020-03-18 17:21:24 +0800&quot;,
            &quot;start_time&quot;: &quot;2020-03-18 17:22:04 +0800&quot;,
            &quot;finish_time&quot;: &quot;2020-03-18 17:22:46 +0800&quot;,
            &quot;url&quot;: &quot;url&quot;
        },
        {
            &quot;id&quot;: 30000101,
            &quot;name&quot;: &quot;task test1111&quot;,
            &quot;status&quot;: {
                &quot;id&quot;: &quot;nd68a418afd23d64a6f0e69338130787&quot;,
                &quot;state&quot;: &quot;FAILED&quot;,
                &quot;name&quot;: &quot;&lt;class 'pipeline.core.pipeline.Pipeline'&gt;&quot;,
                &quot;retry&quot;: 0,
                &quot;loop&quot;: 1,
                &quot;skip&quot;: false,
                &quot;error_ignorable&quot;: false,
                &quot;version&quot;: &quot;&quot;,
                &quot;elapsed_time&quot;: 1375959,
                &quot;start_time&quot;: &quot;2020-03-18 17:15:34 +0800&quot;,
                &quot;finish_time&quot;: &quot;&quot;
            },
            &quot;create_time&quot;: &quot;2020-03-18 17:14:44 +0800&quot;,
            &quot;start_time&quot;: &quot;2020-03-18 17:15:33 +0800&quot;,
            &quot;finish_time&quot;: &quot;&quot;,
            &quot;url&quot;: &quot;url&quot;
        },
        {
            &quot;id&quot;: 30000100,
            &quot;name&quot;: &quot;task_name&quot;,
            &quot;status&quot;: {
                &quot;id&quot;: &quot;nd14eca299643b958761e7a3e5e4b7de&quot;,
                &quot;state&quot;: &quot;RUNNING&quot;,
                &quot;name&quot;: &quot;&lt;class 'pipeline.core.pipeline.Pipeline'&gt;&quot;,
                &quot;retry&quot;: 0,
                &quot;loop&quot;: 1,
                &quot;skip&quot;: false,
                &quot;error_ignorable&quot;: false,
                &quot;version&quot;: &quot;&quot;,
                &quot;elapsed_time&quot;: 1381417,
                &quot;start_time&quot;: &quot;2020-03-18 15:44:36 +0800&quot;,
                &quot;finish_time&quot;: &quot;&quot;
            },
            &quot;create_time&quot;: &quot;2020-03-18 15:44:31 +0800&quot;,
            &quot;start_time&quot;: &quot;2020-03-18 15:44:35 +0800&quot;,
            &quot;finish_time&quot;: &quot;&quot;,
            &quot;url&quot;: &quot;url&quot;
        }
    ],
    &quot;code&quot;: 0
}</code></pre>


<h3 id="_8">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>true/false 查询成功与否</td>
</tr>
<tr>
<td>data</td>
<td>dict</td>
<td>result=true 时返回数据，详细信息见下面说明</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>result=false 时错误信息</td>
</tr>
</tbody>
</table>
<h4 id="data">data 说明</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>string</td>
<td>任务 ID</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>任务名</td>
</tr>
<tr>
<td>status</td>
<td>dict</td>
<td>状态详情</td>
</tr>
<tr>
<td>create_time</td>
<td>string</td>
<td>任务创建时间</td>
</tr>
<tr>
<td>start_time</td>
<td>string</td>
<td>任务开始时间</td>
</tr>
<tr>
<td>finish_time</td>
<td>string</td>
<td>任务完成时间</td>
</tr>
<tr>
<td>children</td>
<td>dict</td>
<td>任务节点执行详情，详细信息见下面说明</td>
</tr>
</tbody>
</table>
<h4 id="datastatus">data.status 说明</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>string</td>
<td>节点 ID</td>
</tr>
<tr>
<td>state</td>
<td>string</td>
<td>执行状态，CREATED：未执行，RUNNING：执行中，FAILED：失败，NODE_SUSPENDED：暂停，FINISHED：成功</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>节点名</td>
</tr>
<tr>
<td>retry</td>
<td>int</td>
<td>重试次数</td>
</tr>
<tr>
<td>loop</td>
<td>int</td>
<td>循环次数</td>
</tr>
<tr>
<td>skip</td>
<td>bool</td>
<td>是否跳过</td>
</tr>
<tr>
<td>error_ignorable</td>
<td>bool</td>
<td>是否忽略错误</td>
</tr>
<tr>
<td>version</td>
<td>string</td>
<td>节点版本</td>
</tr>
<tr>
<td>elapsed_time</td>
<td>int</td>
<td>节点耗时(秒)</td>
</tr>
<tr>
<td>start_time</td>
<td>string</td>
<td>节点开始时间</td>
</tr>
<tr>
<td>finish_time</td>
<td>string</td>
<td>节点完成时间</td>
</tr>
</tbody>
</table>
<h4 id="datachildren-key">data.children KEY</h4>
<p>任务节点 执行态 ID</p>
<h4 id="datachildren-value">data.children VALUE</h4>
<p>同 status 格式</p><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/sops/get_template_info/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>查询业务下的单个模板详情</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>string</td>
<td>是</td>
<td>模板所属业务 ID</td>
</tr>
<tr>
<td>template_id</td>
<td>string</td>
<td>是</td>
<td>模板 ID</td>
</tr>
<tr>
<td>template_source</td>
<td>string</td>
<td>否</td>
<td>流程模板来源，business:默认值，业务流程，common：公共流程</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_biz_id&quot;: &quot;1&quot;,
    &quot;template_id&quot;: &quot;30&quot;,
    &quot;template_source&quot;: &quot;business&quot;,
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;result&quot;: true,
    &quot;data&quot;: {
        &quot;category&quot;: &quot;Other&quot;,
        &quot;edit_time&quot;: &quot;2018-04-27 16:24:24 +0800&quot;,
        &quot;create_time&quot;: &quot;2018-04-16 21:43:15 +0800&quot;,
        &quot;name&quot;: &quot;new20180416213944&quot;,
        &quot;bk_biz_id&quot;: &quot;2&quot;,
        &quot;creator&quot;: &quot;admin&quot;,
        &quot;pipeline_tree&quot;: {
            &quot;activities&quot;: {
                &quot;631b6576cc5dfbdcaa4f510ce88a7e67&quot;: {
                    &quot;outgoing&quot;: &quot;44ab36ebf4cf119edaf2d20401da87e4&quot;,
                    &quot;incoming&quot;: &quot;fb2f3a8b533ca5c67e2440b4164f7632&quot;,
                    &quot;name&quot;: &quot;节点_1&quot;,
                    &quot;error_ignorable&quot;: false,
                    &quot;component&quot;: {
                        &quot;code&quot;: &quot;job_fast_execute_script&quot;,
                        &quot;data&quot;: {
                            &quot;account&quot;: {
                                &quot;hook&quot;: false,
                                &quot;value&quot;: &quot;root&quot;
                            },
                            &quot;ip_list&quot;: {
                                &quot;hook&quot;: false,
                                &quot;value&quot;: &quot;127.0.0.1&quot;
                            },
                            &quot;script_timeout&quot;: {
                                &quot;hook&quot;: true,
                                &quot;value&quot;: &quot;${script_timeout}&quot;
                            },
                            &quot;content&quot;: {
                                &quot;hook&quot;: false,
                                &quot;value&quot;: &quot;${content}&quot;
                            },
                            &quot;script_param&quot;: {
                                &quot;hook&quot;: false,
                                &quot;value&quot;: &quot;${params}&quot;
                            },
                            &quot;script_type&quot;: {
                                &quot;hook&quot;: true,
                                &quot;value&quot;: &quot;${script_type}&quot;
                            }
                        }
                    },
                    &quot;optional&quot;: false,
                    &quot;type&quot;: &quot;ServiceActivity&quot;,
                    &quot;id&quot;: &quot;631b6576cc5dfbdcaa4f510ce88a7e67&quot;,
                    &quot;loop&quot;: null
                }
            },
            &quot;end_event&quot;: {
                &quot;type&quot;: &quot;EmptyEndEvent&quot;,
                &quot;outgoing&quot;: &quot;&quot;,
                &quot;incoming&quot;: &quot;44ab36ebf4cf119edaf2d20401da87e4&quot;,
                &quot;id&quot;: &quot;60c81e383d048d8a3c574d3436e1b82c&quot;,
                &quot;name&quot;: &quot;&quot;
            },
            &quot;outputs&quot;: [],
            &quot;flows&quot;: {
                &quot;fb2f3a8b533ca5c67e2440b4164f7632&quot;: {
                    &quot;is_default&quot;: false,
                    &quot;source&quot;: &quot;48afea1016ab70ee37179fa0eb1e1a14&quot;,
                    &quot;id&quot;: &quot;fb2f3a8b533ca5c67e2440b4164f7632&quot;,
                    &quot;target&quot;: &quot;631b6576cc5dfbdcaa4f510ce88a7e67&quot;
                },
                &quot;44ab36ebf4cf119edaf2d20401da87e4&quot;: {
                    &quot;is_default&quot;: false,
                    &quot;source&quot;: &quot;631b6576cc5dfbdcaa4f510ce88a7e67&quot;,
                    &quot;id&quot;: &quot;44ab36ebf4cf119edaf2d20401da87e4&quot;,
                    &quot;target&quot;: &quot;60c81e383d048d8a3c574d3436e1b82c&quot;
                }
            },
            &quot;start_event&quot;: {
                &quot;type&quot;: &quot;EmptyStartEvent&quot;,
                &quot;outgoing&quot;: &quot;fb2f3a8b533ca5c67e2440b4164f7632&quot;,
                &quot;incoming&quot;: &quot;&quot;,
                &quot;id&quot;: &quot;48afea1016ab70ee37179fa0eb1e1a14&quot;,
                &quot;name&quot;: &quot;&quot;
            },
            &quot;constants&quot;: {
                &quot;${script_type}&quot;: {
                    &quot;source_tag&quot;: &quot;job_fast_execute_script.script_type&quot;,
                    &quot;source_info&quot;: {
                        &quot;631b6576cc5dfbdcaa4f510ce88a7e67&quot;: [
                            &quot;script_type&quot;
                        ]
                    },
                    &quot;name&quot;: &quot;脚本类型&quot;,
                    &quot;index&quot;: 0,
                    &quot;custom_type&quot;: &quot;radio&quot;,
                    &quot;value&quot;: &quot;4&quot;,
                    &quot;show_type&quot;: &quot;show&quot;,
                    &quot;source_type&quot;: &quot;component_inputs&quot;,
                    &quot;key&quot;: &quot;${script_type}&quot;,
                    &quot;validation&quot;: &quot;^.*$&quot;,
                    &quot;desc&quot;: &quot;&quot;
                },
                &quot;${content}&quot;: {
                    &quot;source_tag&quot;: &quot;&quot;,
                    &quot;source_info&quot;: {},
                    &quot;name&quot;: &quot;内容&quot;,
                    &quot;index&quot;: 2,
                    &quot;custom_type&quot;: &quot;textarea&quot;,
                    &quot;value&quot;: &quot;&quot;,
                    &quot;show_type&quot;: &quot;show&quot;,
                    &quot;source_type&quot;: &quot;custom&quot;,
                    &quot;key&quot;: &quot;${content}&quot;,
                    &quot;desc&quot;: &quot;&quot;
                },
                &quot;${script_timeout}&quot;: {
                    &quot;source_tag&quot;: &quot;job_fast_execute_script.script_timeout&quot;,
                    &quot;source_info&quot;: {
                        &quot;631b6576cc5dfbdcaa4f510ce88a7e67&quot;: [
                            &quot;script_timeout&quot;
                        ]
                    },
                    &quot;name&quot;: &quot;超时时间&quot;,
                    &quot;index&quot;: 1,
                    &quot;custom_type&quot;: &quot;input&quot;,
                    &quot;value&quot;: &quot;&quot;,
                    &quot;show_type&quot;: &quot;show&quot;,
                    &quot;source_type&quot;: &quot;component_inputs&quot;,
                    &quot;key&quot;: &quot;${script_timeout}&quot;,
                    &quot;validation&quot;: &quot;^.*$&quot;,
                    &quot;desc&quot;: &quot;&quot;
                },
                &quot;${params}&quot;: {
                    &quot;source_tag&quot;: &quot;&quot;,
                    &quot;source_info&quot;: {},
                    &quot;name&quot;: &quot;参数&quot;,
                    &quot;index&quot;: 3,
                    &quot;custom_type&quot;: &quot;input&quot;,
                    &quot;value&quot;: &quot;&quot;,
                    &quot;show_type&quot;: &quot;show&quot;,
                    &quot;source_type&quot;: &quot;custom&quot;,
                    &quot;key&quot;: &quot;${params}&quot;,
                    &quot;desc&quot;: &quot;&quot;
                }
            },
            &quot;gateways&quot;: {}
        },
        &quot;bk_biz_name&quot;: &quot;蓝鲸&quot;,
        &quot;id&quot;: 30,
        &quot;editor&quot;: &quot;admin&quot;
    },
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>true/false 查询成功与否</td>
</tr>
<tr>
<td>data</td>
<td>dict</td>
<td>result=true 时模板详情，详细信息见下面说明</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>result=false 时错误信息</td>
</tr>
</tbody>
</table>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>string</td>
<td>模板所属业务 ID</td>
</tr>
<tr>
<td>bk_biz_name</td>
<td>string</td>
<td>模板所属业务名称</td>
</tr>
<tr>
<td>id</td>
<td>int</td>
<td>模板 ID</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>模板名称</td>
</tr>
<tr>
<td>category</td>
<td>string</td>
<td>模板分类，分类信息见下面说明</td>
</tr>
<tr>
<td>creator</td>
<td>string</td>
<td>模板创建人</td>
</tr>
<tr>
<td>create_time</td>
<td>string</td>
<td>模板创建时间</td>
</tr>
<tr>
<td>editor</td>
<td>string 或者 null</td>
<td>模板编辑人</td>
</tr>
<tr>
<td>edit_time</td>
<td>string</td>
<td>模板最新编辑时间</td>
</tr>
<tr>
<td>pipeline_tree</td>
<td>dict</td>
<td>模板任务树信息，详细信息见下面说明</td>
</tr>
</tbody>
</table>
<h4 id="datacategory">data.category</h4>
<table>
<thead>
<tr>
<th>返回值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>OpsTools</td>
<td>运维工具</td>
</tr>
<tr>
<td>MonitorAlarm</td>
<td>监控告警</td>
</tr>
<tr>
<td>ConfManage</td>
<td>配置管理</td>
</tr>
<tr>
<td>DevTools</td>
<td>开发工具</td>
</tr>
<tr>
<td>EnterpriseIT</td>
<td>企业 IT</td>
</tr>
<tr>
<td>OfficeApp</td>
<td>办公应用</td>
</tr>
<tr>
<td>Other</td>
<td>其它</td>
</tr>
</tbody>
</table>
<h4 id="datapipeline_tree">data.pipeline_tree</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>start_event</td>
<td>dict</td>
<td>开始节点信息</td>
</tr>
<tr>
<td>end_event</td>
<td>dict</td>
<td>结束节点信息</td>
</tr>
<tr>
<td>activities</td>
<td>dict</td>
<td>任务节点（原子和子流程）信息</td>
</tr>
<tr>
<td>gateways</td>
<td>dict</td>
<td>网关节点（并行网关、分支网关和汇聚网关）信息</td>
</tr>
<tr>
<td>flows</td>
<td>dict</td>
<td>顺序流（节点连线）信息</td>
</tr>
<tr>
<td>constants</td>
<td>dict</td>
<td>全局变量信息，详情见下面</td>
</tr>
<tr>
<td>outputs</td>
<td>list</td>
<td>模板输出信息，标记 constants 中的输出字段</td>
</tr>
</tbody>
</table>
<h4 id="datapipeline_treeconstantskey">data.pipeline_tree.constants.KEY</h4>
<p>全局变量 KEY，${key} 格式</p>
<h4 id="datapipeline_treeconstantsvalue">data.pipeline_tree.constants.VALUE</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>key</td>
<td>string</td>
<td>同 KEY</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>变量名字</td>
</tr>
<tr>
<td>index</td>
<td>int</td>
<td>变量在模板中的显示顺序</td>
</tr>
<tr>
<td>desc</td>
<td>string</td>
<td>变量说明</td>
</tr>
<tr>
<td>source_type</td>
<td>string</td>
<td>变量来源, 取值范围 custom: 自定义变量，component_inputs: 从原子输入参数勾选，component_outputs：从原子输出结果中勾选</td>
</tr>
<tr>
<td>custom_type</td>
<td>string</td>
<td>source_type=custom 时有效，自定义变量类型， 取值范围 input: 输入框，textarea: 文本框，datetime: 日期时间，int: 整数</td>
</tr>
<tr>
<td>source_tag</td>
<td>string</td>
<td>source_type=component_inputs 或 component_outputs 时有效，变量的来源原子</td>
</tr>
<tr>
<td>source_info</td>
<td>dict</td>
<td>source_type=component_inputs 或 component_outputs 时有效，变量的来源节点信息</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/sops/get_template_list/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>查询业务下的模板列表</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>string</td>
<td>是</td>
<td>模板所属业务 ID</td>
</tr>
<tr>
<td>template_source</td>
<td>string</td>
<td>否</td>
<td>流程模板来源，business:默认值，业务流程，common：公共流程</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_biz_id&quot;: &quot;2&quot;,
    &quot;template_source&quot;: &quot;business&quot;,
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;result&quot;: true,
    &quot;data&quot;: [
        {
            &quot;category&quot;: &quot;Other&quot;,
            &quot;edit_time&quot;: &quot;2018-04-23 17:30:48 +0800&quot;,
            &quot;create_time&quot;: &quot;2018-04-23 17:26:40 +0800&quot;,
            &quot;name&quot;: &quot;快速执行脚本&quot;,
            &quot;bk_biz_id&quot;: &quot;2&quot;,
            &quot;creator&quot;: &quot;admin&quot;,
            &quot;bk_biz_name&quot;: &quot;蓝鲸&quot;,
            &quot;id&quot;: 32,
            &quot;editor&quot;: &quot;admin&quot;
        },
        {
            &quot;category&quot;: &quot;Other&quot;,
            &quot;edit_time&quot;: &quot;2018-04-19 12:04:42 +0800&quot;,
            &quot;create_time&quot;: &quot;2018-04-19 12:04:42 +0800&quot;,
            &quot;name&quot;: &quot;new201804191218&quot;,
            &quot;bk_biz_id&quot;: &quot;2&quot;,
            &quot;creator&quot;: &quot;admin&quot;,
            &quot;bk_biz_name&quot;: &quot;蓝鲸&quot;,
            &quot;id&quot;: 31,
            &quot;editor&quot;: null
        },
        {
            &quot;category&quot;: &quot;Other&quot;,
            &quot;edit_time&quot;: &quot;2018-04-18 17:09:39 +0800&quot;,
            &quot;create_time&quot;: &quot;2018-04-16 21:43:15 +0800&quot;,
            &quot;name&quot;: &quot;new20180416213944&quot;,
            &quot;bk_biz_id&quot;: &quot;2&quot;,
            &quot;creator&quot;: &quot;admin&quot;,
            &quot;bk_biz_name&quot;: &quot;蓝鲸&quot;,
            &quot;id&quot;: 30,
            &quot;editor&quot;: &quot;admin&quot;
        },
    ]
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>true/false 查询成功与否</td>
</tr>
<tr>
<td>data</td>
<td>list</td>
<td>result=true 时模板列表，item 信息见下面说明</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>result=false 时错误信息</td>
</tr>
</tbody>
</table>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>string</td>
<td>模板所属业务 ID</td>
</tr>
<tr>
<td>bk_biz_name</td>
<td>string</td>
<td>模板所属业务名称</td>
</tr>
<tr>
<td>id</td>
<td>int</td>
<td>模板 ID</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>模板名称</td>
</tr>
<tr>
<td>category</td>
<td>string</td>
<td>模板分类，分类信息见下面说明</td>
</tr>
<tr>
<td>creator</td>
<td>string</td>
<td>模板创建人</td>
</tr>
<tr>
<td>create_time</td>
<td>string</td>
<td>模板创建时间</td>
</tr>
<tr>
<td>editor</td>
<td>string 或者 null</td>
<td>模板编辑人</td>
</tr>
<tr>
<td>edit_time</td>
<td>string</td>
<td>模板最新编辑时间</td>
</tr>
</tbody>
</table>
<h4 id="datacategory">data.category</h4>
<table>
<thead>
<tr>
<th>返回值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>OpsTools</td>
<td>运维工具</td>
</tr>
<tr>
<td>MonitorAlarm</td>
<td>监控告警</td>
</tr>
<tr>
<td>ConfManage</td>
<td>配置管理</td>
</tr>
<tr>
<td>DevTools</td>
<td>开发工具</td>
</tr>
<tr>
<td>EnterpriseIT</td>
<td>企业 IT</td>
</tr>
<tr>
<td>OfficeApp</td>
<td>办公应用</td>
</tr>
<tr>
<td>Other</td>
<td>其它</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/sops/get_template_schemes/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>获取模板的执行方案列表</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>参数名称</th>
<th>参数类型</th>
<th>必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>app_code</td>
<td>string</td>
<td>是</td>
<td>蓝鲸应用编码</td>
</tr>
<tr>
<td>app_secret</td>
<td>string</td>
<td>是</td>
<td>蓝鲸应用私密 key</td>
</tr>
<tr>
<td>access_token</td>
<td>string</td>
<td>否</td>
<td>用户登录票据，bk_token 为空时必填</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>用户登录票据，access_token 为空时必填</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>string</td>
<td>是</td>
<td>项目唯一 ID，项目 ID 或 CMDB 业务 ID</td>
</tr>
<tr>
<td>template_id</td>
<td>int</td>
<td>是</td>
<td>模板 ID</td>
</tr>
<tr>
<td>scope</td>
<td>string</td>
<td>否</td>
<td>唯一 ID 的范围，取值为 cmdb_biz 或 project，为 cmdb_biz 时 bk_biz_id 代表业务 ID，反之代表项目 ID，不传时默认为 cmdb_biz</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_biz_id&quot;: &quot;2&quot;,
    &quot;template_id&quot;: &quot;12&quot;
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;result&quot;: true,
    &quot;data&quot;: [
        {
            &quot;id&quot;: &quot;47-1&quot;,
            &quot;name&quot;: &quot;1&quot;,
            &quot;data&quot;: &quot;[\&quot;node7082deed0725aed8c72ecff079ba\&quot;,\&quot;node88d9050f288765b94a15cbe023ab\&quot;]&quot;
        },
        {
            &quot;id&quot;: &quot;47-2&quot;,
            &quot;name&quot;: &quot;2&quot;,
            &quot;data&quot;: &quot;[\&quot;node7082deed0725aed8c72ecff079ba\&quot;]&quot;
        },
        {
            &quot;id&quot;: &quot;47-3&quot;,
            &quot;name&quot;: &quot;3&quot;,
            &quot;data&quot;: &quot;[\&quot;node88d9050f288765b94a15cbe023ab\&quot;]&quot;
        }
    ],
    &quot;code&quot;: 0
}</code></pre>


<h3 id="_9">返回结果说明</h3>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>true/false 成功与否</td>
</tr>
<tr>
<td>data</td>
<td>dict</td>
<td>result=true 时返回数据，详情见下面说明</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>result=false 时错误信息</td>
</tr>
</tbody>
</table>
<h4 id="data">data 说明</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>string</td>
<td>执行方案 ID</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>执行方案名</td>
</tr>
<tr>
<td>data</td>
<td>string</td>
<td>执行方案中包含的节点 ID 列表</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/sops/get_user_project_detail/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>获取项目的详情</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>参数名称</th>
<th>参数类型</th>
<th>必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>app_code</td>
<td>string</td>
<td>是</td>
<td>蓝鲸应用编码</td>
</tr>
<tr>
<td>app_secret</td>
<td>string</td>
<td>是</td>
<td>蓝鲸应用私密 key</td>
</tr>
<tr>
<td>access_token</td>
<td>string</td>
<td>否</td>
<td>用户登录票据，bk_token 为空时必填</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>用户登录票据，access_token 为空时必填</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>string</td>
<td>是</td>
<td>项目唯一 ID，项目 ID 或 CMDB 业务 ID</td>
</tr>
<tr>
<td>scope</td>
<td>string</td>
<td>否</td>
<td>唯一 ID 的范围，取值为 cmdb_biz 或 project，为 cmdb_biz 时 bk_biz_id 代表业务 ID，反之代表项目 ID，不传时默认为 cmdb_biz</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_biz_id&quot;: &quot;2&quot;
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;result&quot;: true,
    &quot;data&quot;: {
        &quot;project_id&quot;: 13,
        &quot;project_name&quot;: &quot;蓝鲸&quot;,
        &quot;bk_biz_id&quot;: 2,
        &quot;from_cmdb&quot;: true,
        &quot;bk_biz_name&quot;: &quot;蓝鲸&quot;,
        &quot;bk_biz_developer&quot;: &quot;&quot;,
        &quot;bk_biz_maintainer&quot;: &quot;admin,gcloudadmin&quot;,
        &quot;bk_biz_tester&quot;: &quot;&quot;,
        &quot;bk_biz_productor&quot;: &quot;&quot;
    },
    &quot;code&quot;: 0
}</code></pre>


<h3 id="_9">返回结果说明</h3>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>true/false 成功与否</td>
</tr>
<tr>
<td>data</td>
<td>dict</td>
<td>result=true 时返回数据，详情见下面说明</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>result=false 时错误信息</td>
</tr>
</tbody>
</table>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>project_id</td>
<td>int</td>
<td>项目 ID</td>
</tr>
<tr>
<td>project_name</td>
<td>string</td>
<td>项目名</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>绑定的 CMDB 业务 ID</td>
</tr>
<tr>
<td>from_cmdb</td>
<td>bool</td>
<td>该项目是否是从 CMDB 业务同步的</td>
</tr>
<tr>
<td>bk_biz_name</td>
<td>string</td>
<td>项目名</td>
</tr>
<tr>
<td>bk_biz_developer</td>
<td>string</td>
<td>业务开发人员列表</td>
</tr>
<tr>
<td>bk_biz_maintainer</td>
<td>string</td>
<td>业务运维人员列表</td>
</tr>
<tr>
<td>bk_biz_tester</td>
<td>string</td>
<td>业务测试人员列表</td>
</tr>
<tr>
<td>bk_biz_productor</td>
<td>string</td>
<td>业务产品人员列表</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/sops/get_user_project_list/</p>
<h3 id="_2">请求方法</h3>
<p>GET</p>
<h3 id="_3">功能描述</h3>
<p>查询用户有权限的项目列表</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>参数名称</th>
<th>参数类型</th>
<th>必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>app_code</td>
<td>string</td>
<td>是</td>
<td>蓝鲸应用编码</td>
</tr>
<tr>
<td>app_secret</td>
<td>string</td>
<td>是</td>
<td>蓝鲸应用私密 key</td>
</tr>
<tr>
<td>access_token</td>
<td>string</td>
<td>否</td>
<td>用户登录票据，bk_token 为空时必填</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>用户登录票据，access_token 为空时必填</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;result&quot;: true,
    &quot;data&quot;: [
        {
            &quot;project_id&quot;: 13,
            &quot;bk_biz_id&quot;: 2,
            &quot;name&quot;: &quot;蓝鲸&quot;
        },
        {
            &quot;project_id&quot;: 14,
            &quot;bk_biz_id&quot;: 3,
            &quot;name&quot;: &quot;la&quot;
        }
    ],
    &quot;code&quot;: 0
}</code></pre>


<h3 id="_9">返回结果说明</h3>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>true/false 成功与否</td>
</tr>
<tr>
<td>data</td>
<td>dict</td>
<td>result=true 时返回数据，详情见下面说明</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>result=false 时错误信息</td>
</tr>
</tbody>
</table>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>project_id</td>
<td>int</td>
<td>项目 ID</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>int</td>
<td>绑定的 CMDB 业务 ID</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>项目名</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/sops/import_common_template/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>导入公共流程</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>参数类型</th>
<th>必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>template_data</td>
<td>string</td>
<td>是</td>
<td>公共流程数据，即从标准运维 - 公共流程 - 导出功能下载的文件的内容</td>
</tr>
<tr>
<td>override</td>
<td>bool</td>
<td>否</td>
<td>是否覆盖 ID 相同的流程</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;template_data&quot;: &quot;xxx&quot;,
    &quot;override&quot;: true,
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;message&quot;: &quot;Successfully imported 2 common flows&quot;,
    &quot;data&quot;: {
        &quot;count&quot;: 2
    },
    &quot;result&quot;: true
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>true/false 成功与否</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>result=false 时错误信息</td>
</tr>
<tr>
<td>data</td>
<td>dict</td>
<td>返回数据</td>
</tr>
</tbody>
</table>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>count</td>
<td>int</td>
<td>导入的流程数</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/sops/import_project_template/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>导入项目流程</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>参数类型</th>
<th>必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>template_data</td>
<td>string</td>
<td>是</td>
<td>项目流程数据，即从标准运维 - 项目流程 - 导出功能下载的文件的内容</td>
</tr>
<tr>
<td>project_id</td>
<td>string</td>
<td>是</td>
<td>项目 ID</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;template_data&quot;: &quot;xxx&quot;,
    &quot;project_id&quot;: &quot;3,
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;message&quot;: &quot;Successfully imported 2 flows&quot;,
    &quot;data&quot;: {
        &quot;count&quot;: 2
    },
    &quot;result&quot;: true
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>true/false 成功与否</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>result=false 时错误信息</td>
</tr>
<tr>
<td>data</td>
<td>dict</td>
<td>返回数据</td>
</tr>
</tbody>
</table>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>count</td>
<td>int</td>
<td>导入的流程数</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/sops/modify_constants_for_periodic_task/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>修改周期任务的全局参数</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>task_id</td>
<td>string</td>
<td>是</td>
<td>周期任务 ID</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>string</td>
<td>是</td>
<td>模板所属业务 ID</td>
</tr>
<tr>
<td>constants</td>
<td>dict</td>
<td>否</td>
<td>任务全局参数，详细信息见下面说明</td>
</tr>
</tbody>
</table>
<h4 id="constantskey">constants.KEY</h4>
<p>变量 KEY，${key} 格式</p>
<h4 id="constantsvalue">constants.VALUE</h4>
<p>变量值</p>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_biz_id&quot;: &quot;2&quot;,
    &quot;task_id&quot;: &quot;8&quot;,
    &quot;constants&quot;: {&quot;${bk_timing}&quot;: &quot;100&quot;},
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;data&quot;: {
        &quot;${bk_timing}&quot;: {
            &quot;source_tag&quot;: &quot;sleep_timer.bk_timing&quot;,
            &quot;source_info&quot;: {
                &quot;node76393dcfedcf73dbc726f1c4786d&quot;: [
                    &quot;bk_timing&quot;
                ]
            },
            &quot;name&quot;: &quot;定时时间&quot;,
            &quot;custom_type&quot;: &quot;&quot;,
            &quot;index&quot;: 0,
            &quot;value&quot;: &quot;15&quot;,
            &quot;show_type&quot;: &quot;show&quot;,
            &quot;source_type&quot;: &quot;component_inputs&quot;,
            &quot;key&quot;: &quot;${bk_timing}&quot;,
            &quot;validation&quot;: &quot;&quot;,
            &quot;desc&quot;: &quot;&quot;
        }
    },
    &quot;result&quot;: true
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>true/false 操作是否成功</td>
</tr>
<tr>
<td>data</td>
<td>dict</td>
<td>result=true 时成功数据，详细信息请见下面说明</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>result=false 时错误信息</td>
</tr>
</tbody>
</table>
<h4 id="datakey">data.KEY</h4>
<p>全局变量 KEY，${key} 格式</p>
<h4 id="datavalue">data.VALUE</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>key</td>
<td>string</td>
<td>同 KEY</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>变量名字</td>
</tr>
<tr>
<td>index</td>
<td>int</td>
<td>变量在模板中的显示顺序</td>
</tr>
<tr>
<td>desc</td>
<td>string</td>
<td>变量说明</td>
</tr>
<tr>
<td>source_type</td>
<td>string</td>
<td>变量来源, 取值范围 custom: 自定义变量，component_inputs: 从原子输入参数勾选，component_outputs：从原子输出结果中勾选</td>
</tr>
<tr>
<td>custom_type</td>
<td>string</td>
<td>source_type=custom 时有效，自定义变量类型， 取值范围 input: 输入框，textarea: 文本框，datetime: 日期时间，int: 整数</td>
</tr>
<tr>
<td>source_tag</td>
<td>string</td>
<td>source_type=component_inputs/component_outputs 时有效，变量的来源原子</td>
</tr>
<tr>
<td>source_info</td>
<td>dict</td>
<td>source_type=component_inputs/component_outputs 时有效，变量的来源节点信息</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/sops/modify_constants_for_task/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>修改任务名称和变量</p>
<h4 id="_4">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_5">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>task_id</td>
<td>string</td>
<td>是</td>
<td>任务 ID，需要任务状态是未开始的</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>string</td>
<td>是</td>
<td>模板所属业务 ID</td>
</tr>
<tr>
<td>constants</td>
<td>dict</td>
<td>是</td>
<td>任务全局参数，详细信息见下面说明</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>否</td>
<td>任务新名称</td>
</tr>
<tr>
<td>scope</td>
<td>string</td>
<td>否</td>
<td>bk_biz_id 检索的作用域。默认为 cmdb_biz，此时检索的是绑定的 CMDB 业务 ID 为 bk_biz_id 的项目；当值为 project 时则检索项目 ID 为 bk_biz_id 的项目</td>
</tr>
</tbody>
</table>
<h4 id="constants-key">constants KEY</h4>
<p>变量 KEY，${key} 格式</p>
<h4 id="constants-value">constants VALUE</h4>
<p>变量值</p>
<h3 id="_6">请求参数示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_biz_id&quot;: &quot;2&quot;,
    &quot;task_id&quot;: &quot;8&quot;,
    &quot;constants&quot;: {
        &quot;${bk_timing}&quot;: &quot;100&quot;
    }
}</code></pre>


<h3 id="_7">返回结果示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;data&quot;: &quot;success&quot;,
    &quot;result&quot;: true
}</code></pre>


<h3 id="_8">返回结果说明</h3>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>true/false 操作是否成功</td>
</tr>
<tr>
<td>data</td>
<td>string</td>
<td>result=true 时成功数据, "success"</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>result=false 时错误信息</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/sops/modify_cron_for_periodic_task/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>修改周期任务的调度策略</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>task_id</td>
<td>string</td>
<td>是</td>
<td>周期任务 ID</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>string</td>
<td>是</td>
<td>模板所属业务 ID</td>
</tr>
<tr>
<td>cron</td>
<td>dict</td>
<td>否</td>
<td>调度策略对象</td>
</tr>
</tbody>
</table>
<h4 id="cron">cron</h4>
<table>
<thead>
<tr>
<th>参数名称</th>
<th>参数类型</th>
<th>必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>minute</td>
<td>string</td>
<td>否</td>
<td>分，默认为 *</td>
</tr>
<tr>
<td>hour</td>
<td>string</td>
<td>否</td>
<td>时，默认为 *</td>
</tr>
<tr>
<td>day_of_week</td>
<td>string</td>
<td>否</td>
<td>一周内的某些天，默认为 *</td>
</tr>
<tr>
<td>day_of_month</td>
<td>string</td>
<td>否</td>
<td>一个月中的某些天，默认为 *</td>
</tr>
<tr>
<td>month_of_year</td>
<td>string</td>
<td>否</td>
<td>一年中的某些月份，默认为 *</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_biz_id&quot;: &quot;2&quot;,
    &quot;task_id&quot;: &quot;8&quot;,
    &quot;cron&quot; : {&quot;minute&quot;: &quot;*/1&quot;, &quot;hour&quot;: &quot;15&quot;, &quot;day_of_week&quot;:&quot;*&quot;, &quot;day_of_month&quot;:&quot;*&quot;, &quot;month_of_year&quot;:&quot;*&quot;},
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;data&quot;: {
        &quot;cron&quot;: &quot;*/1 15 * * * (m/h/d/dM/MY)&quot;
    },
    &quot;result&quot;: true
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>true/false 操作是否成功</td>
</tr>
<tr>
<td>data</td>
<td>dict</td>
<td>result=true 时成功数据，详细信息请见下面说明</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>result=false 时错误信息</td>
</tr>
</tbody>
</table>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>cron</td>
<td>string</td>
<td>调度策略表达式</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/sops/node_callback/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>回调指定的节点</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>参数类型</th>
<th>必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>string</td>
<td>是</td>
<td>所属业务 ID</td>
</tr>
<tr>
<td>task_id</td>
<td>string</td>
<td>是</td>
<td>任务 ID</td>
</tr>
<tr>
<td>node_id</td>
<td>string</td>
<td>是</td>
<td>节点 ID</td>
</tr>
<tr>
<td>callback_data</td>
<td>dict</td>
<td>否</td>
<td>回调数据</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;app_code&quot;: &quot;app_code&quot;,
    &quot;app_secret&quot;: &quot;app_secret&quot;,
    &quot;access_token&quot;: &quot;access_token&quot;,
    &quot;bk_biz_id&quot;: &quot;2&quot;,
    &quot;task_id&quot;: &quot;10&quot;,
    &quot;node_id&quot;: &quot;node0df0431f8f553925af01a94854bd&quot;,
    &quot;callback_data&quot;: {&quot;data&quot;: &quot;data&quot;}
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;message&quot;: &quot;success&quot;,
    &quot;result&quot;: true
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>true/false 成功与否</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>result=false 时错误信息</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/sops/operate_node/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>操作节点</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>参数名称</th>
<th>参数类型</th>
<th>必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>app_code</td>
<td>string</td>
<td>是</td>
<td>蓝鲸应用编码</td>
</tr>
<tr>
<td>app_secret</td>
<td>string</td>
<td>是</td>
<td>蓝鲸应用私密 key</td>
</tr>
<tr>
<td>access_token</td>
<td>string</td>
<td>否</td>
<td>用户登录票据，bk_token 为空时必填</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>用户登录票据，access_token 为空时必填</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>string</td>
<td>是</td>
<td>项目唯一 ID，项目 ID 或 CMDB 业务 ID</td>
</tr>
<tr>
<td>task_id</td>
<td>int</td>
<td>是</td>
<td>任务 ID</td>
</tr>
<tr>
<td>scope</td>
<td>string</td>
<td>否</td>
<td>唯一 ID 的范围，取值为 cmdb_biz 或 project，为 cmdb_biz 时 bk_biz_id 代表业务 ID，反之代表项目 ID，不传时默认为 cmdb_biz</td>
</tr>
<tr>
<td>node_id</td>
<td>string</td>
<td>是</td>
<td>节点 ID</td>
</tr>
<tr>
<td>action</td>
<td>string</td>
<td>是</td>
<td>操作类型，可选值有：callback（节点回调）, skip_exg（跳过执行失败的分支网关）, retry（重试失败节点）, skip（跳过失败的节点）, pause_subproc（暂停正在执行的子流程）, resume_subproc（继续暂停的子流程）</td>
</tr>
<tr>
<td>data</td>
<td>object</td>
<td>否</td>
<td>action 为 callback 时传入的数据</td>
</tr>
<tr>
<td>inputs</td>
<td>object</td>
<td>否</td>
<td>action 为 retry 时重试节点时节点的输入数据</td>
</tr>
<tr>
<td>flow_id</td>
<td>string</td>
<td>否</td>
<td>action 为 skip_exg 时选择执行的分支 id</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_biz_id&quot;: &quot;2&quot;,
    &quot;task_id&quot;: &quot;12&quot;,
    &quot;node_id&quot;: &quot;node_id&quot;,
    &quot;action&quot;: &quot;skip&quot;
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;result&quot;: true,
    &quot;data&quot;: &quot;success&quot;,
    &quot;code&quot;: 0
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>true/false 成功与否</td>
</tr>
<tr>
<td>data</td>
<td>string</td>
<td>result=true 时返回的信息</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>result=false 时错误信息</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/sops/operate_task/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>操作任务，如开始、暂停、继续、终止等</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>string</td>
<td>是</td>
<td>模板所属业务 ID</td>
</tr>
<tr>
<td>task_id</td>
<td>string</td>
<td>是</td>
<td>任务 ID</td>
</tr>
<tr>
<td>action</td>
<td>string</td>
<td>是</td>
<td>操作类型</td>
</tr>
</tbody>
</table>
<h4 id="action">action</h4>
<table>
<thead>
<tr>
<th>值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>start</td>
<td>开始任务，等效于调用 start_task 接口</td>
</tr>
<tr>
<td>pause</td>
<td>暂停任务，任务处于执行状态时调用</td>
</tr>
<tr>
<td>resume</td>
<td>继续任务，任务处于暂停状态时调用</td>
</tr>
<tr>
<td>revoke</td>
<td>终止任务</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;action&quot;: &quot;start&quot;,
    &quot;bk_biz_id&quot;: &quot;2&quot;,
    &quot;task_id&quot;: &quot;10&quot;
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;result&quot;: true,
    &quot;data&quot;: {}
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>true/false 操作是否成功</td>
</tr>
<tr>
<td>data</td>
<td>dict</td>
<td>result=true 时返回数据</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>result=false 时错误信息</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/sops/preview_task_tree/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>获取节点选择后新的任务树</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>参数名称</th>
<th>参数类型</th>
<th>必须</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>app_code</td>
<td>string</td>
<td>是</td>
<td>蓝鲸应用编码</td>
</tr>
<tr>
<td>app_secret</td>
<td>string</td>
<td>是</td>
<td>蓝鲸应用私密 key</td>
</tr>
<tr>
<td>access_token</td>
<td>string</td>
<td>否</td>
<td>用户登录票据，bk_token 为空时必填</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>用户登录票据，access_token 为空时必填</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>string</td>
<td>是</td>
<td>项目唯一 ID，项目 ID 或 CMDB 业务 ID</td>
</tr>
<tr>
<td>template_id</td>
<td>int</td>
<td>是</td>
<td>模板 ID</td>
</tr>
<tr>
<td>scope</td>
<td>string</td>
<td>否</td>
<td>唯一 ID 的范围，取值为 cmdb_biz 或 project，为 cmdb_biz 时 bk_biz_id 代表业务 ID，反之代表项目 ID，不传时默认为 cmdb_biz</td>
</tr>
<tr>
<td>version</td>
<td>string</td>
<td>否</td>
<td>模板的版本，不填时默认为最新版本</td>
</tr>
<tr>
<td>exclude_task_nodes_id</td>
<td>否</td>
<td>需要移除的可选节点 ID 列表，不填时默认为 []</td>
<td></td>
</tr>
<tr>
<td>### 请求参数示例</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<pre class="codehilite"><code class="language-bash">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_biz_id&quot;: &quot;2&quot;,
    &quot;template_id&quot;: &quot;12&quot;
}</code></pre>


<h3 id="_7">返回结果示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;result&quot;: true,
    &quot;data&quot;: {
        &quot;pipeline_tree&quot;: {
            &quot;activities&quot;: {
                &quot;node7082deed0725aed8c72ecff079ba&quot;: {
                    &quot;component&quot;: {
                        &quot;code&quot;: &quot;pause_node&quot;,
                        &quot;data&quot;: {},
                        &quot;version&quot;: &quot;legacy&quot;
                    },
                    &quot;error_ignorable&quot;: false,
                    &quot;id&quot;: &quot;node7082deed0725aed8c72ecff079ba&quot;,
                    &quot;incoming&quot;: [
                        &quot;lineda60368b01cd8828a72585115f88&quot;
                    ],
                    &quot;loop&quot;: null,
                    &quot;name&quot;: &quot;暂停&quot;,
                    &quot;optional&quot;: true,
                    &quot;outgoing&quot;: &quot;line4598d41ef39573f7d7493f934bd8&quot;,
                    &quot;stage_name&quot;: &quot;步骤1&quot;,
                    &quot;type&quot;: &quot;ServiceActivity&quot;,
                    &quot;retryable&quot;: true,
                    &quot;skippable&quot;: true
                },
                &quot;node88d9050f288765b94a15cbe023ab&quot;: {
                    &quot;component&quot;: {
                        &quot;code&quot;: &quot;pause_node&quot;,
                        &quot;data&quot;: {},
                        &quot;version&quot;: &quot;legacy&quot;
                    },
                    &quot;error_ignorable&quot;: false,
                    &quot;id&quot;: &quot;node88d9050f288765b94a15cbe023ab&quot;,
                    &quot;incoming&quot;: [
                        &quot;line4598d41ef39573f7d7493f934bd8&quot;
                    ],
                    &quot;loop&quot;: null,
                    &quot;name&quot;: &quot;暂停&quot;,
                    &quot;optional&quot;: true,
                    &quot;outgoing&quot;: &quot;line9c757e214b4f2ff64437653b8408&quot;,
                    &quot;stage_name&quot;: &quot;步骤1&quot;,
                    &quot;type&quot;: &quot;ServiceActivity&quot;,
                    &quot;retryable&quot;: true,
                    &quot;skippable&quot;: true
                }
            },
            &quot;constants&quot;: {},
            &quot;end_event&quot;: {
                &quot;id&quot;: &quot;node253645bb6f162119e55b7352d8b2&quot;,
                &quot;incoming&quot;: [
                    &quot;line9c757e214b4f2ff64437653b8408&quot;
                ],
                &quot;name&quot;: &quot;&quot;,
                &quot;outgoing&quot;: &quot;&quot;,
                &quot;type&quot;: &quot;EmptyEndEvent&quot;
            },
            &quot;flows&quot;: {
                &quot;lineda60368b01cd8828a72585115f88&quot;: {
                    &quot;id&quot;: &quot;lineda60368b01cd8828a72585115f88&quot;,
                    &quot;is_default&quot;: false,
                    &quot;source&quot;: &quot;nodeb9a3a2a32bb4cfe8761377b2270f&quot;,
                    &quot;target&quot;: &quot;node7082deed0725aed8c72ecff079ba&quot;
                },
                &quot;line4598d41ef39573f7d7493f934bd8&quot;: {
                    &quot;id&quot;: &quot;line4598d41ef39573f7d7493f934bd8&quot;,
                    &quot;is_default&quot;: false,
                    &quot;source&quot;: &quot;node7082deed0725aed8c72ecff079ba&quot;,
                    &quot;target&quot;: &quot;node88d9050f288765b94a15cbe023ab&quot;
                },
                &quot;line9c757e214b4f2ff64437653b8408&quot;: {
                    &quot;id&quot;: &quot;line9c757e214b4f2ff64437653b8408&quot;,
                    &quot;is_default&quot;: false,
                    &quot;source&quot;: &quot;node88d9050f288765b94a15cbe023ab&quot;,
                    &quot;target&quot;: &quot;node253645bb6f162119e55b7352d8b2&quot;
                }
            },
            &quot;gateways&quot;: {},
            &quot;line&quot;: [
                {
                    &quot;id&quot;: &quot;lineda60368b01cd8828a72585115f88&quot;,
                    &quot;source&quot;: {
                        &quot;arrow&quot;: &quot;Right&quot;,
                        &quot;id&quot;: &quot;nodeb9a3a2a32bb4cfe8761377b2270f&quot;
                    },
                    &quot;target&quot;: {
                        &quot;arrow&quot;: &quot;Left&quot;,
                        &quot;id&quot;: &quot;node7082deed0725aed8c72ecff079ba&quot;
                    }
                },
                {
                    &quot;source&quot;: {
                        &quot;arrow&quot;: &quot;Right&quot;,
                        &quot;id&quot;: &quot;node7082deed0725aed8c72ecff079ba&quot;
                    },
                    &quot;target&quot;: {
                        &quot;id&quot;: &quot;node88d9050f288765b94a15cbe023ab&quot;,
                        &quot;arrow&quot;: &quot;Left&quot;
                    },
                    &quot;id&quot;: &quot;line4598d41ef39573f7d7493f934bd8&quot;
                },
                {
                    &quot;source&quot;: {
                        &quot;arrow&quot;: &quot;Right&quot;,
                        &quot;id&quot;: &quot;node88d9050f288765b94a15cbe023ab&quot;
                    },
                    &quot;target&quot;: {
                        &quot;id&quot;: &quot;node253645bb6f162119e55b7352d8b2&quot;,
                        &quot;arrow&quot;: &quot;Left&quot;
                    },
                    &quot;id&quot;: &quot;line9c757e214b4f2ff64437653b8408&quot;
                }
            ],
            &quot;location&quot;: [
                {
                    &quot;id&quot;: &quot;nodeb9a3a2a32bb4cfe8761377b2270f&quot;,
                    &quot;type&quot;: &quot;startpoint&quot;,
                    &quot;x&quot;: 80,
                    &quot;y&quot;: 150
                },
                {
                    &quot;id&quot;: &quot;node7082deed0725aed8c72ecff079ba&quot;,
                    &quot;type&quot;: &quot;tasknode&quot;,
                    &quot;name&quot;: &quot;暂停&quot;,
                    &quot;stage_name&quot;: &quot;步骤1&quot;,
                    &quot;x&quot;: 300,
                    &quot;y&quot;: 150,
                    &quot;group&quot;: &quot;蓝鲸服务(BK)&quot;,
                    &quot;icon&quot;: &quot;&quot;
                },
                {
                    &quot;id&quot;: &quot;node253645bb6f162119e55b7352d8b2&quot;,
                    &quot;type&quot;: &quot;endpoint&quot;,
                    &quot;x&quot;: 820,
                    &quot;y&quot;: 150
                },
                {
                    &quot;id&quot;: &quot;node88d9050f288765b94a15cbe023ab&quot;,
                    &quot;type&quot;: &quot;tasknode&quot;,
                    &quot;name&quot;: &quot;暂停&quot;,
                    &quot;stage_name&quot;: &quot;步骤1&quot;,
                    &quot;x&quot;: 500,
                    &quot;y&quot;: 150,
                    &quot;group&quot;: &quot;蓝鲸服务(BK)&quot;,
                    &quot;icon&quot;: &quot;&quot;
                }
            ],
            &quot;outputs&quot;: [],
            &quot;start_event&quot;: {
                &quot;id&quot;: &quot;nodeb9a3a2a32bb4cfe8761377b2270f&quot;,
                &quot;incoming&quot;: &quot;&quot;,
                &quot;name&quot;: &quot;&quot;,
                &quot;outgoing&quot;: &quot;lineda60368b01cd8828a72585115f88&quot;,
                &quot;type&quot;: &quot;EmptyStartEvent&quot;
            }
        },
        &quot;constants_not_referred&quot;: {}
    },
    &quot;code&quot;: 0
}</code></pre>


<h3 id="_8">返回结果说明</h3>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>true/false 成功与否</td>
</tr>
<tr>
<td>data</td>
<td>dict</td>
<td>result=true 时返回数据，详情见下面说明</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>result=false 时错误信息</td>
</tr>
</tbody>
</table>
<h4 id="data">data 说明</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>pipeline_tree</td>
<td>dict</td>
<td>模板任务树信息，详细信息见下面说明</td>
</tr>
<tr>
<td>constants_not_referred</td>
<td>dict</td>
<td>流程模板中未引用的全局变量，数据结构同 pepeline[constants]</td>
</tr>
</tbody>
</table>
<h5 id="datapipeline_tree">data[pipeline_tree]</h5>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>start_event</td>
<td>dict</td>
<td>开始节点信息</td>
</tr>
<tr>
<td>end_event</td>
<td>dict</td>
<td>结束节点信息</td>
</tr>
<tr>
<td>activities</td>
<td>dict</td>
<td>任务节点（原子和子流程）信息</td>
</tr>
<tr>
<td>gateways</td>
<td>dict</td>
<td>网关节点（并行网关、分支网关和汇聚网关）信息</td>
</tr>
<tr>
<td>flows</td>
<td>dict</td>
<td>顺序流（节点连线）信息</td>
</tr>
<tr>
<td>constants</td>
<td>dict</td>
<td>全局变量信息，详情见下面</td>
</tr>
<tr>
<td>outputs</td>
<td>list</td>
<td>模板输出信息，标记 constants 中的输出字段</td>
</tr>
</tbody>
</table>
<h6 id="datapipeline_treeconstantskey">data.pipeline_tree.constants.KEY</h6>
<p>全局变量 KEY，${key} 格式</p>
<h6 id="datapipeline_treeconstantsvalue">data.pipeline_tree.constants.VALUE</h6>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>key</td>
<td>string</td>
<td>同 KEY</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>变量名字</td>
</tr>
<tr>
<td>index</td>
<td>int</td>
<td>变量在模板中的显示顺序</td>
</tr>
<tr>
<td>desc</td>
<td>string</td>
<td>变量说明</td>
</tr>
<tr>
<td>source_type</td>
<td>string</td>
<td>变量来源, 取值范围 custom: 自定义变量，component_inputs: 从原子输入参数勾选，component_outputs：从原子输出结果中勾选</td>
</tr>
<tr>
<td>custom_type</td>
<td>string</td>
<td>source_type=custom 时有效，自定义变量类型， 取值范围 input: 输入框，textarea: 文本框，datetime: 日期时间，int: 整数</td>
</tr>
<tr>
<td>source_tag</td>
<td>string</td>
<td>source_type=component_inputs</td>
</tr>
<tr>
<td>source_info</td>
<td>dict</td>
<td>source_type=component_inputs</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/sops/query_task_count/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>查询任务实例分类统计总数</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>string</td>
<td>是</td>
<td>模板所属业务 ID</td>
</tr>
<tr>
<td>group_by</td>
<td>string</td>
<td>是</td>
<td>分类统计维度，status：按任务状态（未执行、执行中、已完成）统计，category：按照任务类型统计，flow_type：按照流程类型统计，create_method：按照创建方式</td>
</tr>
<tr>
<td>conditions</td>
<td>dict</td>
<td>否</td>
<td>任务过滤条件</td>
</tr>
</tbody>
</table>
<h4 id="conditions">conditions</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>template_id</td>
<td>string</td>
<td>创建任务的模板 ID</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>任务名称</td>
</tr>
<tr>
<td>creator</td>
<td>string</td>
<td>创建人</td>
</tr>
<tr>
<td>create_time__gte</td>
<td>string</td>
<td>任务创建时间起始时间</td>
</tr>
<tr>
<td>create_time__lte</td>
<td>string</td>
<td>任务创建时间截止时间</td>
</tr>
<tr>
<td>executor</td>
<td>string</td>
<td>执行人</td>
</tr>
<tr>
<td>start_time__gte</td>
<td>string</td>
<td>任务执行时间起始时间</td>
</tr>
<tr>
<td>start_time__lte</td>
<td>string</td>
<td>任务执行时间截止时间</td>
</tr>
<tr>
<td>is_started</td>
<td>bool</td>
<td>任务是否启动</td>
</tr>
<tr>
<td>is_finished</td>
<td>bool</td>
<td>任务是否完成</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_biz_id&quot;: &quot;2&quot;,
    &quot;conditions&quot;: {
        &quot;create_time__lte&quot;: &quot;2018-07-12 10:00:00&quot;,
        &quot;is_started&quot;: true
    },
    &quot;group_by&quot;: &quot;flow_type&quot;
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;data&quot;: {
        &quot;total&quot;: 180,
        &quot;groups&quot;: [
            {
                &quot;code&quot;: &quot;common&quot;,
                &quot;name&quot;: &quot;默认任务流程&quot;,
                &quot;value&quot;: 166
            },
            {
                &quot;code&quot;: &quot;common_func&quot;,
                &quot;name&quot;: &quot;职能化任务流程&quot;,
                &quot;value&quot;: 14
            }
        ]
    },
    &quot;result&quot;: true
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>true/false 操作是否成功</td>
</tr>
<tr>
<td>data</td>
<td>dict</td>
<td>result=true 时返回分类统计信息，详细信息见下面说明</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>result=false 时错误信息</td>
</tr>
</tbody>
</table>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>total</td>
<td>int</td>
<td>按照过滤条件获取的任务总数</td>
</tr>
<tr>
<td>groups</td>
<td>list</td>
<td>按照过滤条件分类分类统计详情</td>
</tr>
</tbody>
</table>
<h4 id="datagroups">data.groups[]</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>code</td>
<td>string</td>
<td>分类统计类型编码</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>分类统计类型名称</td>
</tr>
<tr>
<td>value</td>
<td>string</td>
<td>当前分类任务数量</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/sops/set_periodic_task_enabled/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>设置某个周期任务是否激活</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>task_id</td>
<td>string</td>
<td>是</td>
<td>周期任务 ID</td>
</tr>
<tr>
<td>bk_biz_id</td>
<td>string</td>
<td>是</td>
<td>任务所属业务 ID</td>
</tr>
<tr>
<td>enabled</td>
<td>bool</td>
<td>否</td>
<td>该周期任务是否激活，不传则为 false</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_biz_id&quot;: &quot;2&quot;,
    &quot;task_id&quot;: &quot;8&quot;,
    &quot;enabled&quot;: false
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;data&quot;: {
        &quot;enabled&quot;: false
    },
    &quot;result&quot;: true
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>true/false 操作是否成功</td>
</tr>
<tr>
<td>data</td>
<td>dict</td>
<td>result=true 时成功数据，详细信息请见下面说明</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>result=false 时错误信息</td>
</tr>
</tbody>
</table>
<h4 id="data">data</h4>
<table>
<thead>
<tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>enabled</td>
<td>bool</td>
<td>当前周期任务是否已经激活</td>
</tr>
</tbody>
</table><h3 id="_1">请求地址</h3>
<p>/api/c/compapi/v2/sops/start_task/</p>
<h3 id="_2">请求方法</h3>
<p>POST</p>
<h3 id="_3">功能描述</h3>
<p>开始执行任务</p>
<h3 id="_4">请求参数</h3>
<h4 id="_5">通用参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_app_code</td>
<td>string</td>
<td>是</td>
<td>应用 ID</td>
</tr>
<tr>
<td>bk_app_secret</td>
<td>string</td>
<td>是</td>
<td>安全密钥(应用 TOKEN)，可以通过 蓝鲸智云开发者中心 -&gt; 点击应用 ID -&gt; 基本信息 获取</td>
</tr>
<tr>
<td>bk_token</td>
<td>string</td>
<td>否</td>
<td>当前用户登录态，bk_token 与 bk_username 必须一个有效，bk_token 可以通过 Cookie 获取</td>
</tr>
<tr>
<td>bk_username</td>
<td>string</td>
<td>否</td>
<td>当前用户用户名，应用免登录态验证白名单中的应用，用此字段指定当前用户</td>
</tr>
</tbody>
</table>
<h4 id="_6">接口参数</h4>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bk_biz_id</td>
<td>string</td>
<td>是</td>
<td>模板所属业务 ID</td>
</tr>
<tr>
<td>task_id</td>
<td>string</td>
<td>是</td>
<td>任务 ID</td>
</tr>
</tbody>
</table>
<h3 id="_7">请求参数示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;bk_app_code&quot;: &quot;esb_test&quot;,
    &quot;bk_app_secret&quot;: &quot;xxx&quot;,
    &quot;bk_token&quot;: &quot;xxx&quot;,
    &quot;bk_biz_id&quot;: &quot;2&quot;,
    &quot;task_id&quot;: &quot;10&quot;
}</code></pre>


<h3 id="_8">返回结果示例</h3>
<pre class="codehilite"><code class="language-bash">{
    &quot;result&quot;: true,
    &quot;data&quot;: {}
}</code></pre>


<h3 id="_9">返回结果参数说明</h3>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>bool</td>
<td>true/false 操作是否成功</td>
</tr>
<tr>
<td>data</td>
<td>dict</td>
<td>result=true 时返回数据</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>result=false 时错误信息</td>
</tr>
</tbody>
</table><h1 id="_1">常见问题</h1>
<p>1.标准运维标准插件支持用户接入企业内 IT 系统吗？</p>
<p>支持，接入方式请参考 <a href="../附录/Django.md">附录 2：标准插件开发</a>。</p>
<p>2.标准运维点击开始执行任务后报错：<code>taskflow[id=1] get status error: node(nodee37e20…c7fb131) does not exist, may have not by executed</code>，并且在任务列表中查看任务状态是 <code>未知</code>，可能是什么原因？</p>
<p>标准运维执行引擎依赖于蓝鲸的 RabbitMQ 服务和 App 启动的 Celery 进程，请登录服务器确认服务已启动并正常运行，可以查看 App 的 celery.log 日志文件帮助定位问题原因。</p>
<p>3.标准运维能执行任务，但是标准插件节点报错：<code>Trackback…TypeError:int() argument must be a string or a number,not ‘NoneType’</code>，可能是什么原因？</p>
<p>标准运维任务流程的执行状态和标准插件输入、输出等信息缓存依赖 Redis 服务，所以首次部署请务必按照 [标准运维部署文档]，配置 Redis 环境变量后重新部署。</p><h1 id="_1">定义</h1>
<p>分支表达式是一段符合 Python 语法的简单代码，是二元操作符和关键字组成的表达式。</p><h1 id="_1">语法</h1>
<p>二元操作符语法和使用示例参考下面的表格：</p>
<table>
<thead>
<tr>
<th>二元操作符</th>
<th>含义</th>
<th>示例</th>
</tr>
</thead>
<tbody>
<tr>
<td>==</td>
<td>等于</td>
<td v1="v1">$</td>
</tr>
<tr>
<td>!=</td>
<td>不等于</td>
<td v1="v1">$</td>
</tr>
<tr>
<td>&gt;</td>
<td>大于</td>
<td v1="v1">$</td>
</tr>
<tr>
<td>&lt;</td>
<td>小于</td>
<td v1="v1">$</td>
</tr>
<tr>
<td>&gt;=</td>
<td>大于等于</td>
<td v1="v1">$</td>
</tr>
<tr>
<td>&lt;=</td>
<td>小于等于</td>
<td v1="v1">$</td>
</tr>
<tr>
<td>in</td>
<td>包含于</td>
<td v1="v1">$</td>
</tr>
<tr>
<td>notin</td>
<td>不包含于</td>
<td v1="v1">$</td>
</tr>
</tbody>
</table>
<p>关键字语法和使用示例参考下面的表格</p>
<table>
<thead>
<tr>
<th>关键字</th>
<th>含义</th>
<th>示例</th>
</tr>
</thead>
<tbody>
<tr>
<td>and</td>
<td>且</td>
<td v1="v1">$</td>
</tr>
<tr>
<td>or</td>
<td>或</td>
<td v1="v1">$</td>
</tr>
<tr>
<td>True<br>true</td>
<td>真</td>
<td v1="v1">$</td>
</tr>
<tr>
<td>False<br>false</td>
<td>假</td>
<td v1="v1">$</td>
</tr>
</tbody>
</table>
<p>分支表达式也可以通过 ${key} 方式引用全局变量，如：<code>${v1} == ‘1’</code>，<code>‘test’ in ${v1}</code>。</p><h1 id="_1">分支执行逻辑</h1>
<p>执行到分支网关节点时，标准运维执行引擎分别计算每个分支表达式的结果，得出为 True 或者 False。</p>
<p>如果有多个分支条件为 True，执行分支会根据判定顺序，执行第一个结果为 True 的分支，所以请不要设置多个分支的条件存在并集或者多个分支条件一样，如：</p>
<ul>
<li>分支 1： <code>${v1} &gt; 2</code></li>
<li>分支 2： <code>${v1} &gt; 1</code></li>
<li>分支 3： <code>${v1}  &lt;= 1</code></li>
</ul>
<p>可以改为
- 分支 1： <code>${v1} &gt; 2</code>
- 分支 2： <code>${v1} &gt; 1 and ${v1}  &lt;= 2</code>
- 分支 3： <code>${v1}  &lt;= 1</code></p>
<p>如果所有分支判定为 False，则分支网关执行报错。分支网关出错后需要人工介入，手动指定执行分支，选项是各分支的条件表达式，所以请不要设置多个分支的条件表达式一样，否则出错后无法区分需要执行的分支。</p><h1 id="django-app">创建 Django APP 和目录结构</h1>
<p>在根目录下执行 Django-admin startapp custom_atoms ，然后新建 components/collections 和 static/custom_atoms 目录。</p>
<p><img alt="-w2020" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/assets/31.png" /></p><h1 id="settings">修改 settings 配置</h1>
<p>打开 conf/settings_custom.py 文件，找到 I NSTALL_APPS_CUSTOM，加入步骤 1）中创建的 custom_atoms。</p>
<p><img alt="-w2020" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/assets/32.png" /></p><h1 id="esb-api">接入 ESB API</h1>
<p>如果需要调用自定义的 API，请在完成 ESB 接入后，更新标准运维 blueking/component 下的文件。</p>
<p><img alt="-w2020" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/assets/33.png" /></p><h1 id="_1">标准插件后台开发</h1>
<p>在 custom_atoms/components/collections 目录下创建 test.py 文件，其中需要定义的属性和类如下所示。</p>
<p><img alt="-w2020" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/assets/34.png" /></p>
<p>test.py 属性详解：
- <strong><strong>group_name</strong></strong> ：标准插件所属分类（一般是对应 API 的系统简称，如配置平台(CC)）
- class TestCustomService(Service)：标准插件后台执行逻辑
- <strong><strong>need_schedule</strong></strong> = True：是否是异步执行，默认为 False
- interval = StaticIntervalGenerator(5)：异步标准插件的轮询策略
- def execute：前端参数获取、API 参数组装、结果解析、结果输出
- def schedule：轮询逻辑、结果输出
- def outputs_format：输出参数格式化
- class TestCustomComponent(Component)：标准插件定义
- name： 标准插件名称
- code：唯一编码
- bound_service：绑定后台服务
- form：前端表单定义文件路径  </p>
<p>TestCustomService 中 execute 函数详解：
- 可以是任何 Python 代码，如果对应于 ESB API 调用，一般分为参数组装、API 调用、结果解析。
- data 是标准插件前端数据，对应于前端的表单，可以用 get_one_of_inputs 获取某一个参数；执行完成可以使用 set_outputs 写入返回值和异常信息(ex_data)。
- parent_data 是任务的公共参数，包括 excutor—执行者，operator—操作员，biz_cc_id—所属业务 ID。详细请查看 gcloud/taskflow3/utils.py。
- 返回 True 表示标准插件执行成功，False 表示执行失败。</p>
<p><img alt="-w2020" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/assets/35.png" /></p>
<p>TestCustomService 中 execute 函数详解：
- 返回列表格式。
- 列表格式的每一项定义一个返回字段，是 execute 函数中的 set_outputs 输出的字段的子集；key—输出字段标识，name—输出字段含义，type—输出字段类型（str、int 等 Python 数据结构）。</p>
<p><img alt="-w2020" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/assets/36.png" /></p>
<p>TestCustomService 中 shedule 函数详解：
- 由 interval 控制调用策略，如 pipeline.core.flow.activity.StaticIntervalGenerator（每隔多少秒轮询一次）、DefaultIntervalGenerator（每次轮询间隔时间是上一次的两倍）。
- 使用 self.finish_schedule 结束轮询。
- 返回 True 表示标准插件执行成功，False 表示执行失败。</p>
<p><img alt="-w2020" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/assets/37.png" /></p><h1 id="_1">标准插件前端开发</h1>
<p>在 custom_atoms/static/custom_atoms 目录下创建 test 目录，并创建 test_custom.js 文件，注意文件路径和标准插件后台定义的 form 保持一致。通过 $.atoms 注册标准插件前端配置，其中各项含义是：
- test_custom：标准插件后台定义的 code
- tag_code：参数 code，请保持全局唯一，命名规范为 “系统名_参数名”
- type：前端表单类型，可选 input、textarea、radio、checkbox、select、datetime、datatable、upload、combine 等
- attrs：对应 type 的属性设置，如 name、validation</p>
<p><img alt="-w2020" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/assets/38.png" /></p><h1 id="_1">标准插件测试</h1>
<p>创建流程模板，新增标准插件节点，标准插件类型选择新开发的标准插件，展示的输入参数和前端配置项一致，输出参数和后台 outputs_format 一致，其中执行结果是系统默认，值是 True 或 False，表示节点执行结果是成功还是失败。</p>
<p><img alt="-w2020" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/assets/39.png" /></p>
<p>根据上一步创建的流程模板，新建任务执行后查看结果。</p>
<p><img alt="-w2020" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/assets/40.png" /></p>
<p>如果标准插件执行出错，请先查看节点执行详情，确定是否是代码逻辑异常。</p>
<p><img alt="-w2020" src="F:\v_awjliu\社区版文档\BlueKingDocsTest\ZH/6.0/标准运维/产品白皮书/assets/41.png" /></p>
<p>接着查看 App 组件类型日志，确定是都是 ESB API 调用异常。</p><h1 id="_1">提交代码</h1>
<p>执行 <code>python manage.py collectstatic –noinput</code>，然后就可以提交代码并打包发布了。</p><h1 id="_1">标准插件开发规范</h1>
<ul>
<li>分组命名规则是 “系统名(系统英文缩写)”，如：“作业平台(JOB)”。</li>
<li>标准插件编码 (code) 使用下划线方式，规则是 “系统名_接口名”，如：job_execute_task。</li>
<li>后台类名使用驼峰式，规则是 “标准插件编码+继承类名”，如：JobExecuteTaskService。</li>
<li>前端 JS 文件目录保持和系统名缩写一致，JS 文件名保持和标准插件编码一致。</li>
<li>参数 tag_code 命名规则是 “系统名_参数名”，这样可以保证全局唯一；长度不要超过 20 个字符。</li>
</ul>
    </body>
    </html>
    