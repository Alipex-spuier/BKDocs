# 云凭证

容器管理平台支持导入腾讯云和谷歌云的容器集群。用户可以在项目中配置相应云厂商提供的云凭证，以便在后续集群导入过程中使用。

## 新建凭证

### 前提条件

在新建云凭证之前，请确保已完成以下准备工作：

- 登录蓝鲸平台
- 确认当前用户已在权限中心获得容器管理平台（bk_bcs_app）中相应项目的**云账号创建**权限
- 在对应的云平台上准备好服务密钥或服务账号。不同云厂商的云凭证申请方式、格式及配置方法略有差异，请参考下方[服务账号申请指引](#附服务账号申请指引)

### 填写字段信息

创建云凭证时，需要填写以下信息：

- **凭证名称**：为凭证设置易于识别的名称
- **凭证内容**：
  - 腾讯云：输入SecretID和SecretKey
  - 谷歌云：上传服务账号创建时生成的密钥文件（JSON格式）
- **描述**：填写凭证相关的描述，便于日后管理和区分

## 云凭证管理

### 前提条件

在管理云凭证之前，请确保已完成以下准备工作：

- 登录蓝鲸平台
- 确认当前用户已在权限中心获得容器管理平台（bk_bcs_app）中相应项目的**云账号管理**权限

### 管理云凭证

#### 操作

- 已添加的云凭证无法查看密钥内容，也无法编辑，仅支持删除。

#### 展示

- **腾讯云云凭证分页列表**：
  - **ID**：系统生成的唯一ID
  - **名称**：凭证名称
  - **描述**：凭证的简要说明
  - **SecretID**：完整展示
  - **SecretKey**：脱敏展示，显示前后2个字符
  - **关联集群**：关联的集群信息
  - **创建时间**：凭证创建时间

- **谷歌云云凭证分页列表**：
  - **Google项目ID**：对应Google Cloud项目ID
  - **凭证名称**：凭证名称
  - **描述**：凭证的简要说明（可编辑）
  - **密钥ID**：密钥的唯一标识
  - **OAuth2客户端ID**：关联的OAuth2客户端ID
  - **关联集群**：关联的集群信息
  - **创建时间**：凭证创建时间
  - **创建人**：凭证创建者

## 附：服务账号申请指引

### 腾讯云服务账号申请指引

腾讯云集群管理所需的API密钥，可按以下步骤生成并配置相应权限：

1. **登录腾讯云控制台**  
   进入腾讯云控制台，通过API密钥管理页面生成API密钥。

2. **创建API密钥**  
   - 进入[API密钥管理页面](https://console.cloud.tencent.com/cam/capi)。
   - 点击“新增密钥”，生成SecretID和SecretKey。

3. **配置权限**  
   为确保能够管理容器集群，需要为密钥分配admin权限：
   - 进入[访问管理 CAM](https://console.cloud.tencent.com/cam)页面。
   - 找到相应用户或角色，点击“添加策略”。
   - 选择 `QcloudKubernetesAdmin` 策略，确保API密钥具备容器集群管理权限。

4. **使用API密钥**  
   在容器管理平台中输入生成的SecretID和SecretKey，以完成集群管理和导入。

### 谷歌云服务账号申请指引

谷歌云服务账号和密钥文件的申请步骤如下：

1. **登录Google Cloud控制台**  
   使用Google账户登录[Google Cloud Console](https://console.cloud.google.com/)。

2. **创建服务账号**  
   - 进入[IAM & Admin](https://console.cloud.google.com/iam-admin)页面，点击“创建服务账号”。
   - 输入服务账号名称和描述，点击“创建”。

3. **授予权限**  
   为服务账号分配 `Kubernetes Engine Admin` 角色，以确保其具备集群管理权限：
   - 在“权限”部分，选择 `Kubernetes Engine Admin` 角色并确认。

4. **生成密钥文件**  
   - 创建服务账号后，点击“创建密钥”，并下载生成的JSON格式密钥文件。

5. **使用服务账号密钥**  
   在容器管理平台中上传生成的JSON密钥文件，以完成谷歌云集群的管理。

> 更多详细信息，请参考官方文档：
> - [腾讯云API密钥管理文档](https://cloud.tencent.com/document/product/598/37140)
> - [Google Cloud服务账号文档](https://cloud.google.com/iam/docs/creating-managing-service-accounts)